(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(a){if(a.ep)return;a.ep=!0;const c=t(a);fetch(a.href,c)}})();function eN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Pg={exports:{}},du={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z_;function jA(){if(z_)return du;z_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,c){var d=null;if(c!==void 0&&(d=""+c),a.key!==void 0&&(d=""+a.key),"key"in a){c={};for(var f in a)f!=="key"&&(c[f]=a[f])}else c=a;return a=c.ref,{$$typeof:n,type:r,key:d,ref:a!==void 0?a:null,props:c}}return du.Fragment=e,du.jsx=t,du.jsxs=t,du}var H_;function RA(){return H_||(H_=1,Pg.exports=jA()),Pg.exports}var o=RA(),Og={exports:{}},Fe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_;function CA(){if(G_)return Fe;G_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),E=Symbol.iterator;function A(P){return P===null||typeof P!="object"?null:(P=E&&P[E]||P["@@iterator"],typeof P=="function"?P:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,O={};function z(P,$,le){this.props=P,this.context=$,this.refs=O,this.updater=le||V}z.prototype.isReactComponent={},z.prototype.setState=function(P,$){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,$,"setState")},z.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function ae(){}ae.prototype=z.prototype;function K(P,$,le){this.props=P,this.context=$,this.refs=O,this.updater=le||V}var ee=K.prototype=new ae;ee.constructor=K,C(ee,z.prototype),ee.isPureReactComponent=!0;var B=Array.isArray;function Q(){}var j={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function S(P,$,le){var _e=le.ref;return{$$typeof:n,type:P,key:$,ref:_e!==void 0?_e:null,props:le}}function N(P,$){return S(P.type,$,P.props)}function R(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function D(P){var $={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(le){return $[le]})}var M=/\/+/g;function Te(P,$){return typeof P=="object"&&P!==null&&P.key!=null?D(""+P.key):$.toString(36)}function Pe(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Q,Q):(P.status="pending",P.then(function($){P.status==="pending"&&(P.status="fulfilled",P.value=$)},function($){P.status==="pending"&&(P.status="rejected",P.reason=$)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function W(P,$,le,_e,Ne){var F=typeof P;(F==="undefined"||F==="boolean")&&(P=null);var me=!1;if(P===null)me=!0;else switch(F){case"bigint":case"string":case"number":me=!0;break;case"object":switch(P.$$typeof){case n:case e:me=!0;break;case y:return me=P._init,W(me(P._payload),$,le,_e,Ne)}}if(me)return Ne=Ne(P),me=_e===""?"."+Te(P,0):_e,B(Ne)?(le="",me!=null&&(le=me.replace(M,"$&/")+"/"),W(Ne,$,le,"",function(Be){return Be})):Ne!=null&&(R(Ne)&&(Ne=N(Ne,le+(Ne.key==null||P&&P.key===Ne.key?"":(""+Ne.key).replace(M,"$&/")+"/")+me)),$.push(Ne)),1;me=0;var H=_e===""?".":_e+":";if(B(P))for(var pe=0;pe<P.length;pe++)_e=P[pe],F=H+Te(_e,pe),me+=W(_e,$,le,F,Ne);else if(pe=A(P),typeof pe=="function")for(P=pe.call(P),pe=0;!(_e=P.next()).done;)_e=_e.value,F=H+Te(_e,pe++),me+=W(_e,$,le,F,Ne);else if(F==="object"){if(typeof P.then=="function")return W(Pe(P),$,le,_e,Ne);throw $=String(P),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return me}function ce(P,$,le){if(P==null)return P;var _e=[],Ne=0;return W(P,_e,"","",function(F){return $.call(le,F,Ne++)}),_e}function ve(P){if(P._status===-1){var $=P._result;$=$(),$.then(function(le){(P._status===0||P._status===-1)&&(P._status=1,P._result=le)},function(le){(P._status===0||P._status===-1)&&(P._status=2,P._result=le)}),P._status===-1&&(P._status=0,P._result=$)}if(P._status===1)return P._result.default;throw P._result}var ke=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},Ue={map:ce,forEach:function(P,$,le){ce(P,function(){$.apply(this,arguments)},le)},count:function(P){var $=0;return ce(P,function(){$++}),$},toArray:function(P){return ce(P,function($){return $})||[]},only:function(P){if(!R(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Fe.Activity=v,Fe.Children=Ue,Fe.Component=z,Fe.Fragment=t,Fe.Profiler=a,Fe.PureComponent=K,Fe.StrictMode=r,Fe.Suspense=m,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Fe.__COMPILER_RUNTIME={__proto__:null,c:function(P){return j.H.useMemoCache(P)}},Fe.cache=function(P){return function(){return P.apply(null,arguments)}},Fe.cacheSignal=function(){return null},Fe.cloneElement=function(P,$,le){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var _e=C({},P.props),Ne=P.key;if($!=null)for(F in $.key!==void 0&&(Ne=""+$.key),$)!T.call($,F)||F==="key"||F==="__self"||F==="__source"||F==="ref"&&$.ref===void 0||(_e[F]=$[F]);var F=arguments.length-2;if(F===1)_e.children=le;else if(1<F){for(var me=Array(F),H=0;H<F;H++)me[H]=arguments[H+2];_e.children=me}return S(P.type,Ne,_e)},Fe.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:c,_context:P},P},Fe.createElement=function(P,$,le){var _e,Ne={},F=null;if($!=null)for(_e in $.key!==void 0&&(F=""+$.key),$)T.call($,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(Ne[_e]=$[_e]);var me=arguments.length-2;if(me===1)Ne.children=le;else if(1<me){for(var H=Array(me),pe=0;pe<me;pe++)H[pe]=arguments[pe+2];Ne.children=H}if(P&&P.defaultProps)for(_e in me=P.defaultProps,me)Ne[_e]===void 0&&(Ne[_e]=me[_e]);return S(P,F,Ne)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(P){return{$$typeof:f,render:P}},Fe.isValidElement=R,Fe.lazy=function(P){return{$$typeof:y,_payload:{_status:-1,_result:P},_init:ve}},Fe.memo=function(P,$){return{$$typeof:x,type:P,compare:$===void 0?null:$}},Fe.startTransition=function(P){var $=j.T,le={};j.T=le;try{var _e=P(),Ne=j.S;Ne!==null&&Ne(le,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(Q,ke)}catch(F){ke(F)}finally{$!==null&&le.types!==null&&($.types=le.types),j.T=$}},Fe.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Fe.use=function(P){return j.H.use(P)},Fe.useActionState=function(P,$,le){return j.H.useActionState(P,$,le)},Fe.useCallback=function(P,$){return j.H.useCallback(P,$)},Fe.useContext=function(P){return j.H.useContext(P)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(P,$){return j.H.useDeferredValue(P,$)},Fe.useEffect=function(P,$){return j.H.useEffect(P,$)},Fe.useEffectEvent=function(P){return j.H.useEffectEvent(P)},Fe.useId=function(){return j.H.useId()},Fe.useImperativeHandle=function(P,$,le){return j.H.useImperativeHandle(P,$,le)},Fe.useInsertionEffect=function(P,$){return j.H.useInsertionEffect(P,$)},Fe.useLayoutEffect=function(P,$){return j.H.useLayoutEffect(P,$)},Fe.useMemo=function(P,$){return j.H.useMemo(P,$)},Fe.useOptimistic=function(P,$){return j.H.useOptimistic(P,$)},Fe.useReducer=function(P,$,le){return j.H.useReducer(P,$,le)},Fe.useRef=function(P){return j.H.useRef(P)},Fe.useState=function(P){return j.H.useState(P)},Fe.useSyncExternalStore=function(P,$,le){return j.H.useSyncExternalStore(P,$,le)},Fe.useTransition=function(){return j.H.useTransition()},Fe.version="19.2.1",Fe}var K_;function F0(){return K_||(K_=1,Og.exports=CA()),Og.exports}var L=F0();const hd=eN(L);var Vg={exports:{}},hu={},Lg={exports:{}},Ug={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $_;function kA(){return $_||($_=1,(function(n){function e(W,ce){var ve=W.length;W.push(ce);e:for(;0<ve;){var ke=ve-1>>>1,Ue=W[ke];if(0<a(Ue,ce))W[ke]=ce,W[ve]=Ue,ve=ke;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var ce=W[0],ve=W.pop();if(ve!==ce){W[0]=ve;e:for(var ke=0,Ue=W.length,P=Ue>>>1;ke<P;){var $=2*(ke+1)-1,le=W[$],_e=$+1,Ne=W[_e];if(0>a(le,ve))_e<Ue&&0>a(Ne,le)?(W[ke]=Ne,W[_e]=ve,ke=_e):(W[ke]=le,W[$]=ve,ke=$);else if(_e<Ue&&0>a(Ne,ve))W[ke]=Ne,W[_e]=ve,ke=_e;else break e}}return ce}function a(W,ce){var ve=W.sortIndex-ce.sortIndex;return ve!==0?ve:W.id-ce.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],x=[],y=1,v=null,E=3,A=!1,V=!1,C=!1,O=!1,z=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function ee(W){for(var ce=t(x);ce!==null;){if(ce.callback===null)r(x);else if(ce.startTime<=W)r(x),ce.sortIndex=ce.expirationTime,e(m,ce);else break;ce=t(x)}}function B(W){if(C=!1,ee(W),!V)if(t(m)!==null)V=!0,Q||(Q=!0,D());else{var ce=t(x);ce!==null&&Pe(B,ce.startTime-W)}}var Q=!1,j=-1,T=5,S=-1;function N(){return O?!0:!(n.unstable_now()-S<T)}function R(){if(O=!1,Q){var W=n.unstable_now();S=W;var ce=!0;try{e:{V=!1,C&&(C=!1,ae(j),j=-1),A=!0;var ve=E;try{t:{for(ee(W),v=t(m);v!==null&&!(v.expirationTime>W&&N());){var ke=v.callback;if(typeof ke=="function"){v.callback=null,E=v.priorityLevel;var Ue=ke(v.expirationTime<=W);if(W=n.unstable_now(),typeof Ue=="function"){v.callback=Ue,ee(W),ce=!0;break t}v===t(m)&&r(m),ee(W)}else r(m);v=t(m)}if(v!==null)ce=!0;else{var P=t(x);P!==null&&Pe(B,P.startTime-W),ce=!1}}break e}finally{v=null,E=ve,A=!1}ce=void 0}}finally{ce?D():Q=!1}}}var D;if(typeof K=="function")D=function(){K(R)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Te=M.port2;M.port1.onmessage=R,D=function(){Te.postMessage(null)}}else D=function(){z(R,0)};function Pe(W,ce){j=z(function(){W(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(W){switch(E){case 1:case 2:case 3:var ce=3;break;default:ce=E}var ve=E;E=ce;try{return W()}finally{E=ve}},n.unstable_requestPaint=function(){O=!0},n.unstable_runWithPriority=function(W,ce){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ve=E;E=W;try{return ce()}finally{E=ve}},n.unstable_scheduleCallback=function(W,ce,ve){var ke=n.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ke+ve:ke):ve=ke,W){case 1:var Ue=-1;break;case 2:Ue=250;break;case 5:Ue=1073741823;break;case 4:Ue=1e4;break;default:Ue=5e3}return Ue=ve+Ue,W={id:y++,callback:ce,priorityLevel:W,startTime:ve,expirationTime:Ue,sortIndex:-1},ve>ke?(W.sortIndex=ve,e(x,W),t(m)===null&&W===t(x)&&(C?(ae(j),j=-1):C=!0,Pe(B,ve-ke))):(W.sortIndex=Ue,e(m,W),V||A||(V=!0,Q||(Q=!0,D()))),W},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(W){var ce=E;return function(){var ve=E;E=ce;try{return W.apply(this,arguments)}finally{E=ve}}}})(Ug)),Ug}var Q_;function DA(){return Q_||(Q_=1,Lg.exports=kA()),Lg.exports}var Fg={exports:{}},An={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function MA(){if(Y_)return An;Y_=1;var n=F0();function e(m){var x="https://react.dev/errors/"+m;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)x+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+m+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function c(m,x,y){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:m,containerInfo:x,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,x){if(m==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return An.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,An.createPortal=function(m,x){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(e(299));return c(m,x,null,y)},An.flushSync=function(m){var x=d.T,y=r.p;try{if(d.T=null,r.p=2,m)return m()}finally{d.T=x,r.p=y,r.d.f()}},An.preconnect=function(m,x){typeof m=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,r.d.C(m,x))},An.prefetchDNS=function(m){typeof m=="string"&&r.d.D(m)},An.preinit=function(m,x){if(typeof m=="string"&&x&&typeof x.as=="string"){var y=x.as,v=f(y,x.crossOrigin),E=typeof x.integrity=="string"?x.integrity:void 0,A=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;y==="style"?r.d.S(m,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:v,integrity:E,fetchPriority:A}):y==="script"&&r.d.X(m,{crossOrigin:v,integrity:E,fetchPriority:A,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},An.preinitModule=function(m,x){if(typeof m=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var y=f(x.as,x.crossOrigin);r.d.M(m,{crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&r.d.M(m)},An.preload=function(m,x){if(typeof m=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var y=x.as,v=f(y,x.crossOrigin);r.d.L(m,y,{crossOrigin:v,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},An.preloadModule=function(m,x){if(typeof m=="string")if(x){var y=f(x.as,x.crossOrigin);r.d.m(m,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else r.d.m(m)},An.requestFormReset=function(m){r.d.r(m)},An.unstable_batchedUpdates=function(m,x){return m(x)},An.useFormState=function(m,x,y){return d.H.useFormState(m,x,y)},An.useFormStatus=function(){return d.H.useHostTransitionStatus()},An.version="19.2.1",An}var W_;function PA(){if(W_)return Fg.exports;W_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fg.exports=MA(),Fg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X_;function OA(){if(X_)return hu;X_=1;var n=DA(),e=F0(),t=PA();function r(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(s.tag===31){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function m(s){if(c(s)!==s)throw Error(r(188))}function x(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(r(188));return i!==s?null:s}for(var l=s,u=i;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(u=p.return,u!==null){l=u;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return m(p),s;if(g===u)return m(p),i;g=g.sibling}throw Error(r(188))}if(l.return!==u.return)l=p,u=g;else{for(var _=!1,I=p.child;I;){if(I===l){_=!0,l=p,u=g;break}if(I===u){_=!0,u=p,l=g;break}I=I.sibling}if(!_){for(I=g.child;I;){if(I===l){_=!0,l=g,u=p;break}if(I===u){_=!0,u=g,l=p;break}I=I.sibling}if(!_)throw Error(r(189))}}if(l.alternate!==u)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?s:i}function y(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=y(s),i!==null)return i;s=s.sibling}return null}var v=Object.assign,E=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),K=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function D(s){return s===null||typeof s!="object"?null:(s=R&&s[R]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function Te(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case z:return"Profiler";case O:return"StrictMode";case B:return"Suspense";case Q:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case V:return"Portal";case K:return s.displayName||"Context";case ae:return(s._context.displayName||"Context")+".Consumer";case ee:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case j:return i=s.displayName||null,i!==null?i:Te(s.type)||"Memo";case T:i=s._payload,s=s._init;try{return Te(s(i))}catch{}}return null}var Pe=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ke=[],Ue=-1;function P(s){return{current:s}}function $(s){0>Ue||(s.current=ke[Ue],ke[Ue]=null,Ue--)}function le(s,i){Ue++,ke[Ue]=s.current,s.current=i}var _e=P(null),Ne=P(null),F=P(null),me=P(null);function H(s,i){switch(le(F,i),le(Ne,s),le(_e,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?h_(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=h_(i),s=f_(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$(_e),le(_e,s)}function pe(){$(_e),$(Ne),$(F)}function Be(s){s.memoizedState!==null&&le(me,s);var i=_e.current,l=f_(i,s.type);i!==l&&(le(Ne,s),le(_e,l))}function gt(s){Ne.current===s&&($(_e),$(Ne)),me.current===s&&($(me),ou._currentValue=ve)}var Lt,ns;function En(s){if(Lt===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Lt=i&&i[1]||"",ns=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Lt+s+ns}var gr=!1;function si(s,i){if(!s||gr)return"";gr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(se){var te=se}Reflect.construct(s,[],fe)}else{try{fe.call()}catch(se){te=se}s.call(fe.prototype)}}else{try{throw Error()}catch(se){te=se}(fe=s())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(se){if(se&&te&&typeof se.stack=="string")return[se.stack,te.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),_=g[0],I=g[1];if(_&&I){var U=_.split(`
`),J=I.split(`
`);for(p=u=0;u<U.length&&!U[u].includes("DetermineComponentFrameRoot");)u++;for(;p<J.length&&!J[p].includes("DetermineComponentFrameRoot");)p++;if(u===U.length||p===J.length)for(u=U.length-1,p=J.length-1;1<=u&&0<=p&&U[u]!==J[p];)p--;for(;1<=u&&0<=p;u--,p--)if(U[u]!==J[p]){if(u!==1||p!==1)do if(u--,p--,0>p||U[u]!==J[p]){var oe=`
`+U[u].replace(" at new "," at ");return s.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",s.displayName)),oe}while(1<=u&&0<=p);break}}}finally{gr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?En(l):""}function mc(s,i){switch(s.tag){case 26:case 27:case 5:return En(s.type);case 16:return En("Lazy");case 13:return s.child!==i&&i!==null?En("Suspense Fallback"):En("Suspense");case 19:return En("SuspenseList");case 0:case 15:return si(s.type,!1);case 11:return si(s.type.render,!1);case 1:return si(s.type,!0);case 31:return En("Activity");default:return""}}function Ro(s){try{var i="",l=null;do i+=mc(s,l),l=s,s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ri=Object.prototype.hasOwnProperty,xr=n.unstable_scheduleCallback,yr=n.unstable_cancelCallback,Co=n.unstable_shouldYield,ii=n.unstable_requestPaint,en=n.unstable_now,ko=n.unstable_getCurrentPriorityLevel,Ut=n.unstable_ImmediatePriority,Kt=n.unstable_UserBlockingPriority,ks=n.unstable_NormalPriority,Do=n.unstable_LowPriority,xa=n.unstable_IdlePriority,pc=n.log,br=n.unstable_setDisableYieldValue,Ds=null,on=null;function Bn(s){if(typeof pc=="function"&&br(s),on&&typeof on.setStrictMode=="function")try{on.setStrictMode(Ds,s)}catch{}}var pn=Math.clz32?Math.clz32:Mo,gc=Math.log,ya=Math.LN2;function Mo(s){return s>>>=0,s===0?32:31-(gc(s)/ya|0)|0}var vr=256,xs=262144,Hs=4194304;function ss(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function zn(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var p=0,g=s.suspendedLanes,_=s.pingedLanes;s=s.warmLanes;var I=u&134217727;return I!==0?(u=I&~g,u!==0?p=ss(u):(_&=I,_!==0?p=ss(_):l||(l=I&~s,l!==0&&(p=ss(l))))):(I=u&~g,I!==0?p=ss(I):_!==0?p=ss(_):l||(l=u&~s,l!==0&&(p=ss(l)))),p===0?0:i!==0&&i!==p&&(i&g)===0&&(g=p&-p,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:p}function Gs(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function ai(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ba(){var s=Hs;return Hs<<=1,(Hs&62914560)===0&&(Hs=4194304),s}function Ms(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function Ks(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function tn(s,i,l,u,p,g){var _=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,U=s.expirationTimes,J=s.hiddenUpdates;for(l=_&~l;0<l;){var oe=31-pn(l),fe=1<<oe;I[oe]=0,U[oe]=-1;var te=J[oe];if(te!==null)for(J[oe]=null,oe=0;oe<te.length;oe++){var se=te[oe];se!==null&&(se.lane&=-536870913)}l&=~fe}u!==0&&va(s,u,0),g!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=g&~(_&~i))}function va(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-pn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function Ps(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-pn(l),p=1<<u;p&i|s[u]&i&&(s[u]|=i),l&=~p}}function ys(s,i){var l=i&-i;return l=(l&42)!==0?1:oi(l),(l&(s.suspendedLanes|i))!==0?0:l}function oi(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ne(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ye(){var s=ce.p;return s!==0?s:(s=window.event,s===void 0?32:O_(s.type))}function de(s,i){var l=ce.p;try{return ce.p=s,i()}finally{ce.p=l}}var he=Math.random().toString(36).slice(2),Le="__reactFiber$"+he,at="__reactProps$"+he,Rn="__reactContainer$"+he,li="__reactEvents$"+he,$s="__reactListeners$"+he,Md="__reactHandles$"+he,xc="__reactResources$"+he,_r="__reactMarker$"+he;function _a(s){delete s[Le],delete s[at],delete s[li],delete s[$s],delete s[Md]}function wr(s){var i=s[Le];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Rn]||l[Le]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=v_(s);s!==null;){if(l=s[Le])return l;s=v_(s)}return i}s=l,l=s.parentNode}return null}function Nr(s){if(s=s[Le]||s[Rn]){var i=s.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return s}return null}function wa(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(r(33))}function Os(s){var i=s[xc];return i||(i=s[xc]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Ft(s){s[_r]=!0}var Po=new Set,ci={};function Cn(s,i){Qs(s,i),Qs(s+"Capture",i)}function Qs(s,i){for(ci[s]=i,s=0;s<i.length;s++)Po.add(i[s])}var Om=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yc={},bc={};function Pd(s){return ri.call(bc,s)?!0:ri.call(yc,s)?!1:Om.test(s)?bc[s]=!0:(yc[s]=!0,!1)}function ui(s,i,l){if(Pd(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function di(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function bs(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}function kn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Od(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Vm(s,i,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i);if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,g=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return p.call(this)},set:function(_){l=""+_,g.call(this,_)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(_){l=""+_},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Oo(s){if(!s._valueTracker){var i=Od(s)?"checked":"value";s._valueTracker=Vm(s,i,""+s[i])}}function vc(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=Od(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Vo(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Tr=/[\n"\\]/g;function Rt(s){return s.replace(Tr,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function hi(s,i,l,u,p,g,_,I){s.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?s.type=_:s.removeAttribute("type"),i!=null?_==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+kn(i)):s.value!==""+kn(i)&&(s.value=""+kn(i)):_!=="submit"&&_!=="reset"||s.removeAttribute("value"),i!=null?Lo(s,_,kn(i)):l!=null?Lo(s,_,kn(l)):u!=null&&s.removeAttribute("value"),p==null&&g!=null&&(s.defaultChecked=!!g),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+kn(I):s.removeAttribute("name")}function Na(s,i,l,u,p,g,_,I){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null)){Oo(s);return}l=l!=null?""+kn(l):"",i=i!=null?""+kn(i):l,I||i===s.value||(s.value=i),s.defaultValue=i}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=I?s.checked:!!u,s.defaultChecked=!!u,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.name=_),Oo(s)}function Lo(s,i,l){i==="number"&&Vo(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function nt(s,i,l,u){if(s=s.options,i){i={};for(var p=0;p<l.length;p++)i["$"+l[p]]=!0;for(l=0;l<s.length;l++)p=i.hasOwnProperty("$"+s[l].value),s[l].selected!==p&&(s[l].selected=p),p&&u&&(s[l].defaultSelected=!0)}else{for(l=""+kn(l),i=null,p=0;p<s.length;p++){if(s[p].value===l){s[p].selected=!0,u&&(s[p].defaultSelected=!0);return}i!==null||s[p].disabled||(i=s[p])}i!==null&&(i.selected=!0)}}function Ta(s,i,l){if(i!=null&&(i=""+kn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+kn(l):""}function fi(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(r(92));if(Pe(u)){if(1<u.length)throw Error(r(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=kn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),Oo(s)}function vs(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var Lm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _c(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||Lm.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function Vd(s,i,l){if(i!=null&&typeof i!="object")throw Error(r(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var p in i)u=i[p],i.hasOwnProperty(p)&&l[p]!==u&&_c(s,p,u)}else for(var g in i)i.hasOwnProperty(g)&&_c(s,g,i[g])}function wc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Um=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ys(s){return Fm.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ln(){}var Uo=null;function Fo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Er=null,rs=null;function Ld(s){var i=Nr(s);if(i&&(s=i.stateNode)){var l=s[at]||null;e:switch(s=i.stateNode,i.type){case"input":if(hi(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var p=u[at]||null;if(!p)throw Error(r(90));hi(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&vc(u)}break e;case"textarea":Ta(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&nt(s,!!l.multiple,i,!1)}}}var Nc=!1;function Ud(s,i,l){if(Nc)return s(i,l);Nc=!0;try{var u=s(i);return u}finally{if(Nc=!1,(Er!==null||rs!==null)&&(Ph(),Er&&(i=Er,s=rs,rs=Er=null,Ld(i),s)))for(i=0;i<s.length;i++)Ld(s[i])}}function Hn(s,i){var l=s.stateNode;if(l===null)return null;var u=l[at]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(r(231,i,typeof l));return l}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tc=!1;if(Vs)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){Tc=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{Tc=!1}var is=null,qo=null,Xs=null;function mi(){if(Xs)return Xs;var s,i=qo,l=i.length,u,p="value"in is?is.value:is.textContent,g=p.length;for(s=0;s<l&&i[s]===p[s];s++);var _=l-s;for(u=1;u<=_&&i[l-u]===p[g-u];u++);return Xs=p.slice(s,1<u?1-u:void 0)}function Ea(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function pi(){return!0}function bt(){return!1}function Sn(s){function i(l,u,p,g,_){this._reactName=l,this._targetInst=p,this.type=u,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(g):g[I]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?pi:bt,this.isPropagationStopped=bt,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=pi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=pi)},persist:function(){},isPersistent:pi}),i}var Sr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sa=Sn(Sr),gi=v({},Sr,{view:0,detail:0}),Fd=Sn(gi),xi,Bo,Dn,Aa=v({},gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Dn&&(Dn&&s.type==="mousemove"?(xi=s.screenX-Dn.screenX,Bo=s.screenY-Dn.screenY):Bo=xi=0,Dn=s),xi)},movementY:function(s){return"movementY"in s?s.movementY:Bo}}),qd=Sn(Aa),Ia=v({},Aa,{dataTransfer:0}),Bd=Sn(Ia),Ec=v({},gi,{relatedTarget:0}),yi=Sn(Ec),zd=v({},Sr,{animationName:0,elapsedTime:0,pseudoElement:0}),zo=Sn(zd),qm=v({},Sr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Hd=Sn(qm),ja=v({},Sr,{data:0}),Sc=Sn(ja),Gd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ac={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ic={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Kd(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Ic[s])?!!i[s]:!1}function bi(){return Kd}var $d=v({},gi,{key:function(s){if(s.key){var i=Gd[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ea(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ac[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bi,charCode:function(s){return s.type==="keypress"?Ea(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ea(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Qd=Sn($d),Ar=v({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jc=Sn(Ar),Yd=v({},gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bi}),Wd=Sn(Yd),Xd=v({},Sr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ho=Sn(Xd),Mn=v({},Aa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Jd=Sn(Mn),Zd=v({},Sr,{newState:0,oldState:0}),vi=Sn(Zd),h=[9,13,27,32],b=Vs&&"CompositionEvent"in window,w=null;Vs&&"documentMode"in document&&(w=document.documentMode);var k=Vs&&"TextEvent"in window&&!w,Y=Vs&&(!b||w&&8<w&&11>=w),ie=" ",we=!1;function lt(s,i){switch(s){case"keyup":return h.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $t(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function cn(s,i){switch(s){case"compositionend":return $t(i);case"keypress":return i.which!==32?null:(we=!0,ie);case"textInput":return s=i.data,s===ie&&we?null:s;default:return null}}function un(s,i){if(Ke)return s==="compositionend"||!b&&lt(s,i)?(s=mi(),Xs=qo=is=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Y&&i.locale!=="ko"?null:i.data;default:return null}}var _i={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!_i[s.type]:i==="textarea"}function Ra(s,i,l,u){Er?rs?rs.push(u):rs=[u]:Er=u,i=Bh(i,"onChange"),0<i.length&&(l=new Sa("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var Ir=null,Rc=null;function nS(s){a_(s,0)}function eh(s){var i=wa(s);if(vc(i))return s}function Ey(s,i){if(s==="change")return i}var Sy=!1;if(Vs){var Bm;if(Vs){var zm="oninput"in document;if(!zm){var Ay=document.createElement("div");Ay.setAttribute("oninput","return;"),zm=typeof Ay.oninput=="function"}Bm=zm}else Bm=!1;Sy=Bm&&(!document.documentMode||9<document.documentMode)}function Iy(){Ir&&(Ir.detachEvent("onpropertychange",jy),Rc=Ir=null)}function jy(s){if(s.propertyName==="value"&&eh(Rc)){var i=[];Ra(i,Rc,s,Fo(s)),Ud(nS,i)}}function sS(s,i,l){s==="focusin"?(Iy(),Ir=i,Rc=l,Ir.attachEvent("onpropertychange",jy)):s==="focusout"&&Iy()}function rS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return eh(Rc)}function iS(s,i){if(s==="click")return eh(i)}function aS(s,i){if(s==="input"||s==="change")return eh(i)}function oS(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var as=typeof Object.is=="function"?Object.is:oS;function Cc(s,i){if(as(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var p=l[u];if(!ri.call(i,p)||!as(s[p],i[p]))return!1}return!0}function Ry(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Cy(s,i){var l=Ry(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Ry(l)}}function ky(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?ky(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Dy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Vo(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Vo(s.document)}return i}function Hm(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var lS=Vs&&"documentMode"in document&&11>=document.documentMode,Go=null,Gm=null,kc=null,Km=!1;function My(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Km||Go==null||Go!==Vo(u)||(u=Go,"selectionStart"in u&&Hm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),kc&&Cc(kc,u)||(kc=u,u=Bh(Gm,"onSelect"),0<u.length&&(i=new Sa("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=Go)))}function Ca(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var Ko={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionrun:Ca("Transition","TransitionRun"),transitionstart:Ca("Transition","TransitionStart"),transitioncancel:Ca("Transition","TransitionCancel"),transitionend:Ca("Transition","TransitionEnd")},$m={},Py={};Vs&&(Py=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function ka(s){if($m[s])return $m[s];if(!Ko[s])return s;var i=Ko[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in Py)return $m[s]=i[l];return s}var Oy=ka("animationend"),Vy=ka("animationiteration"),Ly=ka("animationstart"),cS=ka("transitionrun"),uS=ka("transitionstart"),dS=ka("transitioncancel"),Uy=ka("transitionend"),Fy=new Map,Qm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qm.push("scrollEnd");function Ls(s,i){Fy.set(s,i),Cn(i,[s])}var th=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},_s=[],$o=0,Ym=0;function nh(){for(var s=$o,i=Ym=$o=0;i<s;){var l=_s[i];_s[i++]=null;var u=_s[i];_s[i++]=null;var p=_s[i];_s[i++]=null;var g=_s[i];if(_s[i++]=null,u!==null&&p!==null){var _=u.pending;_===null?p.next=p:(p.next=_.next,_.next=p),u.pending=p}g!==0&&qy(l,p,g)}}function sh(s,i,l,u){_s[$o++]=s,_s[$o++]=i,_s[$o++]=l,_s[$o++]=u,Ym|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Wm(s,i,l,u){return sh(s,i,l,u),rh(s)}function Da(s,i){return sh(s,null,null,i),rh(s)}function qy(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var p=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(p=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,p&&i!==null&&(p=31-pn(l),s=g.hiddenUpdates,u=s[p],u===null?s[p]=[i]:u.push(i),i.lane=l|536870912),g):null}function rh(s){if(50<eu)throw eu=0,ig=null,Error(r(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Qo={};function hS(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function os(s,i,l,u){return new hS(s,i,l,u)}function Xm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function jr(s,i){var l=s.alternate;return l===null?(l=os(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function By(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function ih(s,i,l,u,p,g){var _=0;if(u=s,typeof s=="function")Xm(s)&&(_=1);else if(typeof s=="string")_=xA(s,l,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=os(31,l,i,p),s.elementType=S,s.lanes=g,s;case C:return Ma(l.children,p,g,i);case O:_=8,p|=24;break;case z:return s=os(12,l,i,p|2),s.elementType=z,s.lanes=g,s;case B:return s=os(13,l,i,p),s.elementType=B,s.lanes=g,s;case Q:return s=os(19,l,i,p),s.elementType=Q,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case K:_=10;break e;case ae:_=9;break e;case ee:_=11;break e;case j:_=14;break e;case T:_=16,u=null;break e}_=29,l=Error(r(130,s===null?"null":typeof s,"")),u=null}return i=os(_,l,i,p),i.elementType=s,i.type=u,i.lanes=g,i}function Ma(s,i,l,u){return s=os(7,s,u,i),s.lanes=l,s}function Jm(s,i,l){return s=os(6,s,null,i),s.lanes=l,s}function zy(s){var i=os(18,null,null,0);return i.stateNode=s,i}function Zm(s,i,l){return i=os(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var Hy=new WeakMap;function ws(s,i){if(typeof s=="object"&&s!==null){var l=Hy.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Ro(i)},Hy.set(s,i),i)}return{value:s,source:i,stack:Ro(i)}}var Yo=[],Wo=0,ah=null,Dc=0,Ns=[],Ts=0,wi=null,Js=1,Zs="";function Rr(s,i){Yo[Wo++]=Dc,Yo[Wo++]=ah,ah=s,Dc=i}function Gy(s,i,l){Ns[Ts++]=Js,Ns[Ts++]=Zs,Ns[Ts++]=wi,wi=s;var u=Js;s=Zs;var p=32-pn(u)-1;u&=~(1<<p),l+=1;var g=32-pn(i)+p;if(30<g){var _=p-p%5;g=(u&(1<<_)-1).toString(32),u>>=_,p-=_,Js=1<<32-pn(i)+p|l<<p|u,Zs=g+s}else Js=1<<g|l<<p|u,Zs=s}function ep(s){s.return!==null&&(Rr(s,1),Gy(s,1,0))}function tp(s){for(;s===ah;)ah=Yo[--Wo],Yo[Wo]=null,Dc=Yo[--Wo],Yo[Wo]=null;for(;s===wi;)wi=Ns[--Ts],Ns[Ts]=null,Zs=Ns[--Ts],Ns[Ts]=null,Js=Ns[--Ts],Ns[Ts]=null}function Ky(s,i){Ns[Ts++]=Js,Ns[Ts++]=Zs,Ns[Ts++]=wi,Js=i.id,Zs=i.overflow,wi=s}var gn=null,vt=null,et=!1,Ni=null,Es=!1,np=Error(r(519));function Ti(s){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mc(ws(i,s)),np}function $y(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Le]=s,i[at]=u,l){case"dialog":Qe("cancel",i),Qe("close",i);break;case"iframe":case"object":case"embed":Qe("load",i);break;case"video":case"audio":for(l=0;l<nu.length;l++)Qe(nu[l],i);break;case"source":Qe("error",i);break;case"img":case"image":case"link":Qe("error",i),Qe("load",i);break;case"details":Qe("toggle",i);break;case"input":Qe("invalid",i),Na(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qe("invalid",i);break;case"textarea":Qe("invalid",i),fi(i,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||u_(i.textContent,l)?(u.popover!=null&&(Qe("beforetoggle",i),Qe("toggle",i)),u.onScroll!=null&&Qe("scroll",i),u.onScrollEnd!=null&&Qe("scrollend",i),u.onClick!=null&&(i.onclick=ln),i=!0):i=!1,i||Ti(s,!0)}function Qy(s){for(gn=s.return;gn;)switch(gn.tag){case 5:case 31:case 13:Es=!1;return;case 27:case 3:Es=!0;return;default:gn=gn.return}}function Xo(s){if(s!==gn)return!1;if(!et)return Qy(s),et=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||vg(s.type,s.memoizedProps)),l=!l),l&&vt&&Ti(s),Qy(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));vt=b_(s)}else if(i===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));vt=b_(s)}else i===27?(i=vt,Li(s.type)?(s=Eg,Eg=null,vt=s):vt=i):vt=gn?As(s.stateNode.nextSibling):null;return!0}function Pa(){vt=gn=null,et=!1}function sp(){var s=Ni;return s!==null&&(Yn===null?Yn=s:Yn.push.apply(Yn,s),Ni=null),s}function Mc(s){Ni===null?Ni=[s]:Ni.push(s)}var rp=P(null),Oa=null,Cr=null;function Ei(s,i,l){le(rp,i._currentValue),i._currentValue=l}function kr(s){s._currentValue=rp.current,$(rp)}function ip(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function ap(s,i,l,u){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var g=p.dependencies;if(g!==null){var _=p.child;g=g.firstContext;e:for(;g!==null;){var I=g;g=p;for(var U=0;U<i.length;U++)if(I.context===i[U]){g.lanes|=l,I=g.alternate,I!==null&&(I.lanes|=l),ip(g.return,l,s),u||(_=null);break e}g=I.next}}else if(p.tag===18){if(_=p.return,_===null)throw Error(r(341));_.lanes|=l,g=_.alternate,g!==null&&(g.lanes|=l),ip(_,l,s),_=null}else _=p.child;if(_!==null)_.return=p;else for(_=p;_!==null;){if(_===s){_=null;break}if(p=_.sibling,p!==null){p.return=_.return,_=p;break}_=_.return}p=_}}function Jo(s,i,l,u){s=null;for(var p=i,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var _=p.alternate;if(_===null)throw Error(r(387));if(_=_.memoizedProps,_!==null){var I=p.type;as(p.pendingProps.value,_.value)||(s!==null?s.push(I):s=[I])}}else if(p===me.current){if(_=p.alternate,_===null)throw Error(r(387));_.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(ou):s=[ou])}p=p.return}s!==null&&ap(i,s,l,u),i.flags|=262144}function oh(s){for(s=s.firstContext;s!==null;){if(!as(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Va(s){Oa=s,Cr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function xn(s){return Yy(Oa,s)}function lh(s,i){return Oa===null&&Va(s),Yy(s,i)}function Yy(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},Cr===null){if(s===null)throw Error(r(308));Cr=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Cr=Cr.next=i;return l}var fS=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},mS=n.unstable_scheduleCallback,pS=n.unstable_NormalPriority,Qt={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function op(){return{controller:new fS,data:new Map,refCount:0}}function Pc(s){s.refCount--,s.refCount===0&&mS(pS,function(){s.controller.abort()})}var Oc=null,lp=0,Zo=0,el=null;function gS(s,i){if(Oc===null){var l=Oc=[];lp=0,Zo=dg(),el={status:"pending",value:void 0,then:function(u){l.push(u)}}}return lp++,i.then(Wy,Wy),i}function Wy(){if(--lp===0&&Oc!==null){el!==null&&(el.status="fulfilled");var s=Oc;Oc=null,Zo=0,el=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function xS(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var p=0;p<l.length;p++)(0,l[p])(i)},function(p){for(u.status="rejected",u.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),u}var Xy=W.S;W.S=function(s,i){Mv=en(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&gS(s,i),Xy!==null&&Xy(s,i)};var La=P(null);function cp(){var s=La.current;return s!==null?s:xt.pooledCache}function ch(s,i){i===null?le(La,La.current):le(La,i.pool)}function Jy(){var s=cp();return s===null?null:{parent:Qt._currentValue,pool:s}}var tl=Error(r(460)),up=Error(r(474)),uh=Error(r(542)),dh={then:function(){}};function Zy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function eb(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(ln,ln),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,nb(s),s;default:if(typeof i.status=="string")i.then(ln,ln);else{if(s=xt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=u}},function(u){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,nb(s),s}throw Fa=i,tl}}function Ua(s){try{var i=s._init;return i(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Fa=l,tl):l}}var Fa=null;function tb(){if(Fa===null)throw Error(r(459));var s=Fa;return Fa=null,s}function nb(s){if(s===tl||s===uh)throw Error(r(483))}var nl=null,Vc=0;function hh(s){var i=Vc;return Vc+=1,nl===null&&(nl=[]),eb(nl,s,i)}function Lc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function fh(s,i){throw i.$$typeof===E?Error(r(525)):(s=Object.prototype.toString.call(i),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function sb(s){function i(G,q){if(s){var X=G.deletions;X===null?(G.deletions=[q],G.flags|=16):X.push(q)}}function l(G,q){if(!s)return null;for(;q!==null;)i(G,q),q=q.sibling;return null}function u(G){for(var q=new Map;G!==null;)G.key!==null?q.set(G.key,G):q.set(G.index,G),G=G.sibling;return q}function p(G,q){return G=jr(G,q),G.index=0,G.sibling=null,G}function g(G,q,X){return G.index=X,s?(X=G.alternate,X!==null?(X=X.index,X<q?(G.flags|=67108866,q):X):(G.flags|=67108866,q)):(G.flags|=1048576,q)}function _(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function I(G,q,X,ue){return q===null||q.tag!==6?(q=Jm(X,G.mode,ue),q.return=G,q):(q=p(q,X),q.return=G,q)}function U(G,q,X,ue){var Me=X.type;return Me===C?oe(G,q,X.props.children,ue,X.key):q!==null&&(q.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===T&&Ua(Me)===q.type)?(q=p(q,X.props),Lc(q,X),q.return=G,q):(q=ih(X.type,X.key,X.props,null,G.mode,ue),Lc(q,X),q.return=G,q)}function J(G,q,X,ue){return q===null||q.tag!==4||q.stateNode.containerInfo!==X.containerInfo||q.stateNode.implementation!==X.implementation?(q=Zm(X,G.mode,ue),q.return=G,q):(q=p(q,X.children||[]),q.return=G,q)}function oe(G,q,X,ue,Me){return q===null||q.tag!==7?(q=Ma(X,G.mode,ue,Me),q.return=G,q):(q=p(q,X),q.return=G,q)}function fe(G,q,X){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Jm(""+q,G.mode,X),q.return=G,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case A:return X=ih(q.type,q.key,q.props,null,G.mode,X),Lc(X,q),X.return=G,X;case V:return q=Zm(q,G.mode,X),q.return=G,q;case T:return q=Ua(q),fe(G,q,X)}if(Pe(q)||D(q))return q=Ma(q,G.mode,X,null),q.return=G,q;if(typeof q.then=="function")return fe(G,hh(q),X);if(q.$$typeof===K)return fe(G,lh(G,q),X);fh(G,q)}return null}function te(G,q,X,ue){var Me=q!==null?q.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return Me!==null?null:I(G,q,""+X,ue);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case A:return X.key===Me?U(G,q,X,ue):null;case V:return X.key===Me?J(G,q,X,ue):null;case T:return X=Ua(X),te(G,q,X,ue)}if(Pe(X)||D(X))return Me!==null?null:oe(G,q,X,ue,null);if(typeof X.then=="function")return te(G,q,hh(X),ue);if(X.$$typeof===K)return te(G,q,lh(G,X),ue);fh(G,X)}return null}function se(G,q,X,ue,Me){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return G=G.get(X)||null,I(q,G,""+ue,Me);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case A:return G=G.get(ue.key===null?X:ue.key)||null,U(q,G,ue,Me);case V:return G=G.get(ue.key===null?X:ue.key)||null,J(q,G,ue,Me);case T:return ue=Ua(ue),se(G,q,X,ue,Me)}if(Pe(ue)||D(ue))return G=G.get(X)||null,oe(q,G,ue,Me,null);if(typeof ue.then=="function")return se(G,q,X,hh(ue),Me);if(ue.$$typeof===K)return se(G,q,X,lh(q,ue),Me);fh(q,ue)}return null}function je(G,q,X,ue){for(var Me=null,st=null,Ce=q,Ge=q=0,Xe=null;Ce!==null&&Ge<X.length;Ge++){Ce.index>Ge?(Xe=Ce,Ce=null):Xe=Ce.sibling;var rt=te(G,Ce,X[Ge],ue);if(rt===null){Ce===null&&(Ce=Xe);break}s&&Ce&&rt.alternate===null&&i(G,Ce),q=g(rt,q,Ge),st===null?Me=rt:st.sibling=rt,st=rt,Ce=Xe}if(Ge===X.length)return l(G,Ce),et&&Rr(G,Ge),Me;if(Ce===null){for(;Ge<X.length;Ge++)Ce=fe(G,X[Ge],ue),Ce!==null&&(q=g(Ce,q,Ge),st===null?Me=Ce:st.sibling=Ce,st=Ce);return et&&Rr(G,Ge),Me}for(Ce=u(Ce);Ge<X.length;Ge++)Xe=se(Ce,G,Ge,X[Ge],ue),Xe!==null&&(s&&Xe.alternate!==null&&Ce.delete(Xe.key===null?Ge:Xe.key),q=g(Xe,q,Ge),st===null?Me=Xe:st.sibling=Xe,st=Xe);return s&&Ce.forEach(function(zi){return i(G,zi)}),et&&Rr(G,Ge),Me}function Ve(G,q,X,ue){if(X==null)throw Error(r(151));for(var Me=null,st=null,Ce=q,Ge=q=0,Xe=null,rt=X.next();Ce!==null&&!rt.done;Ge++,rt=X.next()){Ce.index>Ge?(Xe=Ce,Ce=null):Xe=Ce.sibling;var zi=te(G,Ce,rt.value,ue);if(zi===null){Ce===null&&(Ce=Xe);break}s&&Ce&&zi.alternate===null&&i(G,Ce),q=g(zi,q,Ge),st===null?Me=zi:st.sibling=zi,st=zi,Ce=Xe}if(rt.done)return l(G,Ce),et&&Rr(G,Ge),Me;if(Ce===null){for(;!rt.done;Ge++,rt=X.next())rt=fe(G,rt.value,ue),rt!==null&&(q=g(rt,q,Ge),st===null?Me=rt:st.sibling=rt,st=rt);return et&&Rr(G,Ge),Me}for(Ce=u(Ce);!rt.done;Ge++,rt=X.next())rt=se(Ce,G,Ge,rt.value,ue),rt!==null&&(s&&rt.alternate!==null&&Ce.delete(rt.key===null?Ge:rt.key),q=g(rt,q,Ge),st===null?Me=rt:st.sibling=rt,st=rt);return s&&Ce.forEach(function(IA){return i(G,IA)}),et&&Rr(G,Ge),Me}function mt(G,q,X,ue){if(typeof X=="object"&&X!==null&&X.type===C&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case A:e:{for(var Me=X.key;q!==null;){if(q.key===Me){if(Me=X.type,Me===C){if(q.tag===7){l(G,q.sibling),ue=p(q,X.props.children),ue.return=G,G=ue;break e}}else if(q.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===T&&Ua(Me)===q.type){l(G,q.sibling),ue=p(q,X.props),Lc(ue,X),ue.return=G,G=ue;break e}l(G,q);break}else i(G,q);q=q.sibling}X.type===C?(ue=Ma(X.props.children,G.mode,ue,X.key),ue.return=G,G=ue):(ue=ih(X.type,X.key,X.props,null,G.mode,ue),Lc(ue,X),ue.return=G,G=ue)}return _(G);case V:e:{for(Me=X.key;q!==null;){if(q.key===Me)if(q.tag===4&&q.stateNode.containerInfo===X.containerInfo&&q.stateNode.implementation===X.implementation){l(G,q.sibling),ue=p(q,X.children||[]),ue.return=G,G=ue;break e}else{l(G,q);break}else i(G,q);q=q.sibling}ue=Zm(X,G.mode,ue),ue.return=G,G=ue}return _(G);case T:return X=Ua(X),mt(G,q,X,ue)}if(Pe(X))return je(G,q,X,ue);if(D(X)){if(Me=D(X),typeof Me!="function")throw Error(r(150));return X=Me.call(X),Ve(G,q,X,ue)}if(typeof X.then=="function")return mt(G,q,hh(X),ue);if(X.$$typeof===K)return mt(G,q,lh(G,X),ue);fh(G,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,q!==null&&q.tag===6?(l(G,q.sibling),ue=p(q,X),ue.return=G,G=ue):(l(G,q),ue=Jm(X,G.mode,ue),ue.return=G,G=ue),_(G)):l(G,q)}return function(G,q,X,ue){try{Vc=0;var Me=mt(G,q,X,ue);return nl=null,Me}catch(Ce){if(Ce===tl||Ce===uh)throw Ce;var st=os(29,Ce,null,G.mode);return st.lanes=ue,st.return=G,st}finally{}}}var qa=sb(!0),rb=sb(!1),Si=!1;function dp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hp(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ai(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ii(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(ot&2)!==0){var p=u.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),u.pending=i,i=rh(s),qy(s,null,l),i}return sh(s,u,i,l),rh(s)}function Uc(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Ps(s,l)}}function fp(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var _={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=_:g=g.next=_,l=l.next}while(l!==null);g===null?p=g=i:g=g.next=i}else p=g=i;l={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var mp=!1;function Fc(){if(mp){var s=el;if(s!==null)throw s}}function qc(s,i,l,u){mp=!1;var p=s.updateQueue;Si=!1;var g=p.firstBaseUpdate,_=p.lastBaseUpdate,I=p.shared.pending;if(I!==null){p.shared.pending=null;var U=I,J=U.next;U.next=null,_===null?g=J:_.next=J,_=U;var oe=s.alternate;oe!==null&&(oe=oe.updateQueue,I=oe.lastBaseUpdate,I!==_&&(I===null?oe.firstBaseUpdate=J:I.next=J,oe.lastBaseUpdate=U))}if(g!==null){var fe=p.baseState;_=0,oe=J=U=null,I=g;do{var te=I.lane&-536870913,se=te!==I.lane;if(se?(We&te)===te:(u&te)===te){te!==0&&te===Zo&&(mp=!0),oe!==null&&(oe=oe.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var je=s,Ve=I;te=i;var mt=l;switch(Ve.tag){case 1:if(je=Ve.payload,typeof je=="function"){fe=je.call(mt,fe,te);break e}fe=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Ve.payload,te=typeof je=="function"?je.call(mt,fe,te):je,te==null)break e;fe=v({},fe,te);break e;case 2:Si=!0}}te=I.callback,te!==null&&(s.flags|=64,se&&(s.flags|=8192),se=p.callbacks,se===null?p.callbacks=[te]:se.push(te))}else se={lane:te,tag:I.tag,payload:I.payload,callback:I.callback,next:null},oe===null?(J=oe=se,U=fe):oe=oe.next=se,_|=te;if(I=I.next,I===null){if(I=p.shared.pending,I===null)break;se=I,I=se.next,se.next=null,p.lastBaseUpdate=se,p.shared.pending=null}}while(!0);oe===null&&(U=fe),p.baseState=U,p.firstBaseUpdate=J,p.lastBaseUpdate=oe,g===null&&(p.shared.lanes=0),Di|=_,s.lanes=_,s.memoizedState=fe}}function ib(s,i){if(typeof s!="function")throw Error(r(191,s));s.call(i)}function ab(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)ib(l[s],i)}var sl=P(null),mh=P(0);function ob(s,i){s=qr,le(mh,s),le(sl,i),qr=s|i.baseLanes}function pp(){le(mh,qr),le(sl,sl.current)}function gp(){qr=mh.current,$(sl),$(mh)}var ls=P(null),Ss=null;function ji(s){var i=s.alternate;le(qt,qt.current&1),le(ls,s),Ss===null&&(i===null||sl.current!==null||i.memoizedState!==null)&&(Ss=s)}function xp(s){le(qt,qt.current),le(ls,s),Ss===null&&(Ss=s)}function lb(s){s.tag===22?(le(qt,qt.current),le(ls,s),Ss===null&&(Ss=s)):Ri()}function Ri(){le(qt,qt.current),le(ls,ls.current)}function cs(s){$(ls),Ss===s&&(Ss=null),$(qt)}var qt=P(0);function ph(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Ng(l)||Tg(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dr=0,ze=null,ht=null,Yt=null,gh=!1,rl=!1,Ba=!1,xh=0,Bc=0,il=null,yS=0;function Ct(){throw Error(r(321))}function yp(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!as(s[l],i[l]))return!1;return!0}function bp(s,i,l,u,p,g){return Dr=g,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,W.H=s===null||s.memoizedState===null?Gb:Mp,Ba=!1,g=l(u,p),Ba=!1,rl&&(g=ub(i,l,u,p)),cb(s),g}function cb(s){W.H=Gc;var i=ht!==null&&ht.next!==null;if(Dr=0,Yt=ht=ze=null,gh=!1,Bc=0,il=null,i)throw Error(r(300));s===null||Wt||(s=s.dependencies,s!==null&&oh(s)&&(Wt=!0))}function ub(s,i,l,u){ze=s;var p=0;do{if(rl&&(il=null),Bc=0,rl=!1,25<=p)throw Error(r(301));if(p+=1,Yt=ht=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}W.H=Kb,g=i(l,u)}while(rl);return g}function bS(){var s=W.H,i=s.useState()[0];return i=typeof i.then=="function"?zc(i):i,s=s.useState()[0],(ht!==null?ht.memoizedState:null)!==s&&(ze.flags|=1024),i}function vp(){var s=xh!==0;return xh=0,s}function _p(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function wp(s){if(gh){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}gh=!1}Dr=0,Yt=ht=ze=null,rl=!1,Bc=xh=0,il=null}function Pn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?ze.memoizedState=Yt=s:Yt=Yt.next=s,Yt}function Bt(){if(ht===null){var s=ze.alternate;s=s!==null?s.memoizedState:null}else s=ht.next;var i=Yt===null?ze.memoizedState:Yt.next;if(i!==null)Yt=i,ht=s;else{if(s===null)throw ze.alternate===null?Error(r(467)):Error(r(310));ht=s,s={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},Yt===null?ze.memoizedState=Yt=s:Yt=Yt.next=s}return Yt}function yh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zc(s){var i=Bc;return Bc+=1,il===null&&(il=[]),s=eb(il,s,i),i=ze,(Yt===null?i.memoizedState:Yt.next)===null&&(i=i.alternate,W.H=i===null||i.memoizedState===null?Gb:Mp),s}function bh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return zc(s);if(s.$$typeof===K)return xn(s)}throw Error(r(438,String(s)))}function Np(s){var i=null,l=ze.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=ze.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=yh(),ze.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=N;return i.index++,l}function Mr(s,i){return typeof i=="function"?i(s):i}function vh(s){var i=Bt();return Tp(i,ht,s)}function Tp(s,i,l){var u=s.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=l;var p=s.baseQueue,g=u.pending;if(g!==null){if(p!==null){var _=p.next;p.next=g.next,g.next=_}i.baseQueue=p=g,u.pending=null}if(g=s.baseState,p===null)s.memoizedState=g;else{i=p.next;var I=_=null,U=null,J=i,oe=!1;do{var fe=J.lane&-536870913;if(fe!==J.lane?(We&fe)===fe:(Dr&fe)===fe){var te=J.revertLane;if(te===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),fe===Zo&&(oe=!0);else if((Dr&te)===te){J=J.next,te===Zo&&(oe=!0);continue}else fe={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=fe,_=g):U=U.next=fe,ze.lanes|=te,Di|=te;fe=J.action,Ba&&l(g,fe),g=J.hasEagerState?J.eagerState:l(g,fe)}else te={lane:fe,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(I=U=te,_=g):U=U.next=te,ze.lanes|=fe,Di|=fe;J=J.next}while(J!==null&&J!==i);if(U===null?_=g:U.next=I,!as(g,s.memoizedState)&&(Wt=!0,oe&&(l=el,l!==null)))throw l;s.memoizedState=g,s.baseState=_,s.baseQueue=U,u.lastRenderedState=g}return p===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Ep(s){var i=Bt(),l=i.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=s;var u=l.dispatch,p=l.pending,g=i.memoizedState;if(p!==null){l.pending=null;var _=p=p.next;do g=s(g,_.action),_=_.next;while(_!==p);as(g,i.memoizedState)||(Wt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function db(s,i,l){var u=ze,p=Bt(),g=et;if(g){if(l===void 0)throw Error(r(407));l=l()}else l=i();var _=!as((ht||p).memoizedState,l);if(_&&(p.memoizedState=l,Wt=!0),p=p.queue,Ip(mb.bind(null,u,p,s),[s]),p.getSnapshot!==i||_||Yt!==null&&Yt.memoizedState.tag&1){if(u.flags|=2048,al(9,{destroy:void 0},fb.bind(null,u,p,l,i),null),xt===null)throw Error(r(349));g||(Dr&127)!==0||hb(u,i,l)}return l}function hb(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=ze.updateQueue,i===null?(i=yh(),ze.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function fb(s,i,l,u){i.value=l,i.getSnapshot=u,pb(i)&&gb(s)}function mb(s,i,l){return l(function(){pb(i)&&gb(s)})}function pb(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!as(s,l)}catch{return!0}}function gb(s){var i=Da(s,2);i!==null&&Wn(i,s,2)}function Sp(s){var i=Pn();if(typeof s=="function"){var l=s;if(s=l(),Ba){Bn(!0);try{l()}finally{Bn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mr,lastRenderedState:s},i}function xb(s,i,l,u){return s.baseState=l,Tp(s,ht,typeof u=="function"?u:Mr)}function vS(s,i,l,u,p){if(Nh(s))throw Error(r(485));if(s=i.action,s!==null){var g={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){g.listeners.push(_)}};W.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,yb(i,g)):(g.next=l.next,i.pending=l.next=g)}}function yb(s,i){var l=i.action,u=i.payload,p=s.state;if(i.isTransition){var g=W.T,_={};W.T=_;try{var I=l(p,u),U=W.S;U!==null&&U(_,I),bb(s,i,I)}catch(J){Ap(s,i,J)}finally{g!==null&&_.types!==null&&(g.types=_.types),W.T=g}}else try{g=l(p,u),bb(s,i,g)}catch(J){Ap(s,i,J)}}function bb(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){vb(s,i,u)},function(u){return Ap(s,i,u)}):vb(s,i,l)}function vb(s,i,l){i.status="fulfilled",i.value=l,_b(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,yb(s,l)))}function Ap(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,_b(i),i=i.next;while(i!==u)}s.action=null}function _b(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function wb(s,i){return i}function Nb(s,i){if(et){var l=xt.formState;if(l!==null){e:{var u=ze;if(et){if(vt){t:{for(var p=vt,g=Es;p.nodeType!==8;){if(!g){p=null;break t}if(p=As(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){vt=As(p.nextSibling),u=p.data==="F!";break e}}Ti(u)}u=!1}u&&(i=l[0])}}return l=Pn(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wb,lastRenderedState:i},l.queue=u,l=Bb.bind(null,ze,u),u.dispatch=l,u=Sp(!1),g=Dp.bind(null,ze,!1,u.queue),u=Pn(),p={state:i,dispatch:null,action:s,pending:null},u.queue=p,l=vS.bind(null,ze,p,g,l),p.dispatch=l,u.memoizedState=s,[i,l,!1]}function Tb(s){var i=Bt();return Eb(i,ht,s)}function Eb(s,i,l){if(i=Tp(s,i,wb)[0],s=vh(Mr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=zc(i)}catch(_){throw _===tl?uh:_}else u=i;i=Bt();var p=i.queue,g=p.dispatch;return l!==i.memoizedState&&(ze.flags|=2048,al(9,{destroy:void 0},_S.bind(null,p,l),null)),[u,g,s]}function _S(s,i){s.action=i}function Sb(s){var i=Bt(),l=ht;if(l!==null)return Eb(i,l,s);Bt(),i=i.memoizedState,l=Bt();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function al(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=ze.updateQueue,i===null&&(i=yh(),ze.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function Ab(){return Bt().memoizedState}function _h(s,i,l,u){var p=Pn();ze.flags|=s,p.memoizedState=al(1|i,{destroy:void 0},l,u===void 0?null:u)}function wh(s,i,l,u){var p=Bt();u=u===void 0?null:u;var g=p.memoizedState.inst;ht!==null&&u!==null&&yp(u,ht.memoizedState.deps)?p.memoizedState=al(i,g,l,u):(ze.flags|=s,p.memoizedState=al(1|i,g,l,u))}function Ib(s,i){_h(8390656,8,s,i)}function Ip(s,i){wh(2048,8,s,i)}function wS(s){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=yh(),ze.updateQueue=i,i.events=[s];else{var l=i.events;l===null?i.events=[s]:l.push(s)}}function jb(s){var i=Bt().memoizedState;return wS({ref:i,nextImpl:s}),function(){if((ot&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Rb(s,i){return wh(4,2,s,i)}function Cb(s,i){return wh(4,4,s,i)}function kb(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Db(s,i,l){l=l!=null?l.concat([s]):null,wh(4,4,kb.bind(null,i,s),l)}function jp(){}function Mb(s,i){var l=Bt();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&yp(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function Pb(s,i){var l=Bt();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&yp(i,u[1]))return u[0];if(u=s(),Ba){Bn(!0);try{s()}finally{Bn(!1)}}return l.memoizedState=[u,i],u}function Rp(s,i,l){return l===void 0||(Dr&1073741824)!==0&&(We&261930)===0?s.memoizedState=i:(s.memoizedState=l,s=Ov(),ze.lanes|=s,Di|=s,l)}function Ob(s,i,l,u){return as(l,i)?l:sl.current!==null?(s=Rp(s,l,u),as(s,i)||(Wt=!0),s):(Dr&42)===0||(Dr&1073741824)!==0&&(We&261930)===0?(Wt=!0,s.memoizedState=l):(s=Ov(),ze.lanes|=s,Di|=s,i)}function Vb(s,i,l,u,p){var g=ce.p;ce.p=g!==0&&8>g?g:8;var _=W.T,I={};W.T=I,Dp(s,!1,i,l);try{var U=p(),J=W.S;if(J!==null&&J(I,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var oe=xS(U,u);Hc(s,i,oe,hs(s))}else Hc(s,i,u,hs(s))}catch(fe){Hc(s,i,{then:function(){},status:"rejected",reason:fe},hs())}finally{ce.p=g,_!==null&&I.types!==null&&(_.types=I.types),W.T=_}}function NS(){}function Cp(s,i,l,u){if(s.tag!==5)throw Error(r(476));var p=Lb(s).queue;Vb(s,p,i,ve,l===null?NS:function(){return Ub(s),l(u)})}function Lb(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mr,lastRenderedState:ve},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mr,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Ub(s){var i=Lb(s);i.next===null&&(i=s.alternate.memoizedState),Hc(s,i.next.queue,{},hs())}function kp(){return xn(ou)}function Fb(){return Bt().memoizedState}function qb(){return Bt().memoizedState}function TS(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=hs();s=Ai(l);var u=Ii(i,s,l);u!==null&&(Wn(u,i,l),Uc(u,i,l)),i={cache:op()},s.payload=i;return}i=i.return}}function ES(s,i,l){var u=hs();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Nh(s)?zb(i,l):(l=Wm(s,i,l,u),l!==null&&(Wn(l,s,u),Hb(l,i,u)))}function Bb(s,i,l){var u=hs();Hc(s,i,l,u)}function Hc(s,i,l,u){var p={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Nh(s))zb(i,p);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var _=i.lastRenderedState,I=g(_,l);if(p.hasEagerState=!0,p.eagerState=I,as(I,_))return sh(s,i,p,0),xt===null&&nh(),!1}catch{}finally{}if(l=Wm(s,i,p,u),l!==null)return Wn(l,s,u),Hb(l,i,u),!0}return!1}function Dp(s,i,l,u){if(u={lane:2,revertLane:dg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Nh(s)){if(i)throw Error(r(479))}else i=Wm(s,l,u,2),i!==null&&Wn(i,s,2)}function Nh(s){var i=s.alternate;return s===ze||i!==null&&i===ze}function zb(s,i){rl=gh=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function Hb(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Ps(s,l)}}var Gc={readContext:xn,use:bh,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useLayoutEffect:Ct,useInsertionEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useSyncExternalStore:Ct,useId:Ct,useHostTransitionStatus:Ct,useFormState:Ct,useActionState:Ct,useOptimistic:Ct,useMemoCache:Ct,useCacheRefresh:Ct};Gc.useEffectEvent=Ct;var Gb={readContext:xn,use:bh,useCallback:function(s,i){return Pn().memoizedState=[s,i===void 0?null:i],s},useContext:xn,useEffect:Ib,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,_h(4194308,4,kb.bind(null,i,s),l)},useLayoutEffect:function(s,i){return _h(4194308,4,s,i)},useInsertionEffect:function(s,i){_h(4,2,s,i)},useMemo:function(s,i){var l=Pn();i=i===void 0?null:i;var u=s();if(Ba){Bn(!0);try{s()}finally{Bn(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=Pn();if(l!==void 0){var p=l(i);if(Ba){Bn(!0);try{l(i)}finally{Bn(!1)}}}else p=i;return u.memoizedState=u.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},u.queue=s,s=s.dispatch=ES.bind(null,ze,s),[u.memoizedState,s]},useRef:function(s){var i=Pn();return s={current:s},i.memoizedState=s},useState:function(s){s=Sp(s);var i=s.queue,l=Bb.bind(null,ze,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:jp,useDeferredValue:function(s,i){var l=Pn();return Rp(l,s,i)},useTransition:function(){var s=Sp(!1);return s=Vb.bind(null,ze,s.queue,!0,!1),Pn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=ze,p=Pn();if(et){if(l===void 0)throw Error(r(407));l=l()}else{if(l=i(),xt===null)throw Error(r(349));(We&127)!==0||hb(u,i,l)}p.memoizedState=l;var g={value:l,getSnapshot:i};return p.queue=g,Ib(mb.bind(null,u,g,s),[s]),u.flags|=2048,al(9,{destroy:void 0},fb.bind(null,u,g,l,i),null),l},useId:function(){var s=Pn(),i=xt.identifierPrefix;if(et){var l=Zs,u=Js;l=(u&~(1<<32-pn(u)-1)).toString(32)+l,i="_"+i+"R_"+l,l=xh++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=yS++,i="_"+i+"r_"+l.toString(32)+"_";return s.memoizedState=i},useHostTransitionStatus:kp,useFormState:Nb,useActionState:Nb,useOptimistic:function(s){var i=Pn();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=Dp.bind(null,ze,!0,l),l.dispatch=i,[s,i]},useMemoCache:Np,useCacheRefresh:function(){return Pn().memoizedState=TS.bind(null,ze)},useEffectEvent:function(s){var i=Pn(),l={impl:s};return i.memoizedState=l,function(){if((ot&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}},Mp={readContext:xn,use:bh,useCallback:Mb,useContext:xn,useEffect:Ip,useImperativeHandle:Db,useInsertionEffect:Rb,useLayoutEffect:Cb,useMemo:Pb,useReducer:vh,useRef:Ab,useState:function(){return vh(Mr)},useDebugValue:jp,useDeferredValue:function(s,i){var l=Bt();return Ob(l,ht.memoizedState,s,i)},useTransition:function(){var s=vh(Mr)[0],i=Bt().memoizedState;return[typeof s=="boolean"?s:zc(s),i]},useSyncExternalStore:db,useId:Fb,useHostTransitionStatus:kp,useFormState:Tb,useActionState:Tb,useOptimistic:function(s,i){var l=Bt();return xb(l,ht,s,i)},useMemoCache:Np,useCacheRefresh:qb};Mp.useEffectEvent=jb;var Kb={readContext:xn,use:bh,useCallback:Mb,useContext:xn,useEffect:Ip,useImperativeHandle:Db,useInsertionEffect:Rb,useLayoutEffect:Cb,useMemo:Pb,useReducer:Ep,useRef:Ab,useState:function(){return Ep(Mr)},useDebugValue:jp,useDeferredValue:function(s,i){var l=Bt();return ht===null?Rp(l,s,i):Ob(l,ht.memoizedState,s,i)},useTransition:function(){var s=Ep(Mr)[0],i=Bt().memoizedState;return[typeof s=="boolean"?s:zc(s),i]},useSyncExternalStore:db,useId:Fb,useHostTransitionStatus:kp,useFormState:Sb,useActionState:Sb,useOptimistic:function(s,i){var l=Bt();return ht!==null?xb(l,ht,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Np,useCacheRefresh:qb};Kb.useEffectEvent=jb;function Pp(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:v({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Op={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=hs(),p=Ai(u);p.payload=i,l!=null&&(p.callback=l),i=Ii(s,p,u),i!==null&&(Wn(i,s,u),Uc(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=hs(),p=Ai(u);p.tag=1,p.payload=i,l!=null&&(p.callback=l),i=Ii(s,p,u),i!==null&&(Wn(i,s,u),Uc(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=hs(),u=Ai(l);u.tag=2,i!=null&&(u.callback=i),i=Ii(s,u,l),i!==null&&(Wn(i,s,l),Uc(i,s,l))}};function $b(s,i,l,u,p,g,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,_):i.prototype&&i.prototype.isPureReactComponent?!Cc(l,u)||!Cc(p,g):!0}function Qb(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&Op.enqueueReplaceState(i,i.state,null)}function za(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=v({},l));for(var p in s)l[p]===void 0&&(l[p]=s[p])}return l}function Yb(s){th(s)}function Wb(s){console.error(s)}function Xb(s){th(s)}function Th(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function Jb(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Vp(s,i,l){return l=Ai(l),l.tag=3,l.payload={element:null},l.callback=function(){Th(s,i)},l}function Zb(s){return s=Ai(s),s.tag=3,s}function ev(s,i,l,u){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=u.value;s.payload=function(){return p(g)},s.callback=function(){Jb(i,l,u)}}var _=l.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(s.callback=function(){Jb(i,l,u),typeof p!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})})}function SS(s,i,l,u,p){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&Jo(i,l,p,!0),l=ls.current,l!==null){switch(l.tag){case 31:case 13:return Ss===null?Oh():l.alternate===null&&kt===0&&(kt=3),l.flags&=-257,l.flags|=65536,l.lanes=p,u===dh?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),lg(s,u,p)),!1;case 22:return l.flags|=65536,u===dh?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),lg(s,u,p)),!1}throw Error(r(435,l.tag))}return lg(s,u,p),Oh(),!1}if(et)return i=ls.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,u!==np&&(s=Error(r(422),{cause:u}),Mc(ws(s,l)))):(u!==np&&(i=Error(r(423),{cause:u}),Mc(ws(i,l))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,u=ws(u,l),p=Vp(s.stateNode,u,p),fp(s,p),kt!==4&&(kt=2)),!1;var g=Error(r(520),{cause:u});if(g=ws(g,l),Zc===null?Zc=[g]:Zc.push(g),kt!==4&&(kt=2),i===null)return!0;u=ws(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=p&-p,l.lanes|=s,s=Vp(l.stateNode,u,s),fp(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Mi===null||!Mi.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=Zb(p),ev(p,s,l,u),fp(l,p),!1}l=l.return}while(l!==null);return!1}var Lp=Error(r(461)),Wt=!1;function yn(s,i,l,u){i.child=s===null?rb(i,null,l,u):qa(i,s.child,l,u)}function tv(s,i,l,u,p){l=l.render;var g=i.ref;if("ref"in u){var _={};for(var I in u)I!=="ref"&&(_[I]=u[I])}else _=u;return Va(i),u=bp(s,i,l,_,g,p),I=vp(),s!==null&&!Wt?(_p(s,i,p),Pr(s,i,p)):(et&&I&&ep(i),i.flags|=1,yn(s,i,u,p),i.child)}function nv(s,i,l,u,p){if(s===null){var g=l.type;return typeof g=="function"&&!Xm(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,sv(s,i,g,u,p)):(s=ih(l.type,null,u,i,i.mode,p),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!Kp(s,p)){var _=g.memoizedProps;if(l=l.compare,l=l!==null?l:Cc,l(_,u)&&s.ref===i.ref)return Pr(s,i,p)}return i.flags|=1,s=jr(g,u),s.ref=i.ref,s.return=i,i.child=s}function sv(s,i,l,u,p){if(s!==null){var g=s.memoizedProps;if(Cc(g,u)&&s.ref===i.ref)if(Wt=!1,i.pendingProps=u=g,Kp(s,p))(s.flags&131072)!==0&&(Wt=!0);else return i.lanes=s.lanes,Pr(s,i,p)}return Up(s,i,l,u,p)}function rv(s,i,l,u){var p=u.children,g=s!==null?s.memoizedState:null;if(s===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,s!==null){for(u=i.child=s.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~g}else u=0,i.child=null;return iv(s,i,g,l,u)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&ch(i,g!==null?g.cachePool:null),g!==null?ob(i,g):pp(),lb(i);else return u=i.lanes=536870912,iv(s,i,g!==null?g.baseLanes|l:l,l,u)}else g!==null?(ch(i,g.cachePool),ob(i,g),Ri(),i.memoizedState=null):(s!==null&&ch(i,null),pp(),Ri());return yn(s,i,p,l),i.child}function Kc(s,i){return s!==null&&s.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function iv(s,i,l,u,p){var g=cp();return g=g===null?null:{parent:Qt._currentValue,pool:g},i.memoizedState={baseLanes:l,cachePool:g},s!==null&&ch(i,null),pp(),lb(i),s!==null&&Jo(s,i,u,!0),i.childLanes=p,null}function Eh(s,i){return i=Ah({mode:i.mode,children:i.children},s.mode),i.ref=s.ref,s.child=i,i.return=s,i}function av(s,i,l){return qa(i,s.child,null,l),s=Eh(i,i.pendingProps),s.flags|=2,cs(i),i.memoizedState=null,s}function AS(s,i,l){var u=i.pendingProps,p=(i.flags&128)!==0;if(i.flags&=-129,s===null){if(et){if(u.mode==="hidden")return s=Eh(i,u),i.lanes=536870912,Kc(null,s);if(xp(i),(s=vt)?(s=y_(s,Es),s=s!==null&&s.data==="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:wi!==null?{id:Js,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},l=zy(s),l.return=i,i.child=l,gn=i,vt=null)):s=null,s===null)throw Ti(i);return i.lanes=536870912,null}return Eh(i,u)}var g=s.memoizedState;if(g!==null){var _=g.dehydrated;if(xp(i),p)if(i.flags&256)i.flags&=-257,i=av(s,i,l);else if(i.memoizedState!==null)i.child=s.child,i.flags|=128,i=null;else throw Error(r(558));else if(Wt||Jo(s,i,l,!1),p=(l&s.childLanes)!==0,Wt||p){if(u=xt,u!==null&&(_=ys(u,l),_!==0&&_!==g.retryLane))throw g.retryLane=_,Da(s,_),Wn(u,s,_),Lp;Oh(),i=av(s,i,l)}else s=g.treeContext,vt=As(_.nextSibling),gn=i,et=!0,Ni=null,Es=!1,s!==null&&Ky(i,s),i=Eh(i,u),i.flags|=4096;return i}return s=jr(s.child,{mode:u.mode,children:u.children}),s.ref=i.ref,i.child=s,s.return=i,s}function Sh(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function Up(s,i,l,u,p){return Va(i),l=bp(s,i,l,u,void 0,p),u=vp(),s!==null&&!Wt?(_p(s,i,p),Pr(s,i,p)):(et&&u&&ep(i),i.flags|=1,yn(s,i,l,p),i.child)}function ov(s,i,l,u,p,g){return Va(i),i.updateQueue=null,l=ub(i,u,l,p),cb(s),u=vp(),s!==null&&!Wt?(_p(s,i,g),Pr(s,i,g)):(et&&u&&ep(i),i.flags|=1,yn(s,i,l,g),i.child)}function lv(s,i,l,u,p){if(Va(i),i.stateNode===null){var g=Qo,_=l.contextType;typeof _=="object"&&_!==null&&(g=xn(_)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Op,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},dp(i),_=l.contextType,g.context=typeof _=="object"&&_!==null?xn(_):Qo,g.state=i.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(Pp(i,l,_,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(_=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),_!==g.state&&Op.enqueueReplaceState(g,g.state,null),qc(i,u,g,p),Fc(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var I=i.memoizedProps,U=za(l,I);g.props=U;var J=g.context,oe=l.contextType;_=Qo,typeof oe=="object"&&oe!==null&&(_=xn(oe));var fe=l.getDerivedStateFromProps;oe=typeof fe=="function"||typeof g.getSnapshotBeforeUpdate=="function",I=i.pendingProps!==I,oe||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(I||J!==_)&&Qb(i,g,u,_),Si=!1;var te=i.memoizedState;g.state=te,qc(i,u,g,p),Fc(),J=i.memoizedState,I||te!==J||Si?(typeof fe=="function"&&(Pp(i,l,fe,u),J=i.memoizedState),(U=Si||$b(i,l,U,u,te,J,_))?(oe||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=J),g.props=u,g.state=J,g.context=_,u=U):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,hp(s,i),_=i.memoizedProps,oe=za(l,_),g.props=oe,fe=i.pendingProps,te=g.context,J=l.contextType,U=Qo,typeof J=="object"&&J!==null&&(U=xn(J)),I=l.getDerivedStateFromProps,(J=typeof I=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_!==fe||te!==U)&&Qb(i,g,u,U),Si=!1,te=i.memoizedState,g.state=te,qc(i,u,g,p),Fc();var se=i.memoizedState;_!==fe||te!==se||Si||s!==null&&s.dependencies!==null&&oh(s.dependencies)?(typeof I=="function"&&(Pp(i,l,I,u),se=i.memoizedState),(oe=Si||$b(i,l,oe,u,te,se,U)||s!==null&&s.dependencies!==null&&oh(s.dependencies))?(J||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,se,U),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,se,U)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||_===s.memoizedProps&&te===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&te===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=se),g.props=u,g.state=se,g.context=U,u=oe):(typeof g.componentDidUpdate!="function"||_===s.memoizedProps&&te===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&te===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,Sh(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=qa(i,s.child,null,p),i.child=qa(i,null,l,p)):yn(s,i,l,p),i.memoizedState=g.state,s=i.child):s=Pr(s,i,p),s}function cv(s,i,l,u){return Pa(),i.flags|=256,yn(s,i,l,u),i.child}var Fp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qp(s){return{baseLanes:s,cachePool:Jy()}}function Bp(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=ds),s}function uv(s,i,l){var u=i.pendingProps,p=!1,g=(i.flags&128)!==0,_;if((_=g)||(_=s!==null&&s.memoizedState===null?!1:(qt.current&2)!==0),_&&(p=!0,i.flags&=-129),_=(i.flags&32)!==0,i.flags&=-33,s===null){if(et){if(p?ji(i):Ri(),(s=vt)?(s=y_(s,Es),s=s!==null&&s.data!=="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:wi!==null?{id:Js,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},l=zy(s),l.return=i,i.child=l,gn=i,vt=null)):s=null,s===null)throw Ti(i);return Tg(s)?i.lanes=32:i.lanes=536870912,null}var I=u.children;return u=u.fallback,p?(Ri(),p=i.mode,I=Ah({mode:"hidden",children:I},p),u=Ma(u,p,l,null),I.return=i,u.return=i,I.sibling=u,i.child=I,u=i.child,u.memoizedState=qp(l),u.childLanes=Bp(s,_,l),i.memoizedState=Fp,Kc(null,u)):(ji(i),zp(i,I))}var U=s.memoizedState;if(U!==null&&(I=U.dehydrated,I!==null)){if(g)i.flags&256?(ji(i),i.flags&=-257,i=Hp(s,i,l)):i.memoizedState!==null?(Ri(),i.child=s.child,i.flags|=128,i=null):(Ri(),I=u.fallback,p=i.mode,u=Ah({mode:"visible",children:u.children},p),I=Ma(I,p,l,null),I.flags|=2,u.return=i,I.return=i,u.sibling=I,i.child=u,qa(i,s.child,null,l),u=i.child,u.memoizedState=qp(l),u.childLanes=Bp(s,_,l),i.memoizedState=Fp,i=Kc(null,u));else if(ji(i),Tg(I)){if(_=I.nextSibling&&I.nextSibling.dataset,_)var J=_.dgst;_=J,u=Error(r(419)),u.stack="",u.digest=_,Mc({value:u,source:null,stack:null}),i=Hp(s,i,l)}else if(Wt||Jo(s,i,l,!1),_=(l&s.childLanes)!==0,Wt||_){if(_=xt,_!==null&&(u=ys(_,l),u!==0&&u!==U.retryLane))throw U.retryLane=u,Da(s,u),Wn(_,s,u),Lp;Ng(I)||Oh(),i=Hp(s,i,l)}else Ng(I)?(i.flags|=192,i.child=s.child,i=null):(s=U.treeContext,vt=As(I.nextSibling),gn=i,et=!0,Ni=null,Es=!1,s!==null&&Ky(i,s),i=zp(i,u.children),i.flags|=4096);return i}return p?(Ri(),I=u.fallback,p=i.mode,U=s.child,J=U.sibling,u=jr(U,{mode:"hidden",children:u.children}),u.subtreeFlags=U.subtreeFlags&65011712,J!==null?I=jr(J,I):(I=Ma(I,p,l,null),I.flags|=2),I.return=i,u.return=i,u.sibling=I,i.child=u,Kc(null,u),u=i.child,I=s.child.memoizedState,I===null?I=qp(l):(p=I.cachePool,p!==null?(U=Qt._currentValue,p=p.parent!==U?{parent:U,pool:U}:p):p=Jy(),I={baseLanes:I.baseLanes|l,cachePool:p}),u.memoizedState=I,u.childLanes=Bp(s,_,l),i.memoizedState=Fp,Kc(s.child,u)):(ji(i),l=s.child,s=l.sibling,l=jr(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(_=i.deletions,_===null?(i.deletions=[s],i.flags|=16):_.push(s)),i.child=l,i.memoizedState=null,l)}function zp(s,i){return i=Ah({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function Ah(s,i){return s=os(22,s,null,i),s.lanes=0,s}function Hp(s,i,l){return qa(i,s.child,null,l),s=zp(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function dv(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),ip(s.return,i,l)}function Gp(s,i,l,u,p,g){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:p,treeForkCount:g}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=u,_.tail=l,_.tailMode=p,_.treeForkCount=g)}function hv(s,i,l){var u=i.pendingProps,p=u.revealOrder,g=u.tail;u=u.children;var _=qt.current,I=(_&2)!==0;if(I?(_=_&1|2,i.flags|=128):_&=1,le(qt,_),yn(s,i,u,l),u=et?Dc:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&dv(s,l,i);else if(s.tag===19)dv(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(p){case"forwards":for(l=i.child,p=null;l!==null;)s=l.alternate,s!==null&&ph(s)===null&&(p=l),l=l.sibling;l=p,l===null?(p=i.child,i.child=null):(p=l.sibling,l.sibling=null),Gp(i,!1,p,l,g,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=i.child,i.child=null;p!==null;){if(s=p.alternate,s!==null&&ph(s)===null){i.child=p;break}s=p.sibling,p.sibling=l,l=p,p=s}Gp(i,!0,l,null,g,u);break;case"together":Gp(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function Pr(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),Di|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(Jo(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(r(153));if(i.child!==null){for(s=i.child,l=jr(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=jr(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function Kp(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&oh(s)))}function IS(s,i,l){switch(i.tag){case 3:H(i,i.stateNode.containerInfo),Ei(i,Qt,s.memoizedState.cache),Pa();break;case 27:case 5:Be(i);break;case 4:H(i,i.stateNode.containerInfo);break;case 10:Ei(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,xp(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(ji(i),i.flags|=128,null):(l&i.child.childLanes)!==0?uv(s,i,l):(ji(i),s=Pr(s,i,l),s!==null?s.sibling:null);ji(i);break;case 19:var p=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(Jo(s,i,l,!1),u=(l&i.childLanes)!==0),p){if(u)return hv(s,i,l);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),le(qt,qt.current),u)break;return null;case 22:return i.lanes=0,rv(s,i,l,i.pendingProps);case 24:Ei(i,Qt,s.memoizedState.cache)}return Pr(s,i,l)}function fv(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Wt=!0;else{if(!Kp(s,l)&&(i.flags&128)===0)return Wt=!1,IS(s,i,l);Wt=(s.flags&131072)!==0}else Wt=!1,et&&(i.flags&1048576)!==0&&Gy(i,Dc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(s=Ua(i.elementType),i.type=s,typeof s=="function")Xm(s)?(u=za(s,u),i.tag=1,i=lv(null,i,s,u,l)):(i.tag=0,i=Up(null,i,s,u,l));else{if(s!=null){var p=s.$$typeof;if(p===ee){i.tag=11,i=tv(null,i,s,u,l);break e}else if(p===j){i.tag=14,i=nv(null,i,s,u,l);break e}}throw i=Te(s)||s,Error(r(306,i,""))}}return i;case 0:return Up(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,p=za(u,i.pendingProps),lv(s,i,u,p,l);case 3:e:{if(H(i,i.stateNode.containerInfo),s===null)throw Error(r(387));u=i.pendingProps;var g=i.memoizedState;p=g.element,hp(s,i),qc(i,u,null,l);var _=i.memoizedState;if(u=_.cache,Ei(i,Qt,u),u!==g.cache&&ap(i,[Qt],l,!0),Fc(),u=_.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:_.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=cv(s,i,u,l);break e}else if(u!==p){p=ws(Error(r(424)),i),Mc(p),i=cv(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(vt=As(s.firstChild),gn=i,et=!0,Ni=null,Es=!0,l=rb(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Pa(),u===p){i=Pr(s,i,l);break e}yn(s,i,u,l)}i=i.child}return i;case 26:return Sh(s,i),s===null?(l=T_(i.type,null,i.pendingProps,null))?i.memoizedState=l:et||(l=i.type,s=i.pendingProps,u=zh(F.current).createElement(l),u[Le]=i,u[at]=s,bn(u,l,s),Ft(u),i.stateNode=u):i.memoizedState=T_(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Be(i),s===null&&et&&(u=i.stateNode=__(i.type,i.pendingProps,F.current),gn=i,Es=!0,p=vt,Li(i.type)?(Eg=p,vt=As(u.firstChild)):vt=p),yn(s,i,i.pendingProps.children,l),Sh(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&et&&((p=u=vt)&&(u=rA(u,i.type,i.pendingProps,Es),u!==null?(i.stateNode=u,gn=i,vt=As(u.firstChild),Es=!1,p=!0):p=!1),p||Ti(i)),Be(i),p=i.type,g=i.pendingProps,_=s!==null?s.memoizedProps:null,u=g.children,vg(p,g)?u=null:_!==null&&vg(p,_)&&(i.flags|=32),i.memoizedState!==null&&(p=bp(s,i,bS,null,null,l),ou._currentValue=p),Sh(s,i),yn(s,i,u,l),i.child;case 6:return s===null&&et&&((s=l=vt)&&(l=iA(l,i.pendingProps,Es),l!==null?(i.stateNode=l,gn=i,vt=null,s=!0):s=!1),s||Ti(i)),null;case 13:return uv(s,i,l);case 4:return H(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=qa(i,null,u,l):yn(s,i,u,l),i.child;case 11:return tv(s,i,i.type,i.pendingProps,l);case 7:return yn(s,i,i.pendingProps,l),i.child;case 8:return yn(s,i,i.pendingProps.children,l),i.child;case 12:return yn(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,Ei(i,i.type,u.value),yn(s,i,u.children,l),i.child;case 9:return p=i.type._context,u=i.pendingProps.children,Va(i),p=xn(p),u=u(p),i.flags|=1,yn(s,i,u,l),i.child;case 14:return nv(s,i,i.type,i.pendingProps,l);case 15:return sv(s,i,i.type,i.pendingProps,l);case 19:return hv(s,i,l);case 31:return AS(s,i,l);case 22:return rv(s,i,l,i.pendingProps);case 24:return Va(i),u=xn(Qt),s===null?(p=cp(),p===null&&(p=xt,g=op(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),i.memoizedState={parent:u,cache:p},dp(i),Ei(i,Qt,p)):((s.lanes&l)!==0&&(hp(s,i),qc(i,null,null,l),Fc()),p=s.memoizedState,g=i.memoizedState,p.parent!==u?(p={parent:u,cache:u},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),Ei(i,Qt,u)):(u=g.cache,Ei(i,Qt,u),u!==p.cache&&ap(i,[Qt],l,!0))),yn(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Or(s){s.flags|=4}function $p(s,i,l,u,p){if((i=(s.mode&32)!==0)&&(i=!1),i){if(s.flags|=16777216,(p&335544128)===p)if(s.stateNode.complete)s.flags|=8192;else if(Fv())s.flags|=8192;else throw Fa=dh,up}else s.flags&=-16777217}function mv(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!j_(i))if(Fv())s.flags|=8192;else throw Fa=dh,up}function Ih(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?ba():536870912,s.lanes|=i,ul|=i)}function $c(s,i){if(!et)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function _t(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function jS(s,i,l){var u=i.pendingProps;switch(tp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(i),null;case 1:return _t(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),kr(Qt),pe(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Xo(i)?Or(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,sp())),_t(i),null;case 26:var p=i.type,g=i.memoizedState;return s===null?(Or(i),g!==null?(_t(i),mv(i,g)):(_t(i),$p(i,p,null,u,l))):g?g!==s.memoizedState?(Or(i),_t(i),mv(i,g)):(_t(i),i.flags&=-16777217):(s=s.memoizedProps,s!==u&&Or(i),_t(i),$p(i,p,s,u,l)),null;case 27:if(gt(i),l=F.current,p=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Or(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return _t(i),null}s=_e.current,Xo(i)?$y(i):(s=__(p,u,l),i.stateNode=s,Or(i))}return _t(i),null;case 5:if(gt(i),p=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Or(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return _t(i),null}if(g=_e.current,Xo(i))$y(i);else{var _=zh(F.current);switch(g){case 1:g=_.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=_.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=_.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=_.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=_.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?_.createElement("select",{is:u.is}):_.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?_.createElement(p,{is:u.is}):_.createElement(p)}}g[Le]=i,g[at]=u;e:for(_=i.child;_!==null;){if(_.tag===5||_.tag===6)g.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===i)break e;for(;_.sibling===null;){if(_.return===null||_.return===i)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}i.stateNode=g;e:switch(bn(g,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Or(i)}}return _t(i),$p(i,i.type,s===null?null:s.memoizedProps,i.pendingProps,l),null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&Or(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(r(166));if(s=F.current,Xo(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,p=gn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}s[Le]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||u_(s.nodeValue,l)),s||Ti(i,!0)}else s=zh(s).createTextNode(u),s[Le]=i,i.stateNode=s}return _t(i),null;case 31:if(l=i.memoizedState,s===null||s.memoizedState!==null){if(u=Xo(i),l!==null){if(s===null){if(!u)throw Error(r(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Le]=i}else Pa(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;_t(i),s=!1}else l=sp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return i.flags&256?(cs(i),i):(cs(i),null);if((i.flags&128)!==0)throw Error(r(558))}return _t(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=Xo(i),u!==null&&u.dehydrated!==null){if(s===null){if(!p)throw Error(r(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[Le]=i}else Pa(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;_t(i),p=!1}else p=sp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(cs(i),i):(cs(i),null)}return cs(i),(i.flags&128)!==0?(i.lanes=l,i):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=i.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==p&&(u.flags|=2048)),l!==s&&l&&(i.child.flags|=8192),Ih(i,i.updateQueue),_t(i),null);case 4:return pe(),s===null&&pg(i.stateNode.containerInfo),_t(i),null;case 10:return kr(i.type),_t(i),null;case 19:if($(qt),u=i.memoizedState,u===null)return _t(i),null;if(p=(i.flags&128)!==0,g=u.rendering,g===null)if(p)$c(u,!1);else{if(kt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=ph(s),g!==null){for(i.flags|=128,$c(u,!1),s=g.updateQueue,i.updateQueue=s,Ih(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)By(l,s),l=l.sibling;return le(qt,qt.current&1|2),et&&Rr(i,u.treeForkCount),i.child}s=s.sibling}u.tail!==null&&en()>Dh&&(i.flags|=128,p=!0,$c(u,!1),i.lanes=4194304)}else{if(!p)if(s=ph(g),s!==null){if(i.flags|=128,p=!0,s=s.updateQueue,i.updateQueue=s,Ih(i,s),$c(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!et)return _t(i),null}else 2*en()-u.renderingStartTime>Dh&&l!==536870912&&(i.flags|=128,p=!0,$c(u,!1),i.lanes=4194304);u.isBackwards?(g.sibling=i.child,i.child=g):(s=u.last,s!==null?s.sibling=g:i.child=g,u.last=g)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=en(),s.sibling=null,l=qt.current,le(qt,p?l&1|2:l&1),et&&Rr(i,u.treeForkCount),s):(_t(i),null);case 22:case 23:return cs(i),gp(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(_t(i),i.subtreeFlags&6&&(i.flags|=8192)):_t(i),l=i.updateQueue,l!==null&&Ih(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&$(La),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),kr(Qt),_t(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function RS(s,i){switch(tp(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return kr(Qt),pe(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return gt(i),null;case 31:if(i.memoizedState!==null){if(cs(i),i.alternate===null)throw Error(r(340));Pa()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 13:if(cs(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Pa()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return $(qt),null;case 4:return pe(),null;case 10:return kr(i.type),null;case 22:case 23:return cs(i),gp(),s!==null&&$(La),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return kr(Qt),null;case 25:return null;default:return null}}function pv(s,i){switch(tp(i),i.tag){case 3:kr(Qt),pe();break;case 26:case 27:case 5:gt(i);break;case 4:pe();break;case 31:i.memoizedState!==null&&cs(i);break;case 13:cs(i);break;case 19:$(qt);break;case 10:kr(i.type);break;case 22:case 23:cs(i),gp(),s!==null&&$(La);break;case 24:kr(Qt)}}function Qc(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var p=u.next;l=p;do{if((l.tag&s)===s){u=void 0;var g=l.create,_=l.inst;u=g(),_.destroy=u}l=l.next}while(l!==p)}}catch(I){ut(i,i.return,I)}}function Ci(s,i,l){try{var u=i.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var g=p.next;u=g;do{if((u.tag&s)===s){var _=u.inst,I=_.destroy;if(I!==void 0){_.destroy=void 0,p=i;var U=l,J=I;try{J()}catch(oe){ut(p,U,oe)}}}u=u.next}while(u!==g)}}catch(oe){ut(i,i.return,oe)}}function gv(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{ab(i,l)}catch(u){ut(s,s.return,u)}}}function xv(s,i,l){l.props=za(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){ut(s,i,u)}}function Yc(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(p){ut(s,i,p)}}function er(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(p){ut(s,i,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){ut(s,i,p)}else l.current=null}function yv(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(p){ut(s,s.return,p)}}function Qp(s,i,l){try{var u=s.stateNode;JS(u,s.type,l,i),u[at]=i}catch(p){ut(s,s.return,p)}}function bv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Li(s.type)||s.tag===4}function Yp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||bv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Li(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Wp(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=ln));else if(u!==4&&(u===27&&Li(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(Wp(s,i,l),s=s.sibling;s!==null;)Wp(s,i,l),s=s.sibling}function jh(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&Li(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(jh(s,i,l),s=s.sibling;s!==null;)jh(s,i,l),s=s.sibling}function vv(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);bn(i,u,l),i[Le]=s,i[at]=l}catch(g){ut(s,s.return,g)}}var Vr=!1,Xt=!1,Xp=!1,_v=typeof WeakSet=="function"?WeakSet:Set,dn=null;function CS(s,i){if(s=s.containerInfo,yg=Wh,s=Dy(s),Hm(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var p=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var _=0,I=-1,U=-1,J=0,oe=0,fe=s,te=null;t:for(;;){for(var se;fe!==l||p!==0&&fe.nodeType!==3||(I=_+p),fe!==g||u!==0&&fe.nodeType!==3||(U=_+u),fe.nodeType===3&&(_+=fe.nodeValue.length),(se=fe.firstChild)!==null;)te=fe,fe=se;for(;;){if(fe===s)break t;if(te===l&&++J===p&&(I=_),te===g&&++oe===u&&(U=_),(se=fe.nextSibling)!==null)break;fe=te,te=fe.parentNode}fe=se}l=I===-1||U===-1?null:{start:I,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(bg={focusedElem:s,selectionRange:l},Wh=!1,dn=i;dn!==null;)if(i=dn,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,dn=s;else for(;dn!==null;){switch(i=dn,g=i.alternate,s=i.flags,i.tag){case 0:if((s&4)!==0&&(s=i.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)p=s[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,p=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var je=za(l.type,p);s=u.getSnapshotBeforeUpdate(je,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ve){ut(l,l.return,Ve)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)wg(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":wg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=i.sibling,s!==null){s.return=i.return,dn=s;break}dn=i.return}}function wv(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ur(s,l),u&4&&Qc(5,l);break;case 1:if(Ur(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(_){ut(l,l.return,_)}else{var p=za(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(p,i,s.__reactInternalSnapshotBeforeUpdate)}catch(_){ut(l,l.return,_)}}u&64&&gv(l),u&512&&Yc(l,l.return);break;case 3:if(Ur(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{ab(s,i)}catch(_){ut(l,l.return,_)}}break;case 27:i===null&&u&4&&vv(l);case 26:case 5:Ur(s,l),i===null&&u&4&&yv(l),u&512&&Yc(l,l.return);break;case 12:Ur(s,l);break;case 31:Ur(s,l),u&4&&Ev(s,l);break;case 13:Ur(s,l),u&4&&Sv(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=FS.bind(null,l),aA(s,l))));break;case 22:if(u=l.memoizedState!==null||Vr,!u){i=i!==null&&i.memoizedState!==null||Xt,p=Vr;var g=Xt;Vr=u,(Xt=i)&&!g?Fr(s,l,(l.subtreeFlags&8772)!==0):Ur(s,l),Vr=p,Xt=g}break;case 30:break;default:Ur(s,l)}}function Nv(s){var i=s.alternate;i!==null&&(s.alternate=null,Nv(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&_a(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Nt=null,Kn=!1;function Lr(s,i,l){for(l=l.child;l!==null;)Tv(s,i,l),l=l.sibling}function Tv(s,i,l){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(Ds,l)}catch{}switch(l.tag){case 26:Xt||er(l,i),Lr(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Xt||er(l,i);var u=Nt,p=Kn;Li(l.type)&&(Nt=l.stateNode,Kn=!1),Lr(s,i,l),ru(l.stateNode),Nt=u,Kn=p;break;case 5:Xt||er(l,i);case 6:if(u=Nt,p=Kn,Nt=null,Lr(s,i,l),Nt=u,Kn=p,Nt!==null)if(Kn)try{(Nt.nodeType===9?Nt.body:Nt.nodeName==="HTML"?Nt.ownerDocument.body:Nt).removeChild(l.stateNode)}catch(g){ut(l,i,g)}else try{Nt.removeChild(l.stateNode)}catch(g){ut(l,i,g)}break;case 18:Nt!==null&&(Kn?(s=Nt,g_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),yl(s)):g_(Nt,l.stateNode));break;case 4:u=Nt,p=Kn,Nt=l.stateNode.containerInfo,Kn=!0,Lr(s,i,l),Nt=u,Kn=p;break;case 0:case 11:case 14:case 15:Ci(2,l,i),Xt||Ci(4,l,i),Lr(s,i,l);break;case 1:Xt||(er(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&xv(l,i,u)),Lr(s,i,l);break;case 21:Lr(s,i,l);break;case 22:Xt=(u=Xt)||l.memoizedState!==null,Lr(s,i,l),Xt=u;break;default:Lr(s,i,l)}}function Ev(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{yl(s)}catch(l){ut(i,i.return,l)}}}function Sv(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{yl(s)}catch(l){ut(i,i.return,l)}}function kS(s){switch(s.tag){case 31:case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new _v),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new _v),i;default:throw Error(r(435,s.tag))}}function Rh(s,i){var l=kS(s);i.forEach(function(u){if(!l.has(u)){l.add(u);var p=qS.bind(null,s,u);u.then(p,p)}})}function $n(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var p=l[u],g=s,_=i,I=_;e:for(;I!==null;){switch(I.tag){case 27:if(Li(I.type)){Nt=I.stateNode,Kn=!1;break e}break;case 5:Nt=I.stateNode,Kn=!1;break e;case 3:case 4:Nt=I.stateNode.containerInfo,Kn=!0;break e}I=I.return}if(Nt===null)throw Error(r(160));Tv(g,_,p),Nt=null,Kn=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Av(i,s),i=i.sibling}var Us=null;function Av(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:$n(i,s),Qn(s),u&4&&(Ci(3,s,s.return),Qc(3,s),Ci(5,s,s.return));break;case 1:$n(i,s),Qn(s),u&512&&(Xt||l===null||er(l,l.return)),u&64&&Vr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var p=Us;if($n(i,s),Qn(s),u&512&&(Xt||l===null||er(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":g=p.getElementsByTagName("title")[0],(!g||g[_r]||g[Le]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(u),p.head.insertBefore(g,p.querySelector("head > title"))),bn(g,u,l),g[Le]=s,Ft(g),u=g;break e;case"link":var _=A_("link","href",p).get(u+(l.href||""));if(_){for(var I=0;I<_.length;I++)if(g=_[I],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){_.splice(I,1);break t}}g=p.createElement(u),bn(g,u,l),p.head.appendChild(g);break;case"meta":if(_=A_("meta","content",p).get(u+(l.content||""))){for(I=0;I<_.length;I++)if(g=_[I],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){_.splice(I,1);break t}}g=p.createElement(u),bn(g,u,l),p.head.appendChild(g);break;default:throw Error(r(468,u))}g[Le]=s,Ft(g),u=g}s.stateNode=u}else I_(p,s.type,s.stateNode);else s.stateNode=S_(p,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?I_(p,s.type,s.stateNode):S_(p,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Qp(s,s.memoizedProps,l.memoizedProps)}break;case 27:$n(i,s),Qn(s),u&512&&(Xt||l===null||er(l,l.return)),l!==null&&u&4&&Qp(s,s.memoizedProps,l.memoizedProps);break;case 5:if($n(i,s),Qn(s),u&512&&(Xt||l===null||er(l,l.return)),s.flags&32){p=s.stateNode;try{vs(p,"")}catch(je){ut(s,s.return,je)}}u&4&&s.stateNode!=null&&(p=s.memoizedProps,Qp(s,p,l!==null?l.memoizedProps:p)),u&1024&&(Xp=!0);break;case 6:if($n(i,s),Qn(s),u&4){if(s.stateNode===null)throw Error(r(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(je){ut(s,s.return,je)}}break;case 3:if(Kh=null,p=Us,Us=Hh(i.containerInfo),$n(i,s),Us=p,Qn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{yl(i.containerInfo)}catch(je){ut(s,s.return,je)}Xp&&(Xp=!1,Iv(s));break;case 4:u=Us,Us=Hh(s.stateNode.containerInfo),$n(i,s),Qn(s),Us=u;break;case 12:$n(i,s),Qn(s);break;case 31:$n(i,s),Qn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Rh(s,u)));break;case 13:$n(i,s),Qn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(kh=en()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Rh(s,u)));break;case 22:p=s.memoizedState!==null;var U=l!==null&&l.memoizedState!==null,J=Vr,oe=Xt;if(Vr=J||p,Xt=oe||U,$n(i,s),Xt=oe,Vr=J,Qn(s),u&8192)e:for(i=s.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(l===null||U||Vr||Xt||Ha(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){U=l=i;try{if(g=U.stateNode,p)_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{I=U.stateNode;var fe=U.memoizedProps.style,te=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;I.style.display=te==null||typeof te=="boolean"?"":(""+te).trim()}}catch(je){ut(U,U.return,je)}}}else if(i.tag===6){if(l===null){U=i;try{U.stateNode.nodeValue=p?"":U.memoizedProps}catch(je){ut(U,U.return,je)}}}else if(i.tag===18){if(l===null){U=i;try{var se=U.stateNode;p?x_(se,!0):x_(U.stateNode,!1)}catch(je){ut(U,U.return,je)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Rh(s,l))));break;case 19:$n(i,s),Qn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Rh(s,u)));break;case 30:break;case 21:break;default:$n(i,s),Qn(s)}}function Qn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(bv(u)){l=u;break}u=u.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var p=l.stateNode,g=Yp(s);jh(s,g,p);break;case 5:var _=l.stateNode;l.flags&32&&(vs(_,""),l.flags&=-33);var I=Yp(s);jh(s,I,_);break;case 3:case 4:var U=l.stateNode.containerInfo,J=Yp(s);Wp(s,J,U);break;default:throw Error(r(161))}}catch(oe){ut(s,s.return,oe)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Iv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Iv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Ur(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)wv(s,i.alternate,i),i=i.sibling}function Ha(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Ci(4,i,i.return),Ha(i);break;case 1:er(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&xv(i,i.return,l),Ha(i);break;case 27:ru(i.stateNode);case 26:case 5:er(i,i.return),Ha(i);break;case 22:i.memoizedState===null&&Ha(i);break;case 30:Ha(i);break;default:Ha(i)}s=s.sibling}}function Fr(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,p=s,g=i,_=g.flags;switch(g.tag){case 0:case 11:case 15:Fr(p,g,l),Qc(4,g);break;case 1:if(Fr(p,g,l),u=g,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(J){ut(u,u.return,J)}if(u=g,p=u.updateQueue,p!==null){var I=u.stateNode;try{var U=p.shared.hiddenCallbacks;if(U!==null)for(p.shared.hiddenCallbacks=null,p=0;p<U.length;p++)ib(U[p],I)}catch(J){ut(u,u.return,J)}}l&&_&64&&gv(g),Yc(g,g.return);break;case 27:vv(g);case 26:case 5:Fr(p,g,l),l&&u===null&&_&4&&yv(g),Yc(g,g.return);break;case 12:Fr(p,g,l);break;case 31:Fr(p,g,l),l&&_&4&&Ev(p,g);break;case 13:Fr(p,g,l),l&&_&4&&Sv(p,g);break;case 22:g.memoizedState===null&&Fr(p,g,l),Yc(g,g.return);break;case 30:break;default:Fr(p,g,l)}i=i.sibling}}function Jp(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Pc(l))}function Zp(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pc(s))}function Fs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)jv(s,i,l,u),i=i.sibling}function jv(s,i,l,u){var p=i.flags;switch(i.tag){case 0:case 11:case 15:Fs(s,i,l,u),p&2048&&Qc(9,i);break;case 1:Fs(s,i,l,u);break;case 3:Fs(s,i,l,u),p&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pc(s)));break;case 12:if(p&2048){Fs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,_=g.id,I=g.onPostCommit;typeof I=="function"&&I(_,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(U){ut(i,i.return,U)}}else Fs(s,i,l,u);break;case 31:Fs(s,i,l,u);break;case 13:Fs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,_=i.alternate,i.memoizedState!==null?g._visibility&2?Fs(s,i,l,u):Wc(s,i):g._visibility&2?Fs(s,i,l,u):(g._visibility|=2,ol(s,i,l,u,(i.subtreeFlags&10256)!==0||!1)),p&2048&&Jp(_,i);break;case 24:Fs(s,i,l,u),p&2048&&Zp(i.alternate,i);break;default:Fs(s,i,l,u)}}function ol(s,i,l,u,p){for(p=p&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var g=s,_=i,I=l,U=u,J=_.flags;switch(_.tag){case 0:case 11:case 15:ol(g,_,I,U,p),Qc(8,_);break;case 23:break;case 22:var oe=_.stateNode;_.memoizedState!==null?oe._visibility&2?ol(g,_,I,U,p):Wc(g,_):(oe._visibility|=2,ol(g,_,I,U,p)),p&&J&2048&&Jp(_.alternate,_);break;case 24:ol(g,_,I,U,p),p&&J&2048&&Zp(_.alternate,_);break;default:ol(g,_,I,U,p)}i=i.sibling}}function Wc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,p=u.flags;switch(u.tag){case 22:Wc(l,u),p&2048&&Jp(u.alternate,u);break;case 24:Wc(l,u),p&2048&&Zp(u.alternate,u);break;default:Wc(l,u)}i=i.sibling}}var Xc=8192;function ll(s,i,l){if(s.subtreeFlags&Xc)for(s=s.child;s!==null;)Rv(s,i,l),s=s.sibling}function Rv(s,i,l){switch(s.tag){case 26:ll(s,i,l),s.flags&Xc&&s.memoizedState!==null&&yA(l,Us,s.memoizedState,s.memoizedProps);break;case 5:ll(s,i,l);break;case 3:case 4:var u=Us;Us=Hh(s.stateNode.containerInfo),ll(s,i,l),Us=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Xc,Xc=16777216,ll(s,i,l),Xc=u):ll(s,i,l));break;default:ll(s,i,l)}}function Cv(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Jc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];dn=u,Dv(u,s)}Cv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kv(s),s=s.sibling}function kv(s){switch(s.tag){case 0:case 11:case 15:Jc(s),s.flags&2048&&Ci(9,s,s.return);break;case 3:Jc(s);break;case 12:Jc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Ch(s)):Jc(s);break;default:Jc(s)}}function Ch(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];dn=u,Dv(u,s)}Cv(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Ci(8,i,i.return),Ch(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Ch(i));break;default:Ch(i)}s=s.sibling}}function Dv(s,i){for(;dn!==null;){var l=dn;switch(l.tag){case 0:case 11:case 15:Ci(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Pc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,dn=u;else e:for(l=s;dn!==null;){u=dn;var p=u.sibling,g=u.return;if(Nv(u),u===l){dn=null;break e}if(p!==null){p.return=g,dn=p;break e}dn=g}}}var DS={getCacheForType:function(s){var i=xn(Qt),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l},cacheSignal:function(){return xn(Qt).controller.signal}},MS=typeof WeakMap=="function"?WeakMap:Map,ot=0,xt=null,$e=null,We=0,ct=0,us=null,ki=!1,cl=!1,eg=!1,qr=0,kt=0,Di=0,Ga=0,tg=0,ds=0,ul=0,Zc=null,Yn=null,ng=!1,kh=0,Mv=0,Dh=1/0,Mh=null,Mi=null,nn=0,Pi=null,dl=null,Br=0,sg=0,rg=null,Pv=null,eu=0,ig=null;function hs(){return(ot&2)!==0&&We!==0?We&-We:W.T!==null?dg():ye()}function Ov(){if(ds===0)if((We&536870912)===0||et){var s=xs;xs<<=1,(xs&3932160)===0&&(xs=262144),ds=s}else ds=536870912;return s=ls.current,s!==null&&(s.flags|=32),ds}function Wn(s,i,l){(s===xt&&(ct===2||ct===9)||s.cancelPendingCommit!==null)&&(hl(s,0),Oi(s,We,ds,!1)),Ks(s,l),((ot&2)===0||s!==xt)&&(s===xt&&((ot&2)===0&&(Ga|=l),kt===4&&Oi(s,We,ds,!1)),tr(s))}function Vv(s,i,l){if((ot&6)!==0)throw Error(r(327));var u=!l&&(i&127)===0&&(i&s.expiredLanes)===0||Gs(s,i),p=u?VS(s,i):og(s,i,!0),g=u;do{if(p===0){cl&&!u&&Oi(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!PS(l)){p=og(s,i,!1),g=!1;continue}if(p===2){if(g=i,s.errorRecoveryDisabledLanes&g)var _=0;else _=s.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){i=_;e:{var I=s;p=Zc;var U=I.current.memoizedState.isDehydrated;if(U&&(hl(I,_).flags|=256),_=og(I,_,!1),_!==2){if(eg&&!U){I.errorRecoveryDisabledLanes|=g,Ga|=g,p=4;break e}g=Yn,Yn=p,g!==null&&(Yn===null?Yn=g:Yn.push.apply(Yn,g))}p=_}if(g=!1,p!==2)continue}}if(p===1){hl(s,0),Oi(s,i,0,!0);break}e:{switch(u=s,g=p,g){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Oi(u,i,ds,!ki);break e;case 2:Yn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(p=kh+300-en(),10<p)){if(Oi(u,i,ds,!ki),zn(u,0,!0)!==0)break e;Br=i,u.timeoutHandle=m_(Lv.bind(null,u,l,Yn,Mh,ng,i,ds,Ga,ul,ki,g,"Throttled",-0,0),p);break e}Lv(u,l,Yn,Mh,ng,i,ds,Ga,ul,ki,g,null,-0,0)}}break}while(!0);tr(s)}function Lv(s,i,l,u,p,g,_,I,U,J,oe,fe,te,se){if(s.timeoutHandle=-1,fe=i.subtreeFlags,fe&8192||(fe&16785408)===16785408){fe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ln},Rv(i,g,fe);var je=(g&62914560)===g?kh-en():(g&4194048)===g?Mv-en():0;if(je=bA(fe,je),je!==null){Br=g,s.cancelPendingCommit=je(Kv.bind(null,s,i,g,l,u,p,_,I,U,oe,fe,null,te,se)),Oi(s,g,_,!J);return}}Kv(s,i,g,l,u,p,_,I,U)}function PS(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var p=l[u],g=p.getSnapshot;p=p.value;try{if(!as(g(),p))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Oi(s,i,l,u){i&=~tg,i&=~Ga,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var p=i;0<p;){var g=31-pn(p),_=1<<g;u[g]=-1,p&=~_}l!==0&&va(s,l,i)}function Ph(){return(ot&6)===0?(tu(0),!1):!0}function ag(){if($e!==null){if(ct===0)var s=$e.return;else s=$e,Cr=Oa=null,wp(s),nl=null,Vc=0,s=$e;for(;s!==null;)pv(s.alternate,s),s=s.return;$e=null}}function hl(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,tA(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Br=0,ag(),xt=s,$e=l=jr(s.current,null),We=i,ct=0,us=null,ki=!1,cl=Gs(s,i),eg=!1,ul=ds=tg=Ga=Di=kt=0,Yn=Zc=null,ng=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var p=31-pn(u),g=1<<p;i|=s[p],u&=~g}return qr=i,nh(),l}function Uv(s,i){ze=null,W.H=Gc,i===tl||i===uh?(i=tb(),ct=3):i===up?(i=tb(),ct=4):ct=i===Lp?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,us=i,$e===null&&(kt=1,Th(s,ws(i,s.current)))}function Fv(){var s=ls.current;return s===null?!0:(We&4194048)===We?Ss===null:(We&62914560)===We||(We&536870912)!==0?s===Ss:!1}function qv(){var s=W.H;return W.H=Gc,s===null?Gc:s}function Bv(){var s=W.A;return W.A=DS,s}function Oh(){kt=4,ki||(We&4194048)!==We&&ls.current!==null||(cl=!0),(Di&134217727)===0&&(Ga&134217727)===0||xt===null||Oi(xt,We,ds,!1)}function og(s,i,l){var u=ot;ot|=2;var p=qv(),g=Bv();(xt!==s||We!==i)&&(Mh=null,hl(s,i)),i=!1;var _=kt;e:do try{if(ct!==0&&$e!==null){var I=$e,U=us;switch(ct){case 8:ag(),_=6;break e;case 3:case 2:case 9:case 6:ls.current===null&&(i=!0);var J=ct;if(ct=0,us=null,fl(s,I,U,J),l&&cl){_=0;break e}break;default:J=ct,ct=0,us=null,fl(s,I,U,J)}}OS(),_=kt;break}catch(oe){Uv(s,oe)}while(!0);return i&&s.shellSuspendCounter++,Cr=Oa=null,ot=u,W.H=p,W.A=g,$e===null&&(xt=null,We=0,nh()),_}function OS(){for(;$e!==null;)zv($e)}function VS(s,i){var l=ot;ot|=2;var u=qv(),p=Bv();xt!==s||We!==i?(Mh=null,Dh=en()+500,hl(s,i)):cl=Gs(s,i);e:do try{if(ct!==0&&$e!==null){i=$e;var g=us;t:switch(ct){case 1:ct=0,us=null,fl(s,i,g,1);break;case 2:case 9:if(Zy(g)){ct=0,us=null,Hv(i);break}i=function(){ct!==2&&ct!==9||xt!==s||(ct=7),tr(s)},g.then(i,i);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:Zy(g)?(ct=0,us=null,Hv(i)):(ct=0,us=null,fl(s,i,g,7));break;case 5:var _=null;switch($e.tag){case 26:_=$e.memoizedState;case 5:case 27:var I=$e;if(_?j_(_):I.stateNode.complete){ct=0,us=null;var U=I.sibling;if(U!==null)$e=U;else{var J=I.return;J!==null?($e=J,Vh(J)):$e=null}break t}}ct=0,us=null,fl(s,i,g,5);break;case 6:ct=0,us=null,fl(s,i,g,6);break;case 8:ag(),kt=6;break e;default:throw Error(r(462))}}LS();break}catch(oe){Uv(s,oe)}while(!0);return Cr=Oa=null,W.H=u,W.A=p,ot=l,$e!==null?0:(xt=null,We=0,nh(),kt)}function LS(){for(;$e!==null&&!Co();)zv($e)}function zv(s){var i=fv(s.alternate,s,qr);s.memoizedProps=s.pendingProps,i===null?Vh(s):$e=i}function Hv(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=ov(l,i,i.pendingProps,i.type,void 0,We);break;case 11:i=ov(l,i,i.pendingProps,i.type.render,i.ref,We);break;case 5:wp(i);default:pv(l,i),i=$e=By(i,qr),i=fv(l,i,qr)}s.memoizedProps=s.pendingProps,i===null?Vh(s):$e=i}function fl(s,i,l,u){Cr=Oa=null,wp(i),nl=null,Vc=0;var p=i.return;try{if(SS(s,p,i,l,We)){kt=1,Th(s,ws(l,s.current)),$e=null;return}}catch(g){if(p!==null)throw $e=p,g;kt=1,Th(s,ws(l,s.current)),$e=null;return}i.flags&32768?(et||u===1?s=!0:cl||(We&536870912)!==0?s=!1:(ki=s=!0,(u===2||u===9||u===3||u===6)&&(u=ls.current,u!==null&&u.tag===13&&(u.flags|=16384))),Gv(i,s)):Vh(i)}function Vh(s){var i=s;do{if((i.flags&32768)!==0){Gv(i,ki);return}s=i.return;var l=jS(i.alternate,i,qr);if(l!==null){$e=l;return}if(i=i.sibling,i!==null){$e=i;return}$e=i=s}while(i!==null);kt===0&&(kt=5)}function Gv(s,i){do{var l=RS(s.alternate,s);if(l!==null){l.flags&=32767,$e=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){$e=s;return}$e=s=l}while(s!==null);kt=6,$e=null}function Kv(s,i,l,u,p,g,_,I,U){s.cancelPendingCommit=null;do Lh();while(nn!==0);if((ot&6)!==0)throw Error(r(327));if(i!==null){if(i===s.current)throw Error(r(177));if(g=i.lanes|i.childLanes,g|=Ym,tn(s,l,g,_,I,U),s===xt&&($e=xt=null,We=0),dl=i,Pi=s,Br=l,sg=g,rg=p,Pv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,BS(ks,function(){return Xv(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=W.T,W.T=null,p=ce.p,ce.p=2,_=ot,ot|=4;try{CS(s,i,l)}finally{ot=_,ce.p=p,W.T=u}}nn=1,$v(),Qv(),Yv()}}function $v(){if(nn===1){nn=0;var s=Pi,i=dl,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var u=ce.p;ce.p=2;var p=ot;ot|=4;try{Av(i,s);var g=bg,_=Dy(s.containerInfo),I=g.focusedElem,U=g.selectionRange;if(_!==I&&I&&I.ownerDocument&&ky(I.ownerDocument.documentElement,I)){if(U!==null&&Hm(I)){var J=U.start,oe=U.end;if(oe===void 0&&(oe=J),"selectionStart"in I)I.selectionStart=J,I.selectionEnd=Math.min(oe,I.value.length);else{var fe=I.ownerDocument||document,te=fe&&fe.defaultView||window;if(te.getSelection){var se=te.getSelection(),je=I.textContent.length,Ve=Math.min(U.start,je),mt=U.end===void 0?Ve:Math.min(U.end,je);!se.extend&&Ve>mt&&(_=mt,mt=Ve,Ve=_);var G=Cy(I,Ve),q=Cy(I,mt);if(G&&q&&(se.rangeCount!==1||se.anchorNode!==G.node||se.anchorOffset!==G.offset||se.focusNode!==q.node||se.focusOffset!==q.offset)){var X=fe.createRange();X.setStart(G.node,G.offset),se.removeAllRanges(),Ve>mt?(se.addRange(X),se.extend(q.node,q.offset)):(X.setEnd(q.node,q.offset),se.addRange(X))}}}}for(fe=[],se=I;se=se.parentNode;)se.nodeType===1&&fe.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<fe.length;I++){var ue=fe[I];ue.element.scrollLeft=ue.left,ue.element.scrollTop=ue.top}}Wh=!!yg,bg=yg=null}finally{ot=p,ce.p=u,W.T=l}}s.current=i,nn=2}}function Qv(){if(nn===2){nn=0;var s=Pi,i=dl,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var u=ce.p;ce.p=2;var p=ot;ot|=4;try{wv(s,i.alternate,i)}finally{ot=p,ce.p=u,W.T=l}}nn=3}}function Yv(){if(nn===4||nn===3){nn=0,ii();var s=Pi,i=dl,l=Br,u=Pv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?nn=5:(nn=0,dl=Pi=null,Wv(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&(Mi=null),ne(l),i=i.stateNode,on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(Ds,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=W.T,p=ce.p,ce.p=2,W.T=null;try{for(var g=s.onRecoverableError,_=0;_<u.length;_++){var I=u[_];g(I.value,{componentStack:I.stack})}}finally{W.T=i,ce.p=p}}(Br&3)!==0&&Lh(),tr(s),p=s.pendingLanes,(l&261930)!==0&&(p&42)!==0?s===ig?eu++:(eu=0,ig=s):eu=0,tu(0)}}function Wv(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Pc(i)))}function Lh(){return $v(),Qv(),Yv(),Xv()}function Xv(){if(nn!==5)return!1;var s=Pi,i=sg;sg=0;var l=ne(Br),u=W.T,p=ce.p;try{ce.p=32>l?32:l,W.T=null,l=rg,rg=null;var g=Pi,_=Br;if(nn=0,dl=Pi=null,Br=0,(ot&6)!==0)throw Error(r(331));var I=ot;if(ot|=4,kv(g.current),jv(g,g.current,_,l),ot=I,tu(0,!1),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(Ds,g)}catch{}return!0}finally{ce.p=p,W.T=u,Wv(s,i)}}function Jv(s,i,l){i=ws(l,i),i=Vp(s.stateNode,i,2),s=Ii(s,i,2),s!==null&&(Ks(s,2),tr(s))}function ut(s,i,l){if(s.tag===3)Jv(s,s,l);else for(;i!==null;){if(i.tag===3){Jv(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Mi===null||!Mi.has(u))){s=ws(l,s),l=Zb(2),u=Ii(i,l,2),u!==null&&(ev(l,u,i,s),Ks(u,2),tr(u));break}}i=i.return}}function lg(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new MS;var p=new Set;u.set(i,p)}else p=u.get(i),p===void 0&&(p=new Set,u.set(i,p));p.has(l)||(eg=!0,p.add(l),s=US.bind(null,s,i,l),i.then(s,s))}function US(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,xt===s&&(We&l)===l&&(kt===4||kt===3&&(We&62914560)===We&&300>en()-kh?(ot&2)===0&&hl(s,0):tg|=l,ul===We&&(ul=0)),tr(s)}function Zv(s,i){i===0&&(i=ba()),s=Da(s,i),s!==null&&(Ks(s,i),tr(s))}function FS(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),Zv(s,l)}function qS(s,i){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,p=s.memoizedState;p!==null&&(l=p.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(i),Zv(s,l)}function BS(s,i){return xr(s,i)}var Uh=null,ml=null,cg=!1,Fh=!1,ug=!1,Vi=0;function tr(s){s!==ml&&s.next===null&&(ml===null?Uh=ml=s:ml=ml.next=s),Fh=!0,cg||(cg=!0,HS())}function tu(s,i){if(!ug&&Fh){ug=!0;do for(var l=!1,u=Uh;u!==null;){if(s!==0){var p=u.pendingLanes;if(p===0)var g=0;else{var _=u.suspendedLanes,I=u.pingedLanes;g=(1<<31-pn(42|s)+1)-1,g&=p&~(_&~I),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,s_(u,g))}else g=We,g=zn(u,u===xt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Gs(u,g)||(l=!0,s_(u,g));u=u.next}while(l);ug=!1}}function zS(){e_()}function e_(){Fh=cg=!1;var s=0;Vi!==0&&eA()&&(s=Vi);for(var i=en(),l=null,u=Uh;u!==null;){var p=u.next,g=t_(u,i);g===0?(u.next=null,l===null?Uh=p:l.next=p,p===null&&(ml=l)):(l=u,(s!==0||(g&3)!==0)&&(Fh=!0)),u=p}nn!==0&&nn!==5||tu(s),Vi!==0&&(Vi=0)}function t_(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,p=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var _=31-pn(g),I=1<<_,U=p[_];U===-1?((I&l)===0||(I&u)!==0)&&(p[_]=ai(I,i)):U<=i&&(s.expiredLanes|=I),g&=~I}if(i=xt,l=We,l=zn(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(ct===2||ct===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&yr(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Gs(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&yr(u),ne(l)){case 2:case 8:l=Kt;break;case 32:l=ks;break;case 268435456:l=xa;break;default:l=ks}return u=n_.bind(null,s),l=xr(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&yr(u),s.callbackPriority=2,s.callbackNode=null,2}function n_(s,i){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Lh()&&s.callbackNode!==l)return null;var u=We;return u=zn(s,s===xt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(Vv(s,u,i),t_(s,en()),s.callbackNode!=null&&s.callbackNode===l?n_.bind(null,s):null)}function s_(s,i){if(Lh())return null;Vv(s,i,!0)}function HS(){nA(function(){(ot&6)!==0?xr(Ut,zS):e_()})}function dg(){if(Vi===0){var s=Zo;s===0&&(s=vr,vr<<=1,(vr&261888)===0&&(vr=256)),Vi=s}return Vi}function r_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ys(""+s)}function i_(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function GS(s,i,l,u,p){if(i==="submit"&&l&&l.stateNode===p){var g=r_((p[at]||null).action),_=u.submitter;_&&(i=(i=_[at]||null)?r_(i.formAction):_.getAttribute("formAction"),i!==null&&(g=i,_=null));var I=new Sa("action","action",null,u,p);s.push({event:I,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Vi!==0){var U=_?i_(p,_):new FormData(p);Cp(l,{pending:!0,data:U,method:p.method,action:g},null,U)}}else typeof g=="function"&&(I.preventDefault(),U=_?i_(p,_):new FormData(p),Cp(l,{pending:!0,data:U,method:p.method,action:g},g,U))},currentTarget:p}]})}}for(var hg=0;hg<Qm.length;hg++){var fg=Qm[hg],KS=fg.toLowerCase(),$S=fg[0].toUpperCase()+fg.slice(1);Ls(KS,"on"+$S)}Ls(Oy,"onAnimationEnd"),Ls(Vy,"onAnimationIteration"),Ls(Ly,"onAnimationStart"),Ls("dblclick","onDoubleClick"),Ls("focusin","onFocus"),Ls("focusout","onBlur"),Ls(cS,"onTransitionRun"),Ls(uS,"onTransitionStart"),Ls(dS,"onTransitionCancel"),Ls(Uy,"onTransitionEnd"),Qs("onMouseEnter",["mouseout","mouseover"]),Qs("onMouseLeave",["mouseout","mouseover"]),Qs("onPointerEnter",["pointerout","pointerover"]),Qs("onPointerLeave",["pointerout","pointerover"]),Cn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Cn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Cn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Cn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Cn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Cn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nu));function a_(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],p=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var _=u.length-1;0<=_;_--){var I=u[_],U=I.instance,J=I.currentTarget;if(I=I.listener,U!==g&&p.isPropagationStopped())break e;g=I,p.currentTarget=J;try{g(p)}catch(oe){th(oe)}p.currentTarget=null,g=U}else for(_=0;_<u.length;_++){if(I=u[_],U=I.instance,J=I.currentTarget,I=I.listener,U!==g&&p.isPropagationStopped())break e;g=I,p.currentTarget=J;try{g(p)}catch(oe){th(oe)}p.currentTarget=null,g=U}}}}function Qe(s,i){var l=i[li];l===void 0&&(l=i[li]=new Set);var u=s+"__bubble";l.has(u)||(o_(i,s,2,!1),l.add(u))}function mg(s,i,l){var u=0;i&&(u|=4),o_(l,s,u,i)}var qh="_reactListening"+Math.random().toString(36).slice(2);function pg(s){if(!s[qh]){s[qh]=!0,Po.forEach(function(l){l!=="selectionchange"&&(QS.has(l)||mg(l,!1,s),mg(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[qh]||(i[qh]=!0,mg("selectionchange",!1,i))}}function o_(s,i,l,u){switch(O_(i)){case 2:var p=wA;break;case 8:p=NA;break;default:p=Rg}l=p.bind(null,i,l,s),p=void 0,!Tc||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),u?p!==void 0?s.addEventListener(i,l,{capture:!0,passive:p}):s.addEventListener(i,l,!0):p!==void 0?s.addEventListener(i,l,{passive:p}):s.addEventListener(i,l,!1)}function gg(s,i,l,u,p){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var _=u.tag;if(_===3||_===4){var I=u.stateNode.containerInfo;if(I===p)break;if(_===4)for(_=u.return;_!==null;){var U=_.tag;if((U===3||U===4)&&_.stateNode.containerInfo===p)return;_=_.return}for(;I!==null;){if(_=wr(I),_===null)return;if(U=_.tag,U===5||U===6||U===26||U===27){u=g=_;continue e}I=I.parentNode}}u=u.return}Ud(function(){var J=g,oe=Fo(l),fe=[];e:{var te=Fy.get(s);if(te!==void 0){var se=Sa,je=s;switch(s){case"keypress":if(Ea(l)===0)break e;case"keydown":case"keyup":se=Qd;break;case"focusin":je="focus",se=yi;break;case"focusout":je="blur",se=yi;break;case"beforeblur":case"afterblur":se=yi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=Bd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=Wd;break;case Oy:case Vy:case Ly:se=zo;break;case Uy:se=Ho;break;case"scroll":case"scrollend":se=Fd;break;case"wheel":se=Jd;break;case"copy":case"cut":case"paste":se=Hd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=jc;break;case"toggle":case"beforetoggle":se=vi}var Ve=(i&4)!==0,mt=!Ve&&(s==="scroll"||s==="scrollend"),G=Ve?te!==null?te+"Capture":null:te;Ve=[];for(var q=J,X;q!==null;){var ue=q;if(X=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||X===null||G===null||(ue=Hn(q,G),ue!=null&&Ve.push(su(q,ue,X))),mt)break;q=q.return}0<Ve.length&&(te=new se(te,je,null,l,oe),fe.push({event:te,listeners:Ve}))}}if((i&7)===0){e:{if(te=s==="mouseover"||s==="pointerover",se=s==="mouseout"||s==="pointerout",te&&l!==Uo&&(je=l.relatedTarget||l.fromElement)&&(wr(je)||je[Rn]))break e;if((se||te)&&(te=oe.window===oe?oe:(te=oe.ownerDocument)?te.defaultView||te.parentWindow:window,se?(je=l.relatedTarget||l.toElement,se=J,je=je?wr(je):null,je!==null&&(mt=c(je),Ve=je.tag,je!==mt||Ve!==5&&Ve!==27&&Ve!==6)&&(je=null)):(se=null,je=J),se!==je)){if(Ve=qd,ue="onMouseLeave",G="onMouseEnter",q="mouse",(s==="pointerout"||s==="pointerover")&&(Ve=jc,ue="onPointerLeave",G="onPointerEnter",q="pointer"),mt=se==null?te:wa(se),X=je==null?te:wa(je),te=new Ve(ue,q+"leave",se,l,oe),te.target=mt,te.relatedTarget=X,ue=null,wr(oe)===J&&(Ve=new Ve(G,q+"enter",je,l,oe),Ve.target=X,Ve.relatedTarget=mt,ue=Ve),mt=ue,se&&je)t:{for(Ve=YS,G=se,q=je,X=0,ue=G;ue;ue=Ve(ue))X++;ue=0;for(var Me=q;Me;Me=Ve(Me))ue++;for(;0<X-ue;)G=Ve(G),X--;for(;0<ue-X;)q=Ve(q),ue--;for(;X--;){if(G===q||q!==null&&G===q.alternate){Ve=G;break t}G=Ve(G),q=Ve(q)}Ve=null}else Ve=null;se!==null&&l_(fe,te,se,Ve,!1),je!==null&&mt!==null&&l_(fe,mt,je,Ve,!0)}}e:{if(te=J?wa(J):window,se=te.nodeName&&te.nodeName.toLowerCase(),se==="select"||se==="input"&&te.type==="file")var st=Ey;else if(Gn(te))if(Sy)st=aS;else{st=rS;var Ce=sS}else se=te.nodeName,!se||se.toLowerCase()!=="input"||te.type!=="checkbox"&&te.type!=="radio"?J&&wc(J.elementType)&&(st=Ey):st=iS;if(st&&(st=st(s,J))){Ra(fe,st,l,oe);break e}Ce&&Ce(s,te,J),s==="focusout"&&J&&te.type==="number"&&J.memoizedProps.value!=null&&Lo(te,"number",te.value)}switch(Ce=J?wa(J):window,s){case"focusin":(Gn(Ce)||Ce.contentEditable==="true")&&(Go=Ce,Gm=J,kc=null);break;case"focusout":kc=Gm=Go=null;break;case"mousedown":Km=!0;break;case"contextmenu":case"mouseup":case"dragend":Km=!1,My(fe,l,oe);break;case"selectionchange":if(lS)break;case"keydown":case"keyup":My(fe,l,oe)}var Ge;if(b)e:{switch(s){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Ke?lt(s,l)&&(Xe="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Xe="onCompositionStart");Xe&&(Y&&l.locale!=="ko"&&(Ke||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Ke&&(Ge=mi()):(is=oe,qo="value"in is?is.value:is.textContent,Ke=!0)),Ce=Bh(J,Xe),0<Ce.length&&(Xe=new Sc(Xe,s,null,l,oe),fe.push({event:Xe,listeners:Ce}),Ge?Xe.data=Ge:(Ge=$t(l),Ge!==null&&(Xe.data=Ge)))),(Ge=k?cn(s,l):un(s,l))&&(Xe=Bh(J,"onBeforeInput"),0<Xe.length&&(Ce=new Sc("onBeforeInput","beforeinput",null,l,oe),fe.push({event:Ce,listeners:Xe}),Ce.data=Ge)),GS(fe,s,J,l,oe)}a_(fe,i)})}function su(s,i,l){return{instance:s,listener:i,currentTarget:l}}function Bh(s,i){for(var l=i+"Capture",u=[];s!==null;){var p=s,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=Hn(s,l),p!=null&&u.unshift(su(s,p,g)),p=Hn(s,i),p!=null&&u.push(su(s,p,g))),s.tag===3)return u;s=s.return}return[]}function YS(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function l_(s,i,l,u,p){for(var g=i._reactName,_=[];l!==null&&l!==u;){var I=l,U=I.alternate,J=I.stateNode;if(I=I.tag,U!==null&&U===u)break;I!==5&&I!==26&&I!==27||J===null||(U=J,p?(J=Hn(l,g),J!=null&&_.unshift(su(l,J,U))):p||(J=Hn(l,g),J!=null&&_.push(su(l,J,U)))),l=l.return}_.length!==0&&s.push({event:i,listeners:_})}var WS=/\r\n?/g,XS=/\u0000|\uFFFD/g;function c_(s){return(typeof s=="string"?s:""+s).replace(WS,`
`).replace(XS,"")}function u_(s,i){return i=c_(i),c_(s)===i}function ft(s,i,l,u,p,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||vs(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&vs(s,""+u);break;case"className":di(s,"class",u);break;case"tabIndex":di(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":di(s,l,u);break;case"style":Vd(s,u,g);break;case"data":if(i!=="object"){di(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ys(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&ft(s,i,"name",p.name,p,null),ft(s,i,"formEncType",p.formEncType,p,null),ft(s,i,"formMethod",p.formMethod,p,null),ft(s,i,"formTarget",p.formTarget,p,null)):(ft(s,i,"encType",p.encType,p,null),ft(s,i,"method",p.method,p,null),ft(s,i,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Ys(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=ln);break;case"onScroll":u!=null&&Qe("scroll",s);break;case"onScrollEnd":u!=null&&Qe("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(r(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Ys(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Qe("beforetoggle",s),Qe("toggle",s),ui(s,"popover",u);break;case"xlinkActuate":bs(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":bs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":bs(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":bs(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":bs(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":bs(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":bs(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":bs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":bs(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":ui(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Um.get(l)||l,ui(s,l,u))}}function xg(s,i,l,u,p,g){switch(l){case"style":Vd(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(r(60));s.innerHTML=l}}break;case"children":typeof u=="string"?vs(s,u):(typeof u=="number"||typeof u=="bigint")&&vs(s,""+u);break;case"onScroll":u!=null&&Qe("scroll",s);break;case"onScrollEnd":u!=null&&Qe("scrollend",s);break;case"onClick":u!=null&&(s.onclick=ln);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ci.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),i=l.slice(2,p?l.length-7:void 0),g=s[at]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,p),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,p);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):ui(s,l,u)}}}function bn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",s),Qe("load",s);var u=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var _=l[g];if(_!=null)switch(g){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ft(s,i,g,_,l,null)}}p&&ft(s,i,"srcSet",l.srcSet,l,null),u&&ft(s,i,"src",l.src,l,null);return;case"input":Qe("invalid",s);var I=g=_=p=null,U=null,J=null;for(u in l)if(l.hasOwnProperty(u)){var oe=l[u];if(oe!=null)switch(u){case"name":p=oe;break;case"type":_=oe;break;case"checked":U=oe;break;case"defaultChecked":J=oe;break;case"value":g=oe;break;case"defaultValue":I=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(r(137,i));break;default:ft(s,i,u,oe,l,null)}}Na(s,g,I,U,J,_,p,!1);return;case"select":Qe("invalid",s),u=_=g=null;for(p in l)if(l.hasOwnProperty(p)&&(I=l[p],I!=null))switch(p){case"value":g=I;break;case"defaultValue":_=I;break;case"multiple":u=I;default:ft(s,i,p,I,l,null)}i=g,l=_,s.multiple=!!u,i!=null?nt(s,!!u,i,!1):l!=null&&nt(s,!!u,l,!0);return;case"textarea":Qe("invalid",s),g=p=u=null;for(_ in l)if(l.hasOwnProperty(_)&&(I=l[_],I!=null))switch(_){case"value":u=I;break;case"defaultValue":p=I;break;case"children":g=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:ft(s,i,_,I,l,null)}fi(s,u,p,g);return;case"option":for(U in l)if(l.hasOwnProperty(U)&&(u=l[U],u!=null))switch(U){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ft(s,i,U,u,l,null)}return;case"dialog":Qe("beforetoggle",s),Qe("toggle",s),Qe("cancel",s),Qe("close",s);break;case"iframe":case"object":Qe("load",s);break;case"video":case"audio":for(u=0;u<nu.length;u++)Qe(nu[u],s);break;case"image":Qe("error",s),Qe("load",s);break;case"details":Qe("toggle",s);break;case"embed":case"source":case"link":Qe("error",s),Qe("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in l)if(l.hasOwnProperty(J)&&(u=l[J],u!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ft(s,i,J,u,l,null)}return;default:if(wc(i)){for(oe in l)l.hasOwnProperty(oe)&&(u=l[oe],u!==void 0&&xg(s,i,oe,u,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!=null&&ft(s,i,I,u,l,null))}function JS(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,_=null,I=null,U=null,J=null,oe=null;for(se in l){var fe=l[se];if(l.hasOwnProperty(se)&&fe!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":U=fe;default:u.hasOwnProperty(se)||ft(s,i,se,null,u,fe)}}for(var te in u){var se=u[te];if(fe=l[te],u.hasOwnProperty(te)&&(se!=null||fe!=null))switch(te){case"type":g=se;break;case"name":p=se;break;case"checked":J=se;break;case"defaultChecked":oe=se;break;case"value":_=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,i));break;default:se!==fe&&ft(s,i,te,se,u,fe)}}hi(s,_,I,U,J,oe,g,p);return;case"select":se=_=I=te=null;for(g in l)if(U=l[g],l.hasOwnProperty(g)&&U!=null)switch(g){case"value":break;case"multiple":se=U;default:u.hasOwnProperty(g)||ft(s,i,g,null,u,U)}for(p in u)if(g=u[p],U=l[p],u.hasOwnProperty(p)&&(g!=null||U!=null))switch(p){case"value":te=g;break;case"defaultValue":I=g;break;case"multiple":_=g;default:g!==U&&ft(s,i,p,g,u,U)}i=I,l=_,u=se,te!=null?nt(s,!!l,te,!1):!!u!=!!l&&(i!=null?nt(s,!!l,i,!0):nt(s,!!l,l?[]:"",!1));return;case"textarea":se=te=null;for(I in l)if(p=l[I],l.hasOwnProperty(I)&&p!=null&&!u.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ft(s,i,I,null,u,p)}for(_ in u)if(p=u[_],g=l[_],u.hasOwnProperty(_)&&(p!=null||g!=null))switch(_){case"value":te=p;break;case"defaultValue":se=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==g&&ft(s,i,_,p,u,g)}Ta(s,te,se);return;case"option":for(var je in l)if(te=l[je],l.hasOwnProperty(je)&&te!=null&&!u.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:ft(s,i,je,null,u,te)}for(U in u)if(te=u[U],se=l[U],u.hasOwnProperty(U)&&te!==se&&(te!=null||se!=null))switch(U){case"selected":s.selected=te&&typeof te!="function"&&typeof te!="symbol";break;default:ft(s,i,U,te,u,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in l)te=l[Ve],l.hasOwnProperty(Ve)&&te!=null&&!u.hasOwnProperty(Ve)&&ft(s,i,Ve,null,u,te);for(J in u)if(te=u[J],se=l[J],u.hasOwnProperty(J)&&te!==se&&(te!=null||se!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(r(137,i));break;default:ft(s,i,J,te,u,se)}return;default:if(wc(i)){for(var mt in l)te=l[mt],l.hasOwnProperty(mt)&&te!==void 0&&!u.hasOwnProperty(mt)&&xg(s,i,mt,void 0,u,te);for(oe in u)te=u[oe],se=l[oe],!u.hasOwnProperty(oe)||te===se||te===void 0&&se===void 0||xg(s,i,oe,te,u,se);return}}for(var G in l)te=l[G],l.hasOwnProperty(G)&&te!=null&&!u.hasOwnProperty(G)&&ft(s,i,G,null,u,te);for(fe in u)te=u[fe],se=l[fe],!u.hasOwnProperty(fe)||te===se||te==null&&se==null||ft(s,i,fe,te,u,se)}function d_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZS(){if(typeof performance.getEntriesByType=="function"){for(var s=0,i=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var p=l[u],g=p.transferSize,_=p.initiatorType,I=p.duration;if(g&&I&&d_(_)){for(_=0,I=p.responseEnd,u+=1;u<l.length;u++){var U=l[u],J=U.startTime;if(J>I)break;var oe=U.transferSize,fe=U.initiatorType;oe&&d_(fe)&&(U=U.responseEnd,_+=oe*(U<I?1:(I-J)/(U-J)))}if(--u,i+=8*(g+_)/(p.duration/1e3),s++,10<s)break}}if(0<s)return i/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var yg=null,bg=null;function zh(s){return s.nodeType===9?s:s.ownerDocument}function h_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function f_(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function vg(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var _g=null;function eA(){var s=window.event;return s&&s.type==="popstate"?s===_g?!1:(_g=s,!0):(_g=null,!1)}var m_=typeof setTimeout=="function"?setTimeout:void 0,tA=typeof clearTimeout=="function"?clearTimeout:void 0,p_=typeof Promise=="function"?Promise:void 0,nA=typeof queueMicrotask=="function"?queueMicrotask:typeof p_<"u"?function(s){return p_.resolve(null).then(s).catch(sA)}:m_;function sA(s){setTimeout(function(){throw s})}function Li(s){return s==="head"}function g_(s,i){var l=i,u=0;do{var p=l.nextSibling;if(s.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(p),yl(i);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")ru(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,ru(l);for(var g=l.firstChild;g;){var _=g.nextSibling,I=g.nodeName;g[_r]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=_}}else l==="body"&&ru(s.ownerDocument.body);l=p}while(l);yl(i)}function x_(s,i){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function wg(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":wg(l),_a(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function rA(s,i,l,u){for(;s.nodeType===1;){var p=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[_r])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=As(s.nextSibling),s===null)break}return null}function iA(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=As(s.nextSibling),s===null))return null;return s}function y_(s,i){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!i||(s=As(s.nextSibling),s===null))return null;return s}function Ng(s){return s.data==="$?"||s.data==="$~"}function Tg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aA(s,i){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=i;else if(s.data!=="$?"||l.readyState!=="loading")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function As(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return s}var Eg=null;function b_(s){s=s.nextSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(i===0)return As(s.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}s=s.nextSibling}return null}function v_(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return s;i--}else l!=="/$"&&l!=="/&"||i++}s=s.previousSibling}return null}function __(s,i,l){switch(i=zh(l),s){case"html":if(s=i.documentElement,!s)throw Error(r(452));return s;case"head":if(s=i.head,!s)throw Error(r(453));return s;case"body":if(s=i.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function ru(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);_a(s)}var Is=new Map,w_=new Set;function Hh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var zr=ce.d;ce.d={f:oA,r:lA,D:cA,C:uA,L:dA,m:hA,X:mA,S:fA,M:pA};function oA(){var s=zr.f(),i=Ph();return s||i}function lA(s){var i=Nr(s);i!==null&&i.tag===5&&i.type==="form"?Ub(i):zr.r(s)}var pl=typeof document>"u"?null:document;function N_(s,i,l){var u=pl;if(u&&typeof i=="string"&&i){var p=Rt(i);p='link[rel="'+s+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),w_.has(p)||(w_.add(p),s={rel:s,crossOrigin:l,href:i},u.querySelector(p)===null&&(i=u.createElement("link"),bn(i,"link",s),Ft(i),u.head.appendChild(i)))}}function cA(s){zr.D(s),N_("dns-prefetch",s,null)}function uA(s,i){zr.C(s,i),N_("preconnect",s,i)}function dA(s,i,l){zr.L(s,i,l);var u=pl;if(u&&s&&i){var p='link[rel="preload"][as="'+Rt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+Rt(l.imageSizes)+'"]')):p+='[href="'+Rt(s)+'"]';var g=p;switch(i){case"style":g=gl(s);break;case"script":g=xl(s)}Is.has(g)||(s=v({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),Is.set(g,s),u.querySelector(p)!==null||i==="style"&&u.querySelector(iu(g))||i==="script"&&u.querySelector(au(g))||(i=u.createElement("link"),bn(i,"link",s),Ft(i),u.head.appendChild(i)))}}function hA(s,i){zr.m(s,i);var l=pl;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',g=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=xl(s)}if(!Is.has(g)&&(s=v({rel:"modulepreload",href:s},i),Is.set(g,s),l.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(au(g)))return}u=l.createElement("link"),bn(u,"link",s),Ft(u),l.head.appendChild(u)}}}function fA(s,i,l){zr.S(s,i,l);var u=pl;if(u&&s){var p=Os(u).hoistableStyles,g=gl(s);i=i||"default";var _=p.get(g);if(!_){var I={loading:0,preload:null};if(_=u.querySelector(iu(g)))I.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":i},l),(l=Is.get(g))&&Sg(s,l);var U=_=u.createElement("link");Ft(U),bn(U,"link",s),U._p=new Promise(function(J,oe){U.onload=J,U.onerror=oe}),U.addEventListener("load",function(){I.loading|=1}),U.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Gh(_,i,u)}_={type:"stylesheet",instance:_,count:1,state:I},p.set(g,_)}}}function mA(s,i){zr.X(s,i);var l=pl;if(l&&s){var u=Os(l).hoistableScripts,p=xl(s),g=u.get(p);g||(g=l.querySelector(au(p)),g||(s=v({src:s,async:!0},i),(i=Is.get(p))&&Ag(s,i),g=l.createElement("script"),Ft(g),bn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function pA(s,i){zr.M(s,i);var l=pl;if(l&&s){var u=Os(l).hoistableScripts,p=xl(s),g=u.get(p);g||(g=l.querySelector(au(p)),g||(s=v({src:s,async:!0,type:"module"},i),(i=Is.get(p))&&Ag(s,i),g=l.createElement("script"),Ft(g),bn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function T_(s,i,l,u){var p=(p=F.current)?Hh(p):null;if(!p)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=gl(l.href),l=Os(p).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=gl(l.href);var g=Os(p).hoistableStyles,_=g.get(s);if(_||(p=p.ownerDocument||p,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,_),(g=p.querySelector(iu(s)))&&!g._p&&(_.instance=g,_.state.loading=5),Is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Is.set(s,l),g||gA(p,s,l,_.state))),i&&u===null)throw Error(r(528,""));return _}if(i&&u!==null)throw Error(r(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=xl(l),l=Os(p).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function gl(s){return'href="'+Rt(s)+'"'}function iu(s){return'link[rel="stylesheet"]['+s+"]"}function E_(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function gA(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),bn(i,"link",l),Ft(i),s.head.appendChild(i))}function xl(s){return'[src="'+Rt(s)+'"]'}function au(s){return"script[async]"+s}function S_(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return i.instance=u,Ft(u),u;var p=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),Ft(u),bn(u,"style",p),Gh(u,l.precedence,s),i.instance=u;case"stylesheet":p=gl(l.href);var g=s.querySelector(iu(p));if(g)return i.state.loading|=4,i.instance=g,Ft(g),g;u=E_(l),(p=Is.get(p))&&Sg(u,p),g=(s.ownerDocument||s).createElement("link"),Ft(g);var _=g;return _._p=new Promise(function(I,U){_.onload=I,_.onerror=U}),bn(g,"link",u),i.state.loading|=4,Gh(g,l.precedence,s),i.instance=g;case"script":return g=xl(l.src),(p=s.querySelector(au(g)))?(i.instance=p,Ft(p),p):(u=l,(p=Is.get(g))&&(u=v({},l),Ag(u,p)),s=s.ownerDocument||s,p=s.createElement("script"),Ft(p),bn(p,"link",u),s.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Gh(u,l.precedence,s));return i.instance}function Gh(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,g=p,_=0;_<u.length;_++){var I=u[_];if(I.dataset.precedence===i)g=I;else if(g!==p)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function Sg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function Ag(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Kh=null;function A_(s,i,l){if(Kh===null){var u=new Map,p=Kh=new Map;p.set(l,u)}else p=Kh,u=p.get(l),u||(u=new Map,p.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),p=0;p<l.length;p++){var g=l[p];if(!(g[_r]||g[Le]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var _=g.getAttribute(i)||"";_=s+_;var I=u.get(_);I?I.push(g):u.set(_,[g])}}return u}function I_(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function xA(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function j_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yA(s,i,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=gl(u.href),g=i.querySelector(iu(p));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(s.count++,s=$h.bind(s),i.then(s,s)),l.state.loading|=4,l.instance=g,Ft(g);return}g=i.ownerDocument||i,u=E_(u),(p=Is.get(p))&&Sg(u,p),g=g.createElement("link"),Ft(g);var _=g;_._p=new Promise(function(I,U){_.onload=I,_.onerror=U}),bn(g,"link",u),l.instance=g}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=$h.bind(s),i.addEventListener("load",l),i.addEventListener("error",l))}}var Ig=0;function bA(s,i){return s.stylesheets&&s.count===0&&Yh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&Yh(s,s.stylesheets),s.unsuspend){var g=s.unsuspend;s.unsuspend=null,g()}},6e4+i);0<s.imgBytes&&Ig===0&&(Ig=62500*ZS());var p=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Yh(s,s.stylesheets),s.unsuspend)){var g=s.unsuspend;s.unsuspend=null,g()}},(s.imgBytes>Ig?50:800)+i);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function $h(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Yh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Qh=null;function Yh(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Qh=new Map,i.forEach(vA,s),Qh=null,$h.call(s))}function vA(s,i){if(!(i.state.loading&4)){var l=Qh.get(s);if(l)var u=l.get(null);else{l=new Map,Qh.set(s,l);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var _=p[g];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(l.set(_.dataset.precedence,_),u=_)}u&&l.set(null,u)}p=i.instance,_=p.getAttribute("data-precedence"),g=l.get(_)||u,g===u&&l.set(null,p),l.set(_,p),this.count++,u=$h.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),g?g.parentNode.insertBefore(p,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),i.state.loading|=4}}var ou={$$typeof:K,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function _A(s,i,l,u,p,g,_,I,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ms(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ms(0),this.hiddenUpdates=Ms(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function R_(s,i,l,u,p,g,_,I,U,J,oe,fe){return s=new _A(s,i,l,_,U,J,oe,fe,I),i=1,g===!0&&(i|=24),g=os(3,null,null,i),s.current=g,g.stateNode=s,i=op(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},dp(g),s}function C_(s){return s?(s=Qo,s):Qo}function k_(s,i,l,u,p,g){p=C_(p),u.context===null?u.context=p:u.pendingContext=p,u=Ai(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Ii(s,u,i),l!==null&&(Wn(l,s,i),Uc(l,s,i))}function D_(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function jg(s,i){D_(s,i),(s=s.alternate)&&D_(s,i)}function M_(s){if(s.tag===13||s.tag===31){var i=Da(s,67108864);i!==null&&Wn(i,s,67108864),jg(s,67108864)}}function P_(s){if(s.tag===13||s.tag===31){var i=hs();i=oi(i);var l=Da(s,i);l!==null&&Wn(l,s,i),jg(s,i)}}var Wh=!0;function wA(s,i,l,u){var p=W.T;W.T=null;var g=ce.p;try{ce.p=2,Rg(s,i,l,u)}finally{ce.p=g,W.T=p}}function NA(s,i,l,u){var p=W.T;W.T=null;var g=ce.p;try{ce.p=8,Rg(s,i,l,u)}finally{ce.p=g,W.T=p}}function Rg(s,i,l,u){if(Wh){var p=Cg(u);if(p===null)gg(s,i,u,Xh,l),V_(s,u);else if(EA(p,s,i,l,u))u.stopPropagation();else if(V_(s,u),i&4&&-1<TA.indexOf(s)){for(;p!==null;){var g=Nr(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var _=ss(g.pendingLanes);if(_!==0){var I=g;for(I.pendingLanes|=2,I.entangledLanes|=2;_;){var U=1<<31-pn(_);I.entanglements[1]|=U,_&=~U}tr(g),(ot&6)===0&&(Dh=en()+500,tu(0))}}break;case 31:case 13:I=Da(g,2),I!==null&&Wn(I,g,2),Ph(),jg(g,2)}if(g=Cg(u),g===null&&gg(s,i,u,Xh,l),g===p)break;p=g}p!==null&&u.stopPropagation()}else gg(s,i,u,null,l)}}function Cg(s){return s=Fo(s),kg(s)}var Xh=null;function kg(s){if(Xh=null,s=wr(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===31){if(s=f(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Xh=s,null}function O_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ko()){case Ut:return 2;case Kt:return 8;case ks:case Do:return 32;case xa:return 268435456;default:return 32}default:return 32}}var Dg=!1,Ui=null,Fi=null,qi=null,lu=new Map,cu=new Map,Bi=[],TA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function V_(s,i){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":qi=null;break;case"pointerover":case"pointerout":lu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":cu.delete(i.pointerId)}}function uu(s,i,l,u,p,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[p]},i!==null&&(i=Nr(i),i!==null&&M_(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),s)}function EA(s,i,l,u,p){switch(i){case"focusin":return Ui=uu(Ui,s,i,l,u,p),!0;case"dragenter":return Fi=uu(Fi,s,i,l,u,p),!0;case"mouseover":return qi=uu(qi,s,i,l,u,p),!0;case"pointerover":var g=p.pointerId;return lu.set(g,uu(lu.get(g)||null,s,i,l,u,p)),!0;case"gotpointercapture":return g=p.pointerId,cu.set(g,uu(cu.get(g)||null,s,i,l,u,p)),!0}return!1}function L_(s){var i=wr(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,de(s.priority,function(){P_(l)});return}}else if(i===31){if(i=f(l),i!==null){s.blockedOn=i,de(s.priority,function(){P_(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Jh(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=Cg(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);Uo=u,l.target.dispatchEvent(u),Uo=null}else return i=Nr(l),i!==null&&M_(i),s.blockedOn=l,!1;i.shift()}return!0}function U_(s,i,l){Jh(s)&&l.delete(i)}function SA(){Dg=!1,Ui!==null&&Jh(Ui)&&(Ui=null),Fi!==null&&Jh(Fi)&&(Fi=null),qi!==null&&Jh(qi)&&(qi=null),lu.forEach(U_),cu.forEach(U_)}function Zh(s,i){s.blockedOn===i&&(s.blockedOn=null,Dg||(Dg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,SA)))}var ef=null;function F_(s){ef!==s&&(ef=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ef===s&&(ef=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],p=s[i+2];if(typeof u!="function"){if(kg(u||l)===null)continue;break}var g=Nr(l);g!==null&&(s.splice(i,3),i-=3,Cp(g,{pending:!0,data:p,method:l.method,action:u},u,p))}}))}function yl(s){function i(U){return Zh(U,s)}Ui!==null&&Zh(Ui,s),Fi!==null&&Zh(Fi,s),qi!==null&&Zh(qi,s),lu.forEach(i),cu.forEach(i);for(var l=0;l<Bi.length;l++){var u=Bi[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<Bi.length&&(l=Bi[0],l.blockedOn===null);)L_(l),l.blockedOn===null&&Bi.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var p=l[u],g=l[u+1],_=p[at]||null;if(typeof g=="function")_||F_(l);else if(_){var I=null;if(g&&g.hasAttribute("formAction")){if(p=g,_=g[at]||null)I=_.formAction;else if(kg(p)!==null)continue}else I=_.action;typeof I=="function"?l[u+1]=I:(l.splice(u,3),u-=3),F_(l)}}}function q_(){function s(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(_){return p=_})},focusReset:"manual",scroll:"manual"})}function i(){p!==null&&(p(),p=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),p!==null&&(p(),p=null)}}}function Mg(s){this._internalRoot=s}tf.prototype.render=Mg.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(r(409));var l=i.current,u=hs();k_(l,u,s,i,null,null)},tf.prototype.unmount=Mg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;k_(s.current,2,null,s,null,null),Ph(),i[Rn]=null}};function tf(s){this._internalRoot=s}tf.prototype.unstable_scheduleHydration=function(s){if(s){var i=ye();s={blockedOn:null,target:s,priority:i};for(var l=0;l<Bi.length&&i!==0&&i<Bi[l].priority;l++);Bi.splice(l,0,s),l===0&&L_(s)}};var B_=e.version;if(B_!=="19.2.1")throw Error(r(527,B_,"19.2.1"));ce.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=x(i),s=s!==null?y(s):null,s=s===null?null:s.stateNode,s};var AA={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nf.isDisabled&&nf.supportsFiber)try{Ds=nf.inject(AA),on=nf}catch{}}return hu.createRoot=function(s,i){if(!a(s))throw Error(r(299));var l=!1,u="",p=Yb,g=Wb,_=Xb;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),i=R_(s,1,!1,null,null,l,u,null,p,g,_,q_),s[Rn]=i.current,pg(s),new Mg(i)},hu.hydrateRoot=function(s,i,l){if(!a(s))throw Error(r(299));var u=!1,p="",g=Yb,_=Wb,I=Xb,U=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(U=l.formState)),i=R_(s,1,!0,i,l??null,u,p,U,g,_,I,q_),i.context=C_(null),l=i.current,u=hs(),u=oi(u),p=Ai(u),p.callback=null,Ii(l,p,u),l=u,i.current.lanes=l,Ks(i,l),tr(i),s[Rn]=i.current,pg(s),new tf(i)},hu.version="19.2.1",hu}var J_;function VA(){if(J_)return Vg.exports;J_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Vg.exports=OA(),Vg.exports}var LA=VA();const UA=eN(LA),_o=({className:n,onClick:e,style:t,title:r})=>{const[a,c]=L.useState(!1);return a?o.jsxs("svg",{viewBox:"0 0 300 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,"aria-label":"MASERP",onClick:e,style:t,role:"img",children:[r&&o.jsx("title",{children:r}),o.jsxs("g",{children:[o.jsx("path",{d:"M42 12L70 28V60L42 76L14 60V28L42 12Z",fill:"#1E3A8A"}),o.jsx("path",{d:"M42 30L54 38V50L42 58L30 50V38L42 30Z",fill:"#FFFFFF"})]}),o.jsx("text",{x:"90",y:"55",fill:"#1E3A8A",fontFamily:"sans-serif",fontWeight:"bold",fontSize:"42",children:"MASERP"})]}):o.jsx("img",{src:"/logo.png",alt:"MASERP",className:`object-contain ${n||""}`,onError:()=>c(!0),onClick:e,style:t,title:r})};var Z_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},FA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const c=n[t++];e[r++]=String.fromCharCode((a&31)<<6|c&63)}else if(a>239&&a<365){const c=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(m>>10)),e[r++]=String.fromCharCode(56320+(m&1023))}else{const c=n[t++],d=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(c&63)<<6|d&63)}}return e.join("")},nN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const c=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,x=m?n[a+2]:0,y=c>>2,v=(c&3)<<4|f>>4;let E=(f&15)<<2|x>>6,A=x&63;m||(A=64,d||(E=64)),r.push(t[y],t[v],t[E],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(tN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):FA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const c=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const x=a<n.length?t[n.charAt(a)]:64;++a;const v=a<n.length?t[n.charAt(a)]:64;if(++a,c==null||f==null||x==null||v==null)throw new qA;const E=c<<2|f>>4;if(r.push(E),x!==64){const A=f<<4&240|x>>2;if(r.push(A),v!==64){const V=x<<6&192|v;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class qA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const BA=function(n){const e=tN(n);return nN.encodeByteArray(e,!0)},Af=function(n){return BA(n).replace(/\./g,"")},sN=function(n){try{return nN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function If(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!zA(t)||(n[t]=If(n[t],e[t]));return n}function zA(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=()=>rN().__FIREBASE_DEFAULTS__,GA=()=>{if(typeof process>"u"||typeof Z_>"u")return;const n=Z_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},KA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&sN(n[1]);return e&&JSON.parse(e)},q0=()=>{try{return HA()||GA()||KA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},iN=()=>{var n;return(n=q0())===null||n===void 0?void 0:n.config},$A=n=>{var e;return(e=q0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Af(JSON.stringify(t)),Af(JSON.stringify(d)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jt())}function B0(){var n;const e=(n=q0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XA(){return typeof window<"u"||aN()}function aN(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function JA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function z0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lN(){const n=jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function cN(){return!B0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lu(){try{return typeof indexedDB=="object"}catch{return!1}}function ZA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var c;e(((c=a.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="FirebaseError";class Ln extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=eI,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wo.prototype.create)}}class wo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,c=this.errors[e],d=c?tI(c,r):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new Ln(a,f,r)}}function tI(n,e){return n.replace(nI,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const nI=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function sI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uu(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const c=n[a],d=e[a];if(tw(c)&&tw(d)){if(!Uu(c,d))return!1}else if(c!==d)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function tw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,c]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(c)}}),e}function wu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function uN(n,e){const t=new rI(n,e);return t.subscribe.bind(t)}class rI{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");iI(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=qg),a.error===void 0&&(a.error=qg),a.complete===void 0&&(a.complete=qg);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iI(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function qg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n){return n&&n._delegate?n._delegate:n}class dr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new QA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(a)return null;throw c}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lI(e))try{this.getOrInitializeService({instanceIdentifier:Ya})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:a});r.resolve(c)}catch{}}}}clearInstance(e=Ya){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ya){return this.instances.has(e)}getOptions(e=Ya){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);r===f&&d.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),c=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;c.add(e),this.onInitCallbacks.set(a,c);const d=this.instances.get(a);return d&&e(d,a),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oI(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ya){return this.component?this.component.multipleInstances?e:Ya:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oI(n){return n===Ya?void 0:n}function lI(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new aI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=[];var Ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ye||(Ye={}));const hN={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},cI=Ye.INFO,uI={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},dI=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=uI[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xf{constructor(e){this.name=e,this._logLevel=cI,this._logHandler=dI,this._userLogHandler=null,H0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}function hI(n){H0.forEach(e=>{e.setLogLevel(n)})}function fI(n,e){for(const t of H0){let r=null;e&&e.level&&(r=hN[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(a,c,...d)=>{const f=d.map(m=>{if(m==null)return null;if(typeof m=="string")return m;if(typeof m=="number"||typeof m=="boolean")return m.toString();if(m instanceof Error)return m.message;try{return JSON.stringify(m)}catch{return null}}).filter(m=>m).join(" ");c>=(r??a.logLevel)&&n({level:Ye[c].toLowerCase(),message:f,args:d,type:a.name})}}}const mI=(n,e)=>e.some(t=>n instanceof t);let nw,sw;function pI(){return nw||(nw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gI(){return sw||(sw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fN=new WeakMap,r0=new WeakMap,mN=new WeakMap,Bg=new WeakMap,G0=new WeakMap;function xI(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(Ji(n.result)),a()},d=()=>{r(n.error),a()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&fN.set(t,n)}).catch(()=>{}),G0.set(e,n),e}function yI(n){if(r0.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),a()},d=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});r0.set(n,e)}let i0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return r0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||mN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ji(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bI(n){i0=n(i0)}function vI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(zg(this),e,...t);return mN.set(r,e.sort?e.sort():[e]),Ji(r)}:gI().includes(n)?function(...e){return n.apply(zg(this),e),Ji(fN.get(this))}:function(...e){return Ji(n.apply(zg(this),e))}}function _I(n){return typeof n=="function"?vI(n):(n instanceof IDBTransaction&&yI(n),mI(n,pI())?new Proxy(n,i0):n)}function Ji(n){if(n instanceof IDBRequest)return xI(n);if(Bg.has(n))return Bg.get(n);const e=_I(n);return e!==n&&(Bg.set(n,e),G0.set(e,n)),e}const zg=n=>G0.get(n);function wI(n,e,{blocked:t,upgrade:r,blocking:a,terminated:c}={}){const d=indexedDB.open(n,e),f=Ji(d);return r&&d.addEventListener("upgradeneeded",m=>{r(Ji(d.result),m.oldVersion,m.newVersion,Ji(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{c&&m.addEventListener("close",()=>c()),a&&m.addEventListener("versionchange",x=>a(x.oldVersion,x.newVersion,x))}).catch(()=>{}),f}const NI=["get","getKey","getAll","getAllKeys","count"],TI=["put","add","delete","clear"],Hg=new Map;function rw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Hg.get(e))return Hg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=TI.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||NI.includes(t)))return;const c=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let x=m.store;return r&&(x=x.index(f.shift())),(await Promise.all([x[t](...f),a&&m.done]))[0]};return Hg.set(e,c),c}bI(n=>({...n,get:(e,t,r)=>rw(e,t)||n.get(e,t,r),has:(e,t)=>!!rw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SI(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function SI(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const jf="@firebase/app",a0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new Xf("@firebase/app"),AI="@firebase/app-compat",II="@firebase/analytics-compat",jI="@firebase/analytics",RI="@firebase/app-check-compat",CI="@firebase/app-check",kI="@firebase/auth",DI="@firebase/auth-compat",MI="@firebase/database",PI="@firebase/data-connect",OI="@firebase/database-compat",VI="@firebase/functions",LI="@firebase/functions-compat",UI="@firebase/installations",FI="@firebase/installations-compat",qI="@firebase/messaging",BI="@firebase/messaging-compat",zI="@firebase/performance",HI="@firebase/performance-compat",GI="@firebase/remote-config",KI="@firebase/remote-config-compat",$I="@firebase/storage",QI="@firebase/storage-compat",YI="@firebase/firestore",WI="@firebase/vertexai-preview",XI="@firebase/firestore-compat",JI="firebase",ZI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea="[DEFAULT]",ej={[jf]:"fire-core",[AI]:"fire-core-compat",[jI]:"fire-analytics",[II]:"fire-analytics-compat",[CI]:"fire-app-check",[RI]:"fire-app-check-compat",[kI]:"fire-auth",[DI]:"fire-auth-compat",[MI]:"fire-rtdb",[PI]:"fire-data-connect",[OI]:"fire-rtdb-compat",[VI]:"fire-fn",[LI]:"fire-fn-compat",[UI]:"fire-iid",[FI]:"fire-iid-compat",[qI]:"fire-fcm",[BI]:"fire-fcm-compat",[zI]:"fire-perf",[HI]:"fire-perf-compat",[GI]:"fire-rc",[KI]:"fire-rc-compat",[$I]:"fire-gcs",[QI]:"fire-gcs-compat",[YI]:"fire-fst",[XI]:"fire-fst-compat",[WI]:"fire-vertex","fire-js":"fire-js",[JI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new Map,Ll=new Map,Ul=new Map;function Fu(n,e){try{n.container.addComponent(e)}catch(t){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function pN(n,e){n.container.addOrOverwriteComponent(e)}function na(n){const e=n.name;if(Ul.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;Ul.set(e,n);for(const t of ta.values())Fu(t,n);for(const t of Ll.values())Fu(t,n);return!0}function gN(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function tj(n,e,t=ea){gN(n,e).clearInstance(t)}function xN(n){return n.options!==void 0}function Dt(n){return n.settings!==void 0}function nj(){Ul.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rs=new wo("app","Firebase",sj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yN=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new dr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rs.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj extends yN{constructor(e,t,r,a){const c=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,d={name:r,automaticDataCollectionEnabled:c};if(e.apiKey!==void 0)super(e,d,a);else{const f=e;super(f.options,d,a)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:c},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Bs(jf,a0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){$0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Rs.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=ZI;function K0(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ea,automaticDataCollectionEnabled:!1},e),a=r.name;if(typeof a!="string"||!a)throw Rs.create("bad-app-name",{appName:String(a)});if(t||(t=iN()),!t)throw Rs.create("no-options");const c=ta.get(a);if(c){if(Uu(t,c.options)&&Uu(r,c.config))return c;throw Rs.create("duplicate-app",{appName:a})}const d=new dN(a);for(const m of Ul.values())d.addComponent(m);const f=new yN(t,r,d);return ta.set(a,f),f}function ij(n,e){if(XA()&&!aN())throw Rs.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;xN(n)?t=n.options:t=n;const r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const a=x=>[...x].reduce((y,v)=>Math.imul(31,y)+v.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Rs.create("finalization-registry-not-supported",{});const c=""+a(JSON.stringify(r)),d=Ll.get(c);if(d)return d.incRefCount(e.releaseOnDeref),d;const f=new dN(c);for(const x of Ul.values())f.addComponent(x);const m=new rj(t,e,c,f);return Ll.set(c,m),m}function aj(n=ea){const e=ta.get(n);if(!e&&n===ea&&iN())return K0();if(!e)throw Rs.create("no-app",{appName:n});return e}function oj(){return Array.from(ta.values())}async function $0(n){let e=!1;const t=n.name;ta.has(t)?(e=!0,ta.delete(t)):Ll.has(t)&&n.decRefCount()<=0&&(Ll.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Bs(n,e,t){var r;let a=(r=ej[n])!==null&&r!==void 0?r:n;t&&(a+=`-${t}`);const c=a.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${a}" with version "${e}":`];c&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(f.join(" "));return}na(new dr(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}function bN(n,e){if(n!==null&&typeof n!="function")throw Rs.create("invalid-log-argument");fI(n,e)}function vN(n){hI(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj="firebase-heartbeat-database",cj=1,qu="firebase-heartbeat-store";let Gg=null;function _N(){return Gg||(Gg=wI(lj,cj,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(qu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Rs.create("idb-open",{originalErrorMessage:n.message})})),Gg}async function uj(n){try{const t=(await _N()).transaction(qu),r=await t.objectStore(qu).get(wN(n));return await t.done,r}catch(e){if(e instanceof Ln)Qr.warn(e.message);else{const t=Rs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qr.warn(t.message)}}}async function iw(n,e){try{const r=(await _N()).transaction(qu,"readwrite");await r.objectStore(qu).put(e,wN(n)),await r.done}catch(t){if(t instanceof Ln)Qr.warn(t.message);else{const r=Rs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qr.warn(r.message)}}}function wN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=1024,hj=720*60*60*1e3;class fj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pj(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=aw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c)?void 0:(this._heartbeatsCache.heartbeats.push({date:c,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(d=>{const f=new Date(d.date).valueOf();return Date.now()-f<=hj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Qr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=aw(),{heartbeatsToSend:r,unsentEntries:a}=mj(this._heartbeatsCache.heartbeats),c=Af(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Qr.warn(t),""}}}function aw(){return new Date().toISOString().substring(0,10)}function mj(n,e=dj){const t=[];let r=n.slice();for(const a of n){const c=t.find(d=>d.agent===a.agent);if(c){if(c.dates.push(a.date),ow(t)>e){c.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),ow(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class pj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lu()?ZA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await uj(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return iw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return iw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function ow(n){return Af(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(n){na(new dr("platform-logger",e=>new EI(e),"PRIVATE")),na(new dr("heartbeat",e=>new fj(e),"PRIVATE")),Bs(jf,a0,n),Bs(jf,a0,"esm2017"),Bs("fire-js","")}gj("");const xj=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Ln,SDK_VERSION:da,_DEFAULT_ENTRY_NAME:ea,_addComponent:Fu,_addOrOverwriteComponent:pN,_apps:ta,_clearComponents:nj,_components:Ul,_getProvider:gN,_isFirebaseApp:xN,_isFirebaseServerApp:Dt,_registerComponent:na,_removeServiceInstance:tj,_serverApps:Ll,deleteApp:$0,getApp:aj,getApps:oj,initializeApp:K0,initializeServerApp:ij,onLog:bN,registerVersion:Bs,setLogLevel:vN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e,t){this._delegate=e,this.firebase=t,Fu(e,new dr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),$0(this._delegate)))}_getService(e,t=ea){var r;this._delegate.checkDestroyed();const a=this._delegate.container.getProvider(e);return!a.isInitialized()&&((r=a.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&a.initialize(),a.getImmediate({identifier:t})}_removeServiceInstance(e,t=ea){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Fu(this._delegate,e)}_addOrOverwriteComponent(e){pN(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},lw=new wo("app-compat","Firebase",bj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(n){const e={},t={__esModule:!0,initializeApp:c,app:a,registerVersion:Bs,setLogLevel:vN,onLog:bN,apps:null,SDK_VERSION:da,INTERNAL:{registerComponent:f,removeApp:r,useAsService:m,modularAPIs:xj}};t.default=t,Object.defineProperty(t,"apps",{get:d});function r(x){delete e[x]}function a(x){if(x=x||ea,!ew(e,x))throw lw.create("no-app",{appName:x});return e[x]}a.App=n;function c(x,y={}){const v=K0(x,y);if(ew(e,v.name))return e[v.name];const E=new n(v,t);return e[v.name]=E,E}function d(){return Object.keys(e).map(x=>e[x])}function f(x){const y=x.name,v=y.replace("-compat","");if(na(x)&&x.type==="PUBLIC"){const E=(A=a())=>{if(typeof A[v]!="function")throw lw.create("invalid-app-argument",{appName:y});return A[v]()};x.serviceProps!==void 0&&If(E,x.serviceProps),t[v]=E,n.prototype[v]=function(...A){return this._getService.bind(this,y).apply(this,x.multipleInstances?A:[])}}return x.type==="PUBLIC"?t[v]:null}function m(x,y){return y==="serverAuth"?null:y}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(){const n=vj(yj);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:NN,extendNamespace:e,createSubscribe:uN,ErrorFactory:wo,deepExtend:If});function e(t){If(n,t)}return n}const _j=NN();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=new Xf("@firebase/app-compat"),wj="@firebase/app-compat",Nj="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(n){Bs(wj,Nj,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=rN();if(n.firebase!==void 0){cw.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&cw.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ms=_j;Tj();var Ej="firebase",Sj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ms.registerVersion(Ej,Sj,"app-compat");function Q0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}const fu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},bl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function TN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ij=Aj,jj=TN,EN=new wo("auth","Firebase",TN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=new Xf("@firebase/auth");function Rj(n,...e){Rf.logLevel<=Ye.WARN&&Rf.warn(`Auth (${da}): ${n}`,...e)}function pf(n,...e){Rf.logLevel<=Ye.ERROR&&Rf.error(`Auth (${da}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(n,...e){throw W0(n,...e)}function rn(n,...e){return W0(n,...e)}function Y0(n,e,t){const r=Object.assign(Object.assign({},jj()),{[e]:t});return new wo("auth","Firebase",r).create(e,{appName:n.name})}function mn(n){return Y0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sc(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Tn(n,"argument-error"),Y0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function W0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return EN.create(n,...e)}function be(n,e,...t){if(!n)throw W0(e,...t)}function ar(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pf(e),new Error(e)}function zs(n,e){n||ar(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function X0(){return uw()==="http:"||uw()==="https:"}function uw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(X0()||oN()||"connection"in navigator)?navigator.onLine:!0}function kj(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,t){this.shortDelay=e,this.longDelay=t,zs(t>e,"Short delay should be less than long delay!"),this.isMobile=WA()||z0()}get(){return Cj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(n,e){zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=new fd(3e4,6e4);function Ot(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Vt(n,e,t,r,a={}){return AN(n,a,async()=>{let c={},d={};r&&(e==="GET"?d=r:c={body:JSON.stringify(r)});const f=nc(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const x=Object.assign({method:e,headers:m},c);return JA()||(x.referrerPolicy="no-referrer"),SN.fetch()(IN(n,n.config.apiHost,t,f),x)})}async function AN(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},Dj),e);try{const a=new Oj(n),c=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Nu(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[m,x]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw Nu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw Nu(n,"user-disabled",d);const y=r[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw Y0(n,y,x);Tn(n,y)}}catch(a){if(a instanceof Ln)throw a;Tn(n,"network-request-failed",{message:String(a)})}}async function Jr(n,e,t,r,a={}){const c=await Vt(n,e,t,r,a);return"mfaPendingCredential"in c&&Tn(n,"multi-factor-auth-required",{_serverResponse:c}),c}function IN(n,e,t,r){const a=`${e}${t}?${r}`;return n.config.emulator?J0(n.config,a):`${n.config.apiScheme}://${a}`}function Pj(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Oj{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(rn(this.auth,"network-request-failed")),Mj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Nu(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=rn(n,e,r);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(n){return n!==void 0&&n.getResponse!==void 0}function hw(n){return n!==void 0&&n.enterprise!==void 0}class Vj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Pj(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(n){return(await Vt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Uj(n,e){return Vt(n,"GET","/v2/recaptchaConfig",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fj(n,e){return Vt(n,"POST","/v1/accounts:delete",e)}async function qj(n,e){return Vt(n,"POST","/v1/accounts:update",e)}async function jN(n,e){return Vt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Bj(n,e=!1){const t=Oe(n),r=await t.getIdToken(e),a=Jf(r);be(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const c=typeof a.firebase=="object"?a.firebase:void 0,d=c==null?void 0:c.sign_in_provider;return{claims:a,token:r,authTime:ju(Kg(a.auth_time)),issuedAtTime:ju(Kg(a.iat)),expirationTime:ju(Kg(a.exp)),signInProvider:d||null,signInSecondFactor:(c==null?void 0:c.sign_in_second_factor)||null}}function Kg(n){return Number(n)*1e3}function Jf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return pf("JWT malformed, contained fewer than 3 sections"),null;try{const a=sN(t);return a?JSON.parse(a):(pf("Failed to decode base64 JWT payload"),null)}catch(a){return pf("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function fw(n){const e=Jf(n);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ln&&zj(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function zj({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ju(this.lastLoginAt),this.creationTime=ju(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zu(n){var e;const t=n.auth,r=await n.getIdToken(),a=await Yr(n,jN(t,{idToken:r}));be(a==null?void 0:a.users.length,t,"internal-error");const c=a.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?RN(c.providerUserInfo):[],f=Kj(n.providerData,d),m=n.isAnonymous,x=!(n.email&&c.passwordHash)&&!(f!=null&&f.length),y=m?x:!1,v={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new o0(c.createdAt,c.lastLoginAt),isAnonymous:y};Object.assign(n,v)}async function Gj(n){const e=Oe(n);await zu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Kj(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function RN(n){return n.map(e=>{var{providerId:t}=e,r=Q0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $j(n,e){const t=await AN(n,{},async()=>{const r=nc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:c}=n.config,d=IN(n,a,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();return f["Content-Type"]="application/x-www-form-urlencoded",SN.fetch()(d,{method:"POST",headers:f,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Qj(n,e){return Vt(n,"POST","/v2/accounts:revokeToken",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){be(e.length!==0,"internal-error");const t=fw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:c}=await $j(e,t);this.updateTokensAndExpiration(r,a,Number(c))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:c}=t,d=new kl;return r&&(be(typeof r=="string","internal-error",{appName:e}),d.refreshToken=r),a&&(be(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),c&&(be(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new kl,this.toJSON())}_performRefresh(){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(n,e){be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Hr{constructor(e){var{uid:t,auth:r,stsTokenManager:a}=e,c=Q0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new o0(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Yr(this,this.stsTokenManager.getToken(this.auth,e));return be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Bj(this,e)}reload(){return Gj(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Hr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await zu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dt(this.auth.app))return Promise.reject(mn(this.auth));const e=await this.getIdToken();return await Yr(this,Fj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,a,c,d,f,m,x,y;const v=(r=t.displayName)!==null&&r!==void 0?r:void 0,E=(a=t.email)!==null&&a!==void 0?a:void 0,A=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,V=(d=t.photoURL)!==null&&d!==void 0?d:void 0,C=(f=t.tenantId)!==null&&f!==void 0?f:void 0,O=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,z=(x=t.createdAt)!==null&&x!==void 0?x:void 0,ae=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:K,emailVerified:ee,isAnonymous:B,providerData:Q,stsTokenManager:j}=t;be(K&&j,e,"internal-error");const T=kl.fromJSON(this.name,j);be(typeof K=="string",e,"internal-error"),Hi(v,e.name),Hi(E,e.name),be(typeof ee=="boolean",e,"internal-error"),be(typeof B=="boolean",e,"internal-error"),Hi(A,e.name),Hi(V,e.name),Hi(C,e.name),Hi(O,e.name),Hi(z,e.name),Hi(ae,e.name);const S=new Hr({uid:K,auth:e,email:E,emailVerified:ee,displayName:v,isAnonymous:B,photoURL:V,phoneNumber:A,tenantId:C,stsTokenManager:T,createdAt:z,lastLoginAt:ae});return Q&&Array.isArray(Q)&&(S.providerData=Q.map(N=>Object.assign({},N))),O&&(S._redirectEventId=O),S}static async _fromIdTokenResponse(e,t,r=!1){const a=new kl;a.updateFromServerResponse(t);const c=new Hr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await zu(c),c}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];be(a.localId!==void 0,"internal-error");const c=a.providerUserInfo!==void 0?RN(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(c!=null&&c.length),f=new kl;f.updateFromIdToken(r);const m=new Hr({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new o0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(c!=null&&c.length)};return Object.assign(m,x),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw=new Map;function ps(n){zs(n instanceof Function,"Expected a class definition");let e=mw.get(n);return e?(zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,mw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}CN.type="NONE";const Fl=CN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(n,e,t){return`firebase:${n}:${e}:${t}`}class Dl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:c}=this.auth;this.fullUserKey=io(this.userKey,a.apiKey,c),this.fullPersistenceKey=io("persistence",a.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Dl(ps(Fl),e,r);const a=(await Promise.all(t.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let c=a[0]||ps(Fl);const d=io(r,e.config.apiKey,e.name);let f=null;for(const x of t)try{const y=await x._get(d);if(y){const v=Hr._fromJSON(e,y);x!==c&&(f=v),c=x;break}}catch{}const m=a.filter(x=>x._shouldAllowMigration);return!c._shouldAllowMigration||!m.length?new Dl(c,e,r):(c=m[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async x=>{if(x!==c)try{await x._remove(d)}catch{}})),new Dl(c,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ON(e))return"Blackberry";if(VN(e))return"Webos";if(DN(e))return"Safari";if((e.includes("chrome/")||MN(e))&&!e.includes("edge/"))return"Chrome";if(md(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function kN(n=jt()){return/firefox\//i.test(n)}function DN(n=jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function MN(n=jt()){return/crios\//i.test(n)}function PN(n=jt()){return/iemobile/i.test(n)}function md(n=jt()){return/android/i.test(n)}function ON(n=jt()){return/blackberry/i.test(n)}function VN(n=jt()){return/webos/i.test(n)}function pd(n=jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Yj(n=jt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function Wj(n=jt()){var e;return pd(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xj(){return lN()&&document.documentMode===10}function LN(n=jt()){return pd(n)||md(n)||VN(n)||ON(n)||/windows phone/i.test(n)||PN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(n,e=[]){let t;switch(n){case"Browser":t=pw(jt());break;case"Worker":t=`${pw(jt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${da}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=c=>new Promise((d,f)=>{try{const m=e(c);d(m)}catch(m){f(m)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zj(n,e={}){return Vt(n,"GET","/v2/passwordPolicy",Ot(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR=6;class tR{constructor(e){var t,r,a,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:eR,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,a,c,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(r=m.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(c=m.containsUppercaseLetter)!==null&&c!==void 0?c:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gw(this),this.idTokenSubscription=new gw(this),this.beforeStateQueue=new Jj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ps(t)),this._initializationPromise=this.queue(async()=>{var r,a;if(!this._deleted&&(this.persistenceManager=await Dl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await jN(this,{idToken:e}),r=await Hr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Dt(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,c=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dt(this.app))return Promise.reject(mn(this));const t=e?Oe(e):null;return t&&be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dt(this.app)?Promise.reject(mn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dt(this.app)?Promise.reject(mn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ps(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Zj(this),t=new tR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Qj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ps(e)||this._popupRedirectResolver;be(t,this,"argument-error"),this.redirectPersistenceManager=await Dl.create(this,[ps(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,r,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=UN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Rj(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Mt(n){return Oe(n)}class gw{constructor(e){this.auth=e,this.observer=null,this.addObserver=uN(t=>this.observer=t)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sR(n){gd=n}function Z0(n){return gd.loadJS(n)}function rR(){return gd.recaptchaV2Script}function iR(){return gd.recaptchaEnterpriseScript}function aR(){return gd.gapiScript}function FN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const oR="recaptcha-enterprise",lR="NO_RECAPTCHA";class cR{constructor(e){this.type=oR,this.auth=Mt(e)}async verify(e="verify",t=!1){async function r(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{Uj(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const x=new Vj(m);return c.tenantId==null?c._agentRecaptchaConfig=x:c._tenantRecaptchaConfigs[c.tenantId]=x,d(x.siteKey)}}).catch(m=>{f(m)})})}function a(c,d,f){const m=window.grecaptcha;hw(m)?m.enterprise.ready(()=>{m.enterprise.execute(c,{action:e}).then(x=>{d(x)}).catch(()=>{d(lR)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((c,d)=>{r(this.auth).then(f=>{if(!t&&hw(window.grecaptcha))a(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=iR();m.length!==0&&(m+=f),Z0(m).then(()=>{a(f,c,d)}).catch(x=>{d(x)})}}).catch(f=>{d(f)})})}}async function xw(n,e,t,r=!1){const a=new cR(n);let c;try{c=await a.verify(t)}catch{c=await a.verify(t,!0)}const d=Object.assign({},e);return r?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Hu(n,e,t,r){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await xw(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await xw(n,e,t,t==="getOobCode");return r(n,d)}else return Promise.reject(c)})}function uR(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ps);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function dR(n,e,t){const r=Mt(n);be(r._canInitEmulator,r,"emulator-config-failed"),be(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!(t!=null&&t.disableWarnings),c=qN(e),{host:d,port:f}=hR(e),m=f===null?"":`:${f}`;r.config.emulator={url:`${c}//${d}${m}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||fR()}function qN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function hR(n){const e=qN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const c=a[1];return{host:c,port:yw(r.substr(c.length+1))}}else{const[c,d]=r.split(":");return{host:c,port:yw(d)}}}function yw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function fR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ar("not implemented")}_getIdTokenResponse(e){return ar("not implemented")}_linkToIdToken(e,t){return ar("not implemented")}_getReauthenticationResolver(e){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(n,e){return Vt(n,"POST","/v1/accounts:resetPassword",Ot(n,e))}async function mR(n,e){return Vt(n,"POST","/v1/accounts:update",e)}async function pR(n,e){return Vt(n,"POST","/v1/accounts:signUp",e)}async function gR(n,e){return Vt(n,"POST","/v1/accounts:update",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(n,e){return Jr(n,"POST","/v1/accounts:signInWithPassword",Ot(n,e))}async function Zf(n,e){return Vt(n,"POST","/v1/accounts:sendOobCode",Ot(n,e))}async function yR(n,e){return Zf(n,e)}async function bR(n,e){return Zf(n,e)}async function vR(n,e){return Zf(n,e)}async function _R(n,e){return Zf(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wR(n,e){return Jr(n,"POST","/v1/accounts:signInWithEmailLink",Ot(n,e))}async function NR(n,e){return Jr(n,"POST","/v1/accounts:signInWithEmailLink",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends rc{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Gu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Gu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hu(e,t,"signInWithPassword",xR);case"emailLink":return wR(e,{email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hu(e,r,"signUpPassword",pR);case"emailLink":return NR(e,{idToken:t,email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(n,e){return Jr(n,"POST","/v1/accounts:signInWithIdp",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR="http://localhost";class hr extends rc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=t,c=Q0(t,["providerId","signInMethod"]);if(!r||!a)return null;const d=new hr(r,a);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return $r(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,$r(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$r(e,t)}buildRequest(){const e={requestUri:TR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(n,e){return Vt(n,"POST","/v1/accounts:sendVerificationCode",Ot(n,e))}async function SR(n,e){return Jr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ot(n,e))}async function AR(n,e){const t=await Jr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ot(n,e));if(t.temporaryProof)throw Nu(n,"account-exists-with-different-credential",t);return t}const IR={USER_NOT_FOUND:"user-not-found"};async function jR(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Jr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ot(n,t),IR)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao extends rc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ao({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ao({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return SR(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return AR(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return jR(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:c}=e;return!r&&!t&&!a&&!c?null:new ao({verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function CR(n){const e=Cl(wu(n)).link,t=e?Cl(wu(e)).deep_link_id:null,r=Cl(wu(n)).deep_link_id;return(r?Cl(wu(r)).link:null)||r||t||e||n}class em{constructor(e){var t,r,a,c,d,f;const m=Cl(wu(e)),x=(t=m.apiKey)!==null&&t!==void 0?t:null,y=(r=m.oobCode)!==null&&r!==void 0?r:null,v=RR((a=m.mode)!==null&&a!==void 0?a:null);be(x&&y&&v,"argument-error"),this.apiKey=x,this.operation=v,this.code=y,this.continueUrl=(c=m.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=m.languageCode)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=CR(e);try{return new em(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(){this.providerId=ha.PROVIDER_ID}static credential(e,t){return Gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=em.parseLink(t);return be(r,"argument-error"),Gu._fromEmailAndCode(e,r.code,r.tenantId)}}ha.PROVIDER_ID="password";ha.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ha.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends Zr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ml extends ic{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return be("providerId"in t&&"signInMethod"in t,"argument-error"),hr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return be(e.idToken||e.accessToken,"argument-error"),hr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ml.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ml.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:a,pendingToken:c,nonce:d,providerId:f}=e;if(!r&&!a&&!t&&!c||!f)return null;try{return new Ml(f)._credential({idToken:t,accessToken:r,nonce:d,pendingToken:c})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends ic{constructor(){super("facebook.com")}static credential(e){return hr._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nr.credential(e.oauthAccessToken)}catch{return null}}}nr.FACEBOOK_SIGN_IN_METHOD="facebook.com";nr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr extends ic{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hr._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return sr.credential(t,r)}catch{return null}}}sr.GOOGLE_SIGN_IN_METHOD="google.com";sr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends ic{constructor(){super("github.com")}static credential(e){return hr._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rr.credential(e.oauthAccessToken)}catch{return null}}}rr.GITHUB_SIGN_IN_METHOD="github.com";rr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="http://localhost";class ql extends rc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return $r(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,$r(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$r(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,pendingToken:c}=t;return!r||!a||!c||r!==a?null:new ql(r,c)}static _create(e,t){return new ql(e,t)}buildRequest(){return{requestUri:kR,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR="saml.";class Cf extends Zr{constructor(e){be(e.startsWith(DR),"argument-error"),super(e)}static credentialFromResult(e){return Cf.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Cf.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=ql.fromJSON(e);return be(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return ql._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends ic{constructor(){super("twitter.com")}static credential(e,t){return hr._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ir.credential(t,r)}catch{return null}}}ir.TWITTER_SIGN_IN_METHOD="twitter.com";ir.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(n,e){return Jr(n,"POST","/v1/accounts:signUp",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const c=await Hr._fromIdTokenResponse(e,r,a),d=bw(r);return new Cs({user:c,providerId:d,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=bw(r);return new Cs({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function bw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MR(n){var e;if(Dt(n.app))return Promise.reject(mn(n));const t=Mt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Cs({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await zN(t,{returnSecureToken:!0}),a=await Cs._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf extends Ln{constructor(e,t,r,a){var c;super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,kf.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new kf(e,t,r,a)}}function HN(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?kf._fromErrorAndOperation(n,c,e,r):c})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PR(n,e){const t=Oe(n);await tm(!0,t,e);const{providerUserInfo:r}=await qj(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=GN(r||[]);return t.providerData=t.providerData.filter(c=>a.has(c.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function ex(n,e,t=!1){const r=await Yr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Cs._forOperation(n,"link",r)}async function tm(n,e,t){await zu(e);const r=GN(e.providerData),a=n===!1?"provider-already-linked":"no-such-provider";be(r.has(t)===n,e.auth,a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(n,e,t=!1){const{auth:r}=n;if(Dt(r.app))return Promise.reject(mn(r));const a="reauthenticate";try{const c=await Yr(n,HN(r,a,e,n),t);be(c.idToken,r,"internal-error");const d=Jf(c.idToken);be(d,r,"internal-error");const{sub:f}=d;return be(n.uid===f,r,"user-mismatch"),Cs._forOperation(n,a,c)}catch(c){throw(c==null?void 0:c.code)==="auth/user-not-found"&&Tn(r,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(n,e,t=!1){if(Dt(n.app))return Promise.reject(mn(n));const r="signIn",a=await HN(n,r,e),c=await Cs._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(c.user),c}async function nm(n,e){return $N(Mt(n),e)}async function QN(n,e){const t=Oe(n);return await tm(!1,t,e.providerId),ex(t,e)}async function YN(n,e){return KN(Oe(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OR(n,e){return Jr(n,"POST","/v1/accounts:signInWithCustomToken",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VR(n,e){if(Dt(n.app))return Promise.reject(mn(n));const t=Mt(n),r=await OR(t,{token:e,returnSecureToken:!0}),a=await Cs._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?tx._fromServerResponse(e,t):"totpInfo"in t?nx._fromServerResponse(e,t):Tn(e,"internal-error")}}class tx extends xd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new tx(t)}}class nx extends xd{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new nx(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(n,e,t){var r;be(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),be(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(be(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(be(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sx(n){const e=Mt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function LR(n,e,t){const r=Mt(n),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&sm(r,a,t),await Hu(r,a,"getOobCode",bR)}async function UR(n,e,t){await BN(Oe(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&sx(n),r})}async function FR(n,e){await gR(Oe(n),{oobCode:e})}async function WN(n,e){const t=Oe(n),r=await BN(t,{oobCode:e}),a=r.requestType;switch(be(a,t,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":be(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":be(r.mfaInfo,t,"internal-error");default:be(r.email,t,"internal-error")}let c=null;return r.mfaInfo&&(c=xd._fromServerResponse(Mt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:c},operation:a}}async function qR(n,e){const{data:t}=await WN(Oe(n),e);return t.email}async function BR(n,e,t){if(Dt(n.app))return Promise.reject(mn(n));const r=Mt(n),d=await Hu(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zN).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&sx(n),m}),f=await Cs._fromIdTokenResponse(r,"signIn",d);return await r._updateCurrentUser(f.user),f}function zR(n,e,t){return Dt(n.app)?Promise.reject(mn(n)):nm(Oe(n),ha.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&sx(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(n,e,t){const r=Mt(n),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function c(d,f){be(f.handleCodeInApp,r,"argument-error"),f&&sm(r,d,f)}c(a,t),await Hu(r,a,"getOobCode",vR)}function GR(n,e){const t=em.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function KR(n,e,t){if(Dt(n.app))return Promise.reject(mn(n));const r=Oe(n),a=ha.credentialWithLink(e,t||Bu());return be(a._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),nm(r,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $R(n,e){return Vt(n,"POST","/v1/accounts:createAuthUri",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR(n,e){const t=X0()?Bu():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:a}=await $R(Oe(n),r);return a||[]}async function YR(n,e){const t=Oe(n),a={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&sm(t.auth,a,e);const{email:c}=await yR(t.auth,a);c!==n.email&&await n.reload()}async function WR(n,e,t){const r=Oe(n),c={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&sm(r.auth,c,t);const{email:d}=await _R(r.auth,c);d!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR(n,e){return Vt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Oe(n),c={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await Yr(r,XR(r.auth,c));r.displayName=d.displayName||null,r.photoURL=d.photoUrl||null;const f=r.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=r.displayName,f.photoURL=r.photoURL),await r._updateTokensIfNecessary(d)}function ZR(n,e){const t=Oe(n);return Dt(t.auth.app)?Promise.reject(mn(t.auth)):XN(t,e,null)}function eC(n,e){return XN(Oe(n),null,e)}async function XN(n,e,t){const{auth:r}=n,c={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(c.email=e),t&&(c.password=t);const d=await Yr(n,mR(r,c));await n._updateTokensIfNecessary(d,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(n){var e,t;if(!n)return null;const{providerId:r}=n,a=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},c=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const d=(t=(e=Jf(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(d){const f=d!=="anonymous"&&d!=="custom"?d:null;return new Pl(c,f)}}if(!r)return null;switch(r){case"facebook.com":return new nC(c,a);case"github.com":return new sC(c,a);case"google.com":return new rC(c,a);case"twitter.com":return new iC(c,a,n.screenName||null);case"custom":case"anonymous":return new Pl(c,null);default:return new Pl(c,r,a)}}class Pl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class JN extends Pl{constructor(e,t,r,a){super(e,t,r),this.username=a}}class nC extends Pl{constructor(e,t){super(e,"facebook.com",t)}}class sC extends JN{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class rC extends Pl{constructor(e,t){super(e,"google.com",t)}}class iC extends JN{constructor(e,t,r){super(e,"twitter.com",t,r)}}function aC(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:tC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new no("enroll",e,t)}static _fromMfaPendingCredential(e){return new no("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return no._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return no._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Mt(e),a=t.customData._serverResponse,c=(a.mfaInfo||[]).map(f=>xd._fromServerResponse(r,f));be(a.mfaPendingCredential,r,"internal-error");const d=no._fromMfaPendingCredential(a.mfaPendingCredential);return new rx(d,c,async f=>{const m=await f._process(r,d);delete a.mfaInfo,delete a.mfaPendingCredential;const x=Object.assign(Object.assign({},a),{idToken:m.idToken,refreshToken:m.refreshToken});switch(t.operationType){case"signIn":const y=await Cs._fromIdTokenResponse(r,t.operationType,x);return await r._updateCurrentUser(y.user),y;case"reauthenticate":return be(t.user,r,"internal-error"),Cs._forOperation(t.user,t.operationType,x);default:Tn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function oC(n,e){var t;const r=Oe(n),a=e;return be(e.customData.operationType,r,"argument-error"),be((t=a.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),rx._fromError(r,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(n,e){return Vt(n,"POST","/v2/accounts/mfaEnrollment:start",Ot(n,e))}function cC(n,e){return Vt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ot(n,e))}function uC(n,e){return Vt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ot(n,e))}class ix{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>xd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new ix(e)}async getSession(){return no._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,a=await this.getSession(),c=await Yr(this.user,r._process(this.user.auth,a,t));return await this.user._updateTokensIfNecessary(c),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const a=await Yr(this.user,uC(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:c})=>c!==t),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const $g=new WeakMap;function dC(n){const e=Oe(n);return $g.has(e)||$g.set(e,ix._fromUser(e)),$g.get(e)}const Df="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Df,"1"),this.storage.removeItem(Df),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=1e3,fC=10;class eT extends ZN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(r);!t&&this.localCache[r]===d||this.notifyListeners(r,d)},c=this.storage.getItem(r);Xj()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,fC):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},hC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}eT.type="LOCAL";const ax=eT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT extends ZN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}tT.type="SESSION";const lo=tT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new rm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:c}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const f=Array.from(d).map(async x=>x(t.origin,c)),m=await mC(f);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let c,d;return new Promise((f,m)=>{const x=yd("",20);a.port1.start();const y=setTimeout(()=>{m(new Error("unsupported_event"))},r);d={messageChannel:a,onMessage(v){const E=v;if(E.data.eventId===x)switch(E.data.status){case"ack":clearTimeout(y),c=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(E.data.response);break;default:clearTimeout(y),clearTimeout(c),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:x,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(){return window}function gC(n){Zt().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(){return typeof Zt().WorkerGlobalScope<"u"&&typeof Zt().importScripts=="function"}async function xC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yC(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function bC(){return ox()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="firebaseLocalStorageDb",vC=1,Mf="firebaseLocalStorage",sT="fbase_key";class bd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function im(n,e){return n.transaction([Mf],e?"readwrite":"readonly").objectStore(Mf)}function _C(){const n=indexedDB.deleteDatabase(nT);return new bd(n).toPromise()}function l0(){const n=indexedDB.open(nT,vC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Mf,{keyPath:sT})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Mf)?e(r):(r.close(),await _C(),e(await l0()))})})}async function vw(n,e,t){const r=im(n,!0).put({[sT]:e,value:t});return new bd(r).toPromise()}async function wC(n,e){const t=im(n,!1).get(e),r=await new bd(t).toPromise();return r===void 0?null:r.value}function _w(n,e){const t=im(n,!0).delete(e);return new bd(t).toPromise()}const NC=800,TC=3;class rT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await l0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>TC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ox()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rm._getInstance(bC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await xC(),!this.activeServiceWorker)return;this.sender=new pC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await l0();return await vw(e,Df,"1"),await _w(e,Df),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>vw(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>wC(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_w(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const c=im(a,!1).getAll();return new bd(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:c}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(c)&&(this.notifyListeners(a,c),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),NC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rT.type="LOCAL";const Ku=rT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(n,e){return Vt(n,"POST","/v2/accounts/mfaSignIn:start",Ot(n,e))}function SC(n,e){return Vt(n,"POST","/v2/accounts/mfaSignIn:finalize",Ot(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=500,IC=6e4,sf=1e12;class jC{constructor(e){this.auth=e,this.counter=sf,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new RC(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||sf;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||sf;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||sf;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class RC{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;be(a,"argument-error",{appName:t}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=CC(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},IC)},AC))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function CC(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=FN("rcb"),kC=new fd(3e4,6e4);class DC{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Zt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return be(MC(t),e,"argument-error"),this.shouldResolveImmediately(t)&&dw(Zt().grecaptcha)?Promise.resolve(Zt().grecaptcha):new Promise((r,a)=>{const c=Zt().setTimeout(()=>{a(rn(e,"network-request-failed"))},kC.get());Zt()[Qg]=()=>{Zt().clearTimeout(c),delete Zt()[Qg];const f=Zt().grecaptcha;if(!f||!dw(f)){a(rn(e,"internal-error"));return}const m=f.render;f.render=(x,y)=>{const v=m(x,y);return this.counter++,v},this.hostLanguage=t,r(f)};const d=`${rR()}?${nc({onload:Qg,render:"explicit",hl:t})}`;Z0(d).catch(()=>{clearTimeout(c),a(rn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Zt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function MC(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class PC{async load(e){return new jC(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="recaptcha",OC={theme:"light",type:"image"};let VC=class{constructor(e,t,r=Object.assign({},OC)){this.parameters=r,this.type=iT,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Mt(e),this.isInvisible=this.parameters.size==="invisible",be(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof t=="string"?document.getElementById(t):t;be(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new PC:new DC,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(a=>{const c=d=>{d&&(this.tokenChangeListeners.delete(c),a(d))};this.tokenChangeListeners.add(c),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){be(!this.parameters.sitekey,this.auth,"argument-error"),be(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),be(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Zt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){be(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){be(X0()&&!ox(),this.auth,"internal-error"),await LC(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Lj(this.auth);be(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return be(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function LC(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ao._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function UC(n,e,t){if(Dt(n.app))return Promise.reject(mn(n));const r=Mt(n),a=await am(r,e,Oe(t));return new lx(a,c=>nm(r,c))}async function FC(n,e,t){const r=Oe(n);await tm(!1,r,"phone");const a=await am(r.auth,e,Oe(t));return new lx(a,c=>QN(r,c))}async function qC(n,e,t){const r=Oe(n);if(Dt(r.auth.app))return Promise.reject(mn(r.auth));const a=await am(r.auth,e,Oe(t));return new lx(a,c=>YN(r,c))}async function am(n,e,t){var r;const a=await t.verify();try{be(typeof a=="string",n,"argument-error"),be(t.type===iT,n,"argument-error");let c;if(typeof e=="string"?c={phoneNumber:e}:c=e,"session"in c){const d=c.session;if("phoneNumber"in c)return be(d.type==="enroll",n,"internal-error"),(await lC(n,{idToken:d.credential,phoneEnrollmentInfo:{phoneNumber:c.phoneNumber,recaptchaToken:a}})).phoneSessionInfo.sessionInfo;{be(d.type==="signin",n,"internal-error");const f=((r=c.multiFactorHint)===null||r===void 0?void 0:r.uid)||c.multiFactorUid;return be(f,n,"missing-multi-factor-info"),(await EC(n,{mfaPendingCredential:d.credential,mfaEnrollmentId:f,phoneSignInInfo:{recaptchaToken:a}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:d}=await ER(n,{phoneNumber:c.phoneNumber,recaptchaToken:a});return d}}finally{t._reset()}}async function BC(n,e){const t=Oe(n);if(Dt(t.auth.app))return Promise.reject(mn(t.auth));await ex(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let co=class gf{constructor(e){this.providerId=gf.PROVIDER_ID,this.auth=Mt(e)}verifyPhoneNumber(e,t){return am(this.auth,e,Oe(t))}static credential(e,t){return ao._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gf.credentialFromTaggedObject(t)}static credentialFromError(e){return gf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?ao._fromTokenResponse(t,r):null}};co.PROVIDER_ID="phone";co.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(n,e){return e?ps(e):(be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx extends rc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $r(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $r(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $r(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zC(n){return $N(n.auth,new cx(n),n.bypassAuthState)}function HC(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),KN(t,new cx(n),n.bypassAuthState)}async function GC(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),ex(t,new cx(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,t,r,a,c=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:r,tenantId:c||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(x){this.reject(x)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zC;case"linkViaPopup":case"linkViaRedirect":return GC;case"reauthViaPopup":case"reauthViaRedirect":return HC;default:Tn(this.auth,"internal-error")}}resolve(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=new fd(2e3,1e4);async function $C(n,e,t){if(Dt(n.app))return Promise.reject(rn(n,"operation-not-supported-in-this-environment"));const r=Mt(n);sc(n,e,Zr);const a=No(r,t);return new Gr(r,"signInViaPopup",e,a).executeNotNull()}async function QC(n,e,t){const r=Oe(n);if(Dt(r.auth.app))return Promise.reject(rn(r.auth,"operation-not-supported-in-this-environment"));sc(r.auth,e,Zr);const a=No(r.auth,t);return new Gr(r.auth,"reauthViaPopup",e,a,r).executeNotNull()}async function YC(n,e,t){const r=Oe(n);sc(r.auth,e,Zr);const a=No(r.auth,t);return new Gr(r.auth,"linkViaPopup",e,a,r).executeNotNull()}class Gr extends aT{constructor(e,t,r,a,c){super(e,t,a,c),this.provider=r,this.authWindow=null,this.pollId=null,Gr.currentPopupAction&&Gr.currentPopupAction.cancel(),Gr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){zs(this.filter.length===1,"Popup operations only handle one event");const e=yd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(rn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(rn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,KC.get())};e()}}Gr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="pendingRedirect",Ru=new Map;class XC extends aT{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ru.get(this.auth._key());if(!e){try{const r=await JC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ru.set(this.auth._key(),e)}return this.bypassAuthState||Ru.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JC(n,e){const t=lT(e),r=oT(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}async function ux(n,e){return oT(n)._set(lT(e),"true")}function ZC(){Ru.clear()}function dx(n,e){Ru.set(n._key(),e)}function oT(n){return ps(n._redirectPersistence)}function lT(n){return io(WC,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(n,e,t){return tk(n,e,t)}async function tk(n,e,t){if(Dt(n.app))return Promise.reject(mn(n));const r=Mt(n);sc(n,e,Zr),await r._initializationPromise;const a=No(r,t);return await ux(a,r),a._openRedirect(r,e,"signInViaRedirect")}function nk(n,e,t){return sk(n,e,t)}async function sk(n,e,t){const r=Oe(n);if(sc(r.auth,e,Zr),Dt(r.auth.app))return Promise.reject(mn(r.auth));await r.auth._initializationPromise;const a=No(r.auth,t);await ux(a,r.auth);const c=await cT(r);return a._openRedirect(r.auth,e,"reauthViaRedirect",c)}function rk(n,e,t){return ik(n,e,t)}async function ik(n,e,t){const r=Oe(n);sc(r.auth,e,Zr),await r.auth._initializationPromise;const a=No(r.auth,t);await tm(!1,r,e.providerId),await ux(a,r.auth);const c=await cT(r);return a._openRedirect(r.auth,e,"linkViaRedirect",c)}async function ak(n,e){return await Mt(n)._initializationPromise,om(n,e,!1)}async function om(n,e,t=!1){if(Dt(n.app))return Promise.reject(mn(n));const r=Mt(n),a=No(r,e),d=await new XC(r,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await r._persistUserIfCurrent(d.user),await r._setRedirectUser(null,e)),d}async function cT(n){const e=yd(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok=600*1e3;class uT{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!dT(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(rn(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ok&&this.cachedEventUids.clear(),this.cachedEventUids.has(ww(e))}saveEventToCache(e){this.cachedEventUids.add(ww(e)),this.lastProcessedEventTime=Date.now()}}function ww(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function lk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hT(n,e={}){return Vt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uk=/^https?/;async function dk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await hT(n);for(const t of e)try{if(hk(t))return}catch{}Tn(n,"unauthorized-domain")}function hk(n){const e=Bu(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===r}if(!uk.test(t))return!1;if(ck.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk=new fd(3e4,6e4);function Nw(){const n=Zt().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function mk(n){return new Promise((e,t)=>{var r,a,c;function d(){Nw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nw(),t(rn(n,"network-request-failed"))},timeout:fk.get()})}if(!((a=(r=Zt().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((c=Zt().gapi)===null||c===void 0)&&c.load)d();else{const f=FN("iframefcb");return Zt()[f]=()=>{gapi.load?d():t(rn(n,"network-request-failed"))},Z0(`${aR()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw xf=null,e})}let xf=null;function pk(n){return xf=xf||mk(n),xf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=new fd(5e3,15e3),xk="__/auth/iframe",yk="emulator/auth/iframe",bk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _k(n){const e=n.config;be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?J0(e,yk):`https://${n.config.authDomain}/${xk}`,r={apiKey:e.apiKey,appName:n.name,v:da},a=vk.get(n.config.apiHost);a&&(r.eid=a);const c=n._getFrameworks();return c.length&&(r.fw=c.join(",")),`${t}?${nc(r).slice(1)}`}async function wk(n){const e=await pk(n),t=Zt().gapi;return be(t,n,"internal-error"),e.open({where:document.body,url:_k(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bk,dontclear:!0},r=>new Promise(async(a,c)=>{await r.restyle({setHideOnLeave:!1});const d=rn(n,"network-request-failed"),f=Zt().setTimeout(()=>{c(d)},gk.get());function m(){Zt().clearTimeout(f),a(r)}r.ping(m).then(m,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Tk=500,Ek=600,Sk="_blank",Ak="http://localhost";class Tw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ik(n,e,t,r=Tk,a=Ek){const c=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const m=Object.assign(Object.assign({},Nk),{width:r.toString(),height:a.toString(),top:c,left:d}),x=jt().toLowerCase();t&&(f=MN(x)?Sk:t),kN(x)&&(e=e||Ak,m.scrollbars="yes");const y=Object.entries(m).reduce((E,[A,V])=>`${E}${A}=${V},`,"");if(Wj(x)&&f!=="_self")return jk(e||"",f),new Tw(null);const v=window.open(e||"",f,y);be(v,n,"popup-blocked");try{v.focus()}catch{}return new Tw(v)}function jk(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="__/auth/handler",Ck="emulator/auth/handler",kk=encodeURIComponent("fac");async function c0(n,e,t,r,a,c){be(n.config.authDomain,n,"auth-domain-config-required"),be(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:da,eventId:a};if(e instanceof Zr){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",sI(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries(c||{}))d[y]=v}if(e instanceof ic){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(d.scopes=y.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const m=await n._getAppCheckToken(),x=m?`#${kk}=${encodeURIComponent(m)}`:"";return`${Dk(n)}?${nc(f).slice(1)}${x}`}function Dk({config:n}){return n.emulator?J0(n,Ck):`https://${n.authDomain}/${Rk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="webStorageSupport";class Mk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lo,this._completeRedirectFn=om,this._overrideRedirectResult=dx}async _openPopup(e,t,r,a){var c;zs((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await c0(e,t,r,Bu(),a);return Ik(e,d,yd())}async _openRedirect(e,t,r,a){await this._originValidation(e);const c=await c0(e,t,r,Bu(),a);return gC(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:c}=this.eventManagers[t];return a?Promise.resolve(a):(zs(c,"If manager is not set, promise should be"),c)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await wk(e),r=new uT(e);return t.register("authEvent",a=>(be(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yg,{type:Yg},a=>{var c;const d=(c=a==null?void 0:a[0])===null||c===void 0?void 0:c[Yg];d!==void 0&&t(!!d),Tn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LN()||DN()||pd()}}const Pk=Mk;class Ok{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ar("unexpected MultiFactorSessionType")}}}class hx extends Ok{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new hx(e)}_finalizeEnroll(e,t,r){return cC(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return SC(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class fT{constructor(){}static assertion(e){return hx._fromCredential(e)}}fT.FACTOR_ID="phone";var Ew="@firebase/auth",Sw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Uk(n){na(new dr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=r.options;be(d&&!d.includes(":"),"invalid-api-key",{appName:r.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:UN(n)},x=new nR(r,a,c,m);return uR(x,t),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),na(new dr("auth-internal",e=>{const t=Mt(e.getProvider("auth").getImmediate());return(r=>new Vk(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bs(Ew,Sw,Lk(n)),Bs(Ew,Sw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=300;$A("authIdTokenMaxAge");function qk(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}sR({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const c=rn("internal-error");c.customData=a,t(c)},r.type="text/javascript",r.charset="UTF-8",qk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Uk("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=2e3;async function zk(n,e,t){var r;const{BuildInfo:a}=uo();zs(e.sessionId,"AuthEvent did not contain a session ID");const c=await Qk(e.sessionId),d={};return pd()?d.ibi=a.packageName:md()?d.apn=a.packageName:Tn(n,"operation-not-supported-in-this-environment"),a.displayName&&(d.appDisplayName=a.displayName),d.sessionId=c,c0(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,d)}async function Hk(n){const{BuildInfo:e}=uo(),t={};pd()?t.iosBundleId=e.packageName:md()?t.androidPackageName=e.packageName:Tn(n,"operation-not-supported-in-this-environment"),await hT(n,t)}function Gk(n){const{cordova:e}=uo();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let a=null;r?e.plugins.browsertab.openUrl(n):a=e.InAppBrowser.open(n,Yj()?"_blank":"_system","location=yes"),t(a)})})}async function Kk(n,e,t){const{cordova:r}=uo();let a=()=>{};try{await new Promise((c,d)=>{let f=null;function m(){var v;c();const E=(v=r.plugins.browsertab)===null||v===void 0?void 0:v.close;typeof E=="function"&&E(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function x(){f||(f=window.setTimeout(()=>{d(rn(n,"redirect-cancelled-by-user"))},Bk))}function y(){(document==null?void 0:document.visibilityState)==="visible"&&x()}e.addPassiveListener(m),document.addEventListener("resume",x,!1),md()&&document.addEventListener("visibilitychange",y,!1),a=()=>{e.removePassiveListener(m),document.removeEventListener("resume",x,!1),document.removeEventListener("visibilitychange",y,!1),f&&window.clearTimeout(f)}})}finally{a()}}function $k(n){var e,t,r,a,c,d,f,m,x,y;const v=uo();be(typeof((e=v==null?void 0:v.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),be(typeof((t=v==null?void 0:v.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),be(typeof((c=(a=(r=v==null?void 0:v.cordova)===null||r===void 0?void 0:r.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),be(typeof((m=(f=(d=v==null?void 0:v.cordova)===null||d===void 0?void 0:d.plugins)===null||f===void 0?void 0:f.browsertab)===null||m===void 0?void 0:m.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),be(typeof((y=(x=v==null?void 0:v.cordova)===null||x===void 0?void 0:x.InAppBrowser)===null||y===void 0?void 0:y.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Qk(n){const e=Yk(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function Yk(n){if(zs(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=20;class Xk extends uT{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Jk(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:t5(),postBody:null,tenantId:n.tenantId,error:rn(n,"no-auth-event")}}function Zk(n,e){return u0()._set(d0(n),e)}async function Aw(n){const e=await u0()._get(d0(n));return e&&await u0()._remove(d0(n)),e}function e5(n,e){var t,r;const a=s5(e);if(a.includes("/__/auth/callback")){const c=yf(a),d=c.firebaseError?n5(decodeURIComponent(c.firebaseError)):null,f=(r=(t=d==null?void 0:d.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],m=f?rn(f):null;return m?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:m,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:a,postBody:null}}return null}function t5(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Wk;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function u0(){return ps(ax)}function d0(n){return io("authEvent",n.config.apiKey,n.name)}function n5(n){try{return JSON.parse(n)}catch{return null}}function s5(n){const e=yf(n),t=e.link?decodeURIComponent(e.link):void 0,r=yf(t).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return yf(a).link||a||r||t||n}function yf(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Cl(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5=500;class i5{constructor(){this._redirectPersistence=lo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=om,this._overrideRedirectResult=dx}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new Xk(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Tn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,a){$k(e);const c=await this._initialize(e);await c.initialized(),c.resetRedirect(),ZC(),await this._originValidation(e);const d=Jk(e,r,a);await Zk(e,d);const f=await zk(e,d,t),m=await Gk(f);return Kk(e,c,m)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Hk(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:a,BuildInfo:c}=uo(),d=setTimeout(async()=>{await Aw(e),t.onEvent(Iw())},r5),f=async y=>{clearTimeout(d);const v=await Aw(e);let E=null;v&&(y!=null&&y.url)&&(E=e5(v,y.url)),t.onEvent(E||Iw())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,f);const m=a,x=`${c.packageName.toLowerCase()}://`;uo().handleOpenURL=async y=>{if(y.toLowerCase().startsWith(x)&&f({url:y}),typeof m=="function")try{m(y)}catch(v){console.error(v)}}}}const a5=i5;function Iw(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:rn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(n,e){Mt(n)._logFramework(e)}var l5="@firebase/auth-compat",c5="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=1e3;function Cu(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function d5(){return Cu()==="http:"||Cu()==="https:"}function mT(n=jt()){return!!((Cu()==="file:"||Cu()==="ionic:"||Cu()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function h5(){return z0()||B0()}function f5(){return lN()&&(document==null?void 0:document.documentMode)===11}function m5(n=jt()){return/Edge\/\d+/.test(n)}function p5(n=jt()){return f5()||m5(n)}function pT(){try{const n=self.localStorage,e=yd();if(n)return n.setItem(e,"1"),n.removeItem(e),p5()?Lu():!0}catch{return fx()&&Lu()}return!1}function fx(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Wg(){return(d5()||oN()||mT())&&!h5()&&pT()&&!fx()}function gT(){return mT()&&typeof document<"u"}async function g5(){return gT()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},u5);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function x5(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs={LOCAL:"local",NONE:"none",SESSION:"session"},mu=be,xT="persistence";function y5(n,e){if(mu(Object.values(fs).includes(e),n,"invalid-persistence-type"),z0()){mu(e!==fs.SESSION,n,"unsupported-persistence-type");return}if(B0()){mu(e===fs.NONE,n,"unsupported-persistence-type");return}if(fx()){mu(e===fs.NONE||e===fs.LOCAL&&Lu(),n,"unsupported-persistence-type");return}mu(e===fs.NONE||pT(),n,"unsupported-persistence-type")}async function h0(n){await n._initializationPromise;const e=yT(),t=io(xT,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function b5(n,e){const t=yT();if(!t)return[];const r=io(xT,n,e);switch(t.getItem(r)){case fs.NONE:return[Fl];case fs.LOCAL:return[Ku,lo];case fs.SESSION:return[lo];default:return[]}}function yT(){var n;try{return((n=x5())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=be;class Wi{constructor(){this.browserResolver=ps(Pk),this.cordovaResolver=ps(a5),this.underlyingResolver=null,this._redirectPersistence=lo,this._completeRedirectFn=om,this._overrideRedirectResult=dx}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,a)}async _openRedirect(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,a)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return gT()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return v5(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await g5();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(n){return n.unwrap()}function _5(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(n){return vT(n)}function N5(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const a=e;a.resolver=new T5(n,oC(n,e))}else if(r){const a=vT(e),c=e;a&&(c.credential=a,c.tenantId=r.tenantId||void 0,c.email=r.email||void 0,c.phoneNumber=r.phoneNumber||void 0)}}function vT(n){const{_tokenResponse:e}=n instanceof Ln?n.customData:n;if(!e)return null;if(!(n instanceof Ln)&&"temporaryProof"in e&&"phoneNumber"in e)return co.credentialFromResult(n);const t=e.providerId;if(!t||t===fu.PASSWORD)return null;let r;switch(t){case fu.GOOGLE:r=sr;break;case fu.FACEBOOK:r=nr;break;case fu.GITHUB:r=rr;break;case fu.TWITTER:r=ir;break;default:const{oauthIdToken:a,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:f,nonce:m}=e;return!c&&!d&&!a&&!f?null:f?t.startsWith("saml.")?ql._create(t,f):hr._fromParams({providerId:t,signInMethod:t,pendingToken:f,idToken:a,accessToken:c}):new Ml(t).credential({idToken:a,accessToken:c,rawNonce:m})}return n instanceof Ln?r.credentialFromError(n):r.credentialFromResult(n)}function Xn(n,e){return e.catch(t=>{throw t instanceof Ln&&N5(n,t),t}).then(t=>{const r=t.operationType,a=t.user;return{operationType:r,credential:w5(t),additionalUserInfo:aC(t),user:lm.getOrCreate(a)}})}async function f0(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Xn(n,t.confirm(r))}}class T5{constructor(e,t){this.resolver=t,this.auth=_5(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Xn(bT(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lm=class Tu{constructor(e){this._delegate=e,this.multiFactor=dC(e)}static getOrCreate(e){return Tu.USER_MAP.has(e)||Tu.USER_MAP.set(e,new Tu(e)),Tu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Xn(this.auth,QN(this._delegate,e))}async linkWithPhoneNumber(e,t){return f0(this.auth,FC(this._delegate,e,t))}async linkWithPopup(e){return Xn(this.auth,YC(this._delegate,e,Wi))}async linkWithRedirect(e){return await h0(Mt(this.auth)),rk(this._delegate,e,Wi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Xn(this.auth,YN(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return f0(this.auth,qC(this._delegate,e,t))}reauthenticateWithPopup(e){return Xn(this.auth,QC(this._delegate,e,Wi))}async reauthenticateWithRedirect(e){return await h0(Mt(this.auth)),nk(this._delegate,e,Wi)}sendEmailVerification(e){return YR(this._delegate,e)}async unlink(e){return await PR(this._delegate,e),this}updateEmail(e){return ZR(this._delegate,e)}updatePassword(e){return eC(this._delegate,e)}updatePhoneNumber(e){return BC(this._delegate,e)}updateProfile(e){return JR(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return WR(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};lm.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=be;class m0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;pu(r,"invalid-api-key",{appName:e.name}),pu(r,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?Wi:void 0;this._delegate=t.initialize({options:{persistence:E5(r,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Ij),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?lm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){dR(this._delegate,e,t)}applyActionCode(e){return FR(this._delegate,e)}checkActionCode(e){return WN(this._delegate,e)}confirmPasswordReset(e,t){return UR(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Xn(this._delegate,BR(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return QR(this._delegate,e)}isSignInWithEmailLink(e){return GR(this._delegate,e)}async getRedirectResult(){pu(Wg(),this._delegate,"operation-not-supported-in-this-environment");const e=await ak(this._delegate,Wi);return e?Xn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){o5(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:a,error:c,complete:d}=jw(e,t,r);return this._delegate.onAuthStateChanged(a,c,d)}onIdTokenChanged(e,t,r){const{next:a,error:c,complete:d}=jw(e,t,r);return this._delegate.onIdTokenChanged(a,c,d)}sendSignInLinkToEmail(e,t){return HR(this._delegate,e,t)}sendPasswordResetEmail(e,t){return LR(this._delegate,e,t||void 0)}async setPersistence(e){y5(this._delegate,e);let t;switch(e){case fs.SESSION:t=lo;break;case fs.LOCAL:t=await ps(Ku)._isAvailable()?Ku:ax;break;case fs.NONE:t=Fl;break;default:return Tn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Xn(this._delegate,MR(this._delegate))}signInWithCredential(e){return Xn(this._delegate,nm(this._delegate,e))}signInWithCustomToken(e){return Xn(this._delegate,VR(this._delegate,e))}signInWithEmailAndPassword(e,t){return Xn(this._delegate,zR(this._delegate,e,t))}signInWithEmailLink(e,t){return Xn(this._delegate,KR(this._delegate,e,t))}signInWithPhoneNumber(e,t){return f0(this._delegate,UC(this._delegate,e,t))}async signInWithPopup(e){return pu(Wg(),this._delegate,"operation-not-supported-in-this-environment"),Xn(this._delegate,$C(this._delegate,e,Wi))}async signInWithRedirect(e){return pu(Wg(),this._delegate,"operation-not-supported-in-this-environment"),await h0(this._delegate),ek(this._delegate,e,Wi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return qR(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}m0.Persistence=fs;function jw(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const a=r;return{next:d=>a(d&&lm.getOrCreate(d)),error:e,complete:t}}function E5(n,e){const t=b5(n,e);if(typeof self<"u"&&!t.includes(Ku)&&t.push(Ku),typeof window<"u")for(const r of[ax,lo])t.includes(r)||t.push(r);return t.includes(Fl)||t.push(Fl),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(){this.providerId="phone",this._delegate=new co(bT(ms.auth()))}static credential(e,t){return co.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}mx.PHONE_SIGN_IN_METHOD=co.PHONE_SIGN_IN_METHOD;mx.PROVIDER_ID=co.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5=be;class A5{constructor(e,t,r=ms.app()){var a;S5((a=r.options)===null||a===void 0?void 0:a.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new VC(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5="auth-compat";function j5(n){n.INTERNAL.registerComponent(new dr(I5,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new m0(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:bl.EMAIL_SIGNIN,PASSWORD_RESET:bl.PASSWORD_RESET,RECOVER_EMAIL:bl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:bl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:bl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:bl.VERIFY_EMAIL}},EmailAuthProvider:ha,FacebookAuthProvider:nr,GithubAuthProvider:rr,GoogleAuthProvider:sr,OAuthProvider:Ml,SAMLAuthProvider:Cf,PhoneAuthProvider:mx,PhoneMultiFactorGenerator:fT,RecaptchaVerifier:A5,TwitterAuthProvider:ir,Auth:m0,AuthCredential:rc,Error:Ln}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(l5,c5)}j5(ms);var Rw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var oo,_T;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,T){function S(){}S.prototype=T.prototype,j.D=T.prototype,j.prototype=new S,j.prototype.constructor=j,j.C=function(N,R,D){for(var M=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)M[Te-2]=arguments[Te];return T.prototype[R].apply(N,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(j,T,S){S||(S=0);var N=Array(16);if(typeof T=="string")for(var R=0;16>R;++R)N[R]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(R=0;16>R;++R)N[R]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=j.g[0],S=j.g[1],R=j.g[2];var D=j.g[3],M=T+(D^S&(R^D))+N[0]+3614090360&4294967295;T=S+(M<<7&4294967295|M>>>25),M=D+(R^T&(S^R))+N[1]+3905402710&4294967295,D=T+(M<<12&4294967295|M>>>20),M=R+(S^D&(T^S))+N[2]+606105819&4294967295,R=D+(M<<17&4294967295|M>>>15),M=S+(T^R&(D^T))+N[3]+3250441966&4294967295,S=R+(M<<22&4294967295|M>>>10),M=T+(D^S&(R^D))+N[4]+4118548399&4294967295,T=S+(M<<7&4294967295|M>>>25),M=D+(R^T&(S^R))+N[5]+1200080426&4294967295,D=T+(M<<12&4294967295|M>>>20),M=R+(S^D&(T^S))+N[6]+2821735955&4294967295,R=D+(M<<17&4294967295|M>>>15),M=S+(T^R&(D^T))+N[7]+4249261313&4294967295,S=R+(M<<22&4294967295|M>>>10),M=T+(D^S&(R^D))+N[8]+1770035416&4294967295,T=S+(M<<7&4294967295|M>>>25),M=D+(R^T&(S^R))+N[9]+2336552879&4294967295,D=T+(M<<12&4294967295|M>>>20),M=R+(S^D&(T^S))+N[10]+4294925233&4294967295,R=D+(M<<17&4294967295|M>>>15),M=S+(T^R&(D^T))+N[11]+2304563134&4294967295,S=R+(M<<22&4294967295|M>>>10),M=T+(D^S&(R^D))+N[12]+1804603682&4294967295,T=S+(M<<7&4294967295|M>>>25),M=D+(R^T&(S^R))+N[13]+4254626195&4294967295,D=T+(M<<12&4294967295|M>>>20),M=R+(S^D&(T^S))+N[14]+2792965006&4294967295,R=D+(M<<17&4294967295|M>>>15),M=S+(T^R&(D^T))+N[15]+1236535329&4294967295,S=R+(M<<22&4294967295|M>>>10),M=T+(R^D&(S^R))+N[1]+4129170786&4294967295,T=S+(M<<5&4294967295|M>>>27),M=D+(S^R&(T^S))+N[6]+3225465664&4294967295,D=T+(M<<9&4294967295|M>>>23),M=R+(T^S&(D^T))+N[11]+643717713&4294967295,R=D+(M<<14&4294967295|M>>>18),M=S+(D^T&(R^D))+N[0]+3921069994&4294967295,S=R+(M<<20&4294967295|M>>>12),M=T+(R^D&(S^R))+N[5]+3593408605&4294967295,T=S+(M<<5&4294967295|M>>>27),M=D+(S^R&(T^S))+N[10]+38016083&4294967295,D=T+(M<<9&4294967295|M>>>23),M=R+(T^S&(D^T))+N[15]+3634488961&4294967295,R=D+(M<<14&4294967295|M>>>18),M=S+(D^T&(R^D))+N[4]+3889429448&4294967295,S=R+(M<<20&4294967295|M>>>12),M=T+(R^D&(S^R))+N[9]+568446438&4294967295,T=S+(M<<5&4294967295|M>>>27),M=D+(S^R&(T^S))+N[14]+3275163606&4294967295,D=T+(M<<9&4294967295|M>>>23),M=R+(T^S&(D^T))+N[3]+4107603335&4294967295,R=D+(M<<14&4294967295|M>>>18),M=S+(D^T&(R^D))+N[8]+1163531501&4294967295,S=R+(M<<20&4294967295|M>>>12),M=T+(R^D&(S^R))+N[13]+2850285829&4294967295,T=S+(M<<5&4294967295|M>>>27),M=D+(S^R&(T^S))+N[2]+4243563512&4294967295,D=T+(M<<9&4294967295|M>>>23),M=R+(T^S&(D^T))+N[7]+1735328473&4294967295,R=D+(M<<14&4294967295|M>>>18),M=S+(D^T&(R^D))+N[12]+2368359562&4294967295,S=R+(M<<20&4294967295|M>>>12),M=T+(S^R^D)+N[5]+4294588738&4294967295,T=S+(M<<4&4294967295|M>>>28),M=D+(T^S^R)+N[8]+2272392833&4294967295,D=T+(M<<11&4294967295|M>>>21),M=R+(D^T^S)+N[11]+1839030562&4294967295,R=D+(M<<16&4294967295|M>>>16),M=S+(R^D^T)+N[14]+4259657740&4294967295,S=R+(M<<23&4294967295|M>>>9),M=T+(S^R^D)+N[1]+2763975236&4294967295,T=S+(M<<4&4294967295|M>>>28),M=D+(T^S^R)+N[4]+1272893353&4294967295,D=T+(M<<11&4294967295|M>>>21),M=R+(D^T^S)+N[7]+4139469664&4294967295,R=D+(M<<16&4294967295|M>>>16),M=S+(R^D^T)+N[10]+3200236656&4294967295,S=R+(M<<23&4294967295|M>>>9),M=T+(S^R^D)+N[13]+681279174&4294967295,T=S+(M<<4&4294967295|M>>>28),M=D+(T^S^R)+N[0]+3936430074&4294967295,D=T+(M<<11&4294967295|M>>>21),M=R+(D^T^S)+N[3]+3572445317&4294967295,R=D+(M<<16&4294967295|M>>>16),M=S+(R^D^T)+N[6]+76029189&4294967295,S=R+(M<<23&4294967295|M>>>9),M=T+(S^R^D)+N[9]+3654602809&4294967295,T=S+(M<<4&4294967295|M>>>28),M=D+(T^S^R)+N[12]+3873151461&4294967295,D=T+(M<<11&4294967295|M>>>21),M=R+(D^T^S)+N[15]+530742520&4294967295,R=D+(M<<16&4294967295|M>>>16),M=S+(R^D^T)+N[2]+3299628645&4294967295,S=R+(M<<23&4294967295|M>>>9),M=T+(R^(S|~D))+N[0]+4096336452&4294967295,T=S+(M<<6&4294967295|M>>>26),M=D+(S^(T|~R))+N[7]+1126891415&4294967295,D=T+(M<<10&4294967295|M>>>22),M=R+(T^(D|~S))+N[14]+2878612391&4294967295,R=D+(M<<15&4294967295|M>>>17),M=S+(D^(R|~T))+N[5]+4237533241&4294967295,S=R+(M<<21&4294967295|M>>>11),M=T+(R^(S|~D))+N[12]+1700485571&4294967295,T=S+(M<<6&4294967295|M>>>26),M=D+(S^(T|~R))+N[3]+2399980690&4294967295,D=T+(M<<10&4294967295|M>>>22),M=R+(T^(D|~S))+N[10]+4293915773&4294967295,R=D+(M<<15&4294967295|M>>>17),M=S+(D^(R|~T))+N[1]+2240044497&4294967295,S=R+(M<<21&4294967295|M>>>11),M=T+(R^(S|~D))+N[8]+1873313359&4294967295,T=S+(M<<6&4294967295|M>>>26),M=D+(S^(T|~R))+N[15]+4264355552&4294967295,D=T+(M<<10&4294967295|M>>>22),M=R+(T^(D|~S))+N[6]+2734768916&4294967295,R=D+(M<<15&4294967295|M>>>17),M=S+(D^(R|~T))+N[13]+1309151649&4294967295,S=R+(M<<21&4294967295|M>>>11),M=T+(R^(S|~D))+N[4]+4149444226&4294967295,T=S+(M<<6&4294967295|M>>>26),M=D+(S^(T|~R))+N[11]+3174756917&4294967295,D=T+(M<<10&4294967295|M>>>22),M=R+(T^(D|~S))+N[2]+718787259&4294967295,R=D+(M<<15&4294967295|M>>>17),M=S+(D^(R|~T))+N[9]+3951481745&4294967295,j.g[0]=j.g[0]+T&4294967295,j.g[1]=j.g[1]+(R+(M<<21&4294967295|M>>>11))&4294967295,j.g[2]=j.g[2]+R&4294967295,j.g[3]=j.g[3]+D&4294967295}r.prototype.u=function(j,T){T===void 0&&(T=j.length);for(var S=T-this.blockSize,N=this.B,R=this.h,D=0;D<T;){if(R==0)for(;D<=S;)a(this,j,D),D+=this.blockSize;if(typeof j=="string"){for(;D<T;)if(N[R++]=j.charCodeAt(D++),R==this.blockSize){a(this,N),R=0;break}}else for(;D<T;)if(N[R++]=j[D++],R==this.blockSize){a(this,N),R=0;break}}this.h=R,this.o+=T},r.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var T=1;T<j.length-8;++T)j[T]=0;var S=8*this.o;for(T=j.length-8;T<j.length;++T)j[T]=S&255,S/=256;for(this.u(j),j=Array(16),T=S=0;4>T;++T)for(var N=0;32>N;N+=8)j[S++]=this.g[T]>>>N&255;return j};function c(j,T){var S=f;return Object.prototype.hasOwnProperty.call(S,j)?S[j]:S[j]=T(j)}function d(j,T){this.h=T;for(var S=[],N=!0,R=j.length-1;0<=R;R--){var D=j[R]|0;N&&D==T||(S[R]=D,N=!1)}this.g=S}var f={};function m(j){return-128<=j&&128>j?c(j,function(T){return new d([T|0],0>T?-1:0)}):new d([j|0],0>j?-1:0)}function x(j){if(isNaN(j)||!isFinite(j))return v;if(0>j)return O(x(-j));for(var T=[],S=1,N=0;j>=S;N++)T[N]=j/S|0,S*=4294967296;return new d(T,0)}function y(j,T){if(j.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(j.charAt(0)=="-")return O(y(j.substring(1),T));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=x(Math.pow(T,8)),N=v,R=0;R<j.length;R+=8){var D=Math.min(8,j.length-R),M=parseInt(j.substring(R,R+D),T);8>D?(D=x(Math.pow(T,D)),N=N.j(D).add(x(M))):(N=N.j(S),N=N.add(x(M)))}return N}var v=m(0),E=m(1),A=m(16777216);n=d.prototype,n.m=function(){if(C(this))return-O(this).m();for(var j=0,T=1,S=0;S<this.g.length;S++){var N=this.i(S);j+=(0<=N?N:4294967296+N)*T,T*=4294967296}return j},n.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(V(this))return"0";if(C(this))return"-"+O(this).toString(j);for(var T=x(Math.pow(j,6)),S=this,N="";;){var R=ee(S,T).g;S=z(S,R.j(T));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(j);if(S=R,V(S))return D+N;for(;6>D.length;)D="0"+D;N=D+N}},n.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function V(j){if(j.h!=0)return!1;for(var T=0;T<j.g.length;T++)if(j.g[T]!=0)return!1;return!0}function C(j){return j.h==-1}n.l=function(j){return j=z(this,j),C(j)?-1:V(j)?0:1};function O(j){for(var T=j.g.length,S=[],N=0;N<T;N++)S[N]=~j.g[N];return new d(S,~j.h).add(E)}n.abs=function(){return C(this)?O(this):this},n.add=function(j){for(var T=Math.max(this.g.length,j.g.length),S=[],N=0,R=0;R<=T;R++){var D=N+(this.i(R)&65535)+(j.i(R)&65535),M=(D>>>16)+(this.i(R)>>>16)+(j.i(R)>>>16);N=M>>>16,D&=65535,M&=65535,S[R]=M<<16|D}return new d(S,S[S.length-1]&-2147483648?-1:0)};function z(j,T){return j.add(O(T))}n.j=function(j){if(V(this)||V(j))return v;if(C(this))return C(j)?O(this).j(O(j)):O(O(this).j(j));if(C(j))return O(this.j(O(j)));if(0>this.l(A)&&0>j.l(A))return x(this.m()*j.m());for(var T=this.g.length+j.g.length,S=[],N=0;N<2*T;N++)S[N]=0;for(N=0;N<this.g.length;N++)for(var R=0;R<j.g.length;R++){var D=this.i(N)>>>16,M=this.i(N)&65535,Te=j.i(R)>>>16,Pe=j.i(R)&65535;S[2*N+2*R]+=M*Pe,ae(S,2*N+2*R),S[2*N+2*R+1]+=D*Pe,ae(S,2*N+2*R+1),S[2*N+2*R+1]+=M*Te,ae(S,2*N+2*R+1),S[2*N+2*R+2]+=D*Te,ae(S,2*N+2*R+2)}for(N=0;N<T;N++)S[N]=S[2*N+1]<<16|S[2*N];for(N=T;N<2*T;N++)S[N]=0;return new d(S,0)};function ae(j,T){for(;(j[T]&65535)!=j[T];)j[T+1]+=j[T]>>>16,j[T]&=65535,T++}function K(j,T){this.g=j,this.h=T}function ee(j,T){if(V(T))throw Error("division by zero");if(V(j))return new K(v,v);if(C(j))return T=ee(O(j),T),new K(O(T.g),O(T.h));if(C(T))return T=ee(j,O(T)),new K(O(T.g),T.h);if(30<j.g.length){if(C(j)||C(T))throw Error("slowDivide_ only works with positive integers.");for(var S=E,N=T;0>=N.l(j);)S=B(S),N=B(N);var R=Q(S,1),D=Q(N,1);for(N=Q(N,2),S=Q(S,2);!V(N);){var M=D.add(N);0>=M.l(j)&&(R=R.add(S),D=M),N=Q(N,1),S=Q(S,1)}return T=z(j,R.j(T)),new K(R,T)}for(R=v;0<=j.l(T);){for(S=Math.max(1,Math.floor(j.m()/T.m())),N=Math.ceil(Math.log(S)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),D=x(S),M=D.j(T);C(M)||0<M.l(j);)S-=N,D=x(S),M=D.j(T);V(D)&&(D=E),R=R.add(D),j=z(j,M)}return new K(R,j)}n.A=function(j){return ee(this,j).h},n.and=function(j){for(var T=Math.max(this.g.length,j.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)&j.i(N);return new d(S,this.h&j.h)},n.or=function(j){for(var T=Math.max(this.g.length,j.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)|j.i(N);return new d(S,this.h|j.h)},n.xor=function(j){for(var T=Math.max(this.g.length,j.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)^j.i(N);return new d(S,this.h^j.h)};function B(j){for(var T=j.g.length+1,S=[],N=0;N<T;N++)S[N]=j.i(N)<<1|j.i(N-1)>>>31;return new d(S,j.h)}function Q(j,T){var S=T>>5;T%=32;for(var N=j.g.length-S,R=[],D=0;D<N;D++)R[D]=0<T?j.i(D+S)>>>T|j.i(D+S+1)<<32-T:j.i(D+S);return new d(R,j.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_T=r,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=x,d.fromString=y,oo=d}).apply(typeof Rw<"u"?Rw:typeof self<"u"?self:typeof window<"u"?window:{});var rf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wT,Eu,NT,bf,p0,TT,ET,ST;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,b,w){return h==Array.prototype||h==Object.prototype||(h[b]=w.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof rf=="object"&&rf];for(var b=0;b<h.length;++b){var w=h[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function a(h,b){if(b)e:{var w=r;h=h.split(".");for(var k=0;k<h.length-1;k++){var Y=h[k];if(!(Y in w))break e;w=w[Y]}h=h[h.length-1],k=w[h],b=b(k),b!=k&&b!=null&&e(w,h,{configurable:!0,writable:!0,value:b})}}function c(h,b){h instanceof String&&(h+="");var w=0,k=!1,Y={next:function(){if(!k&&w<h.length){var ie=w++;return{value:b(ie,h[ie]),done:!1}}return k=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}a("Array.prototype.values",function(h){return h||function(){return c(this,function(b,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(h){var b=typeof h;return b=b!="object"?b:h?Array.isArray(h)?"array":b:"null",b=="array"||b=="object"&&typeof h.length=="number"}function x(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function y(h,b,w){return h.call.apply(h.bind,arguments)}function v(h,b,w){if(!h)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,k),h.apply(b,Y)}}return function(){return h.apply(b,arguments)}}function E(h,b,w){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:v,E.apply(null,arguments)}function A(h,b){var w=Array.prototype.slice.call(arguments,1);return function(){var k=w.slice();return k.push.apply(k,arguments),h.apply(this,k)}}function V(h,b){function w(){}w.prototype=b.prototype,h.aa=b.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(k,Y,ie){for(var we=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)we[lt-2]=arguments[lt];return b.prototype[Y].apply(k,we)}}function C(h){const b=h.length;if(0<b){const w=Array(b);for(let k=0;k<b;k++)w[k]=h[k];return w}return[]}function O(h,b){for(let w=1;w<arguments.length;w++){const k=arguments[w];if(m(k)){const Y=h.length||0,ie=k.length||0;h.length=Y+ie;for(let we=0;we<ie;we++)h[Y+we]=k[we]}else h.push(k)}}class z{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function ae(h){return/^[\s\xa0]*$/.test(h)}function K(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function ee(h){return ee[" "](h),h}ee[" "]=function(){};var B=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function Q(h,b,w){for(const k in h)b.call(w,h[k],k,h)}function j(h,b){for(const w in h)b.call(void 0,h[w],w,h)}function T(h){const b={};for(const w in h)b[w]=h[w];return b}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(h,b){let w,k;for(let Y=1;Y<arguments.length;Y++){k=arguments[Y];for(w in k)h[w]=k[w];for(let ie=0;ie<S.length;ie++)w=S[ie],Object.prototype.hasOwnProperty.call(k,w)&&(h[w]=k[w])}}function R(h){var b=1;h=h.split(":");const w=[];for(;0<b&&h.length;)w.push(h.shift()),b--;return h.length&&w.push(h.join(":")),w}function D(h){f.setTimeout(()=>{throw h},0)}function M(){var h=ke;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class Te{constructor(){this.h=this.g=null}add(b,w){const k=Pe.get();k.set(b,w),this.h?this.h.next=k:this.g=k,this.h=k}}var Pe=new z(()=>new W,h=>h.reset());class W{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,ve=!1,ke=new Te,Ue=()=>{const h=f.Promise.resolve(void 0);ce=()=>{h.then(P)}};var P=()=>{for(var h;h=M();){try{h.h.call(h.g)}catch(w){D(w)}var b=Pe;b.j(h),100>b.h&&(b.h++,h.next=b.g,b.g=h)}ve=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function le(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};var _e=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};f.addEventListener("test",w,b),f.removeEventListener("test",w,b)}catch{}return h})();function Ne(h,b){if(le.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,k=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget){if(B){e:{try{ee(b.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(b=null)}}else w=="mouseover"?b=h.fromElement:w=="mouseout"&&(b=h.toElement);this.relatedTarget=b,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:F[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Ne.aa.h.call(this)}}V(Ne,le);var F={2:"touch",3:"pen",4:"mouse"};Ne.prototype.h=function(){Ne.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),H=0;function pe(h,b,w,k,Y){this.listener=h,this.proxy=null,this.src=b,this.type=w,this.capture=!!k,this.ha=Y,this.key=++H,this.da=this.fa=!1}function Be(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function gt(h){this.src=h,this.g={},this.h=0}gt.prototype.add=function(h,b,w,k,Y){var ie=h.toString();h=this.g[ie],h||(h=this.g[ie]=[],this.h++);var we=ns(h,b,k,Y);return-1<we?(b=h[we],w||(b.fa=!1)):(b=new pe(b,this.src,ie,!!k,Y),b.fa=w,h.push(b)),b};function Lt(h,b){var w=b.type;if(w in h.g){var k=h.g[w],Y=Array.prototype.indexOf.call(k,b,void 0),ie;(ie=0<=Y)&&Array.prototype.splice.call(k,Y,1),ie&&(Be(b),h.g[w].length==0&&(delete h.g[w],h.h--))}}function ns(h,b,w,k){for(var Y=0;Y<h.length;++Y){var ie=h[Y];if(!ie.da&&ie.listener==b&&ie.capture==!!w&&ie.ha==k)return Y}return-1}var En="closure_lm_"+(1e6*Math.random()|0),gr={};function si(h,b,w,k,Y){if(Array.isArray(b)){for(var ie=0;ie<b.length;ie++)si(h,b[ie],w,k,Y);return null}return w=ko(w),h&&h[me]?h.K(b,w,x(k)?!!k.capture:!1,Y):mc(h,b,w,!1,k,Y)}function mc(h,b,w,k,Y,ie){if(!b)throw Error("Invalid event type");var we=x(Y)?!!Y.capture:!!Y,lt=ii(h);if(lt||(h[En]=lt=new gt(h)),w=lt.add(b,w,k,we,ie),w.proxy)return w;if(k=Ro(),w.proxy=k,k.src=h,k.listener=w,h.addEventListener)_e||(Y=we),Y===void 0&&(Y=!1),h.addEventListener(b.toString(),k,Y);else if(h.attachEvent)h.attachEvent(yr(b.toString()),k);else if(h.addListener&&h.removeListener)h.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Ro(){function h(w){return b.call(h.src,h.listener,w)}const b=Co;return h}function ri(h,b,w,k,Y){if(Array.isArray(b))for(var ie=0;ie<b.length;ie++)ri(h,b[ie],w,k,Y);else k=x(k)?!!k.capture:!!k,w=ko(w),h&&h[me]?(h=h.i,b=String(b).toString(),b in h.g&&(ie=h.g[b],w=ns(ie,w,k,Y),-1<w&&(Be(ie[w]),Array.prototype.splice.call(ie,w,1),ie.length==0&&(delete h.g[b],h.h--)))):h&&(h=ii(h))&&(b=h.g[b.toString()],h=-1,b&&(h=ns(b,w,k,Y)),(w=-1<h?b[h]:null)&&xr(w))}function xr(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[me])Lt(b.i,h);else{var w=h.type,k=h.proxy;b.removeEventListener?b.removeEventListener(w,k,h.capture):b.detachEvent?b.detachEvent(yr(w),k):b.addListener&&b.removeListener&&b.removeListener(k),(w=ii(b))?(Lt(w,h),w.h==0&&(w.src=null,b[En]=null)):Be(h)}}}function yr(h){return h in gr?gr[h]:gr[h]="on"+h}function Co(h,b){if(h.da)h=!0;else{b=new Ne(b,this);var w=h.listener,k=h.ha||h.src;h.fa&&xr(h),h=w.call(k,b)}return h}function ii(h){return h=h[En],h instanceof gt?h:null}var en="__closure_events_fn_"+(1e9*Math.random()>>>0);function ko(h){return typeof h=="function"?h:(h[en]||(h[en]=function(b){return h.handleEvent(b)}),h[en])}function Ut(){$.call(this),this.i=new gt(this),this.M=this,this.F=null}V(Ut,$),Ut.prototype[me]=!0,Ut.prototype.removeEventListener=function(h,b,w,k){ri(this,h,b,w,k)};function Kt(h,b){var w,k=h.F;if(k)for(w=[];k;k=k.F)w.push(k);if(h=h.M,k=b.type||b,typeof b=="string")b=new le(b,h);else if(b instanceof le)b.target=b.target||h;else{var Y=b;b=new le(k,h),N(b,Y)}if(Y=!0,w)for(var ie=w.length-1;0<=ie;ie--){var we=b.g=w[ie];Y=ks(we,k,!0,b)&&Y}if(we=b.g=h,Y=ks(we,k,!0,b)&&Y,Y=ks(we,k,!1,b)&&Y,w)for(ie=0;ie<w.length;ie++)we=b.g=w[ie],Y=ks(we,k,!1,b)&&Y}Ut.prototype.N=function(){if(Ut.aa.N.call(this),this.i){var h=this.i,b;for(b in h.g){for(var w=h.g[b],k=0;k<w.length;k++)Be(w[k]);delete h.g[b],h.h--}}this.F=null},Ut.prototype.K=function(h,b,w,k){return this.i.add(String(h),b,!1,w,k)},Ut.prototype.L=function(h,b,w,k){return this.i.add(String(h),b,!0,w,k)};function ks(h,b,w,k){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();for(var Y=!0,ie=0;ie<b.length;++ie){var we=b[ie];if(we&&!we.da&&we.capture==w){var lt=we.listener,$t=we.ha||we.src;we.fa&&Lt(h.i,we),Y=lt.call($t,k)!==!1&&Y}}return Y&&!k.defaultPrevented}function Do(h,b,w){if(typeof h=="function")w&&(h=E(h,w));else if(h&&typeof h.handleEvent=="function")h=E(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:f.setTimeout(h,b||0)}function xa(h){h.g=Do(()=>{h.g=null,h.i&&(h.i=!1,xa(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class pc extends ${constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:xa(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function br(h){$.call(this),this.h=h,this.g={}}V(br,$);var Ds=[];function on(h){Q(h.g,function(b,w){this.g.hasOwnProperty(w)&&xr(b)},h),h.g={}}br.prototype.N=function(){br.aa.N.call(this),on(this)},br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bn=f.JSON.stringify,pn=f.JSON.parse,gc=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function ya(){}ya.prototype.h=null;function Mo(h){return h.h||(h.h=h.i())}function vr(){}var xs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hs(){le.call(this,"d")}V(Hs,le);function ss(){le.call(this,"c")}V(ss,le);var zn={},Gs=null;function ai(){return Gs=Gs||new Ut}zn.La="serverreachability";function ba(h){le.call(this,zn.La,h)}V(ba,le);function Ms(h){const b=ai();Kt(b,new ba(b))}zn.STAT_EVENT="statevent";function Ks(h,b){le.call(this,zn.STAT_EVENT,h),this.stat=b}V(Ks,le);function tn(h){const b=ai();Kt(b,new Ks(b,h))}zn.Ma="timingevent";function va(h,b){le.call(this,zn.Ma,h),this.size=b}V(va,le);function Ps(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},b)}function ys(){this.g=!0}ys.prototype.xa=function(){this.g=!1};function oi(h,b,w,k,Y,ie){h.info(function(){if(h.g)if(ie)for(var we="",lt=ie.split("&"),$t=0;$t<lt.length;$t++){var Ke=lt[$t].split("=");if(1<Ke.length){var cn=Ke[0];Ke=Ke[1];var un=cn.split("_");we=2<=un.length&&un[1]=="type"?we+(cn+"="+Ke+"&"):we+(cn+"=redacted&")}}else we=null;else we=ie;return"XMLHTTP REQ ("+k+") [attempt "+Y+"]: "+b+`
`+w+`
`+we})}function ne(h,b,w,k,Y,ie,we){h.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+Y+"]: "+b+`
`+w+`
`+ie+" "+we})}function ye(h,b,w,k){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+he(h,w)+(k?" "+k:"")})}function de(h,b){h.info(function(){return"TIMEOUT: "+b})}ys.prototype.info=function(){};function he(h,b){if(!h.g)return b;if(!b)return null;try{var w=JSON.parse(b);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var k=w[h];if(!(2>k.length)){var Y=k[1];if(Array.isArray(Y)&&!(1>Y.length)){var ie=Y[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var we=1;we<Y.length;we++)Y[we]=""}}}}return Bn(w)}catch{return b}}var Le={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},at={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rn;function li(){}V(li,ya),li.prototype.g=function(){return new XMLHttpRequest},li.prototype.i=function(){return{}},Rn=new li;function $s(h,b,w,k){this.j=h,this.i=b,this.l=w,this.R=k||1,this.U=new br(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Md}function Md(){this.i=null,this.g="",this.h=!1}var xc={},_r={};function _a(h,b,w){h.L=1,h.v=Ta(Rt(b)),h.m=w,h.P=!0,wr(h,null)}function wr(h,b){h.F=Date.now(),Os(h),h.A=Rt(h.v);var w=h.A,k=h.R;Array.isArray(k)||(k=[String(k)]),Er(w.i,"t",k),h.C=0,w=h.j.J,h.h=new Md,h.g=Wd(h.j,w?b:null,!h.m),0<h.O&&(h.M=new pc(E(h.Y,h,h.g),h.O)),b=h.U,w=h.g,k=h.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(Ds[0]=Y.toString()),Y=Ds);for(var ie=0;ie<Y.length;ie++){var we=si(w,Y[ie],k||b.handleEvent,!1,b.h||b);if(!we)break;b.g[we.key]=we}b=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,b)):(h.u="GET",h.g.ea(h.A,h.u,null,b)),Ms(),oi(h.i,h.u,h.A,h.l,h.R,h.m)}$s.prototype.ca=function(h){h=h.target;const b=this.M;b&&Dn(h)==3?b.j():this.Y(h)},$s.prototype.Y=function(h){try{if(h==this.g)e:{const un=Dn(this.g);var b=this.g.Ba();const _i=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||Aa(this.g)))){this.J||un!=4||b==7||(b==8||0>=_i?Ms(3):Ms(2)),Po(this);var w=this.g.Z();this.X=w;t:if(Nr(this)){var k=Aa(this.g);h="";var Y=k.length,ie=Dn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Cn(this),ci(this);var we="";break t}this.h.i=new f.TextDecoder}for(b=0;b<Y;b++)this.h.h=!0,h+=this.h.i.decode(k[b],{stream:!(ie&&b==Y-1)});k.length=0,this.h.g+=h,this.C=0,we=this.h.g}else we=this.g.oa();if(this.o=w==200,ne(this.i,this.u,this.A,this.l,this.R,un,w),this.o){if(this.T&&!this.K){t:{if(this.g){var lt,$t=this.g;if((lt=$t.g?$t.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ae(lt)){var Ke=lt;break t}}Ke=null}if(w=Ke)ye(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qs(this,w);else{this.o=!1,this.s=3,tn(12),Cn(this),ci(this);break e}}if(this.P){w=!0;let Gn;for(;!this.J&&this.C<we.length;)if(Gn=wa(this,we),Gn==_r){un==4&&(this.s=4,tn(14),w=!1),ye(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==xc){this.s=4,tn(15),ye(this.i,this.l,we,"[Invalid Chunk]"),w=!1;break}else ye(this.i,this.l,Gn,null),Qs(this,Gn);if(Nr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||we.length!=0||this.h.h||(this.s=1,tn(16),w=!1),this.o=this.o&&w,!w)ye(this.i,this.l,we,"[Invalid Chunked Response]"),Cn(this),ci(this);else if(0<we.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+we.length),Ic(cn),cn.M=!0,tn(11))}}else ye(this.i,this.l,we,null),Qs(this,we);un==4&&Cn(this),this.o&&!this.J&&(un==4?$d(this.j,this):(this.o=!1,Os(this)))}else qd(this.g),w==400&&0<we.indexOf("Unknown SID")?(this.s=3,tn(12)):(this.s=0,tn(13)),Cn(this),ci(this)}}}catch{}finally{}};function Nr(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function wa(h,b){var w=h.C,k=b.indexOf(`
`,w);return k==-1?_r:(w=Number(b.substring(w,k)),isNaN(w)?xc:(k+=1,k+w>b.length?_r:(b=b.slice(k,k+w),h.C=k+w,b)))}$s.prototype.cancel=function(){this.J=!0,Cn(this)};function Os(h){h.S=Date.now()+h.I,Ft(h,h.I)}function Ft(h,b){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Ps(E(h.ba,h),b)}function Po(h){h.B&&(f.clearTimeout(h.B),h.B=null)}$s.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(de(this.i,this.A),this.L!=2&&(Ms(),tn(17)),Cn(this),this.s=2,ci(this)):Ft(this,this.S-h)};function ci(h){h.j.G==0||h.J||$d(h.j,h)}function Cn(h){Po(h);var b=h.M;b&&typeof b.ma=="function"&&b.ma(),h.M=null,on(h.U),h.g&&(b=h.g,h.g=null,b.abort(),b.ma())}function Qs(h,b){try{var w=h.j;if(w.G!=0&&(w.g==h||ui(w.h,h))){if(!h.K&&ui(w.h,h)&&w.G==3){try{var k=w.Da.g.parse(b)}catch{k=null}if(Array.isArray(k)&&k.length==3){var Y=k;if(Y[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)bi(w),yi(w);else break e;Ac(w),tn(18)}}else w.za=Y[1],0<w.za-w.T&&37500>Y[2]&&w.F&&w.v==0&&!w.C&&(w.C=Ps(E(w.Za,w),6e3));if(1>=Pd(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Ar(w,11)}else if((h.K||w.g==h)&&bi(w),!ae(b))for(Y=w.Da.g.parse(b),b=0;b<Y.length;b++){let Ke=Y[b];if(w.T=Ke[0],Ke=Ke[1],w.G==2)if(Ke[0]=="c"){w.K=Ke[1],w.ia=Ke[2];const cn=Ke[3];cn!=null&&(w.la=cn,w.j.info("VER="+w.la));const un=Ke[4];un!=null&&(w.Aa=un,w.j.info("SVER="+w.Aa));const _i=Ke[5];_i!=null&&typeof _i=="number"&&0<_i&&(k=1.5*_i,w.L=k,w.j.info("backChannelRequestTimeoutMs_="+k)),k=w;const Gn=h.g;if(Gn){const Ra=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ra){var ie=k.h;ie.g||Ra.indexOf("spdy")==-1&&Ra.indexOf("quic")==-1&&Ra.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(di(ie,ie.h),ie.h=null))}if(k.D){const Ir=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ir&&(k.ya=Ir,nt(k.I,k.D,Ir))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),k=w;var we=h;if(k.qa=Yd(k,k.J?k.ia:null,k.W),we.K){bs(k.h,we);var lt=we,$t=k.L;$t&&(lt.I=$t),lt.B&&(Po(lt),Os(lt)),k.g=we}else Gd(k);0<w.i.length&&zo(w)}else Ke[0]!="stop"&&Ke[0]!="close"||Ar(w,7);else w.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?Ar(w,7):Ec(w):Ke[0]!="noop"&&w.l&&w.l.ta(Ke),w.v=0)}}Ms(4)}catch{}}var Om=class{constructor(h,b){this.g=h,this.map=b}};function yc(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Pd(h){return h.h?1:h.g?h.g.size:0}function ui(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function di(h,b){h.g?h.g.add(b):h.h=b}function bs(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}yc.prototype.cancel=function(){if(this.i=kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function kn(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const w of h.g.values())b=b.concat(w.D);return b}return C(h.i)}function Od(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(m(h)){for(var b=[],w=h.length,k=0;k<w;k++)b.push(h[k]);return b}b=[],w=0;for(k in h)b[w++]=h[k];return b}function Vm(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(m(h)||typeof h=="string"){var b=[];h=h.length;for(var w=0;w<h;w++)b.push(w);return b}b=[],w=0;for(const k in h)b[w++]=k;return b}}}function Oo(h,b){if(h.forEach&&typeof h.forEach=="function")h.forEach(b,void 0);else if(m(h)||typeof h=="string")Array.prototype.forEach.call(h,b,void 0);else for(var w=Vm(h),k=Od(h),Y=k.length,ie=0;ie<Y;ie++)b.call(void 0,k[ie],w&&w[ie],h)}var vc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vo(h,b){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var k=h[w].indexOf("="),Y=null;if(0<=k){var ie=h[w].substring(0,k);Y=h[w].substring(k+1)}else ie=h[w];b(ie,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Tr(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Tr){this.h=h.h,hi(this,h.j),this.o=h.o,this.g=h.g,Na(this,h.s),this.l=h.l;var b=h.i,w=new Ys;w.i=b.i,b.g&&(w.g=new Map(b.g),w.h=b.h),Lo(this,w),this.m=h.m}else h&&(b=String(h).match(vc))?(this.h=!1,hi(this,b[1]||"",!0),this.o=fi(b[2]||""),this.g=fi(b[3]||"",!0),Na(this,b[4]),this.l=fi(b[5]||"",!0),Lo(this,b[6]||"",!0),this.m=fi(b[7]||"")):(this.h=!1,this.i=new Ys(null,this.h))}Tr.prototype.toString=function(){var h=[],b=this.j;b&&h.push(vs(b,_c,!0),":");var w=this.g;return(w||b=="file")&&(h.push("//"),(b=this.o)&&h.push(vs(b,_c,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(vs(w,w.charAt(0)=="/"?wc:Vd,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",vs(w,Fm)),h.join("")};function Rt(h){return new Tr(h)}function hi(h,b,w){h.j=w?fi(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Na(h,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);h.s=b}else h.s=null}function Lo(h,b,w){b instanceof Ys?(h.i=b,Ld(h.i,h.h)):(w||(b=vs(b,Um)),h.i=new Ys(b,h.h))}function nt(h,b,w){h.i.set(b,w)}function Ta(h){return nt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function fi(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function vs(h,b,w){return typeof h=="string"?(h=encodeURI(h).replace(b,Lm),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Lm(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var _c=/[#\/\?@]/g,Vd=/[#\?:]/g,wc=/[#\?]/g,Um=/[#\?@]/g,Fm=/#/g;function Ys(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function ln(h){h.g||(h.g=new Map,h.h=0,h.i&&Vo(h.i,function(b,w){h.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}n=Ys.prototype,n.add=function(h,b){ln(this),this.i=null,h=rs(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(b),this.h+=1,this};function Uo(h,b){ln(h),b=rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Fo(h,b){return ln(h),b=rs(h,b),h.g.has(b)}n.forEach=function(h,b){ln(this),this.g.forEach(function(w,k){w.forEach(function(Y){h.call(b,Y,k,this)},this)},this)},n.na=function(){ln(this);const h=Array.from(this.g.values()),b=Array.from(this.g.keys()),w=[];for(let k=0;k<b.length;k++){const Y=h[k];for(let ie=0;ie<Y.length;ie++)w.push(b[k])}return w},n.V=function(h){ln(this);let b=[];if(typeof h=="string")Fo(this,h)&&(b=b.concat(this.g.get(rs(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)b=b.concat(h[w])}return b},n.set=function(h,b){return ln(this),this.i=null,h=rs(this,h),Fo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=this.V(h),0<h.length?String(h[0]):b):b};function Er(h,b,w){Uo(h,b),0<w.length&&(h.i=null,h.g.set(rs(h,b),C(w)),h.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(var w=0;w<b.length;w++){var k=b[w];const ie=encodeURIComponent(String(k)),we=this.V(k);for(k=0;k<we.length;k++){var Y=ie;we[k]!==""&&(Y+="="+encodeURIComponent(String(we[k]))),h.push(Y)}}return this.i=h.join("&")};function rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Ld(h,b){b&&!h.j&&(ln(h),h.i=null,h.g.forEach(function(w,k){var Y=k.toLowerCase();k!=Y&&(Uo(this,k),Er(this,Y,w))},h)),h.j=b}function Nc(h,b){const w=new ys;if(f.Image){const k=new Image;k.onload=A(Hn,w,"TestLoadImage: loaded",!0,b,k),k.onerror=A(Hn,w,"TestLoadImage: error",!1,b,k),k.onabort=A(Hn,w,"TestLoadImage: abort",!1,b,k),k.ontimeout=A(Hn,w,"TestLoadImage: timeout",!1,b,k),f.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=h}else b(!1)}function Ud(h,b){const w=new ys,k=new AbortController,Y=setTimeout(()=>{k.abort(),Hn(w,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:k.signal}).then(ie=>{clearTimeout(Y),ie.ok?Hn(w,"TestPingServer: ok",!0,b):Hn(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(Y),Hn(w,"TestPingServer: error",!1,b)})}function Hn(h,b,w,k,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),k(w)}catch{}}function Vs(){this.g=new gc}function Tc(h,b,w){const k=w||"";try{Oo(h,function(Y,ie){let we=Y;x(Y)&&(we=Bn(Y)),b.push(k+ie+"="+encodeURIComponent(we))})}catch(Y){throw b.push(k+"type="+encodeURIComponent("_badmap")),Y}}function Ws(h){this.l=h.Ub||null,this.j=h.eb||!1}V(Ws,ya),Ws.prototype.g=function(){return new is(this.l,this.j)},Ws.prototype.i=(function(h){return function(){return h}})({});function is(h,b){Ut.call(this),this.D=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(is,Ut),n=is.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=b,this.readyState=1,mi(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(b.body=h),(this.D||f).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xs(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,mi(this)),this.g&&(this.readyState=3,mi(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qo(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function qo(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Xs(this):mi(this),this.readyState==3&&qo(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Xs(this))},n.Qa=function(h){this.g&&(this.response=h,Xs(this))},n.ga=function(){this.g&&Xs(this)};function Xs(h){h.readyState=4,h.l=null,h.j=null,h.v=null,mi(h)}n.setRequestHeader=function(h,b){this.u.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=b.next();return h.join(`\r
`)};function mi(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(is.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ea(h){let b="";return Q(h,function(w,k){b+=k,b+=":",b+=w,b+=`\r
`}),b}function pi(h,b,w){e:{for(k in w){var k=!1;break e}k=!0}k||(w=Ea(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):nt(h,b,w))}function bt(h){Ut.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(bt,Ut);var Sn=/^https?$/i,Sr=["POST","PUT"];n=bt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,b,w,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rn.g(),this.v=this.o?Mo(this.o):Mo(Rn),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ie){Sa(this,ie);return}if(h=w||"",w=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var Y in k)w.set(Y,k[Y]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const ie of k.keys())w.set(ie,k.get(ie));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(w.keys()).find(ie=>ie.toLowerCase()=="content-type"),Y=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Sr,b,void 0))||k||Y||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,we]of w)this.g.setRequestHeader(ie,we);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Bo(this),this.u=!0,this.g.send(h),this.u=!1}catch(ie){Sa(this,ie)}};function Sa(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.m=5,gi(h),xi(h)}function gi(h){h.A||(h.A=!0,Kt(h,"complete"),Kt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Kt(this,"complete"),Kt(this,"abort"),xi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xi(this,!0)),bt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Fd(this):this.bb())},n.bb=function(){Fd(this)};function Fd(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Dn(h)!=4||h.Z()!=2)){if(h.u&&Dn(h)==4)Do(h.Ea,0,h);else if(Kt(h,"readystatechange"),Dn(h)==4){h.h=!1;try{const we=h.Z();e:switch(we){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var k;if(k=we===0){var Y=String(h.D).match(vc)[1]||null;!Y&&f.self&&f.self.location&&(Y=f.self.location.protocol.slice(0,-1)),k=!Sn.test(Y?Y.toLowerCase():"")}w=k}if(w)Kt(h,"complete"),Kt(h,"success");else{h.m=6;try{var ie=2<Dn(h)?h.g.statusText:""}catch{ie=""}h.l=ie+" ["+h.Z()+"]",gi(h)}}finally{xi(h)}}}}function xi(h,b){if(h.g){Bo(h);const w=h.g,k=h.v[0]?()=>{}:null;h.g=null,h.v=null,b||Kt(h,"ready");try{w.onreadystatechange=k}catch{}}}function Bo(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Dn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Dn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),pn(b)}};function Aa(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function qd(h){const b={};h=(h.g&&2<=Dn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<h.length;k++){if(ae(h[k]))continue;var w=R(h[k]);const Y=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ie=b[Y]||[];b[Y]=ie,ie.push(w)}j(b,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ia(h,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||b}function Bd(h){this.Aa=0,this.i=[],this.j=new ys,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ia("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ia("baseRetryDelayMs",5e3,h),this.cb=Ia("retryDelaySeedMs",1e4,h),this.Wa=Ia("forwardChannelMaxRetries",2,h),this.wa=Ia("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new yc(h&&h.concurrentRequestLimit),this.Da=new Vs,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Bd.prototype,n.la=8,n.G=1,n.connect=function(h,b,w,k){tn(0),this.W=h,this.H=b||{},w&&k!==void 0&&(this.H.OSID=w,this.H.OAID=k),this.F=this.X,this.I=Yd(this,null,this.W),zo(this)};function Ec(h){if(zd(h),h.G==3){var b=h.U++,w=Rt(h.I);if(nt(w,"SID",h.K),nt(w,"RID",b),nt(w,"TYPE","terminate"),ja(h,w),b=new $s(h,h.j,b),b.L=2,b.v=Ta(Rt(w)),w=!1,f.navigator&&f.navigator.sendBeacon)try{w=f.navigator.sendBeacon(b.v.toString(),"")}catch{}!w&&f.Image&&(new Image().src=b.v,w=!0),w||(b.g=Wd(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Os(b)}jc(h)}function yi(h){h.g&&(Ic(h),h.g.cancel(),h.g=null)}function zd(h){yi(h),h.u&&(f.clearTimeout(h.u),h.u=null),bi(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function zo(h){if(!bc(h.h)&&!h.s){h.s=!0;var b=h.Ga;ce||Ue(),ve||(ce(),ve=!0),ke.add(b,h),h.B=0}}function qm(h,b){return Pd(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=b.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Ps(E(h.Ga,h,b),Qd(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const Y=new $s(this,this.j,h);let ie=this.o;if(this.S&&(ie?(ie=T(ie),N(ie,this.S)):ie=this.S),this.m!==null||this.O||(Y.H=ie,ie=null),this.P)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var k=this.i[w];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(b+=k,4096<b){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=Sc(this,Y,b),w=Rt(this.I),nt(w,"RID",h),nt(w,"CVER",22),this.D&&nt(w,"X-HTTP-Session-Id",this.D),ja(this,w),ie&&(this.O?b="headers="+encodeURIComponent(String(Ea(ie)))+"&"+b:this.m&&pi(w,this.m,ie)),di(this.h,Y),this.Ua&&nt(w,"TYPE","init"),this.P?(nt(w,"$req",b),nt(w,"SID","null"),Y.T=!0,_a(Y,w,null)):_a(Y,w,b),this.G=2}}else this.G==3&&(h?Hd(this,h):this.i.length==0||bc(this.h)||Hd(this))};function Hd(h,b){var w;b?w=b.l:w=h.U++;const k=Rt(h.I);nt(k,"SID",h.K),nt(k,"RID",w),nt(k,"AID",h.T),ja(h,k),h.m&&h.o&&pi(k,h.m,h.o),w=new $s(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),b&&(h.i=b.D.concat(h.i)),b=Sc(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),di(h.h,w),_a(w,k,b)}function ja(h,b){h.H&&Q(h.H,function(w,k){nt(b,k,w)}),h.l&&Oo({},function(w,k){nt(b,k,w)})}function Sc(h,b,w){w=Math.min(h.i.length,w);var k=h.l?E(h.l.Na,h.l,h):null;e:{var Y=h.i;let ie=-1;for(;;){const we=["count="+w];ie==-1?0<w?(ie=Y[0].g,we.push("ofs="+ie)):ie=0:we.push("ofs="+ie);let lt=!0;for(let $t=0;$t<w;$t++){let Ke=Y[$t].g;const cn=Y[$t].map;if(Ke-=ie,0>Ke)ie=Math.max(0,Y[$t].g-100),lt=!1;else try{Tc(cn,we,"req"+Ke+"_")}catch{k&&k(cn)}}if(lt){k=we.join("&");break e}}}return h=h.i.splice(0,w),b.D=h,k}function Gd(h){if(!h.g&&!h.u){h.Y=1;var b=h.Fa;ce||Ue(),ve||(ce(),ve=!0),ke.add(b,h),h.v=0}}function Ac(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Ps(E(h.Fa,h),Qd(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Kd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Ps(E(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tn(10),yi(this),Kd(this))};function Ic(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Kd(h){h.g=new $s(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var b=Rt(h.qa);nt(b,"RID","rpc"),nt(b,"SID",h.K),nt(b,"AID",h.T),nt(b,"CI",h.F?"0":"1"),!h.F&&h.ja&&nt(b,"TO",h.ja),nt(b,"TYPE","xmlhttp"),ja(h,b),h.m&&h.o&&pi(b,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=Ta(Rt(b)),w.m=null,w.P=!0,wr(w,h)}n.Za=function(){this.C!=null&&(this.C=null,yi(this),Ac(this),tn(19))};function bi(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function $d(h,b){var w=null;if(h.g==b){bi(h),Ic(h),h.g=null;var k=2}else if(ui(h.h,b))w=b.D,bs(h.h,b),k=1;else return;if(h.G!=0){if(b.o)if(k==1){w=b.m?b.m.length:0,b=Date.now()-b.F;var Y=h.B;k=ai(),Kt(k,new va(k,w)),zo(h)}else Gd(h);else if(Y=b.s,Y==3||Y==0&&0<b.X||!(k==1&&qm(h,b)||k==2&&Ac(h)))switch(w&&0<w.length&&(b=h.h,b.i=b.i.concat(w)),Y){case 1:Ar(h,5);break;case 4:Ar(h,10);break;case 3:Ar(h,6);break;default:Ar(h,2)}}}function Qd(h,b){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*b}function Ar(h,b){if(h.j.info("Error code "+b),b==2){var w=E(h.fb,h),k=h.Xa;const Y=!k;k=new Tr(k||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||hi(k,"https"),Ta(k),Y?Nc(k.toString(),w):Ud(k.toString(),w)}else tn(2);h.G=0,h.l&&h.l.sa(b),jc(h),zd(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),tn(2)):(this.j.info("Failed to ping google.com"),tn(1))};function jc(h){if(h.G=0,h.ka=[],h.l){const b=kn(h.h);(b.length!=0||h.i.length!=0)&&(O(h.ka,b),O(h.ka,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.ra()}}function Yd(h,b,w){var k=w instanceof Tr?Rt(w):new Tr(w);if(k.g!="")b&&(k.g=b+"."+k.g),Na(k,k.s);else{var Y=f.location;k=Y.protocol,b=b?b+"."+Y.hostname:Y.hostname,Y=+Y.port;var ie=new Tr(null);k&&hi(ie,k),b&&(ie.g=b),Y&&Na(ie,Y),w&&(ie.l=w),k=ie}return w=h.D,b=h.ya,w&&b&&nt(k,w,b),nt(k,"VER",h.la),ja(h,k),k}function Wd(h,b,w){if(b&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Ca&&!h.pa?new bt(new Ws({eb:w})):new bt(h.pa),b.Ha(h.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xd(){}n=Xd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ho(){}Ho.prototype.g=function(h,b){return new Mn(h,b)};function Mn(h,b){Ut.call(this),this.g=new Bd(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(h?h["X-WebChannel-Client-Profile"]=b.va:h={"X-WebChannel-Client-Profile":b.va}),this.g.S=h,(h=b&&b.Sb)&&!ae(h)&&(this.g.m=h),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!ae(b)&&(this.g.D=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new vi(this)}V(Mn,Ut),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){Ec(this.g)},Mn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=Bn(h),h=w);b.i.push(new Om(b.Ya++,h)),b.G==3&&zo(b)},Mn.prototype.N=function(){this.g.l=null,delete this.j,Ec(this.g),delete this.g,Mn.aa.N.call(this)};function Jd(h){Hs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const w in b){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}V(Jd,Hs);function Zd(){ss.call(this),this.status=1}V(Zd,ss);function vi(h){this.g=h}V(vi,Xd),vi.prototype.ua=function(){Kt(this.g,"a")},vi.prototype.ta=function(h){Kt(this.g,new Jd(h))},vi.prototype.sa=function(h){Kt(this.g,new Zd)},vi.prototype.ra=function(){Kt(this.g,"b")},Ho.prototype.createWebChannel=Ho.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,ST=function(){return new Ho},ET=function(){return ai()},TT=zn,p0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Le.NO_ERROR=0,Le.TIMEOUT=8,Le.HTTP_ERROR=6,bf=Le,at.COMPLETE="complete",NT=at,vr.EventType=xs,xs.OPEN="a",xs.CLOSE="b",xs.ERROR="c",xs.MESSAGE="d",Ut.prototype.listen=Ut.prototype.K,Eu=vr,bt.prototype.listenOnce=bt.prototype.L,bt.prototype.getLastError=bt.prototype.Ka,bt.prototype.getLastErrorCode=bt.prototype.Ba,bt.prototype.getStatus=bt.prototype.Z,bt.prototype.getResponseJson=bt.prototype.Oa,bt.prototype.getResponseText=bt.prototype.oa,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Ha,wT=bt}).apply(typeof rf<"u"?rf:typeof self<"u"?self:typeof window<"u"?window:{});const Cw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ac="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa=new Xf("@firebase/firestore");function Sl(){return sa.logLevel}function R5(n){sa.setLogLevel(n)}function xe(n,...e){if(sa.logLevel<=Ye.DEBUG){const t=e.map(px);sa.debug(`Firestore (${ac}): ${n}`,...t)}}function zt(n,...e){if(sa.logLevel<=Ye.ERROR){const t=e.map(px);sa.error(`Firestore (${ac}): ${n}`,...t)}}function fr(n,...e){if(sa.logLevel<=Ye.WARN){const t=e.map(px);sa.warn(`Firestore (${ac}): ${n}`,...t)}}function px(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(n="Unexpected state"){const e=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: `+n;throw zt(e),new Error(e)}function Re(n,e){n||Ie()}function C5(n,e){n||Ie()}function Ae(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Ln{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class D5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class M5{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Re(this.o===void 0);let r=this.i;const a=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let c=new Nn;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Nn,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=c;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Nn)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string"),new AT(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string"),new fn(e)}}class P5{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class O5{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new P5(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V5{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L5{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Re(this.o===void 0);const r=c=>{c.error!=null&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.R;return this.R=c.token,xe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>r(c)))};const a=c=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((c=>a(c))),setTimeout((()=>{if(!this.appCheck){const c=this.A.getImmediate({optional:!0});c?a(c):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Re(typeof t.token=="string"),this.R=t.token,new V5(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U5(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const a=U5(40);for(let c=0;c<a.length;++c)r.length<20&&a[c]<t&&(r+=e.charAt(a[c]%e.length))}return r}}function qe(n,e){return n<e?-1:n>e?1:0}function Bl(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}function jT(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ge(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return At.fromMillis(Date.now())}static fromDate(e){return At.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new At(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.timestamp=e}static fromTimestamp(e){return new De(e)}static min(){return new De(new At(0,0))}static max(){return new De(new At(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ie(),r===void 0?r=e.length-t:r>e.length-t&&Ie(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return $u.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $u?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const c=e.get(a),d=t.get(a);if(c<d)return-1;if(c>d)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Je extends $u{construct(e,t,r){return new Je(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(re.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Je(t)}static emptyPath(){return new Je([])}}const F5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends $u{construct(e,t,r){return new Et(e,t,r)}static isValidIdentifier(e){return F5.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Et(["__name__"])}static fromServerFormat(e){const t=[];let r="",a=0;const c=()=>{if(r.length===0)throw new ge(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new ge(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new ge(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(r+=f,a++):(c(),a++)}if(c(),d)throw new ge(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(t)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(Je.fromString(e))}static fromName(e){return new Se(Je.fromString(e).popFirst(5))}static empty(){return new Se(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new Je(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function g0(n){return n.fields.find((e=>e.kind===2))}function Wa(n){return n.fields.filter((e=>e.kind!==2))}Pf.UNKNOWN_ID=-1;class vf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qu(0,gs.min())}}function RT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=De.fromTimestamp(r===1e9?new At(t+1,0):new At(t,r));return new gs(a,Se.empty(),e)}function CT(n){return new gs(n.readTime,n.key,-1)}class gs{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new gs(De.min(),Se.empty(),-1)}static max(){return new gs(De.max(),Se.empty(),-1)}}function gx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fa(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==kT)throw n;xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((r,a)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(r,a)},this.catchCallback=c=>{this.wrapFailure(t,c).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,r)=>{t(e)}))}static reject(e){return new Z(((t,r)=>{r(e)}))}static waitFor(e){return new Z(((t,r)=>{let a=0,c=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++c,d&&c===a&&t()}),(m=>r(m)))})),d=!0,c===a&&t()}))}static or(e){let t=Z.resolve(!1);for(const r of e)t=t.next((a=>a?Z.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,c)=>{r.push(t.call(this,a,c))})),this.waitFor(r)}static mapArray(e,t){return new Z(((r,a)=>{const c=e.length,d=new Array(c);let f=0;for(let m=0;m<c;m++){const x=m;t(e[x]).next((y=>{d[x]=y,++f,f===c&&r(d)}),(y=>a(y)))}}))}static doWhile(e,t){return new Z(((r,a)=>{const c=()=>{e()===!0?t().next((()=>{c()}),a):r()};c()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Nn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ku(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const a=xx(r.target.error);this.V.reject(new ku(e,a))}}static open(e,t,r,a){try{return new cm(t,e.transaction(a,r))}catch(c){throw new ku(t,c)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(xe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new B5(t)}}class cr{constructor(e,t,r){this.name=e,this.version=t,this.p=r,cr.S(jt())===12.2&&zt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return xe("SimpleDb","Removing database:",e),Xa(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Lu())return!1;if(cr.v())return!0;const e=jt(),t=cr.S(e),r=0<t&&t<10,a=MT(e),c=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||c)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(xe("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=c=>{const d=c.target.result;t(d)},a.onblocked=()=>{r(new ku(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=c=>{const d=c.target.error;d.name==="VersionError"?r(new ge(re.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):d.name==="InvalidStateError"?r(new ge(re.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):r(new ku(e,d))},a.onupgradeneeded=c=>{xe("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',c.oldVersion);const d=c.target.result;this.p.O(d,a.transaction,c.oldVersion,this.version).next((()=>{xe("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const c=t==="readonly";let d=0;for(;;){++d;try{this.db=await this.M(e);const f=cm.open(this.db,e,c?"readonly":"readwrite",r),m=a(f).next((x=>(f.g(),x))).catch((x=>(f.abort(x),Z.reject(x)))).toPromise();return m.catch((()=>{})),await f.m,m}catch(f){const m=f,x=m.name!=="FirebaseError"&&d<3;if(xe("SimpleDb","Transaction failed with error:",m.message,"Retrying:",x),this.close(),!x)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function MT(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class q5{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Xa(this.B.delete())}}class ku extends ge{constructor(e,t){super(re.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ma(n){return n.name==="IndexedDbTransactionError"}class B5{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(xe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(xe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Xa(r)}add(e){return xe("SimpleDb","ADD",this.store.name,e,e),Xa(this.store.add(e))}get(e){return Xa(this.store.get(e)).next((t=>(t===void 0&&(t=null),xe("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return xe("SimpleDb","DELETE",this.store.name,e),Xa(this.store.delete(e))}count(){return xe("SimpleDb","COUNT",this.store.name),Xa(this.store.count())}U(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const c=a.getAll(r.range);return new Z(((d,f)=>{c.onerror=m=>{f(m.target.error)},c.onsuccess=m=>{d(m.target.result)}}))}{const c=this.cursor(r),d=[];return this.W(c,((f,m)=>{d.push(m)})).next((()=>d))}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new Z(((a,c)=>{r.onerror=d=>{c(d.target.error)},r.onsuccess=d=>{a(d.target.result)}}))}j(e,t){xe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const a=this.cursor(r);return this.W(a,((c,d,f)=>f.delete()))}J(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.W(a,t)}Y(e){const t=this.cursor({});return new Z(((r,a)=>{t.onerror=c=>{const d=xx(c.target.error);a(d)},t.onsuccess=c=>{const d=c.target.result;d?e(d.primaryKey,d.value).next((f=>{f?d.continue():r()})):r()}}))}W(e,t){const r=[];return new Z(((a,c)=>{e.onerror=d=>{c(d.target.error)},e.onsuccess=d=>{const f=d.target.result;if(!f)return void a();const m=new q5(f),x=t(f.primaryKey,f.value,m);if(x instanceof Z){const y=x.catch((v=>(m.done(),Z.reject(v))));r.push(y)}m.isDone?a():m.K===null?f.continue():f.continue(m.K)}})).next((()=>Z.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Xa(n){return new Z(((e,t)=>{n.onsuccess=r=>{const a=r.target.result;e(a)},n.onerror=r=>{const a=xx(r.target.error);t(a)}}))}let kw=!1;function xx(n){const e=cr.S(jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kw||(kw=!0,setTimeout((()=>{throw r}),0)),r}}return n}class z5{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){xe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{xe("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){ma(t)?xe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await fa(t)}await this.X(6e4)}))}}class H5{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const r=new Set;let a=t,c=!0;return Z.doWhile((()=>c===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((d=>{if(d!==null&&!r.has(d))return xe("IndexBackfiller",`Processing collection: ${d}`),this.ne(e,d,a).next((f=>{a-=f,r.add(d)}));c=!1})))).next((()=>t-a))}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next((c=>{const d=c.changes;return this.localStore.indexManager.updateIndexEntries(e,d).next((()=>this.re(a,c))).next((f=>(xe("IndexBackfiller",`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(e,t,f)))).next((()=>d.size))}))))}re(e,t){let r=e;return t.changes.forEach(((a,c)=>{const d=CT(c);gx(d,r)>0&&(r=d)})),new gs(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Zn.oe=-1;function vd(n){return n==null}function Yu(n){return n===0&&1/n==-1/0}function PT(n){return typeof n=="number"&&Number.isInteger(n)&&!Yu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Dw(e)),e=G5(n.get(t),e);return Dw(e)}function G5(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const c=n.charAt(a);switch(c){case"\0":t+="";break;case"":t+="";break;default:t+=c}}return t}function Dw(n){return n+""}function or(n){const e=n.length;if(Re(e>=2),e===2)return Re(n.charAt(0)===""&&n.charAt(1)===""),Je.emptyPath();const t=e-2,r=[];let a="";for(let c=0;c<e;){const d=n.indexOf("",c);switch((d<0||d>t)&&Ie(),n.charAt(d+1)){case"":const f=n.substring(c,d);let m;a.length===0?m=f:(a+=f,m=a,a=""),r.push(m);break;case"":a+=n.substring(c,d),a+="\0";break;case"":a+=n.substring(c,d+1);break;default:Ie()}c=d+2}return new Je(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(n,e){return[n,Un(e)]}function OT(n,e,t){return[n,Un(e),t]}const K5={},$5=["prefixPath","collectionGroup","readTime","documentId"],Q5=["prefixPath","collectionGroup","documentId"],Y5=["collectionGroup","readTime","prefixPath","documentId"],W5=["canonicalId","targetId"],X5=["targetId","path"],J5=["path","targetId"],Z5=["collectionId","parent"],eD=["indexId","uid"],tD=["uid","sequenceNumber"],nD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],sD=["indexId","uid","orderedDocumentKey"],rD=["userId","collectionPath","documentId"],iD=["userId","collectionPath","largestBatchId"],aD=["userId","collectionGroup","largestBatchId"],VT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],oD=[...VT,"documentOverlays"],LT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],UT=LT,yx=[...UT,"indexConfiguration","indexState","indexEntries"],lD=yx,cD=[...yx,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0 extends DT{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function an(n,e){const t=Ae(n);return cr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function To(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t){this.comparator=e,this.root=t||_n.EMPTY}insert(e,t){return new yt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new yt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new af(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new af(this.root,e,this.comparator,!1)}getReverseIterator(){return new af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new af(this.root,e,this.comparator,!0)}}class af{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?r(e.key,t):1,t&&a&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,t,r,a,c){this.key=e,this.value=t,this.color=r??_n.RED,this.left=a??_n.EMPTY,this.right=c??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,c){return new _n(e??this.key,t??this.value,r??this.color,a??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const c=r(e,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(e,t,r),null):c===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ie();const e=this.left.check();if(e!==this.right.check())throw Ie();return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie()}get value(){throw Ie()}get color(){throw Ie()}get left(){throw Ie()}get right(){throw Ie()}copy(e,t,r,a,c){return this}insert(e,t,r){return new _n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.comparator=e,this.data=new yt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ow(this.data.getIterator())}getIteratorFrom(e){return new Ow(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof pt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,c=r.getNext().key;if(this.comparator(a,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new pt(this.comparator);return t.data=e,t}}class Ow{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new es([])}unionWith(e){let t=new pt(Et.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new qT("Invalid base64 string: "+c):c}})(e);return new Pt(t)}static fromUint8Array(e){const t=(function(a){let c="";for(let d=0;d<a.length;++d)c+=String.fromCharCode(a[d]);return c})(e);return new Pt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const dD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wr(n){if(Re(!!n),typeof n=="string"){let e=0;const t=dD.exec(n);if(Re(!!t),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Tt(n.seconds),nanos:Tt(n.nanos)}}function Tt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ra(n){return typeof n=="string"?Pt.fromBase64String(n):Pt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function bx(n){const e=n.mapValue.fields.__previous_value__;return um(e)?bx(e):e}function Wu(n){const e=Wr(n.mapValue.fields.__local_write_time__.timestampValue);return new At(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,t,r,a,c,d,f,m,x){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=x}}class ia{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ia("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ia&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wf={nullValue:"NULL_VALUE"};function ho(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?um(n)?4:BT(n)?9007199254740991:dm(n)?10:11:Ie()}function mr(n,e){if(n===e)return!0;const t=ho(n);if(t!==ho(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wu(n).isEqual(Wu(e));case 3:return(function(a,c){if(typeof a.timestampValue=="string"&&typeof c.timestampValue=="string"&&a.timestampValue.length===c.timestampValue.length)return a.timestampValue===c.timestampValue;const d=Wr(a.timestampValue),f=Wr(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,c){return ra(a.bytesValue).isEqual(ra(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,c){return Tt(a.geoPointValue.latitude)===Tt(c.geoPointValue.latitude)&&Tt(a.geoPointValue.longitude)===Tt(c.geoPointValue.longitude)})(n,e);case 2:return(function(a,c){if("integerValue"in a&&"integerValue"in c)return Tt(a.integerValue)===Tt(c.integerValue);if("doubleValue"in a&&"doubleValue"in c){const d=Tt(a.doubleValue),f=Tt(c.doubleValue);return d===f?Yu(d)===Yu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Bl(n.arrayValue.values||[],e.arrayValue.values||[],mr);case 10:case 11:return(function(a,c){const d=a.mapValue.fields||{},f=c.mapValue.fields||{};if(Pw(d)!==Pw(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!mr(d[m],f[m])))return!1;return!0})(n,e);default:return Ie()}}function Xu(n,e){return(n.values||[]).find((t=>mr(t,e)))!==void 0}function aa(n,e){if(n===e)return 0;const t=ho(n),r=ho(e);if(t!==r)return qe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const f=Tt(c.integerValue||c.doubleValue),m=Tt(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Vw(n.timestampValue,e.timestampValue);case 4:return Vw(Wu(n),Wu(e));case 5:return qe(n.stringValue,e.stringValue);case 6:return(function(c,d){const f=ra(c),m=ra(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const f=c.split("/"),m=d.split("/");for(let x=0;x<f.length&&x<m.length;x++){const y=qe(f[x],m[x]);if(y!==0)return y}return qe(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const f=qe(Tt(c.latitude),Tt(d.latitude));return f!==0?f:qe(Tt(c.longitude),Tt(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Lw(n.arrayValue,e.arrayValue);case 10:return(function(c,d){var f,m,x,y;const v=c.fields||{},E=d.fields||{},A=(f=v.value)===null||f===void 0?void 0:f.arrayValue,V=(m=E.value)===null||m===void 0?void 0:m.arrayValue,C=qe(((x=A==null?void 0:A.values)===null||x===void 0?void 0:x.length)||0,((y=V==null?void 0:V.values)===null||y===void 0?void 0:y.length)||0);return C!==0?C:Lw(A,V)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===Xi.mapValue&&d===Xi.mapValue)return 0;if(c===Xi.mapValue)return 1;if(d===Xi.mapValue)return-1;const f=c.fields||{},m=Object.keys(f),x=d.fields||{},y=Object.keys(x);m.sort(),y.sort();for(let v=0;v<m.length&&v<y.length;++v){const E=qe(m[v],y[v]);if(E!==0)return E;const A=aa(f[m[v]],x[y[v]]);if(A!==0)return A}return qe(m.length,y.length)})(n.mapValue,e.mapValue);default:throw Ie()}}function Vw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=Wr(n),r=Wr(e),a=qe(t.seconds,r.seconds);return a!==0?a:qe(t.nanos,r.nanos)}function Lw(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const c=aa(t[a],r[a]);if(c)return c}return qe(t.length,r.length)}function zl(n){return y0(n)}function y0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Wr(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ra(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Se.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const c of t.values||[])a?a=!1:r+=",",r+=y0(c);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",c=!0;for(const d of r)c?c=!1:a+=",",a+=`${d}:${y0(t.fields[d])}`;return a+"}"})(n.mapValue):Ie()}function fo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function b0(n){return!!n&&"integerValue"in n}function Ju(n){return!!n&&"arrayValue"in n}function Uw(n){return!!n&&"nullValue"in n}function Fw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Nf(n){return!!n&&"mapValue"in n}function dm(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Du(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return To(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Du(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Du(n.arrayValue.values[t]);return e}return Object.assign({},n)}function BT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const zT={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function fD(n){return"nullValue"in n?wf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?fo(ia.empty(),Se.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?dm(n)?zT:{mapValue:{}}:Ie()}function mD(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?fo(ia.empty(),Se.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?zT:"mapValue"in n?dm(n)?{mapValue:{}}:Xi:Ie()}function qw(n,e){const t=aa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Bw(n,e){const t=aa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.value=e}static empty(){return new wn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Nf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Du(t)}setAll(e){let t=Et.emptyPath(),r={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,r,a),r={},a=[],t=f.popLast()}d?r[f.lastSegment()]=Du(d):a.push(f.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,r,a)}delete(e){const t=this.field(e.popLast());Nf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return mr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Nf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){To(t,((a,c)=>e[a]=c));for(const a of r)delete e[a]}clone(){return new wn(Du(this.value))}}function HT(n){const e=[];return To(n.fields,((t,r)=>{const a=new Et([t]);if(Nf(r)){const c=HT(r.mapValue).fields;if(c.length===0)e.push(a);else for(const d of c)e.push(a.child(d))}else e.push(a)})),new es(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,t,r,a,c,d,f){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new wt(e,0,De.min(),De.min(),De.min(),wn.empty(),0)}static newFoundDocument(e,t,r,a){return new wt(e,1,t,De.min(),r,a,0)}static newNoDocument(e,t){return new wt(e,2,t,De.min(),De.min(),wn.empty(),0)}static newUnknownDocument(e,t){return new wt(e,3,t,De.min(),De.min(),wn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=wn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=wn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,t){this.position=e,this.inclusive=t}}function zw(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const c=e[a],d=n.position[a];if(c.field.isKeyField()?r=Se.comparator(Se.fromName(d.referenceValue),t.key):r=aa(d,t.data.field(c.field)),c.dir==="desc"&&(r*=-1),r!==0)break}return r}function Hw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!mr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,t="asc"){this.field=e,this.dir=t}}function pD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{}class Ze extends GT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new gD(e,t,r):t==="array-contains"?new bD(e,r):t==="in"?new XT(e,r):t==="not-in"?new vD(e,r):t==="array-contains-any"?new _D(e,r):new Ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new xD(e,r):new yD(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(aa(t,this.value)):t!==null&&ho(this.value)===ho(t)&&this.matchesComparison(aa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dt extends GT{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new dt(e,t)}matches(e){return Hl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Hl(n){return n.op==="and"}function v0(n){return n.op==="or"}function vx(n){return KT(n)&&Hl(n)}function KT(n){for(const e of n.filters)if(e instanceof dt)return!1;return!0}function _0(n){if(n instanceof Ze)return n.field.canonicalString()+n.op.toString()+zl(n.value);if(vx(n))return n.filters.map((e=>_0(e))).join(",");{const e=n.filters.map((t=>_0(t))).join(",");return`${n.op}(${e})`}}function $T(n,e){return n instanceof Ze?(function(r,a){return a instanceof Ze&&r.op===a.op&&r.field.isEqual(a.field)&&mr(r.value,a.value)})(n,e):n instanceof dt?(function(r,a){return a instanceof dt&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((c,d,f)=>c&&$T(d,a.filters[f])),!0):!1})(n,e):void Ie()}function QT(n,e){const t=n.filters.concat(e);return dt.create(t,n.op)}function YT(n){return n instanceof Ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${zl(t.value)}`})(n):n instanceof dt?(function(t){return t.op.toString()+" {"+t.getFilters().map(YT).join(" ,")+"}"})(n):"Filter"}class gD extends Ze{constructor(e,t,r){super(e,t,r),this.key=Se.fromName(r.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class xD extends Ze{constructor(e,t){super(e,"in",t),this.keys=WT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class yD extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=WT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function WT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>Se.fromName(r.referenceValue)))}class bD extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ju(t)&&Xu(t.arrayValue,this.value)}}class XT extends Ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xu(this.value.arrayValue,t)}}class vD extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Xu(this.value.arrayValue,t)}}class _D extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ju(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Xu(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,t=null,r=[],a=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=c,this.startAt=d,this.endAt=f,this.ue=null}}function w0(n,e=null,t=[],r=[],a=null,c=null,d=null){return new wD(n,e,t,r,a,c,d)}function mo(n){const e=Ae(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>_0(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(c){return c.field.canonicalString()+c.dir})(r))).join(","),vd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>zl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>zl(r))).join(",")),e.ue=t}return e.ue}function _d(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!$T(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Hw(n.startAt,e.startAt)&&Hw(n.endAt,e.endAt)}function Of(n){return Se.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Vf(n,e){return n.filters.filter((t=>t instanceof Ze&&t.field.isEqual(e)))}function Gw(n,e,t){let r=wf,a=!0;for(const c of Vf(n,e)){let d=wf,f=!0;switch(c.op){case"<":case"<=":d=fD(c.value);break;case"==":case"in":case">=":d=c.value;break;case">":d=c.value,f=!1;break;case"!=":case"not-in":d=wf}qw({value:r,inclusive:a},{value:d,inclusive:f})<0&&(r=d,a=f)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const d=t.position[c];qw({value:r,inclusive:a},{value:d,inclusive:t.inclusive})<0&&(r=d,a=t.inclusive);break}}return{value:r,inclusive:a}}function Kw(n,e,t){let r=Xi,a=!0;for(const c of Vf(n,e)){let d=Xi,f=!0;switch(c.op){case">=":case">":d=mD(c.value),f=!1;break;case"==":case"in":case"<=":d=c.value;break;case"<":d=c.value,f=!1;break;case"!=":case"not-in":d=Xi}Bw({value:r,inclusive:a},{value:d,inclusive:f})>0&&(r=d,a=f)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const d=t.position[c];Bw({value:r,inclusive:a},{value:d,inclusive:t.inclusive})>0&&(r=d,a=t.inclusive);break}}return{value:r,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t=null,r=[],a=[],c=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=m,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function JT(n,e,t,r,a,c,d,f){return new ei(n,e,t,r,a,c,d,f)}function oc(n){return new ei(n)}function $w(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _x(n){return n.collectionGroup!==null}function Ol(n){const e=Ae(n);if(e.ce===null){e.ce=[];const t=new Set;for(const c of e.explicitOrderBy)e.ce.push(c),t.add(c.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new pt(Et.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((x=>{x.isInequality()&&(f=f.add(x.field))}))})),f})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.ce.push(new Zu(c,r))})),t.has(Et.keyField().canonicalString())||e.ce.push(new Zu(Et.keyField(),r))}return e.ce}function Fn(n){const e=Ae(n);return e.le||(e.le=ND(e,Ol(n))),e.le}function ND(n,e){if(n.limitType==="F")return w0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const c=a.dir==="desc"?"asc":"desc";return new Zu(a.field,c)}));const t=n.endAt?new oa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oa(n.startAt.position,n.startAt.inclusive):null;return w0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function N0(n,e){const t=n.filters.concat([e]);return new ei(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Lf(n,e,t){return new ei(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wd(n,e){return _d(Fn(n),Fn(e))&&n.limitType===e.limitType}function ZT(n){return`${mo(Fn(n))}|lt:${n.limitType}`}function Al(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>YT(a))).join(", ")}]`),vd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>zl(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>zl(a))).join(",")),`Target(${r})`})(Fn(n))}; limitType=${n.limitType})`}function Nd(n,e){return e.isFoundDocument()&&(function(r,a){const c=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(c):Se.isDocumentKey(r.path)?r.path.isEqual(c):r.path.isImmediateParentOf(c)})(n,e)&&(function(r,a){for(const c of Ol(r))if(!c.field.isKeyField()&&a.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const c of r.filters)if(!c.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(d,f,m){const x=zw(d,f,m);return d.inclusive?x<=0:x<0})(r.startAt,Ol(r),a)||r.endAt&&!(function(d,f,m){const x=zw(d,f,m);return d.inclusive?x>=0:x>0})(r.endAt,Ol(r),a))})(n,e)}function e2(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t2(n){return(e,t)=>{let r=!1;for(const a of Ol(n)){const c=TD(a,e,t);if(c!==0)return c;r=r||a.field.isKeyField()}return 0}}function TD(n,e,t){const r=n.field.isKeyField()?Se.comparator(e.key,t.key):(function(c,d,f){const m=d.data.field(c),x=f.data.field(c);return m!==null&&x!==null?aa(m,x):Ie()})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ie()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,c]of r)if(this.equalsFn(a,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let c=0;c<a.length;c++)if(this.equalsFn(a[c][0],e))return void(a[c]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){To(this.inner,((t,r)=>{for(const[a,c]of r)e(a,c)}))}isEmpty(){return FT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED=new yt(Se.comparator);function ts(){return ED}const n2=new yt(Se.comparator);function Su(...n){let e=n2;for(const t of n)e=e.insert(t.key,t);return e}function s2(n){let e=n2;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function lr(){return Mu()}function r2(){return Mu()}function Mu(){return new pa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const SD=new yt(Se.comparator),AD=new pt(Se.comparator);function He(...n){let e=AD;for(const t of n)e=e.add(t);return e}const ID=new pt(qe);function wx(){return ID}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yu(e)?"-0":e}}function i2(n){return{integerValue:""+n}}function a2(n,e){return PT(e)?i2(e):Nx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(){this._=void 0}}function jD(n,e,t){return n instanceof Gl?(function(a,c){const d={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return c&&um(c)&&(c=bx(c)),c&&(d.fields.__previous_value__=c),{mapValue:d}})(t,e):n instanceof po?l2(n,e):n instanceof go?c2(n,e):(function(a,c){const d=o2(a,c),f=Qw(d)+Qw(a.Pe);return b0(d)&&b0(a.Pe)?i2(f):Nx(a.serializer,f)})(n,e)}function RD(n,e,t){return n instanceof po?l2(n,e):n instanceof go?c2(n,e):t}function o2(n,e){return n instanceof Kl?(function(r){return b0(r)||(function(c){return!!c&&"doubleValue"in c})(r)})(e)?e:{integerValue:0}:null}class Gl extends hm{}class po extends hm{constructor(e){super(),this.elements=e}}function l2(n,e){const t=u2(e);for(const r of n.elements)t.some((a=>mr(a,r)))||t.push(r);return{arrayValue:{values:t}}}class go extends hm{constructor(e){super(),this.elements=e}}function c2(n,e){let t=u2(e);for(const r of n.elements)t=t.filter((a=>!mr(a,r)));return{arrayValue:{values:t}}}class Kl extends hm{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Qw(n){return Tt(n.integerValue||n.doubleValue)}function u2(n){return Ju(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,t){this.field=e,this.transform=t}}function CD(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof po&&a instanceof po||r instanceof go&&a instanceof go?Bl(r.elements,a.elements,mr):r instanceof Kl&&a instanceof Kl?mr(r.Pe,a.Pe):r instanceof Gl&&a instanceof Gl})(n.transform,e.transform)}class kD{constructor(e,t){this.version=e,this.transformResults=t}}class St{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new St}static exists(e){return new St(void 0,e)}static updateTime(e){return new St(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Tf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class fm{}function d2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cc(n.key,St.none()):new lc(n.key,n.data,St.none());{const t=n.data,r=wn.empty();let a=new pt(Et.comparator);for(let c of e.fields)if(!a.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?r.delete(c):r.set(c,d),a=a.add(c)}return new ti(n.key,r,new es(a.toArray()),St.none())}}function DD(n,e,t){n instanceof lc?(function(a,c,d){const f=a.value.clone(),m=Ww(a.fieldTransforms,c,d.transformResults);f.setAll(m),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ti?(function(a,c,d){if(!Tf(a.precondition,c))return void c.convertToUnknownDocument(d.version);const f=Ww(a.fieldTransforms,c,d.transformResults),m=c.data;m.setAll(h2(a)),m.setAll(f),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Pu(n,e,t,r){return n instanceof lc?(function(c,d,f,m){if(!Tf(c.precondition,d))return f;const x=c.value.clone(),y=Xw(c.fieldTransforms,m,d);return x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),null})(n,e,t,r):n instanceof ti?(function(c,d,f,m){if(!Tf(c.precondition,d))return f;const x=Xw(c.fieldTransforms,m,d),y=d.data;return y.setAll(h2(c)),y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(c,d,f){return Tf(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function MD(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),c=o2(r.transform,a||null);c!=null&&(t===null&&(t=wn.empty()),t.set(r.field,c))}return t||null}function Yw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Bl(r,a,((c,d)=>CD(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lc extends fm{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ti extends fm{constructor(e,t,r,a,c=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function h2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Ww(n,e,t){const r=new Map;Re(n.length===t.length);for(let a=0;a<t.length;a++){const c=n[a],d=c.transform,f=e.data.field(c.field);r.set(c.field,RD(d,f,t[a]))}return r}function Xw(n,e,t){const r=new Map;for(const a of n){const c=a.transform,d=t.data.field(a.field);r.set(a.field,jD(c,d,e))}return r}class cc extends fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Tx extends fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const c=this.mutations[a];c.key.isEqual(e.key)&&DD(c,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Pu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Pu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=r2();return this.mutations.forEach((a=>{const c=e.get(a.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(a.key)?null:f;const m=d2(d,f);m!==null&&r.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(De.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),He())}isEqual(e){return this.batchId===e.batchId&&Bl(this.mutations,e.mutations,((t,r)=>Yw(t,r)))&&Bl(this.baseMutations,e.baseMutations,((t,r)=>Yw(t,r)))}}class Sx{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Re(e.mutations.length===r.length);let a=(function(){return SD})();const c=e.mutations;for(let d=0;d<c.length;d++)a=a.insert(c[d].key,r[d].version);return new Sx(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,tt;function f2(n){switch(n){default:return Ie();case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0}}function m2(n){if(n===void 0)return zt("GRPC error has no .code"),re.UNKNOWN;switch(n){case Jt.OK:return re.OK;case Jt.CANCELLED:return re.CANCELLED;case Jt.UNKNOWN:return re.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return re.INTERNAL;case Jt.UNAVAILABLE:return re.UNAVAILABLE;case Jt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Jt.NOT_FOUND:return re.NOT_FOUND;case Jt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Jt.ABORTED:return re.ABORTED;case Jt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Jt.DATA_LOSS:return re.DATA_LOSS;default:return Ie()}}(tt=Jt||(Jt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=new oo([4294967295,4294967295],0);function Jw(n){const e=p2().encode(n),t=new _T;return t.update(e),new Uint8Array(t.digest())}function Zw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new oo([t,r],0),new oo([a,c],0)]}class Ix{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Au(`Invalid padding: ${t}`);if(r<0)throw new Au(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Au(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Au(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=oo.fromNumber(this.Ie)}Ee(e,t,r){let a=e.add(t.multiply(oo.fromNumber(r)));return a.compare(OD)===1&&(a=new oo([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Jw(e),[r,a]=Zw(t);for(let c=0;c<this.hashCount;c++){const d=this.Ee(r,a,c);if(!this.de(d))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Ix(c,a,t);return r.forEach((f=>d.insert(f))),d}insert(e){if(this.Ie===0)return;const t=Jw(e),[r,a]=Zw(t);for(let c=0;c<this.hashCount;c++){const d=this.Ee(r,a,c);this.Ae(d)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,r,a,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,Sd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ed(De.min(),a,new yt(qe),ts(),He())}}class Sd{constructor(e,t,r,a,c){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Sd(r,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t,r,a){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=a}}class g2{constructor(e,t){this.targetId=e,this.me=t}}class x2{constructor(e,t,r=Pt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class e1{constructor(){this.fe=0,this.ge=n1(),this.pe=Pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=He(),t=He(),r=He();return this.ge.forEach(((a,c)=>{switch(c){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:Ie()}})),new Sd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=n1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Re(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class VD{constructor(e){this.Le=e,this.Be=new Map,this.ke=ts(),this.qe=t1(),this.Qe=new yt(qe)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ie()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((r,a)=>{this.ze(a)&&t(a)}))}He(e){const t=e.targetId,r=e.me.count,a=this.Je(t);if(a){const c=a.target;if(Of(c))if(r===0){const d=new Se(c.path);this.Ue(t,d,wt.newNoDocument(d,De.min()))}else Re(r===1);else{const d=this.Ye(t);if(d!==r){const f=this.Ze(e),m=f?this.Xe(f,e,d):1;if(m!==0){this.je(t);const x=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,x)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:c=0}=t;let d,f;try{d=ra(r).toUint8Array()}catch(m){if(m instanceof qT)return fr("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Ix(d,a,c)}catch(m){return fr(m instanceof Au?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.Ie===0?null:f}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let a=0;return r.forEach((c=>{const d=this.Le.tt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.Ue(t,c,null),a++)})),a}rt(e){const t=new Map;this.Be.forEach(((c,d)=>{const f=this.Je(d);if(f){if(c.current&&Of(f.target)){const m=new Se(f.target.path);this.ke.get(m)!==null||this.it(d,m)||this.Ue(d,m,wt.newNoDocument(m,e))}c.be&&(t.set(d,c.ve()),c.Ce())}}));let r=He();this.qe.forEach(((c,d)=>{let f=!0;d.forEachWhile((m=>{const x=this.Je(m);return!x||x.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(r=r.add(c))})),this.ke.forEach(((c,d)=>d.setReadTime(e)));const a=new Ed(e,t,this.Qe,this.ke,r);return this.ke=ts(),this.qe=t1(),this.Qe=new yt(qe),a}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,t)?a.Fe(t,1):a.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new e1,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new pt(qe),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||xe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new e1),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function t1(){return new yt(Se.comparator)}function n1(){return new yt(Se.comparator)}const LD={asc:"ASCENDING",desc:"DESCENDING"},UD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FD={and:"AND",or:"OR"};class qD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function T0(n,e){return n.useProto3Json||vd(e)?e:{value:e}}function $l(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function y2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function BD(n,e){return $l(n,e.toTimestamp())}function Ht(n){return Re(!!n),De.fromTimestamp((function(t){const r=Wr(t);return new At(r.seconds,r.nanos)})(n))}function jx(n,e){return E0(n,e).canonicalString()}function E0(n,e){const t=(function(a){return new Je(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function b2(n){const e=Je.fromString(n);return Re(j2(e)),e}function ed(n,e){return jx(n.databaseId,e.path)}function ur(n,e){const t=b2(e);if(t.get(1)!==n.databaseId.projectId)throw new ge(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ge(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Se(w2(t))}function v2(n,e){return jx(n.databaseId,e)}function _2(n){const e=b2(n);return e.length===4?Je.emptyPath():w2(e)}function S0(n){return new Je(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function w2(n){return Re(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function s1(n,e,t){return{name:ed(n,e),fields:t.value.mapValue.fields}}function N2(n,e,t){const r=ur(n,e.name),a=Ht(e.updateTime),c=e.createTime?Ht(e.createTime):De.min(),d=new wn({mapValue:{fields:e.fields}}),f=wt.newFoundDocument(r,a,c,d);return t&&f.setHasCommittedMutations(),t?f.setHasCommittedMutations():f}function zD(n,e){return"found"in e?(function(r,a){Re(!!a.found),a.found.name,a.found.updateTime;const c=ur(r,a.found.name),d=Ht(a.found.updateTime),f=a.found.createTime?Ht(a.found.createTime):De.min(),m=new wn({mapValue:{fields:a.found.fields}});return wt.newFoundDocument(c,d,f,m)})(n,e):"missing"in e?(function(r,a){Re(!!a.missing),Re(!!a.readTime);const c=ur(r,a.missing),d=Ht(a.readTime);return wt.newNoDocument(c,d)})(n,e):Ie()}function HD(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(x){return x==="NO_CHANGE"?0:x==="ADD"?1:x==="REMOVE"?2:x==="CURRENT"?3:x==="RESET"?4:Ie()})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],c=(function(x,y){return x.useProto3Json?(Re(y===void 0||typeof y=="string"),Pt.fromBase64String(y||"")):(Re(y===void 0||y instanceof Buffer||y instanceof Uint8Array),Pt.fromUint8Array(y||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(x){const y=x.code===void 0?re.UNKNOWN:m2(x.code);return new ge(y,x.message||"")})(d);t=new x2(r,a,c,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=ur(n,r.document.name),c=Ht(r.document.updateTime),d=r.document.createTime?Ht(r.document.createTime):De.min(),f=new wn({mapValue:{fields:r.document.fields}}),m=wt.newFoundDocument(a,c,d,f),x=r.targetIds||[],y=r.removedTargetIds||[];t=new Ef(x,y,m.key,m)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=ur(n,r.document),c=r.readTime?Ht(r.readTime):De.min(),d=wt.newNoDocument(a,c),f=r.removedTargetIds||[];t=new Ef([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=ur(n,r.document),c=r.removedTargetIds||[];t=new Ef([],c,a,null)}else{if(!("filter"in e))return Ie();{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:c}=r,d=new PD(a,c),f=r.targetId;t=new g2(f,d)}}return t}function td(n,e){let t;if(e instanceof lc)t={update:s1(n,e.key,e.value)};else if(e instanceof cc)t={delete:ed(n,e.key)};else if(e instanceof ti)t={update:s1(n,e.key,e.data),updateMask:WD(e.fieldMask)};else{if(!(e instanceof Tx))return Ie();t={verify:ed(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(c,d){const f=d.transform;if(f instanceof Gl)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof po)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof go)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Kl)return{fieldPath:d.field.canonicalString(),increment:f.Pe};throw Ie()})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,c){return c.updateTime!==void 0?{updateTime:BD(a,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Ie()})(n,e.precondition)),t}function A0(n,e){const t=e.currentDocument?(function(c){return c.updateTime!==void 0?St.updateTime(Ht(c.updateTime)):c.exists!==void 0?St.exists(c.exists):St.none()})(e.currentDocument):St.none(),r=e.updateTransforms?e.updateTransforms.map((a=>(function(d,f){let m=null;if("setToServerValue"in f)Re(f.setToServerValue==="REQUEST_TIME"),m=new Gl;else if("appendMissingElements"in f){const y=f.appendMissingElements.values||[];m=new po(y)}else if("removeAllFromArray"in f){const y=f.removeAllFromArray.values||[];m=new go(y)}else"increment"in f?m=new Kl(d,f.increment):Ie();const x=Et.fromServerFormat(f.fieldPath);return new Td(x,m)})(n,a))):[];if(e.update){e.update.name;const a=ur(n,e.update.name),c=new wn({mapValue:{fields:e.update.fields}});if(e.updateMask){const d=(function(m){const x=m.fieldPaths||[];return new es(x.map((y=>Et.fromServerFormat(y))))})(e.updateMask);return new ti(a,c,d,t,r)}return new lc(a,c,t,r)}if(e.delete){const a=ur(n,e.delete);return new cc(a,t)}if(e.verify){const a=ur(n,e.verify);return new Tx(a,t)}return Ie()}function GD(n,e){return n&&n.length>0?(Re(e!==void 0),n.map((t=>(function(a,c){let d=a.updateTime?Ht(a.updateTime):Ht(c);return d.isEqual(De.min())&&(d=Ht(c)),new kD(d,a.transformResults||[])})(t,e)))):[]}function T2(n,e){return{documents:[v2(n,e.path)]}}function E2(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=v2(n,a);const c=(function(x){if(x.length!==0)return I2(dt.create(x,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(x){if(x.length!==0)return x.map((y=>(function(E){return{field:Il(E.field),direction:$D(E.dir)}})(y)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=T0(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(x){return{before:x.inclusive,values:x.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(x){return{before:!x.inclusive,values:x.position}})(e.endAt)),{_t:t,parent:a}}function S2(n){let e=_2(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Re(r===1);const y=t.from[0];y.allDescendants?a=y.collectionId:e=e.child(y.collectionId)}let c=[];t.where&&(c=(function(v){const E=A2(v);return E instanceof dt&&vx(E)?E.getFilters():[E]})(t.where));let d=[];t.orderBy&&(d=(function(v){return v.map((E=>(function(V){return new Zu(jl(V.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(E)))})(t.orderBy));let f=null;t.limit&&(f=(function(v){let E;return E=typeof v=="object"?v.value:v,vd(E)?null:E})(t.limit));let m=null;t.startAt&&(m=(function(v){const E=!!v.before,A=v.values||[];return new oa(A,E)})(t.startAt));let x=null;return t.endAt&&(x=(function(v){const E=!v.before,A=v.values||[];return new oa(A,E)})(t.endAt)),JT(e,a,d,c,f,"F",m,x)}function KD(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function A2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=jl(t.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=jl(t.unaryFilter.field);return Ze.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=jl(t.unaryFilter.field);return Ze.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=jl(t.unaryFilter.field);return Ze.create(d,"!=",{nullValue:"NULL_VALUE"});default:return Ie()}})(n):n.fieldFilter!==void 0?(function(t){return Ze.create(jl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ie()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return dt.create(t.compositeFilter.filters.map((r=>A2(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ie()}})(t.compositeFilter.op))})(n):Ie()}function $D(n){return LD[n]}function QD(n){return UD[n]}function YD(n){return FD[n]}function Il(n){return{fieldPath:n.canonicalString()}}function jl(n){return Et.fromServerFormat(n.fieldPath)}function I2(n){return n instanceof Ze?(function(t){if(t.op==="=="){if(Fw(t.value))return{unaryFilter:{field:Il(t.field),op:"IS_NAN"}};if(Uw(t.value))return{unaryFilter:{field:Il(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Fw(t.value))return{unaryFilter:{field:Il(t.field),op:"IS_NOT_NAN"}};if(Uw(t.value))return{unaryFilter:{field:Il(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Il(t.field),op:QD(t.op),value:t.value}}})(n):n instanceof dt?(function(t){const r=t.getFilters().map((a=>I2(a)));return r.length===1?r[0]:{compositeFilter:{op:YD(t.op),filters:r}}})(n):Ie()}function WD(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function j2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,t,r,a,c=De.min(),d=De.min(),f=Pt.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Kr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e){this.ct=e}}function XD(n,e){let t;if(e.document)t=N2(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Se.fromSegments(e.noDocument.path),a=yo(e.noDocument.readTime);t=wt.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ie();{const r=Se.fromSegments(e.unknownDocument.path),a=yo(e.unknownDocument.version);t=wt.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime((function(a){const c=new At(a[0],a[1]);return De.fromTimestamp(c)})(e.readTime)),t}function r1(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Uf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(c,d){return{name:ed(c,d.key),fields:d.data.value.mapValue.fields,updateTime:$l(c,d.version.toTimestamp()),createTime:$l(c,d.createTime.toTimestamp())}})(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:xo(e.version)};else{if(!e.isUnknownDocument())return Ie();r.unknownDocument={path:t.path.toArray(),version:xo(e.version)}}return r}function Uf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function xo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yo(n){const e=new At(n.seconds,n.nanoseconds);return De.fromTimestamp(e)}function Ja(n,e){const t=(e.baseMutations||[]).map((c=>A0(n.ct,c)));for(let c=0;c<e.mutations.length-1;++c){const d=e.mutations[c];if(c+1<e.mutations.length&&e.mutations[c+1].transform!==void 0){const f=e.mutations[c+1];d.updateTransforms=f.transform.fieldTransforms,e.mutations.splice(c+1,1),++c}}const r=e.mutations.map((c=>A0(n.ct,c))),a=At.fromMillis(e.localWriteTimeMs);return new Ex(e.batchId,a,t,r)}function Iu(n){const e=yo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?yo(n.lastLimboFreeSnapshotVersion):De.min();let r;return r=(function(c){return c.documents!==void 0})(n.query)?(function(c){return Re(c.documents.length===1),Fn(oc(_2(c.documents[0])))})(n.query):(function(c){return Fn(S2(c))})(n.query),new Kr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Pt.fromBase64String(n.resumeToken))}function C2(n,e){const t=xo(e.snapshotVersion),r=xo(e.lastLimboFreeSnapshotVersion);let a;a=Of(e.target)?T2(n.ct,e.target):E2(n.ct,e.target)._t;const c=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:mo(e.target),readTime:t,resumeToken:c,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function Rx(n){const e=S2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Lf(e,e.limit,"L"):e}function Xg(n,e){return new Ax(e.largestBatchId,A0(n.ct,e.overlayMutation))}function i1(n,e){const t=e.path.lastSegment();return[n,Un(e.path.popLast()),t]}function a1(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:xo(r.readTime),documentKey:Un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{getBundleMetadata(e,t){return o1(e).get(t).next((r=>{if(r)return(function(c){return{id:c.bundleId,createTime:yo(c.createTime),version:c.version}})(r)}))}saveBundleMetadata(e,t){return o1(e).put((function(a){return{bundleId:a.id,createTime:xo(Ht(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return l1(e).get(t).next((r=>{if(r)return(function(c){return{name:c.name,query:Rx(c.bundledQuery),readTime:yo(c.readTime)}})(r)}))}saveNamedQuery(e,t){return l1(e).put((function(a){return{name:a.name,readTime:xo(Ht(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function o1(n){return an(n,"bundles")}function l1(n){return an(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new mm(e,r)}getOverlay(e,t){return gu(e).get(i1(this.userId,t)).next((r=>r?Xg(this.serializer,r):null))}getOverlays(e,t){const r=lr();return Z.forEach(t,(a=>this.getOverlay(e,a).next((c=>{c!==null&&r.set(a,c)})))).next((()=>r))}saveOverlays(e,t,r){const a=[];return r.forEach(((c,d)=>{const f=new Ax(t,d);a.push(this.ht(e,f))})),Z.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach((d=>a.add(Un(d.getCollectionPath()))));const c=[];return a.forEach((d=>{const f=IDBKeyRange.bound([this.userId,d,r],[this.userId,d,r+1],!1,!0);c.push(gu(e).j("collectionPathOverlayIndex",f))})),Z.waitFor(c)}getOverlaysForCollection(e,t,r){const a=lr(),c=Un(t),d=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,Number.POSITIVE_INFINITY],!0);return gu(e).U("collectionPathOverlayIndex",d).next((f=>{for(const m of f){const x=Xg(this.serializer,m);a.set(x.getKey(),x)}return a}))}getOverlaysForCollectionGroup(e,t,r,a){const c=lr();let d;const f=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gu(e).J({index:"collectionGroupOverlayIndex",range:f},((m,x,y)=>{const v=Xg(this.serializer,x);c.size()<a||v.largestBatchId===d?(c.set(v.getKey(),v),d=v.largestBatchId):y.done()})).next((()=>c))}ht(e,t){return gu(e).put((function(a,c,d){const[f,m,x]=i1(c,d.mutation.key);return{userId:c,collectionPath:m,documentId:x,collectionGroup:d.mutation.key.getCollectionGroup(),largestBatchId:d.largestBatchId,overlayMutation:td(a.ct,d.mutation)}})(this.serializer,this.userId,t))}}function gu(n){return an(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{Pt(e){return an(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?Pt.fromUint8Array(r):Pt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Tt(e.integerValue));else if("doubleValue"in e){const r=Tt(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Yu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Wr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ra(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?BT(e)?this.dt(t,Number.MAX_SAFE_INTEGER):dm(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ie()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const a of Object.keys(r))this.Vt(a,t),this.Tt(r[a],t)}wt(e,t){var r,a;const c=e.fields||{};this.dt(t,53);const d="value",f=((a=(r=c[d].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.length)||0;this.dt(t,15),t.At(Tt(f)),this.Vt(d,t),this.Tt(c[d],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const a of r)this.Tt(a,t)}yt(e,t){this.dt(t,37),Se.fromName(e).path.forEach((r=>{this.dt(t,60),this.Dt(r,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Za.vt=new Za;function e4(n){if(n===0)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function c1(n){const e=64-(function(r){let a=0;for(let c=0;c<8;++c){const d=e4(255&r[c]);if(a+=d,d!==8)break}return a})(n);return Math.ceil(e/8)}class t4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const a=t.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const a=t.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const t=this.qt(e),r=c1(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}Kt(e){const t=this.qt(e),r=c1(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=(function(c){const d=new DataView(new ArrayBuffer(8));return d.setFloat64(0,c,!1),new Uint8Array(d.buffer)})(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class n4{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class s4{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class xu{constructor(){this.jt=new t4,this.Ht=new n4(this.jt),this.Jt=new s4(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t,r,a){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=a}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new eo(this.indexId,this.documentKey,this.arrayValue,r)}}function Gi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=u1(n.arrayValue,e.arrayValue),t!==0?t:(t=u1(n.directionalValue,e.directionalValue),t!==0?t:Se.comparator(n.documentKey,e.documentKey)))}function u1(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.Xt=new pt(((t,r)=>Et.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Re(e.collectionGroup===this.collectionId),this.nn)return!1;const t=g0(e);if(t!==void 0&&!this.sn(t))return!1;const r=Wa(e);let a=new Set,c=0,d=0;for(;c<r.length&&this.sn(r[c]);++c)a=a.add(r[c].fieldPath.canonicalString());if(c===r.length)return!0;if(this.Xt.size>0){const f=this.Xt.getIterator().getNext();if(!a.has(f.field.canonicalString())){const m=r[c];if(!this.on(f,m)||!this._n(this.en[d++],m))return!1}++c}for(;c<r.length;++c){const f=r[c];if(d>=this.en.length||!this._n(this.en[d++],f))return!1}return!0}an(){if(this.nn)return null;let e=new pt(Et.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new vf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new vf(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new vf(r.field,r.dir==="asc"?0:1)));return new Pf(Pf.UNKNOWN_ID,this.collectionId,t,Qu.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(n){var e,t;if(Re(n instanceof Ze||n instanceof dt),n instanceof Ze){if(n instanceof XT){const a=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((c=>Ze.create(n.field,"==",c))))||[];return dt.create(a,"or")}return n}const r=n.filters.map((a=>k2(a)));return dt.create(r,n.op)}function r4(n){if(n.getFilters().length===0)return[];const e=R0(k2(n));return Re(D2(e)),I0(e)||j0(e)?[e]:e.getFilters()}function I0(n){return n instanceof Ze}function j0(n){return n instanceof dt&&vx(n)}function D2(n){return I0(n)||j0(n)||(function(t){if(t instanceof dt&&v0(t)){for(const r of t.getFilters())if(!I0(r)&&!j0(r))return!1;return!0}return!1})(n)}function R0(n){if(Re(n instanceof Ze||n instanceof dt),n instanceof Ze)return n;if(n.filters.length===1)return R0(n.filters[0]);const e=n.filters.map((r=>R0(r)));let t=dt.create(e,n.op);return t=Ff(t),D2(t)?t:(Re(t instanceof dt),Re(Hl(t)),Re(t.filters.length>1),t.filters.reduce(((r,a)=>Cx(r,a))))}function Cx(n,e){let t;return Re(n instanceof Ze||n instanceof dt),Re(e instanceof Ze||e instanceof dt),t=n instanceof Ze?e instanceof Ze?(function(a,c){return dt.create([a,c],"and")})(n,e):h1(n,e):e instanceof Ze?h1(e,n):(function(a,c){if(Re(a.filters.length>0&&c.filters.length>0),Hl(a)&&Hl(c))return QT(a,c.getFilters());const d=v0(a)?a:c,f=v0(a)?c:a,m=d.filters.map((x=>Cx(x,f)));return dt.create(m,"or")})(n,e),Ff(t)}function h1(n,e){if(Hl(e))return QT(e,n.getFilters());{const t=e.filters.map((r=>Cx(n,r)));return dt.create(t,"or")}}function Ff(n){if(Re(n instanceof Ze||n instanceof dt),n instanceof Ze)return n;const e=n.getFilters();if(e.length===1)return Ff(e[0]);if(KT(n))return n;const t=e.map((a=>Ff(a))),r=[];return t.forEach((a=>{a instanceof Ze?r.push(a):a instanceof dt&&(a.op===n.op?r.push(...a.filters):r.push(a))})),r.length===1?r[0]:dt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(){this.un=new kx}addToCollectionParentIndex(e,t){return this.un.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(gs.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(gs.min())}updateCollectionGroup(e,t,r){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class kx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new pt(Je.comparator),c=!a.has(r);return this.index[t]=a.add(r),c}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new pt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of=new Uint8Array(0);class a4{constructor(e,t){this.databaseId=t,this.cn=new kx,this.ln=new pa((r=>mo(r)),((r,a)=>_d(r,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const c={collectionId:r,parent:Un(a)};return f1(e).put(c)}return Z.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[jT(t),""],!1,!0);return f1(e).U(a).next((c=>{for(const d of c){if(d.collectionId!==t)break;r.push(or(d.parent))}return r}))}addFieldIndex(e,t){const r=yu(e),a=(function(f){return{indexId:f.indexId,collectionGroup:f.collectionGroup,fields:f.fields.map((m=>[m.fieldPath.canonicalString(),m.kind]))}})(t);delete a.indexId;const c=r.add(a);if(t.indexState){const d=wl(e);return c.next((f=>{d.put(a1(f,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return c.next()}deleteFieldIndex(e,t){const r=yu(e),a=wl(e),c=_l(e);return r.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>c.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=yu(e),r=_l(e),a=wl(e);return t.j().next((()=>r.j())).next((()=>a.j()))}createTargetIndexes(e,t){return Z.forEach(this.hn(t),(r=>this.getIndexType(e,r).next((a=>{if(a===0||a===1){const c=new d1(r).an();if(c!=null)return this.addFieldIndex(e,c)}}))))}getDocumentsMatchingTarget(e,t){const r=_l(e);let a=!0;const c=new Map;return Z.forEach(this.hn(t),(d=>this.Pn(e,d).next((f=>{a&&(a=!!f),c.set(d,f)})))).next((()=>{if(a){let d=He();const f=[];return Z.forEach(c,((m,x)=>{xe("IndexedDbIndexManager",`Using index ${(function(K){return`id=${K.indexId}|cg=${K.collectionGroup}|f=${K.fields.map((ee=>`${ee.fieldPath}:${ee.kind}`)).join(",")}`})(m)} to execute ${mo(t)}`);const y=(function(K,ee){const B=g0(ee);if(B===void 0)return null;for(const Q of Vf(K,B.fieldPath))switch(Q.op){case"array-contains-any":return Q.value.arrayValue.values||[];case"array-contains":return[Q.value]}return null})(x,m),v=(function(K,ee){const B=new Map;for(const Q of Wa(ee))for(const j of Vf(K,Q.fieldPath))switch(j.op){case"==":case"in":B.set(Q.fieldPath.canonicalString(),j.value);break;case"not-in":case"!=":return B.set(Q.fieldPath.canonicalString(),j.value),Array.from(B.values())}return null})(x,m),E=(function(K,ee){const B=[];let Q=!0;for(const j of Wa(ee)){const T=j.kind===0?Gw(K,j.fieldPath,K.startAt):Kw(K,j.fieldPath,K.startAt);B.push(T.value),Q&&(Q=T.inclusive)}return new oa(B,Q)})(x,m),A=(function(K,ee){const B=[];let Q=!0;for(const j of Wa(ee)){const T=j.kind===0?Kw(K,j.fieldPath,K.endAt):Gw(K,j.fieldPath,K.endAt);B.push(T.value),Q&&(Q=T.inclusive)}return new oa(B,Q)})(x,m),V=this.In(m,x,E),C=this.In(m,x,A),O=this.Tn(m,x,v),z=this.En(m.indexId,y,V,E.inclusive,C,A.inclusive,O);return Z.forEach(z,(ae=>r.G(ae,t.limit).next((K=>{K.forEach((ee=>{const B=Se.fromSegments(ee.documentKey);d.has(B)||(d=d.add(B),f.push(B))}))}))))})).next((()=>f))}return Z.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=r4(dt.create(e.filters,"and")).map((r=>w0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,r,a,c,d,f){const m=(t!=null?t.length:1)*Math.max(r.length,c.length),x=m/(t!=null?t.length:1),y=[];for(let v=0;v<m;++v){const E=t?this.dn(t[v/x]):of,A=this.An(e,E,r[v%x],a),V=this.Rn(e,E,c[v%x],d),C=f.map((O=>this.An(e,E,O,!0)));y.push(...this.createRange(A,V,C))}return y}An(e,t,r,a){const c=new eo(e,Se.empty(),t,r);return a?c:c.Zt()}Rn(e,t,r,a){const c=new eo(e,Se.empty(),t,r);return a?c.Zt():c}Pn(e,t){const r=new d1(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((c=>{let d=null;for(const f of c)r.rn(f)&&(!d||f.fields.length>d.fields.length)&&(d=f);return d}))}getIndexType(e,t){let r=2;const a=this.hn(t);return Z.forEach(a,(c=>this.Pn(e,c).next((d=>{d?r!==0&&d.fields.length<(function(m){let x=new pt(Et.comparator),y=!1;for(const v of m.filters)for(const E of v.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?y=!0:x=x.add(E.field));for(const v of m.orderBy)v.field.isKeyField()||(x=x.add(v.field));return x.size+(y?1:0)})(c)&&(r=1):r=0})))).next((()=>(function(d){return d.limit!==null})(t)&&a.length>1&&r===2?1:r))}Vn(e,t){const r=new xu;for(const a of Wa(e)){const c=t.data.field(a.fieldPath);if(c==null)return null;const d=r.Yt(a.kind);Za.vt.It(c,d)}return r.zt()}dn(e){const t=new xu;return Za.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new xu;return Za.vt.It(fo(this.databaseId,t),r.Yt((function(c){const d=Wa(c);return d.length===0?0:d[d.length-1].kind})(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let a=[];a.push(new xu);let c=0;for(const d of Wa(e)){const f=r[c++];for(const m of a)if(this.fn(t,d.fieldPath)&&Ju(f))a=this.gn(a,d,f);else{const x=m.Yt(d.kind);Za.vt.It(f,x)}}return this.pn(a)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const a=[...e],c=[];for(const d of r.arrayValue.values||[])for(const f of a){const m=new xu;m.seed(f.zt()),Za.vt.It(d,m.Yt(t.kind)),c.push(m)}return c}fn(e,t){return!!e.filters.find((r=>r instanceof Ze&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=yu(e),a=wl(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next((c=>{const d=[];return Z.forEach(c,(f=>a.get([f.indexId,this.uid]).next((m=>{d.push((function(y,v){const E=v?new Qu(v.sequenceNumber,new gs(yo(v.readTime),new Se(or(v.documentKey)),v.largestBatchId)):Qu.empty(),A=y.fields.map((([V,C])=>new vf(Et.fromServerFormat(V),C)));return new Pf(y.indexId,y.collectionGroup,A,E)})(f,m))})))).next((()=>d))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,a)=>{const c=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return c!==0?c:qe(r.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const a=yu(e),c=wl(e);return this.yn(e).next((d=>a.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((f=>Z.forEach(f,(m=>c.put(a1(m.indexId,this.uid,d,r))))))))}updateIndexEntries(e,t){const r=new Map;return Z.forEach(t,((a,c)=>{const d=r.get(a.collectionGroup);return(d?Z.resolve(d):this.getFieldIndexes(e,a.collectionGroup)).next((f=>(r.set(a.collectionGroup,f),Z.forEach(f,(m=>this.wn(e,a,m).next((x=>{const y=this.Sn(c,m);return x.isEqual(y)?Z.resolve():this.bn(e,c,m,x,y)})))))))}))}Dn(e,t,r,a){return _l(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,a){return _l(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const a=_l(e);let c=new pt(Gi);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},((d,f)=>{c=c.add(new eo(r.indexId,t,f.arrayValue,f.directionalValue))})).next((()=>c))}Sn(e,t){let r=new pt(Gi);const a=this.Vn(t,e);if(a==null)return r;const c=g0(t);if(c!=null){const d=e.data.field(c.fieldPath);if(Ju(d))for(const f of d.arrayValue.values||[])r=r.add(new eo(t.indexId,e.key,this.dn(f),a))}else r=r.add(new eo(t.indexId,e.key,of,a));return r}bn(e,t,r,a,c){xe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const d=[];return(function(m,x,y,v,E){const A=m.getIterator(),V=x.getIterator();let C=vl(A),O=vl(V);for(;C||O;){let z=!1,ae=!1;if(C&&O){const K=y(C,O);K<0?ae=!0:K>0&&(z=!0)}else C!=null?ae=!0:z=!0;z?(v(O),O=vl(V)):ae?(E(C),C=vl(A)):(C=vl(A),O=vl(V))}})(a,c,Gi,(f=>{d.push(this.Dn(e,t,r,f))}),(f=>{d.push(this.vn(e,t,r,f))})),Z.waitFor(d)}yn(e){let t=1;return wl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,a,c)=>{c.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((d,f)=>Gi(d,f))).filter(((d,f,m)=>!f||Gi(d,m[f-1])!==0));const a=[];a.push(e);for(const d of r){const f=Gi(d,e),m=Gi(d,t);if(f===0)a[0]=e.Zt();else if(f>0&&m<0)a.push(d),a.push(d.Zt());else if(m>0)break}a.push(t);const c=[];for(let d=0;d<a.length;d+=2){if(this.Cn(a[d],a[d+1]))return[];const f=[a[d].indexId,this.uid,a[d].arrayValue,a[d].directionalValue,of,[]],m=[a[d+1].indexId,this.uid,a[d+1].arrayValue,a[d+1].directionalValue,of,[]];c.push(IDBKeyRange.bound(f,m))}return c}Cn(e,t){return Gi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(m1)}getMinOffset(e,t){return Z.mapArray(this.hn(t),(r=>this.Pn(e,r).next((a=>a||Ie())))).next(m1)}}function f1(n){return an(n,"collectionParents")}function _l(n){return an(n,"indexEntries")}function yu(n){return an(n,"indexConfiguration")}function wl(n){return an(n,"indexState")}function m1(n){Re(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const a=n[r].indexState.offset;gx(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new gs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Jn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(n,e,t){const r=n.store("mutations"),a=n.store("documentMutations"),c=[],d=IDBKeyRange.only(t.batchId);let f=0;const m=r.J({range:d},((y,v,E)=>(f++,E.delete())));c.push(m.next((()=>{Re(f===1)})));const x=[];for(const y of t.mutations){const v=OT(e,y.key.path,t.batchId);c.push(a.delete(v)),x.push(y.key)}return Z.waitFor(c).next((()=>x))}function qf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ie();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(41943040,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class pm{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Fn={}}static lt(e,t,r,a){Re(e.uid!=="");const c=e.isAuthenticated()?e.uid:"";return new pm(c,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ki(e).J({index:"userMutationsIndex",range:r},((a,c,d)=>{t=!1,d.done()})).next((()=>t))}addMutationBatch(e,t,r,a){const c=Rl(e),d=Ki(e);return d.add({}).next((f=>{Re(typeof f=="number");const m=new Ex(f,t,r,a),x=(function(A,V,C){const O=C.baseMutations.map((ae=>td(A.ct,ae))),z=C.mutations.map((ae=>td(A.ct,ae)));return{userId:V,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:O,mutations:z}})(this.serializer,this.userId,m),y=[];let v=new pt(((E,A)=>qe(E.canonicalString(),A.canonicalString())));for(const E of a){const A=OT(this.userId,E.key.path,f);v=v.add(E.key.path.popLast()),y.push(d.put(x)),y.push(c.put(A,K5))}return v.forEach((E=>{y.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Fn[f]=m.keys()})),Z.waitFor(y).next((()=>m))}))}lookupMutationBatch(e,t){return Ki(e).get(t).next((r=>r?(Re(r.userId===this.userId),Ja(this.serializer,r)):null))}Mn(e,t){return this.Fn[t]?Z.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const a=r.keys();return this.Fn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let c=null;return Ki(e).J({index:"userMutationsIndex",range:a},((d,f,m)=>{f.userId===this.userId&&(Re(f.batchId>=r),c=Ja(this.serializer,f)),m.done()})).next((()=>c))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ki(e).J({index:"userMutationsIndex",range:t,reverse:!0},((a,c,d)=>{r=c.batchId,d.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ki(e).U("userMutationsIndex",t).next((r=>r.map((a=>Ja(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=_f(this.userId,t.path),a=IDBKeyRange.lowerBound(r),c=[];return Rl(e).J({range:a},((d,f,m)=>{const[x,y,v]=d,E=or(y);if(x===this.userId&&t.path.isEqual(E))return Ki(e).get(v).next((A=>{if(!A)throw Ie();Re(A.userId===this.userId),c.push(Ja(this.serializer,A))}));m.done()})).next((()=>c))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pt(qe);const a=[];return t.forEach((c=>{const d=_f(this.userId,c.path),f=IDBKeyRange.lowerBound(d),m=Rl(e).J({range:f},((x,y,v)=>{const[E,A,V]=x,C=or(A);E===this.userId&&c.path.isEqual(C)?r=r.add(V):v.done()}));a.push(m)})),Z.waitFor(a).next((()=>this.xn(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,c=_f(this.userId,r),d=IDBKeyRange.lowerBound(c);let f=new pt(qe);return Rl(e).J({range:d},((m,x,y)=>{const[v,E,A]=m,V=or(E);v===this.userId&&r.isPrefixOf(V)?V.length===a&&(f=f.add(A)):y.done()})).next((()=>this.xn(e,f)))}xn(e,t){const r=[],a=[];return t.forEach((c=>{a.push(Ki(e).get(c).next((d=>{if(d===null)throw Ie();Re(d.userId===this.userId),r.push(Ja(this.serializer,d))})))})),Z.waitFor(a).next((()=>r))}removeMutationBatch(e,t){return M2(e._e,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),Z.forEach(r,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const r=IDBKeyRange.lowerBound((function(d){return[d]})(this.userId)),a=[];return Rl(e).J({range:r},((c,d,f)=>{if(c[0]===this.userId){const m=or(c[1]);a.push(m)}else f.done()})).next((()=>{Re(a.length===0)}))}))}containsKey(e,t){return P2(e,this.userId,t)}Nn(e){return O2(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function P2(n,e,t){const r=_f(e,t.path),a=r[1],c=IDBKeyRange.lowerBound(r);let d=!1;return Rl(n).J({range:c,H:!0},((f,m,x)=>{const[y,v,E]=f;y===e&&v===a&&(d=!0),x.done()})).next((()=>d))}function Ki(n){return an(n,"mutations")}function Rl(n){return an(n,"documentMutations")}function O2(n){return an(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new bo(0)}static kn(){return new bo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const r=new bo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((t=>De.fromTimestamp(new At(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.qn(e).next((a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.Qn(e,a))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nl(e).delete(t.targetId))).next((()=>this.qn(e))).next((r=>(Re(r.targetCount>0),r.targetCount-=1,this.Qn(e,r))))}removeTargets(e,t,r){let a=0;const c=[];return Nl(e).J(((d,f)=>{const m=Iu(f);m.sequenceNumber<=t&&r.get(m.targetId)===null&&(a++,c.push(this.removeTargetData(e,m)))})).next((()=>Z.waitFor(c))).next((()=>a))}forEachTarget(e,t){return Nl(e).J(((r,a)=>{const c=Iu(a);t(c)}))}qn(e){return g1(e).get("targetGlobalKey").next((t=>(Re(t!==null),t)))}Qn(e,t){return g1(e).put("targetGlobalKey",t)}Kn(e,t){return Nl(e).put(C2(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next((t=>t.targetCount))}getTargetData(e,t){const r=mo(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let c=null;return Nl(e).J({range:a,index:"queryTargetsIndex"},((d,f,m)=>{const x=Iu(f);_d(t,x.target)&&(c=x,m.done())})).next((()=>c))}addMatchingKeys(e,t,r){const a=[],c=Qi(e);return t.forEach((d=>{const f=Un(d.path);a.push(c.put({targetId:r,path:f})),a.push(this.referenceDelegate.addReference(e,r,d))})),Z.waitFor(a)}removeMatchingKeys(e,t,r){const a=Qi(e);return Z.forEach(t,(c=>{const d=Un(c.path);return Z.waitFor([a.delete([r,d]),this.referenceDelegate.removeReference(e,r,c)])}))}removeMatchingKeysForTargetId(e,t){const r=Qi(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=Qi(e);let c=He();return a.J({range:r,H:!0},((d,f,m)=>{const x=or(d[1]),y=new Se(x);c=c.add(y)})).next((()=>c))}containsKey(e,t){const r=Un(t.path),a=IDBKeyRange.bound([r],[jT(r)],!1,!0);let c=0;return Qi(e).J({index:"documentTargetsIndex",H:!0,range:a},(([d,f],m,x)=>{d!==0&&(c++,x.done())})).next((()=>c>0))}ot(e,t){return Nl(e).get(t).next((r=>r?Iu(r):null))}}function Nl(n){return an(n,"targets")}function g1(n){return an(n,"targetGlobal")}function Qi(n){return an(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1([n,e],[t,r]){const a=qe(n,t);return a===0?qe(e,r):a}class l4{constructor(e){this.Un=e,this.buffer=new pt(x1),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();x1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class c4{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){xe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ma(t)?xe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await fa(t)}await this.Hn(3e5)}))}}class u4{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(Zn.oe);const r=new l4(t);return this.Jn.forEachTarget(e,(a=>r.zn(a.sequenceNumber))).next((()=>this.Jn.Zn(e,(a=>r.zn(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(xe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(p1)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),p1):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,a,c,d,f,m,x;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,d=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(r=v,f=Date.now(),this.removeTargets(e,r,t)))).next((v=>(c=v,m=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(x=Date.now(),Sl()<=Ye.DEBUG&&xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${c} targets in `+(m-f)+`ms
	Removed ${v} documents in `+(x-m)+`ms
Total Duration: ${x-y}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:c,documentsRemoved:v}))))}}function d4(n,e){return new u4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,t){this.db=e,this.garbageCollector=d4(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}er(e){let t=0;return this.Zn(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((r,a)=>t(a)))}addReference(e,t,r){return lf(e,r)}removeReference(e,t,r){return lf(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return lf(e,t)}nr(e,t){return(function(a,c){let d=!1;return O2(a).Y((f=>P2(a,f,c).next((m=>(m&&(d=!0),Z.resolve(!m)))))).next((()=>d))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let c=0;return this.tr(e,((d,f)=>{if(f<=t){const m=this.nr(e,d).next((x=>{if(!x)return c++,r.getEntry(e,d).next((()=>(r.removeEntry(d,De.min()),Qi(e).delete((function(v){return[0,Un(v.path)]})(d)))))}));a.push(m)}})).next((()=>Z.waitFor(a))).next((()=>r.apply(e))).next((()=>c))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return lf(e,t)}tr(e,t){const r=Qi(e);let a,c=Zn.oe;return r.J({index:"documentTargetsIndex"},(([d,f],{path:m,sequenceNumber:x})=>{d===0?(c!==Zn.oe&&t(new Se(or(a)),c),c=x,a=m):c=Zn.oe})).next((()=>{c!==Zn.oe&&t(new Se(or(a)),c)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lf(n,e){return Qi(n).put((function(r,a){return{targetId:0,path:Un(r.path),sequenceNumber:a}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(){this.changes=new pa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ka(e).put(r)}removeEntry(e,t,r){return Ka(e).delete((function(c,d){const f=c.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],Uf(d),f[f.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.rr(e,r))))}getEntry(e,t){let r=wt.newInvalidDocument(t);return Ka(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(bu(t))},((a,c)=>{r=this.ir(t,c)})).next((()=>r))}sr(e,t){let r={size:0,document:wt.newInvalidDocument(t)};return Ka(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(bu(t))},((a,c)=>{r={document:this.ir(t,c),size:qf(c)}})).next((()=>r))}getEntries(e,t){let r=ts();return this._r(e,t,((a,c)=>{const d=this.ir(a,c);r=r.insert(a,d)})).next((()=>r))}ar(e,t){let r=ts(),a=new yt(Se.comparator);return this._r(e,t,((c,d)=>{const f=this.ir(c,d);r=r.insert(c,f),a=a.insert(c,qf(d))})).next((()=>({documents:r,ur:a})))}_r(e,t,r){if(t.isEmpty())return Z.resolve();let a=new pt(v1);t.forEach((m=>a=a.add(m)));const c=IDBKeyRange.bound(bu(a.first()),bu(a.last())),d=a.getIterator();let f=d.getNext();return Ka(e).J({index:"documentKeyIndex",range:c},((m,x,y)=>{const v=Se.fromSegments([...x.prefixPath,x.collectionGroup,x.documentId]);for(;f&&v1(f,v)<0;)r(f,null),f=d.getNext();f&&f.isEqual(v)&&(r(f,x),f=d.hasNext()?d.getNext():null),f?y.$(bu(f)):y.done()})).next((()=>{for(;f;)r(f,null),f=d.hasNext()?d.getNext():null}))}getDocumentsMatchingQuery(e,t,r,a,c){const d=t.path,f=[d.popLast().toArray(),d.lastSegment(),Uf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],m=[d.popLast().toArray(),d.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ka(e).U(IDBKeyRange.bound(f,m,!0)).next((x=>{c==null||c.incrementDocumentReadCount(x.length);let y=ts();for(const v of x){const E=this.ir(Se.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);E.isFoundDocument()&&(Nd(t,E)||a.has(E.key))&&(y=y.insert(E.key,E))}return y}))}getAllFromCollectionGroup(e,t,r,a){let c=ts();const d=b1(t,r),f=b1(t,gs.max());return Ka(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(d,f,!0)},((m,x,y)=>{const v=this.ir(Se.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);c=c.insert(v.key,v),c.size===a&&y.done()})).next((()=>c))}newChangeBuffer(e){return new m4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return y1(e).get("remoteDocumentGlobalKey").next((t=>(Re(!!t),t)))}rr(e,t){return y1(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=XD(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(De.min())))return r}return wt.newInvalidDocument(e)}}function L2(n){return new f4(n)}class m4 extends V2{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new pa((r=>r.toString()),((r,a)=>r.isEqual(a)))}applyChanges(e){const t=[];let r=0,a=new pt(((c,d)=>qe(c.canonicalString(),d.canonicalString())));return this.changes.forEach(((c,d)=>{const f=this.lr.get(c);if(t.push(this.cr.removeEntry(e,c,f.readTime)),d.isValidDocument()){const m=r1(this.cr.serializer,d);a=a.add(c.path.popLast());const x=qf(m);r+=x-f.size,t.push(this.cr.addEntry(e,c,m))}else if(r-=f.size,this.trackRemovals){const m=r1(this.cr.serializer,d.convertToNoDocument(De.min()));t.push(this.cr.addEntry(e,c,m))}})),a.forEach((c=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,c))})),t.push(this.cr.updateMetadata(e,r)),Z.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:r,ur:a})=>(a.forEach(((c,d)=>{this.lr.set(c,{size:d,readTime:r.get(c).readTime})})),r)))}}function y1(n){return an(n,"remoteDocumentGlobal")}function Ka(n){return an(n,"remoteDocumentsV14")}function bu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function b1(n,e){const t=e.documentKey.path.toArray();return[n,Uf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function v1(n,e){const t=n.path.toArray(),r=e.path.toArray();let a=0;for(let c=0;c<t.length-2&&c<r.length-2;++c)if(a=qe(t[c],r[c]),a)return a;return a=qe(t.length,r.length),a||(a=qe(t[t.length-2],r[r.length-2]),a||qe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&Pu(r.mutation,a,es.empty(),At.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,He()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=He()){const a=lr();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((c=>{let d=Su();return c.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const r=lr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,He())))}populateOverlays(e,t,r){const a=[];return r.forEach((c=>{t.has(c)||a.push(c)})),this.documentOverlayCache.getOverlays(e,a).next((c=>{c.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,r,a){let c=ts();const d=Mu(),f=(function(){return Mu()})();return t.forEach(((m,x)=>{const y=r.get(x.key);a.has(x.key)&&(y===void 0||y.mutation instanceof ti)?c=c.insert(x.key,x):y!==void 0?(d.set(x.key,y.mutation.getFieldMask()),Pu(y.mutation,x,y.mutation.getFieldMask(),At.now())):d.set(x.key,es.empty())})),this.recalculateAndSaveOverlays(e,c).next((m=>(m.forEach(((x,y)=>d.set(x,y))),t.forEach(((x,y)=>{var v;return f.set(x,new p4(y,(v=d.get(x))!==null&&v!==void 0?v:null))})),f)))}recalculateAndSaveOverlays(e,t){const r=Mu();let a=new yt(((d,f)=>d-f)),c=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const x=t.get(m);if(x===null)return;let y=r.get(m)||es.empty();y=f.applyToLocalView(x,y),r.set(m,y);const v=(a.get(f.batchId)||He()).add(m);a=a.insert(f.batchId,v)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),x=m.key,y=m.value,v=r2();y.forEach((E=>{if(!c.has(E)){const A=d2(t.get(E),r.get(E));A!==null&&v.set(E,A),c=c.add(E)}})),d.push(this.documentOverlayCache.saveOverlays(e,x,v))}return Z.waitFor(d)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(d){return Se.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_x(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((c=>{const d=a-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-c.size):Z.resolve(lr());let f=-1,m=c;return d.next((x=>Z.forEach(x,((y,v)=>(f<v.largestBatchId&&(f=v.largestBatchId),c.get(y)?Z.resolve():this.remoteDocumentCache.getEntry(e,y).next((E=>{m=m.insert(y,E)}))))).next((()=>this.populateOverlays(e,x,c))).next((()=>this.computeViews(e,m,x,He()))).next((y=>({batchId:f,changes:s2(y)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next((r=>{let a=Su();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const c=t.collectionGroup;let d=Su();return this.indexManager.getCollectionParents(e,c).next((f=>Z.forEach(f,(m=>{const x=(function(v,E){return new ei(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,m.child(c));return this.getDocumentsMatchingCollectionQuery(e,x,r,a).next((y=>{y.forEach(((v,E)=>{d=d.insert(v,E)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,c,a)))).next((d=>{c.forEach(((m,x)=>{const y=x.getKey();d.get(y)===null&&(d=d.insert(y,wt.newInvalidDocument(y)))}));let f=Su();return d.forEach(((m,x)=>{const y=c.get(m);y!==void 0&&Pu(y.mutation,x,es.empty(),At.now()),Nd(t,x)&&(f=f.insert(m,x))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Z.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Ht(a.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(a){return{name:a.name,query:Rx(a.bundledQuery),readTime:Ht(a.readTime)}})(t)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(){this.overlays=new yt(Se.comparator),this.Ir=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=lr();return Z.forEach(t,(a=>this.getOverlay(e,a).next((c=>{c!==null&&r.set(a,c)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,c)=>{this.ht(e,t,c)})),Z.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.Ir.get(r);return a!==void 0&&(a.forEach((c=>this.overlays=this.overlays.remove(c))),this.Ir.delete(r)),Z.resolve()}getOverlaysForCollection(e,t,r){const a=lr(),c=t.length+1,d=new Se(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,x=m.getKey();if(!t.isPrefixOf(x.path))break;x.path.length===c&&m.largestBatchId>r&&a.set(m.getKey(),m)}return Z.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let c=new yt(((x,y)=>x-y));const d=this.overlays.getIterator();for(;d.hasNext();){const x=d.getNext().value;if(x.getKey().getCollectionGroup()===t&&x.largestBatchId>r){let y=c.get(x.largestBatchId);y===null&&(y=lr(),c=c.insert(x.largestBatchId,y)),y.set(x.getKey(),x)}}const f=lr(),m=c.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((x,y)=>f.set(x,y))),!(f.size()>=a)););return Z.resolve(f)}ht(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const d=this.Ir.get(a.largestBatchId).delete(r.key);this.Ir.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(r.key,new Ax(t,r));let c=this.Ir.get(t);c===void 0&&(c=He(),this.Ir.set(t,c)),this.Ir.set(t,c.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(){this.Tr=new pt(hn.Er),this.dr=new pt(hn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new hn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Vr(new hn(e,t))}mr(e,t){e.forEach((r=>this.removeReference(r,t)))}gr(e){const t=new Se(new Je([])),r=new hn(t,e),a=new hn(t,e+1),c=[];return this.dr.forEachInRange([r,a],(d=>{this.Vr(d),c.push(d.key)})),c}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Se(new Je([])),r=new hn(t,e),a=new hn(t,e+1);let c=He();return this.dr.forEachInRange([r,a],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new hn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class hn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Se.comparator(e.key,t.key)||qe(e.wr,t.wr)}static Ar(e,t){return qe(e.wr,t.wr)||Se.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new pt(hn.Er)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const c=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new Ex(c,t,r,a);this.mutationQueue.push(d);for(const f of a)this.br=this.br.add(new hn(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return Z.resolve(d)}lookupMutationBatch(e,t){return Z.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.vr(r),c=a<0?0:a;return Z.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hn(t,0),a=new hn(t,Number.POSITIVE_INFINITY),c=[];return this.br.forEachInRange([r,a],(d=>{const f=this.Dr(d.wr);c.push(f)})),Z.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pt(qe);return t.forEach((a=>{const c=new hn(a,0),d=new hn(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([c,d],(f=>{r=r.add(f.wr)}))})),Z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let c=r;Se.isDocumentKey(c)||(c=c.child(""));const d=new hn(new Se(c),0);let f=new pt(qe);return this.br.forEachWhile((m=>{const x=m.key.path;return!!r.isPrefixOf(x)&&(x.length===a&&(f=f.add(m.wr)),!0)}),d),Z.resolve(this.Cr(f))}Cr(e){const t=[];return e.forEach((r=>{const a=this.Dr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Re(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Z.forEach(t.mutations,(a=>{const c=new hn(a.key,t.batchId);return r=r.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.br=r}))}On(e){}containsKey(e,t){const r=new hn(t,0),a=this.br.firstAfterOrEqual(r);return Z.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e){this.Mr=e,this.docs=(function(){return new yt(Se.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),c=a?a.size:0,d=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Z.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(t))}getEntries(e,t){let r=ts();return t.forEach((a=>{const c=this.docs.get(a);r=r.insert(a,c?c.document.mutableCopy():wt.newInvalidDocument(a))})),Z.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let c=ts();const d=t.path,f=new Se(d.child("")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:x,value:{document:y}}=m.getNext();if(!d.isPrefixOf(x.path))break;x.path.length>d.length+1||gx(CT(y),r)<=0||(a.has(y.key)||Nd(t,y))&&(c=c.insert(y.key,y.mutableCopy()))}return Z.resolve(c)}getAllFromCollectionGroup(e,t,r,a){Ie()}Or(e,t){return Z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new _4(this)}getSize(e){return Z.resolve(this.size)}}class _4 extends V2{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.cr.addEntry(e,a)):this.cr.removeEntry(r)})),Z.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e){this.persistence=e,this.Nr=new pa((t=>mo(t)),_d),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Dx,this.targetCount=0,this.kr=bo.Bn()}forEachTarget(e,t){return this.Nr.forEach(((r,a)=>t(a))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),Z.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new bo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Kn(t),Z.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,r){let a=0;const c=[];return this.Nr.forEach(((d,f)=>{f.sequenceNumber<=t&&r.get(f.targetId)===null&&(this.Nr.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),Z.waitFor(c).next((()=>a))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return Z.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),Z.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const a=this.persistence.referenceDelegate,c=[];return a&&t.forEach((d=>{c.push(a.markPotentiallyOrphaned(e,d))})),Z.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return Z.resolve(r)}containsKey(e,t){return Z.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Zn(0),this.Kr=!1,this.Kr=!0,this.$r=new y4,this.referenceDelegate=e(this),this.Ur=new w4(this),this.indexManager=new i4,this.remoteDocumentCache=(function(a){return new v4(a)})((r=>this.referenceDelegate.Wr(r))),this.serializer=new R2(t),this.Gr=new g4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new x4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new b4(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){xe("MemoryPersistence","Starting transaction:",e);const a=new N4(this.Qr.next());return this.referenceDelegate.zr(),r(a).next((c=>this.referenceDelegate.jr(a).next((()=>c)))).toPromise().then((c=>(a.raiseOnCommittedEvent(),c)))}Hr(e,t){return Z.or(Object.values(this.qr).map((r=>()=>r.containsKey(e,t))))}}class N4 extends DT{constructor(e){super(),this.currentSequenceNumber=e}}class gm{constructor(e){this.persistence=e,this.Jr=new Dx,this.Yr=null}static Zr(e){return new gm(e)}get Xr(){if(this.Yr)return this.Yr;throw Ie()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),Z.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((a=>this.Xr.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((c=>this.Xr.add(c.toString())))})).next((()=>r.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.Xr,(r=>{const a=Se.fromPath(r);return this.ei(e,a).next((c=>{c||t.removeEntry(a,De.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Z.or([()=>Z.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.serializer=e}O(e,t,r,a){const c=new cm("createOrUpgrade",t);r<1&&a>=1&&((function(m){m.createObjectStore("owner")})(e),(function(m){m.createObjectStore("mutationQueues",{keyPath:"userId"}),m.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Mw,{unique:!0}),m.createObjectStore("documentMutations")})(e),_1(e),(function(m){m.createObjectStore("remoteDocuments")})(e));let d=Z.resolve();return r<3&&a>=3&&(r!==0&&((function(m){m.deleteObjectStore("targetDocuments"),m.deleteObjectStore("targets"),m.deleteObjectStore("targetGlobal")})(e),_1(e)),d=d.next((()=>(function(m){const x=m.store("targetGlobal"),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return x.put("targetGlobalKey",y)})(c)))),r<4&&a>=4&&(r!==0&&(d=d.next((()=>(function(m,x){return x.store("mutations").U().next((y=>{m.deleteObjectStore("mutations"),m.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Mw,{unique:!0});const v=x.store("mutations"),E=y.map((A=>v.put(A)));return Z.waitFor(E)}))})(e,c)))),d=d.next((()=>{(function(m){m.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)}))),r<5&&a>=5&&(d=d.next((()=>this.ni(c)))),r<6&&a>=6&&(d=d.next((()=>((function(m){m.createObjectStore("remoteDocumentGlobal")})(e),this.ri(c))))),r<7&&a>=7&&(d=d.next((()=>this.ii(c)))),r<8&&a>=8&&(d=d.next((()=>this.si(e,c)))),r<9&&a>=9&&(d=d.next((()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&a>=10&&(d=d.next((()=>this.oi(c)))),r<11&&a>=11&&(d=d.next((()=>{(function(m){m.createObjectStore("bundles",{keyPath:"bundleId"})})(e),(function(m){m.createObjectStore("namedQueries",{keyPath:"name"})})(e)}))),r<12&&a>=12&&(d=d.next((()=>{(function(m){const x=m.createObjectStore("documentOverlays",{keyPath:rD});x.createIndex("collectionPathOverlayIndex",iD,{unique:!1}),x.createIndex("collectionGroupOverlayIndex",aD,{unique:!1})})(e)}))),r<13&&a>=13&&(d=d.next((()=>(function(m){const x=m.createObjectStore("remoteDocumentsV14",{keyPath:$5});x.createIndex("documentKeyIndex",Q5),x.createIndex("collectionGroupIndex",Y5)})(e))).next((()=>this._i(e,c))).next((()=>e.deleteObjectStore("remoteDocuments")))),r<14&&a>=14&&(d=d.next((()=>this.ai(e,c)))),r<15&&a>=15&&(d=d.next((()=>(function(m){m.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),m.createObjectStore("indexState",{keyPath:eD}).createIndex("sequenceNumberIndex",tD,{unique:!1}),m.createObjectStore("indexEntries",{keyPath:nD}).createIndex("documentKeyIndex",sD,{unique:!1})})(e)))),r<16&&a>=16&&(d=d.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),r<17&&a>=17&&(d=d.next((()=>{(function(m){m.createObjectStore("globals",{keyPath:"name"})})(e)}))),d}ri(e){let t=0;return e.store("remoteDocuments").J(((r,a)=>{t+=qf(a)})).next((()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)}))}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next((a=>Z.forEach(a,(c=>{const d=IDBKeyRange.bound([c.userId,-1],[c.userId,c.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",d).next((f=>Z.forEach(f,(m=>{Re(m.userId===c.userId);const x=Ja(this.serializer,m);return M2(e,c.userId,x).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((a=>{const c=[];return r.J(((d,f)=>{const m=new Je(d),x=(function(v){return[0,Un(v)]})(m);c.push(t.get(x).next((y=>y?Z.resolve():(v=>t.put({targetId:0,path:Un(v),sequenceNumber:a.highestListenSequenceNumber}))(m))))})).next((()=>Z.waitFor(c)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:Z5});const r=t.store("collectionParents"),a=new kx,c=d=>{if(a.add(d)){const f=d.lastSegment(),m=d.popLast();return r.put({collectionId:f,parent:Un(m)})}};return t.store("remoteDocuments").J({H:!0},((d,f)=>{const m=new Je(d);return c(m.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([d,f,m],x)=>{const y=or(f);return c(y.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((r,a)=>{const c=Iu(a),d=C2(this.serializer,c);return t.put(d)}))}_i(e,t){const r=t.store("remoteDocuments"),a=[];return r.J(((c,d)=>{const f=t.store("remoteDocumentsV14"),m=(function(v){return v.document?new Se(Je.fromString(v.document.name).popFirst(5)):v.noDocument?Se.fromSegments(v.noDocument.path):v.unknownDocument?Se.fromSegments(v.unknownDocument.path):Ie()})(d).path.toArray(),x={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:d.readTime||[0,0],unknownDocument:d.unknownDocument,noDocument:d.noDocument,document:d.document,hasCommittedMutations:!!d.hasCommittedMutations};a.push(f.put(x))})).next((()=>Z.waitFor(a)))}ai(e,t){const r=t.store("mutations"),a=L2(this.serializer),c=new F2(gm.Zr,this.serializer.ct);return r.U().next((d=>{const f=new Map;return d.forEach((m=>{var x;let y=(x=f.get(m.userId))!==null&&x!==void 0?x:He();Ja(this.serializer,m).keys().forEach((v=>y=y.add(v))),f.set(m.userId,y)})),Z.forEach(f,((m,x)=>{const y=new fn(x),v=mm.lt(this.serializer,y),E=c.getIndexManager(y),A=pm.lt(y,this.serializer,E,c.referenceDelegate);return new U2(a,A,v,E).recalculateAndSaveOverlaysForDocumentKeys(new x0(t,Zn.oe),m).next()}))}))}}function _1(n){n.createObjectStore("targetDocuments",{keyPath:X5}).createIndex("documentTargetsIndex",J5,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",W5,{unique:!0}),n.createObjectStore("targetGlobal")}const Jg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Mx{constructor(e,t,r,a,c,d,f,m,x,y,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=c,this.window=d,this.document=f,this.ci=x,this.li=y,this.hi=v,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=E=>Promise.resolve(),!Mx.D())throw new ge(re.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new h4(this,a),this.Ai=t+"main",this.serializer=new R2(m),this.Ri=new cr(this.Ai,this.hi,new T4(this.serializer)),this.$r=new ZD,this.Ur=new o4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=L2(this.serializer),this.Gr=new JD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,y===!1&&zt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ge(re.FAILED_PRECONDITION,Jg);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new Zn(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>cf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(ma(e))return xe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return xe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return vu(e).get("owner").next((t=>Z.resolve(this.vi(t))))}Ci(e){return cf(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=an(t,"clientMetadata");return r.U().next((a=>{const c=this.xi(a,18e5),d=a.filter((f=>c.indexOf(f)===-1));return Z.forEach(d,(f=>r.delete(f.clientId))).next((()=>d))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Z.resolve(!0):vu(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ge(re.FAILED_PRECONDITION,Jg);return!1}}return!(!this.networkEnabled||!this.inForeground)||cf(e).U().next((r=>this.xi(r,5e3).find((a=>{if(this.clientId!==a.clientId){const c=!this.networkEnabled&&a.networkEnabled,d=!this.inForeground&&a.inForeground,f=this.networkEnabled===a.networkEnabled;if(c||d&&f)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&xe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new x0(e,Zn.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>cf(e).U().next((t=>this.xi(t,18e5).map((r=>r.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return pm.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new a4(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return mm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){xe("IndexedDbPersistence","Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",c=(function(m){return m===17?cD:m===16?lD:m===15?yx:m===14?UT:m===13?LT:m===12?oD:m===11?VT:void Ie()})(this.hi);let d;return this.Ri.runTransaction(e,a,c,(f=>(d=new x0(f,this.Qr?this.Qr.next():Zn.oe),t==="readwrite-primary"?this.wi(d).next((m=>!!m||this.Si(d))).next((m=>{if(!m)throw zt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new ge(re.FAILED_PRECONDITION,kT);return r(d)})).next((m=>this.Di(d).next((()=>m)))):this.Ki(d).next((()=>r(d)))))).then((f=>(d.raiseOnCommittedEvent(),f)))}Ki(e){return vu(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ge(re.FAILED_PRECONDITION,Jg)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vu(e).put("owner",t)}static D(){return cr.D()}bi(e){const t=vu(e);return t.get("owner").next((r=>this.vi(r)?(xe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Z.resolve()))}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(zt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;cN()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return xe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return zt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){zt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vu(n){return an(n,"owner")}function cf(n){return an(n,"clientMetadata")}function Px(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=a}static Wi(e,t){let r=He(),a=He();for(const c of t.docChanges)switch(c.type){case 0:r=r.add(c.doc.key);break;case 1:a=a.add(c.doc.key)}return new Ox(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return cN()?8:MT(jt())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,a){const c={result:null};return this.Yi(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.Zi(e,t,a,r).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new E4;return this.Xi(e,t,d).next((f=>{if(c.result=f,this.zi)return this.es(e,t,d,f.size)}))})).next((()=>c.result))}es(e,t,r,a){return r.documentReadCount<this.ji?(Sl()<=Ye.DEBUG&&xe("QueryEngine","SDK will not create cache indexes for query:",Al(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Z.resolve()):(Sl()<=Ye.DEBUG&&xe("QueryEngine","Query:",Al(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.Hi*a?(Sl()<=Ye.DEBUG&&xe("QueryEngine","The SDK decides to create cache indexes for query:",Al(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(t))):Z.resolve())}Yi(e,t){if($w(t))return Z.resolve(null);let r=Fn(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Lf(t,null,"F"),r=Fn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((c=>{const d=He(...c);return this.Ji.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,r).next((m=>{const x=this.ts(t,f);return this.ns(t,x,d,m.readTime)?this.Yi(e,Lf(t,null,"F")):this.rs(e,x,t,m)}))))})))))}Zi(e,t,r,a){return $w(t)||a.isEqual(De.min())?Z.resolve(null):this.Ji.getDocuments(e,r).next((c=>{const d=this.ts(t,c);return this.ns(t,d,r,a)?Z.resolve(null):(Sl()<=Ye.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Al(t)),this.rs(e,d,t,RT(a,-1)).next((f=>f)))}))}ts(e,t){let r=new pt(t2(e));return t.forEach(((a,c)=>{Nd(e,c)&&(r=r.add(c))})),r}ns(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(a)>0)}Xi(e,t,r){return Sl()<=Ye.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",Al(t)),this.Ji.getDocumentsMatchingQuery(e,t,gs.min(),r)}rs(e,t,r,a){return this.Ji.getDocumentsMatchingQuery(e,r,a).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,t,r,a){this.persistence=e,this.ss=t,this.serializer=a,this.os=new yt(qe),this._s=new pa((c=>mo(c)),_d),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function B2(n,e,t,r){return new S4(n,e,t,r)}async function z2(n,e){const t=Ae(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((c=>(a=c,t.ls(e),t.mutationQueue.getAllMutationBatches(r)))).next((c=>{const d=[],f=[];let m=He();for(const x of a){d.push(x.batchId);for(const y of x.mutations)m=m.add(y.key)}for(const x of c){f.push(x.batchId);for(const y of x.mutations)m=m.add(y.key)}return t.localDocuments.getDocuments(r,m).next((x=>({hs:x,removedBatchIds:d,addedBatchIds:f})))}))}))}function A4(n,e){const t=Ae(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),c=t.cs.newChangeBuffer({trackRemovals:!0});return(function(f,m,x,y){const v=x.batch,E=v.keys();let A=Z.resolve();return E.forEach((V=>{A=A.next((()=>y.getEntry(m,V))).next((C=>{const O=x.docVersions.get(V);Re(O!==null),C.version.compareTo(O)<0&&(v.applyToRemoteDocument(C,x),C.isValidDocument()&&(C.setReadTime(x.commitVersion),y.addEntry(C)))}))})),A.next((()=>f.mutationQueue.removeMutationBatch(m,v)))})(t,r,e,c).next((()=>c.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(f){let m=He();for(let x=0;x<f.mutationResults.length;++x)f.mutationResults[x].transformResults.length>0&&(m=m.add(f.batch.mutations[x].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function H2(n){const e=Ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function I4(n,e){const t=Ae(n),r=e.snapshotVersion;let a=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.cs.newChangeBuffer({trackRemovals:!0});a=t.os;const f=[];e.targetChanges.forEach(((y,v)=>{const E=a.get(v);if(!E)return;f.push(t.Ur.removeMatchingKeys(c,y.removedDocuments,v).next((()=>t.Ur.addMatchingKeys(c,y.addedDocuments,v))));let A=E.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(v)!==null?A=A.withResumeToken(Pt.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):y.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(y.resumeToken,r)),a=a.insert(v,A),(function(C,O,z){return C.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(E,A,y)&&f.push(t.Ur.updateTargetData(c,A))}));let m=ts(),x=He();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,y))})),f.push(G2(c,d,e.documentUpdates).next((y=>{m=y.Ps,x=y.Is}))),!r.isEqual(De.min())){const y=t.Ur.getLastRemoteSnapshotVersion(c).next((v=>t.Ur.setTargetsMetadata(c,c.currentSequenceNumber,r)));f.push(y)}return Z.waitFor(f).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,m,x))).next((()=>m))})).then((c=>(t.os=a,c)))}function G2(n,e,t){let r=He(),a=He();return t.forEach((c=>r=r.add(c))),e.getEntries(n,r).next((c=>{let d=ts();return t.forEach(((f,m)=>{const x=c.get(f);m.isFoundDocument()!==x.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(De.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!x.isValidDocument()||m.version.compareTo(x.version)>0||m.version.compareTo(x.version)===0&&x.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):xe("LocalStore","Ignoring outdated watch update for ",f,". Current version:",x.version," Watch version:",m.version)})),{Ps:d,Is:a}}))}function j4(n,e){const t=Ae(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ql(n,e){const t=Ae(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.Ur.getTargetData(r,e).next((c=>c?(a=c,Z.resolve(a)):t.Ur.allocateTargetId(r).next((d=>(a=new Kr(e,d,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.os.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r}))}async function Yl(n,e,t){const r=Ae(n),a=r.os.get(e),c=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",c,(d=>r.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!ma(d))throw d;xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${d}`)}r.os=r.os.remove(e),r._s.delete(a.target)}function Bf(n,e,t){const r=Ae(n);let a=De.min(),c=He();return r.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,x,y){const v=Ae(m),E=v._s.get(y);return E!==void 0?Z.resolve(v.os.get(E)):v.Ur.getTargetData(x,y)})(r,d,Fn(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(d,f.targetId).next((m=>{c=m}))})).next((()=>r.ss.getDocumentsMatchingQuery(d,e,t?a:De.min(),t?c:He()))).next((f=>(Q2(r,e2(e),f),{documents:f,Ts:c})))))}function K2(n,e){const t=Ae(n),r=Ae(t.Ur),a=t.os.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(c=>r.ot(c,e).next((d=>d?d.target:null))))}function $2(n,e){const t=Ae(n),r=t.us.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.cs.getAllFromCollectionGroup(a,e,RT(r,-1),Number.MAX_SAFE_INTEGER))).then((a=>(Q2(t,e,a),a)))}function Q2(n,e,t){let r=n.us.get(e)||De.min();t.forEach(((a,c)=>{c.readTime.compareTo(r)>0&&(r=c.readTime)})),n.us.set(e,r)}async function R4(n,e,t,r){const a=Ae(n);let c=He(),d=ts();for(const x of t){const y=e.Es(x.metadata.name);x.document&&(c=c.add(y));const v=e.ds(x);v.setReadTime(e.As(x.metadata.readTime)),d=d.insert(y,v)}const f=a.cs.newChangeBuffer({trackRemovals:!0}),m=await Ql(a,(function(y){return Fn(oc(Je.fromString(`__bundle__/docs/${y}`)))})(r));return a.persistence.runTransaction("Apply bundle documents","readwrite",(x=>G2(x,f,d).next((y=>(f.apply(x),y))).next((y=>a.Ur.removeMatchingKeysForTargetId(x,m.targetId).next((()=>a.Ur.addMatchingKeys(x,c,m.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(x,y.Ps,y.Is))).next((()=>y.Ps))))))}async function C4(n,e,t=He()){const r=await Ql(n,Fn(Rx(e.bundledQuery))),a=Ae(n);return a.persistence.runTransaction("Save named query","readwrite",(c=>{const d=Ht(e.readTime);if(r.snapshotVersion.compareTo(d)>=0)return a.Gr.saveNamedQuery(c,e);const f=r.withResumeToken(Pt.EMPTY_BYTE_STRING,d);return a.os=a.os.insert(f.targetId,f),a.Ur.updateTargetData(c,f).next((()=>a.Ur.removeMatchingKeysForTargetId(c,r.targetId))).next((()=>a.Ur.addMatchingKeys(c,t,r.targetId))).next((()=>a.Gr.saveNamedQuery(c,e)))}))}function w1(n,e){return`firestore_clients_${n}_${e}`}function N1(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Zg(n,e){return`firestore_targets_${n}_${e}`}class zf{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static Rs(e,t,r){const a=JSON.parse(r);let c,d=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return d&&a.error&&(d=typeof a.error.message=="string"&&typeof a.error.code=="string",d&&(c=new ge(a.error.code,a.error.message))),d?new zf(e,t,a.state,c):(zt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ou{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let a,c=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return c&&r.error&&(c=typeof r.error.message=="string"&&typeof r.error.code=="string",c&&(a=new ge(r.error.code,r.error.message))),c?new Ou(e,r.state,a):(zt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Hf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let a=typeof r=="object"&&r.activeTargetIds instanceof Array,c=wx();for(let d=0;a&&d<r.activeTargetIds.length;++d)a=PT(r.activeTargetIds[d]),c=c.add(r.activeTargetIds[d]);return a?new Hf(e,c):(zt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Vx{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Vx(t.clientId,t.onlineState):(zt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class C0{constructor(){this.activeTargetIds=wx()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class e0{constructor(e,t,r,a,c){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new yt(qe),this.started=!1,this.bs=[];const d=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.Ds=w1(this.persistenceKey,this.ps),this.vs=(function(m){return`firestore_sequence_number_${m}`})(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new C0),this.Cs=new RegExp(`^firestore_clients_${d}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${d}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${d}_(\\d+)$`),this.xs=(function(m){return`firestore_online_state_${m}`})(this.persistenceKey),this.Os=(function(m){return`firestore_bundle_loaded_v2_${m}`})(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const a=this.getItem(w1(this.persistenceKey,r));if(a){const c=Hf.Rs(r,a);c&&(this.Ss=this.Ss.insert(c.clientId,c))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Zg(this.persistenceKey,e));if(a){const c=Ou.Rs(e,a);c&&(r=c.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zg(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach((a=>{this.Qs(a)})),this.currentUser=e,r.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return xe("SharedClientState","READ",e,t),t}setItem(e,t){xe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){xe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(xe("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void zt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=(function(c){let d=Zn.oe;if(c!=null)try{const f=JSON.parse(c);Re(typeof f=="number"),d=f}catch(f){zt("SharedClientState","Failed to read sequence number from WebStorage",f)}return d})(t.newValue);r!==Zn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map((a=>this.syncEngine.eo(a))))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const a=new zf(this.currentUser,e,t,r),c=N1(this.persistenceKey,this.currentUser,e);this.setItem(c,a.Vs())}Qs(e){const t=N1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const a=Zg(this.persistenceKey,e),c=new Ou(e,t,r);this.setItem(a,c.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Hf.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),a=Number(r[1]),c=r[2]!==void 0?r[2]:null;return zf.Rs(new fn(c),a,t)}Ys(e,t){const r=this.Ms.exec(e),a=Number(r[1]);return Ou.Rs(a,t)}Ls(e){return Vx.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);xe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),a=this.ks(this.Ss),c=this.ks(r),d=[],f=[];return c.forEach((m=>{a.has(m)||d.push(m)})),a.forEach((m=>{c.has(m)||f.push(m)})),this.syncEngine.io(d,f).then((()=>{this.Ss=r}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=wx();return e.forEach(((r,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class Y2{constructor(){this.so=new C0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new C0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uf=null;function t0(){return uf===null?uf=(function(){return 268435456+Math.round(2147483648*Math.random())})():uf++,"0x"+uf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="WebChannelConnection";class P4 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),c=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${a}/databases/${c}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${c}`}get Fo(){return!1}Mo(t,r,a,c,d){const f=t0(),m=this.xo(t,r.toUriEncodedString());xe("RestConnection",`Sending RPC '${t}' ${f}:`,m,a);const x={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(x,c,d),this.No(t,m,x,a).then((y=>(xe("RestConnection",`Received RPC '${t}' ${f}: `,y),y)),(y=>{throw fr("RestConnection",`RPC '${t}' ${f} failed with error: `,y,"url: ",m,"request:",a),y}))}Lo(t,r,a,c,d,f){return this.Mo(t,r,a,c,d)}Oo(t,r,a){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ac})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((c,d)=>t[d]=c)),a&&a.headers.forEach(((c,d)=>t[d]=c))}xo(t,r){const a=D4[t];return`${this.Do}/v1/${r}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,a){const c=t0();return new Promise(((d,f)=>{const m=new wT;m.setWithCredentials(!0),m.listenOnce(NT.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case bf.NO_ERROR:const y=m.getResponseJson();xe(In,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(y)),d(y);break;case bf.TIMEOUT:xe(In,`RPC '${e}' ${c} timed out`),f(new ge(re.DEADLINE_EXCEEDED,"Request time out"));break;case bf.HTTP_ERROR:const v=m.getStatus();if(xe(In,`RPC '${e}' ${c} failed with status:`,v,"response text:",m.getResponseText()),v>0){let E=m.getResponseJson();Array.isArray(E)&&(E=E[0]);const A=E==null?void 0:E.error;if(A&&A.status&&A.message){const V=(function(O){const z=O.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(z)>=0?z:re.UNKNOWN})(A.status);f(new ge(V,A.message))}else f(new ge(re.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new ge(re.UNAVAILABLE,"Connection failed."));break;default:Ie()}}finally{xe(In,`RPC '${e}' ${c} completed.`)}}));const x=JSON.stringify(a);xe(In,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",x,r,15)}))}Bo(e,t,r){const a=t0(),c=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=ST(),f=ET(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},x=this.longPollingOptions.timeoutSeconds;x!==void 0&&(m.longPollingTimeout=Math.round(1e3*x)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Oo(m.initMessageHeaders,t,r),m.encodeInitMessageHeaders=!0;const y=c.join("");xe(In,`Creating RPC '${e}' stream ${a}: ${y}`,m);const v=d.createWebChannel(y,m);let E=!1,A=!1;const V=new M4({Io:O=>{A?xe(In,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(E||(xe(In,`Opening RPC '${e}' stream ${a} transport.`),v.open(),E=!0),xe(In,`RPC '${e}' stream ${a} sending:`,O),v.send(O))},To:()=>v.close()}),C=(O,z,ae)=>{O.listen(z,(K=>{try{ae(K)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return C(v,Eu.EventType.OPEN,(()=>{A||(xe(In,`RPC '${e}' stream ${a} transport opened.`),V.yo())})),C(v,Eu.EventType.CLOSE,(()=>{A||(A=!0,xe(In,`RPC '${e}' stream ${a} transport closed`),V.So())})),C(v,Eu.EventType.ERROR,(O=>{A||(A=!0,fr(In,`RPC '${e}' stream ${a} transport errored:`,O),V.So(new ge(re.UNAVAILABLE,"The operation could not be completed")))})),C(v,Eu.EventType.MESSAGE,(O=>{var z;if(!A){const ae=O.data[0];Re(!!ae);const K=ae,ee=K.error||((z=K[0])===null||z===void 0?void 0:z.error);if(ee){xe(In,`RPC '${e}' stream ${a} received error:`,ee);const B=ee.status;let Q=(function(S){const N=Jt[S];if(N!==void 0)return m2(N)})(B),j=ee.message;Q===void 0&&(Q=re.INTERNAL,j="Unknown error status: "+B+" with message "+ee.message),A=!0,V.So(new ge(Q,j)),v.close()}else xe(In,`RPC '${e}' stream ${a} received:`,ae),V.bo(ae)}})),C(f,TT.STAT_EVENT,(O=>{O.stat===p0.PROXY?xe(In,`RPC '${e}' stream ${a} detected buffering proxy`):O.stat===p0.NOPROXY&&xe(In,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{V.wo()}),0),V}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(){return typeof window<"u"?window:null}function Sf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(n){return new qD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,t,r=1e3,a=1.5,c=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=a,this.Qo=c,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),a=Math.max(0,t-r);a>0&&xe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,t,r,a,c,d,f,m){this.ui=e,this.Ho=r,this.Jo=a,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lx(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(zt(t.toString()),zt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.Yo===t&&this.P_(r,a)}),(r=>{e((()=>{const a=new ge(re.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(a)}))}))}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{r((()=>this.listener.Eo()))})),this.stream.Ro((()=>{r((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((a=>{r((()=>this.I_(a)))})),this.stream.onMessage((a=>{r((()=>++this.e_==1?this.E_(a):this.onNext(a)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class O4 extends X2{constructor(e,t,r,a,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,d),this.serializer=c}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=HD(this.serializer,e),r=(function(c){if(!("targetChange"in c))return De.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?De.min():d.readTime?Ht(d.readTime):De.min()})(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=S0(this.serializer),t.addTarget=(function(c,d){let f;const m=d.target;if(f=Of(m)?{documents:T2(c,m)}:{query:E2(c,m)._t},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=y2(c,d.resumeToken);const x=T0(c,d.expectedCount);x!==null&&(f.expectedCount=x)}else if(d.snapshotVersion.compareTo(De.min())>0){f.readTime=$l(c,d.snapshotVersion.toTimestamp());const x=T0(c,d.expectedCount);x!==null&&(f.expectedCount=x)}return f})(this.serializer,e);const r=KD(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=S0(this.serializer),t.removeTarget=e,this.a_(t)}}class V4 extends X2{constructor(e,t,r,a,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,d),this.serializer=c}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Re(!!e.streamToken),this.lastStreamToken=e.streamToken,Re(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=GD(e.writeResults,e.commitTime),r=Ht(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=S0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>td(this.serializer,r)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4 extends class{}{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new ge(re.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Mo(e,E0(t,r),a,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ge(re.UNKNOWN,c.toString())}))}Lo(e,t,r,a,c){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Lo(e,E0(t,r),a,d,f,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ge(re.UNKNOWN,d.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class U4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(zt(t),this.D_=!1):xe("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,t,r,a,c){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=c,this.k_._o((d=>{r.enqueueAndForget((async()=>{ga(this)&&(xe("RemoteStore","Restarting streams for network reachability change."),await(async function(m){const x=Ae(m);x.L_.add(4),await uc(x),x.q_.set("Unknown"),x.L_.delete(4),await Id(x)})(this))}))})),this.q_=new U4(r,a)}}async function Id(n){if(ga(n))for(const e of n.B_)await e(!0)}async function uc(n){for(const e of n.B_)await e(!1)}function xm(n,e){const t=Ae(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),qx(t)?Fx(t):hc(t).r_()&&Ux(t,e))}function Wl(n,e){const t=Ae(n),r=hc(t);t.N_.delete(e),r.r_()&&J2(t,e),t.N_.size===0&&(r.r_()?r.o_():ga(t)&&t.q_.set("Unknown"))}function Ux(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hc(n).A_(e)}function J2(n,e){n.Q_.xe(e),hc(n).R_(e)}function Fx(n){n.Q_=new VD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),hc(n).start(),n.q_.v_()}function qx(n){return ga(n)&&!hc(n).n_()&&n.N_.size>0}function ga(n){return Ae(n).L_.size===0}function Z2(n){n.Q_=void 0}async function q4(n){n.q_.set("Online")}async function B4(n){n.N_.forEach(((e,t)=>{Ux(n,e)}))}async function z4(n,e){Z2(n),qx(n)?(n.q_.M_(e),Fx(n)):n.q_.set("Unknown")}async function H4(n,e,t){if(n.q_.set("Online"),e instanceof x2&&e.state===2&&e.cause)try{await(async function(a,c){const d=c.cause;for(const f of c.targetIds)a.N_.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.N_.delete(f),a.Q_.removeTarget(f))})(n,e)}catch(r){xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gf(n,r)}else if(e instanceof Ef?n.Q_.Ke(e):e instanceof g2?n.Q_.He(e):n.Q_.We(e),!t.isEqual(De.min()))try{const r=await H2(n.localStore);t.compareTo(r)>=0&&await(function(c,d){const f=c.Q_.rt(d);return f.targetChanges.forEach(((m,x)=>{if(m.resumeToken.approximateByteSize()>0){const y=c.N_.get(x);y&&c.N_.set(x,y.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,x)=>{const y=c.N_.get(m);if(!y)return;c.N_.set(m,y.withResumeToken(Pt.EMPTY_BYTE_STRING,y.snapshotVersion)),J2(c,m);const v=new Kr(y.target,m,x,y.sequenceNumber);Ux(c,v)})),c.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(r){xe("RemoteStore","Failed to raise snapshot:",r),await Gf(n,r)}}async function Gf(n,e,t){if(!ma(e))throw e;n.L_.add(1),await uc(n),n.q_.set("Offline"),t||(t=()=>H2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{xe("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Id(n)}))}function eE(n,e){return e().catch((t=>Gf(n,t,e)))}async function dc(n){const e=Ae(n),t=la(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;G4(e);)try{const a=await j4(e.localStore,r);if(a===null){e.O_.length===0&&t.o_();break}r=a.batchId,K4(e,a)}catch(a){await Gf(e,a)}tE(e)&&nE(e)}function G4(n){return ga(n)&&n.O_.length<10}function K4(n,e){n.O_.push(e);const t=la(n);t.r_()&&t.V_&&t.m_(e.mutations)}function tE(n){return ga(n)&&!la(n).n_()&&n.O_.length>0}function nE(n){la(n).start()}async function $4(n){la(n).p_()}async function Q4(n){const e=la(n);for(const t of n.O_)e.m_(t.mutations)}async function Y4(n,e,t){const r=n.O_.shift(),a=Sx.from(r,e,t);await eE(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await dc(n)}async function W4(n,e){e&&la(n).V_&&await(async function(r,a){if((function(d){return f2(d)&&d!==re.ABORTED})(a.code)){const c=r.O_.shift();la(r).s_(),await eE(r,(()=>r.remoteSyncer.rejectFailedWrite(c.batchId,a))),await dc(r)}})(n,e),tE(n)&&nE(n)}async function E1(n,e){const t=Ae(n);t.asyncQueue.verifyOperationInProgress(),xe("RemoteStore","RemoteStore received new credentials");const r=ga(t);t.L_.add(3),await uc(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Id(t)}async function k0(n,e){const t=Ae(n);e?(t.L_.delete(2),await Id(t)):e||(t.L_.add(2),await uc(t),t.q_.set("Unknown"))}function hc(n){return n.K_||(n.K_=(function(t,r,a){const c=Ae(t);return c.w_(),new O4(r,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,a)})(n.datastore,n.asyncQueue,{Eo:q4.bind(null,n),Ro:B4.bind(null,n),mo:z4.bind(null,n),d_:H4.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),qx(n)?Fx(n):n.q_.set("Unknown")):(await n.K_.stop(),Z2(n))}))),n.K_}function la(n){return n.U_||(n.U_=(function(t,r,a){const c=Ae(t);return c.w_(),new V4(r,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,a)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:$4.bind(null,n),mo:W4.bind(null,n),f_:Q4.bind(null,n),g_:Y4.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await dc(n)):(await n.U_.stop(),n.O_.length>0&&(xe("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,r,a,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=c,this.deferred=new Nn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,c){const d=Date.now()+r,f=new Bx(e,t,d,a,c);return f.start(r),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fc(n,e){if(zt("AsyncQueue",`${e}: ${n}`),ma(n))return new ge(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Se.comparator(t.key,r.key):(t,r)=>Se.comparator(t.key,r.key),this.keyedMap=Su(),this.sortedSet=new yt(this.comparator)}static emptySet(e){return new Vl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,c=r.getNext().key;if(!a.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Vl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.W_=new yt(Se.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ie():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Xl{constructor(e,t,r,a,c,d,f,m,x){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=x}static fromInitialDocuments(e,t,r,a,c){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Xl(e,t,Vl.emptySet(t),d,r,a,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class J4{constructor(){this.queries=A1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const a=Ae(t),c=a.queries;a.queries=A1(),c.forEach(((d,f)=>{for(const m of f.j_)m.onError(r)}))})(this,new ge(re.ABORTED,"Firestore shutting down"))}}function A1(){return new pa((n=>ZT(n)),wd)}async function zx(n,e){const t=Ae(n);let r=3;const a=e.query;let c=t.queries.get(a);c?!c.H_()&&e.J_()&&(r=2):(c=new X4,r=e.J_()?0:1);try{switch(r){case 0:c.z_=await t.onListen(a,!0);break;case 1:c.z_=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=fc(d,`Initialization of query '${Al(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,c),c.j_.push(e),e.Z_(t.onlineState),c.z_&&e.X_(c.z_)&&Gx(t)}async function Hx(n,e){const t=Ae(n),r=e.query;let a=3;const c=t.queries.get(r);if(c){const d=c.j_.indexOf(e);d>=0&&(c.j_.splice(d,1),c.j_.length===0?a=e.J_()?0:1:!c.H_()&&e.J_()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Z4(n,e){const t=Ae(n);let r=!1;for(const a of e){const c=a.query,d=t.queries.get(c);if(d){for(const f of d.j_)f.X_(a)&&(r=!0);d.z_=a}}r&&Gx(t)}function e3(n,e,t){const r=Ae(n),a=r.queries.get(e);if(a)for(const c of a.j_)c.onError(t);r.queries.delete(e)}function Gx(n){n.Y_.forEach((e=>{e.next()}))}var D0,I1;(I1=D0||(D0={})).ea="default",I1.Cache="cache";class Kx{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Xl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==D0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e){this.serializer=e}Es(e){return ur(this.serializer,e)}ds(e){return e.metadata.exists?N2(this.serializer,e.document,!1):wt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ht(e)}}class n3{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=sE(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=Je.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new j1(this.serializer);for(const a of e)if(a.metadata.queries){const c=r.Es(a.metadata.name);for(const d of a.metadata.queries){const f=(t.get(d)||He()).add(c);t.set(d,f)}}return t}async complete(){const e=await R4(this.localStore,new j1(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await C4(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function sE(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e){this.key=e}}class iE{constructor(e){this.key=e}}class aE{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=He(),this.mutatedKeys=He(),this.Aa=t2(e),this.Ra=new Vl(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new S1,a=t?t.Ra:this.Ra;let c=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,x=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((y,v)=>{const E=a.get(y),A=Nd(this.query,v)?v:null,V=!!E&&this.mutatedKeys.has(E.key),C=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let O=!1;E&&A?E.data.isEqual(A.data)?V!==C&&(r.track({type:3,doc:A}),O=!0):this.ga(E,A)||(r.track({type:2,doc:A}),O=!0,(m&&this.Aa(A,m)>0||x&&this.Aa(A,x)<0)&&(f=!0)):!E&&A?(r.track({type:0,doc:A}),O=!0):E&&!A&&(r.track({type:1,doc:E}),O=!0,(m||x)&&(f=!0)),O&&(A?(d=d.add(A),c=C?c.add(y):c.delete(y)):(d=d.delete(y),c=c.delete(y)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),c=c.delete(y.key),r.track({type:1,doc:y})}return{Ra:d,fa:r,ns:f,mutatedKeys:c}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const c=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const d=e.fa.G_();d.sort(((y,v)=>(function(A,V){const C=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie()}};return C(A)-C(V)})(y.type,v.type)||this.Aa(y.doc,v.doc))),this.pa(r),a=a!=null&&a;const f=t&&!a?this.ya():[],m=this.da.size===0&&this.current&&!a?1:0,x=m!==this.Ea;return this.Ea=m,d.length!==0||x?{snapshot:new Xl(this.query,e.Ra,c,d,e.mutatedKeys,m===0,x,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:f}:{wa:f}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new S1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=He(),this.Ra.forEach((r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))}));const t=[];return e.forEach((r=>{this.da.has(r)||t.push(new iE(r))})),this.da.forEach((r=>{e.has(r)||t.push(new rE(r))})),t}ba(e){this.Ta=e.Ts,this.da=He();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Xl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class s3{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class r3{constructor(e){this.key=e,this.va=!1}}class i3{constructor(e,t,r,a,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Ca={},this.Fa=new pa((f=>ZT(f)),wd),this.Ma=new Map,this.xa=new Set,this.Oa=new yt(Se.comparator),this.Na=new Map,this.La=new Dx,this.Ba={},this.ka=new Map,this.qa=bo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function a3(n,e,t=!0){const r=ym(n);let a;const c=r.Fa.get(e);return c?(r.sharedClientState.addLocalQueryTarget(c.targetId),a=c.view.Da()):a=await oE(r,e,t,!0),a}async function o3(n,e){const t=ym(n);await oE(t,e,!0,!1)}async function oE(n,e,t,r){const a=await Ql(n.localStore,Fn(e)),c=a.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return r&&(f=await $x(n,e,c,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&xm(n.remoteStore,a),f}async function $x(n,e,t,r,a){n.Ka=(v,E,A)=>(async function(C,O,z,ae){let K=O.view.ma(z);K.ns&&(K=await Bf(C.localStore,O.query,!1).then((({documents:j})=>O.view.ma(j,K))));const ee=ae&&ae.targetChanges.get(O.targetId),B=ae&&ae.targetMismatches.get(O.targetId)!=null,Q=O.view.applyChanges(K,C.isPrimaryClient,ee,B);return M0(C,O.targetId,Q.wa),Q.snapshot})(n,v,E,A);const c=await Bf(n.localStore,e,!0),d=new aE(e,c.Ts),f=d.ma(c.documents),m=Sd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),x=d.applyChanges(f,n.isPrimaryClient,m);M0(n,t,x.wa);const y=new s3(e,t,d);return n.Fa.set(e,y),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),x.snapshot}async function l3(n,e,t){const r=Ae(n),a=r.Fa.get(e),c=r.Ma.get(a.targetId);if(c.length>1)return r.Ma.set(a.targetId,c.filter((d=>!wd(d,e)))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Yl(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&Wl(r.remoteStore,a.targetId),Jl(r,a.targetId)})).catch(fa)):(Jl(r,a.targetId),await Yl(r.localStore,a.targetId,!0))}async function c3(n,e){const t=Ae(n),r=t.Fa.get(e),a=t.Ma.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Wl(t.remoteStore,r.targetId))}async function u3(n,e,t){const r=Xx(n);try{const a=await(function(d,f){const m=Ae(d),x=At.now(),y=f.reduce(((A,V)=>A.add(V.key)),He());let v,E;return m.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let V=ts(),C=He();return m.cs.getEntries(A,y).next((O=>{V=O,V.forEach(((z,ae)=>{ae.isValidDocument()||(C=C.add(z))}))})).next((()=>m.localDocuments.getOverlayedDocuments(A,V))).next((O=>{v=O;const z=[];for(const ae of f){const K=MD(ae,v.get(ae.key).overlayedDocument);K!=null&&z.push(new ti(ae.key,K,HT(K.value.mapValue),St.exists(!0)))}return m.mutationQueue.addMutationBatch(A,x,z,f)})).next((O=>{E=O;const z=O.applyToLocalDocumentSet(v,C);return m.documentOverlayCache.saveOverlays(A,O.batchId,z)}))})).then((()=>({batchId:E.batchId,changes:s2(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let x=d.Ba[d.currentUser.toKey()];x||(x=new yt(qe)),x=x.insert(f,m),d.Ba[d.currentUser.toKey()]=x})(r,a.batchId,t),await ni(r,a.changes),await dc(r.remoteStore)}catch(a){const c=fc(a,"Failed to persist write");t.reject(c)}}async function lE(n,e){const t=Ae(n);try{const r=await I4(t.localStore,e);e.targetChanges.forEach(((a,c)=>{const d=t.Na.get(c);d&&(Re(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?d.va=!0:a.modifiedDocuments.size>0?Re(d.va):a.removedDocuments.size>0&&(Re(d.va),d.va=!1))})),await ni(t,r,e)}catch(r){await fa(r)}}function R1(n,e,t){const r=Ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Fa.forEach(((c,d)=>{const f=d.view.Z_(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=Ae(d);m.onlineState=f;let x=!1;m.queries.forEach(((y,v)=>{for(const E of v.j_)E.Z_(f)&&(x=!0)})),x&&Gx(m)})(r.eventManager,e),a.length&&r.Ca.d_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function d3(n,e,t){const r=Ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Na.get(e),c=a&&a.key;if(c){let d=new yt(Se.comparator);d=d.insert(c,wt.newNoDocument(c,De.min()));const f=He().add(c),m=new Ed(De.min(),new Map,new yt(qe),d,f);await lE(r,m),r.Oa=r.Oa.remove(c),r.Na.delete(e),Wx(r)}else await Yl(r.localStore,e,!1).then((()=>Jl(r,e,t))).catch(fa)}async function h3(n,e){const t=Ae(n),r=e.batch.batchId;try{const a=await A4(t.localStore,e);Yx(t,r,null),Qx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ni(t,a)}catch(a){await fa(a)}}async function f3(n,e,t){const r=Ae(n);try{const a=await(function(d,f){const m=Ae(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(x=>{let y;return m.mutationQueue.lookupMutationBatch(x,f).next((v=>(Re(v!==null),y=v.keys(),m.mutationQueue.removeMutationBatch(x,v)))).next((()=>m.mutationQueue.performConsistencyCheck(x))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(x,y,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(x,y))).next((()=>m.localDocuments.getDocuments(x,y)))}))})(r.localStore,e);Yx(r,e,t),Qx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ni(r,a)}catch(a){await fa(a)}}async function m3(n,e){const t=Ae(n);ga(t.remoteStore)||xe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(d){const f=Ae(d);return f.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(m=>f.mutationQueue.getHighestUnacknowledgedBatchId(m)))})(t.localStore);if(r===-1)return void e.resolve();const a=t.ka.get(r)||[];a.push(e),t.ka.set(r,a)}catch(r){const a=fc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function Qx(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function Yx(n,e,t){const r=Ae(n);let a=r.Ba[r.currentUser.toKey()];if(a){const c=a.get(e);c&&(t?c.reject(t):c.resolve(),a=a.remove(e)),r.Ba[r.currentUser.toKey()]=a}}function Jl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((r=>{n.La.containsKey(r)||cE(n,r)}))}function cE(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Wl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Wx(n))}function M0(n,e,t){for(const r of t)r instanceof rE?(n.La.addReference(r.key,e),p3(n,r)):r instanceof iE?(xe("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||cE(n,r.key)):Ie()}function p3(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(xe("SyncEngine","New document in limbo: "+t),n.xa.add(r),Wx(n))}function Wx(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Se(Je.fromString(e)),r=n.qa.next();n.Na.set(r,new r3(t)),n.Oa=n.Oa.insert(t,r),xm(n.remoteStore,new Kr(Fn(oc(t.path)),r,"TargetPurposeLimboResolution",Zn.oe))}}async function ni(n,e,t){const r=Ae(n),a=[],c=[],d=[];r.Fa.isEmpty()||(r.Fa.forEach(((f,m)=>{d.push(r.Ka(m,e,t).then((x=>{var y;if((x||t)&&r.isPrimaryClient){const v=x?!x.fromCache:(y=t==null?void 0:t.targetChanges.get(m.targetId))===null||y===void 0?void 0:y.current;r.sharedClientState.updateQueryState(m.targetId,v?"current":"not-current")}if(x){a.push(x);const v=Ox.Wi(m.targetId,x);c.push(v)}})))})),await Promise.all(d),r.Ca.d_(a),await(async function(m,x){const y=Ae(m);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Z.forEach(x,(E=>Z.forEach(E.$i,(A=>y.persistence.referenceDelegate.addReference(v,E.targetId,A))).next((()=>Z.forEach(E.Ui,(A=>y.persistence.referenceDelegate.removeReference(v,E.targetId,A)))))))))}catch(v){if(!ma(v))throw v;xe("LocalStore","Failed to update sequence numbers: "+v)}for(const v of x){const E=v.targetId;if(!v.fromCache){const A=y.os.get(E),V=A.snapshotVersion,C=A.withLastLimboFreeSnapshotVersion(V);y.os=y.os.insert(E,C)}}})(r.localStore,c))}async function g3(n,e){const t=Ae(n);if(!t.currentUser.isEqual(e)){xe("SyncEngine","User change. New user:",e.toKey());const r=await z2(t.localStore,e);t.currentUser=e,(function(c,d){c.ka.forEach((f=>{f.forEach((m=>{m.reject(new ge(re.CANCELLED,d))}))})),c.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ni(t,r.hs)}}function x3(n,e){const t=Ae(n),r=t.Na.get(e);if(r&&r.va)return He().add(r.key);{let a=He();const c=t.Ma.get(e);if(!c)return a;for(const d of c){const f=t.Fa.get(d);a=a.unionWith(f.view.Va)}return a}}async function y3(n,e){const t=Ae(n),r=await Bf(t.localStore,e.query,!0),a=e.view.ba(r);return t.isPrimaryClient&&M0(t,e.targetId,a.wa),a}async function b3(n,e){const t=Ae(n);return $2(t.localStore,e).then((r=>ni(t,r)))}async function v3(n,e,t,r){const a=Ae(n),c=await(function(f,m){const x=Ae(f),y=Ae(x.mutationQueue);return x.persistence.runTransaction("Lookup mutation documents","readonly",(v=>y.Mn(v,m).next((E=>E?x.localDocuments.getDocuments(v,E):Z.resolve(null)))))})(a.localStore,e);c!==null?(t==="pending"?await dc(a.remoteStore):t==="acknowledged"||t==="rejected"?(Yx(a,e,r||null),Qx(a,e),(function(f,m){Ae(Ae(f).mutationQueue).On(m)})(a.localStore,e)):Ie(),await ni(a,c)):xe("SyncEngine","Cannot apply mutation batch with id: "+e)}async function _3(n,e){const t=Ae(n);if(ym(t),Xx(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),a=await C1(t,r.toArray());t.Qa=!0,await k0(t.remoteStore,!0);for(const c of a)xm(t.remoteStore,c)}else if(e===!1&&t.Qa!==!1){const r=[];let a=Promise.resolve();t.Ma.forEach(((c,d)=>{t.sharedClientState.isLocalQueryTarget(d)?r.push(d):a=a.then((()=>(Jl(t,d),Yl(t.localStore,d,!0)))),Wl(t.remoteStore,d)})),await a,await C1(t,r),(function(d){const f=Ae(d);f.Na.forEach(((m,x)=>{Wl(f.remoteStore,x)})),f.La.pr(),f.Na=new Map,f.Oa=new yt(Se.comparator)})(t),t.Qa=!1,await k0(t.remoteStore,!1)}}async function C1(n,e,t){const r=Ae(n),a=[],c=[];for(const d of e){let f;const m=r.Ma.get(d);if(m&&m.length!==0){f=await Ql(r.localStore,Fn(m[0]));for(const x of m){const y=r.Fa.get(x),v=await y3(r,y);v.snapshot&&c.push(v.snapshot)}}else{const x=await K2(r.localStore,d);f=await Ql(r.localStore,x),await $x(r,uE(x),d,!1,f.resumeToken)}a.push(f)}return r.Ca.d_(c),a}function uE(n){return JT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function w3(n){return(function(t){return Ae(Ae(t).persistence).Qi()})(Ae(n).localStore)}async function N3(n,e,t,r){const a=Ae(n);if(a.Qa)return void xe("SyncEngine","Ignoring unexpected query state notification.");const c=a.Ma.get(e);if(c&&c.length>0)switch(t){case"current":case"not-current":{const d=await $2(a.localStore,e2(c[0])),f=Ed.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Pt.EMPTY_BYTE_STRING);await ni(a,d,f);break}case"rejected":await Yl(a.localStore,e,!0),Jl(a,e,r);break;default:Ie()}}async function T3(n,e,t){const r=ym(n);if(r.Qa){for(const a of e){if(r.Ma.has(a)&&r.sharedClientState.isActiveQueryTarget(a)){xe("SyncEngine","Adding an already active target "+a);continue}const c=await K2(r.localStore,a),d=await Ql(r.localStore,c);await $x(r,uE(c),d.targetId,!1,d.resumeToken),xm(r.remoteStore,d)}for(const a of t)r.Ma.has(a)&&await Yl(r.localStore,a,!1).then((()=>{Wl(r.remoteStore,a),Jl(r,a)})).catch(fa)}}function ym(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=lE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=x3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=d3.bind(null,e),e.Ca.d_=Z4.bind(null,e.eventManager),e.Ca.$a=e3.bind(null,e.eventManager),e}function Xx(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=h3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=f3.bind(null,e),e}function E3(n,e,t){const r=Ae(n);(async function(c,d,f){try{const m=await d.getMetadata();if(await(function(A,V){const C=Ae(A),O=Ht(V.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",(z=>C.Gr.getBundleMetadata(z,V.id))).then((z=>!!z&&z.createTime.compareTo(O)>=0))})(c.localStore,m))return await d.close(),f._completeWith((function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}})(m)),Promise.resolve(new Set);f._updateProgress(sE(m));const x=new n3(m,c.localStore,d.serializer);let y=await d.Ua();for(;y;){const E=await x.la(y);E&&f._updateProgress(E),y=await d.Ua()}const v=await x.complete();return await ni(c,v.Ia,void 0),await(function(A,V){const C=Ae(A);return C.persistence.runTransaction("Save bundle","readwrite",(O=>C.Gr.saveBundleMetadata(O,V)))})(c.localStore,m),f._completeWith(v.progress),Promise.resolve(v.Pa)}catch(m){return fr("SyncEngine",`Loading bundle failed with ${m}`),f._failWith(m),Promise.resolve(new Set)}})(r,e,t).then((a=>{r.sharedClientState.notifyBundleLoaded(a)}))}class nd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ad(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return B2(this.persistence,new q2,e.initialUser,this.serializer)}Ga(e){return new F2(gm.Zr,this.serializer)}Wa(e){return new Y2}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nd.provider={build:()=>new nd};class dE extends nd{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Xx(this.Ja.syncEngine),await dc(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return B2(this.persistence,new q2,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new c4(r,e.asyncQueue,t)}Ha(e,t){const r=new H5(t,this.persistence);return new z5(e.asyncQueue,r)}Ga(e){const t=Px(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Mx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,W2(),Sf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Y2}}class S3 extends dE{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof e0&&(this.sharedClientState.syncEngine={no:v3.bind(null,t),ro:N3.bind(null,t),io:T3.bind(null,t),Qi:w3.bind(null,t),eo:b3.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async r=>{await _3(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=W2();if(!e0.D(t))throw new ge(re.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Px(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new e0(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class sd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>R1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=g3.bind(null,this.syncEngine),await k0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new J4})()}createDatastore(e){const t=Ad(e.databaseInfo.databaseId),r=(function(c){return new P4(c)})(e.databaseInfo);return(function(c,d,f,m){return new L4(c,d,f,m)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,c,d,f){return new F4(r,a,c,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>R1(this.syncEngine,t,0)),(function(){return T1.D()?new T1:new k4})())}createSyncEngine(e,t){return(function(a,c,d,f,m,x,y){const v=new i3(a,c,d,f,m,x);return y&&(v.Qa=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const c=Ae(a);xe("RemoteStore","RemoteStore shutting down."),c.L_.add(5),await uc(c),c.k_.shutdown(),c.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}sd.provider={build:()=>new sd};function k1(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):zt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Nn,this.buffer=new Uint8Array,this.eu=(function(){return new TextDecoder("utf-8")})(),this.tu().then((r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const a=await this.iu(r);return new t3(JSON.parse(a),e.length+r)}su(){return this.buffer.findIndex((e=>e===123))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,c){const d=Ae(a),f={documents:c.map((v=>ed(d.serializer,v)))},m=await d.Lo("BatchGetDocuments",d.serializer.databaseId,Je.emptyPath(),f,c.length),x=new Map;m.forEach((v=>{const E=zD(d.serializer,v);x.set(E.key.toString(),E)}));const y=[];return c.forEach((v=>{const E=x.get(v.toString());Re(!!E),y.push(E)})),y})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new cc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const a=Se.fromPath(r);this.mutations.push(new Tx(a,this.precondition(a)))})),await(async function(r,a){const c=Ae(r),d={writes:a.map((f=>td(c.serializer,f)))};await c.Mo("Commit",c.serializer.databaseId,Je.emptyPath(),d)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ie();t=De.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ge(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(De.min())?St.exists(!1):St.updateTime(t):St.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(De.min()))throw new ge(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return St.updateTime(t)}return St.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(e,t,r,a,c){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=c,this._u=r.maxAttempts,this.t_=new Lx(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new I3(this.datastore),t=this.cu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((a=>{this.lu(a)}))))})).catch((r=>{this.lu(r)}))}))}cu(e){try{const t=this.updateFunction(e);return!vd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!f2(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,t,r,a,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=fn.UNAUTHENTICATED,this.clientId=IT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(r,(async d=>{xe("FirestoreClient","Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(r,(d=>(xe("FirestoreClient","Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Nn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=fc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function n0(n,e){n.asyncQueue.verifyOperationInProgress(),xe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await z2(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function D1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Jx(n);xe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>E1(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>E1(e.remoteStore,a))),n._onlineComponents=e}async function Jx(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){xe("FirestoreClient","Using user provided OfflineComponentProvider");try{await n0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===re.FAILED_PRECONDITION||a.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;fr("Error using user provided cache. Falling back to memory cache: "+t),await n0(n,new nd)}}else xe("FirestoreClient","Using default OfflineComponentProvider"),await n0(n,new nd);return n._offlineComponents}async function vm(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(xe("FirestoreClient","Using user provided OnlineComponentProvider"),await D1(n,n._uninitializedComponentsProvider._online)):(xe("FirestoreClient","Using default OnlineComponentProvider"),await D1(n,new sd))),n._onlineComponents}function hE(n){return Jx(n).then((e=>e.persistence))}function Zx(n){return Jx(n).then((e=>e.localStore))}function fE(n){return vm(n).then((e=>e.remoteStore))}function ey(n){return vm(n).then((e=>e.syncEngine))}function C3(n){return vm(n).then((e=>e.datastore))}async function Zl(n){const e=await vm(n),t=e.eventManager;return t.onListen=a3.bind(null,e.syncEngine),t.onUnlisten=l3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=o3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=c3.bind(null,e.syncEngine),t}function k3(n){return n.asyncQueue.enqueue((async()=>{const e=await hE(n),t=await fE(n);return e.setNetworkEnabled(!0),(function(a){const c=Ae(a);return c.L_.delete(0),Id(c)})(t)}))}function D3(n){return n.asyncQueue.enqueue((async()=>{const e=await hE(n),t=await fE(n);return e.setNetworkEnabled(!1),(async function(a){const c=Ae(a);c.L_.add(0),await uc(c),c.q_.set("Offline")})(t)}))}function M3(n,e){const t=new Nn;return n.asyncQueue.enqueueAndForget((async()=>(async function(a,c,d){try{const f=await(function(x,y){const v=Ae(x);return v.persistence.runTransaction("read document","readonly",(E=>v.localDocuments.getDocument(E,y)))})(a,c);f.isFoundDocument()?d.resolve(f):f.isNoDocument()?d.resolve(null):d.reject(new ge(re.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(f){const m=fc(f,`Failed to get document '${c} from cache`);d.reject(m)}})(await Zx(n),e,t))),t.promise}function mE(n,e,t={}){const r=new Nn;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,m,x){const y=new bm({next:E=>{y.Za(),d.enqueueAndForget((()=>Hx(c,v)));const A=E.docs.has(f);!A&&E.fromCache?x.reject(new ge(re.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&m&&m.source==="server"?x.reject(new ge(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):x.resolve(E)},error:E=>x.reject(E)}),v=new Kx(oc(f.path),y,{includeMetadataChanges:!0,_a:!0});return zx(c,v)})(await Zl(n),n.asyncQueue,e,t,r))),r.promise}function P3(n,e){const t=new Nn;return n.asyncQueue.enqueueAndForget((async()=>(async function(a,c,d){try{const f=await Bf(a,c,!0),m=new aE(c,f.Ts),x=m.ma(f.documents),y=m.applyChanges(x,!1);d.resolve(y.snapshot)}catch(f){const m=fc(f,`Failed to execute query '${c} against cache`);d.reject(m)}})(await Zx(n),e,t))),t.promise}function pE(n,e,t={}){const r=new Nn;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,m,x){const y=new bm({next:E=>{y.Za(),d.enqueueAndForget((()=>Hx(c,v))),E.fromCache&&m.source==="server"?x.reject(new ge(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):x.resolve(E)},error:E=>x.reject(E)}),v=new Kx(f,y,{includeMetadataChanges:!0,_a:!0});return zx(c,v)})(await Zl(n),n.asyncQueue,e,t,r))),r.promise}function O3(n,e){const t=new bm(e);return n.asyncQueue.enqueueAndForget((async()=>(function(a,c){Ae(a).Y_.add(c),c.next()})(await Zl(n),t))),()=>{t.Za(),n.asyncQueue.enqueueAndForget((async()=>(function(a,c){Ae(a).Y_.delete(c)})(await Zl(n),t)))}}function V3(n,e,t,r){const a=(function(d,f){let m;return m=typeof d=="string"?p2().encode(d):d,(function(y,v){return new A3(y,v)})((function(y,v){if(y instanceof Uint8Array)return k1(y,v);if(y instanceof ArrayBuffer)return k1(new Uint8Array(y),v);if(y instanceof ReadableStream)return y.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(m),f)})(t,Ad(e));n.asyncQueue.enqueueAndForget((async()=>{E3(await ey(n),a,r)}))}function L3(n,e){return n.asyncQueue.enqueue((async()=>(function(r,a){const c=Ae(r);return c.persistence.runTransaction("Get named query","readonly",(d=>c.Gr.getNamedQuery(d,a)))})(await Zx(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gE(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(n,e,t){if(!t)throw new ge(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xE(n,e,t,r){if(e===!0&&r===!0)throw new ge(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function P1(n){if(!Se.isDocumentKey(n))throw new ge(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function O1(n){if(Se.isDocumentKey(n))throw new ge(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _m(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie()}function it(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ge(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_m(n);throw new ge(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function yE(n,e){if(e<=0)throw new ge(re.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jd{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new V1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new V1(e),e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new k5;switch(r.type){case"firstParty":return new O5(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=M1.get(t);r&&(xe("ComponentProvider","Removing Datastore"),M1.delete(t),r.terminate())})(this),Promise.resolve()}}function U3(n,e,t,r={}){var a;const c=(n=it(n,jd))._getSettings(),d=`${e}:${t}`;if(c.host!=="firestore.googleapis.com"&&c.host!==d&&fr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},c),{host:d,ssl:!1})),r.mockUserToken){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=fn.MOCK_USER;else{f=YA(r.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new ge(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new fn(x)}n._authCredentials=new D5(new AT(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qn=class bE{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new bE(this.firestore,e,this._query)}},It=class vE{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vE(this.firestore,e,this._key)}},Zi=class _E extends qn{constructor(e,t,r){super(e,t,oc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new Se(e))}withConverter(e){return new _E(this.firestore,e,this._path)}};function wE(n,e,...t){if(n=Oe(n),ty("collection","path",e),n instanceof jd){const r=Je.fromString(e,...t);return O1(r),new Zi(n,null,r)}{if(!(n instanceof It||n instanceof Zi))throw new ge(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Je.fromString(e,...t));return O1(r),new Zi(n.firestore,null,r)}}function F3(n,e){if(n=it(n,jd),ty("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ge(re.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qn(n,null,(function(r){return new ei(Je.emptyPath(),r)})(e))}function Kf(n,e,...t){if(n=Oe(n),arguments.length===1&&(e=IT.newId()),ty("doc","path",e),n instanceof jd){const r=Je.fromString(e,...t);return P1(r),new It(n,null,new Se(r))}{if(!(n instanceof It||n instanceof Zi))throw new ge(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Je.fromString(e,...t));return P1(r),new It(n.firestore,n instanceof Zi?n.converter:null,new Se(r))}}function NE(n,e){return n=Oe(n),e=Oe(e),(n instanceof It||n instanceof Zi)&&(e instanceof It||e instanceof Zi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function TE(n,e){return n=Oe(n),e=Oe(e),n instanceof qn&&e instanceof qn&&n.firestore===e.firestore&&wd(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lx(this,"async_queue_retry"),this.Vu=()=>{const r=Sf();r&&xe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Sf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Sf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Nn;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ma(e))throw e;xe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((r=>{this.Eu=r,this.du=!1;const a=(function(d){let f=d.message||"";return d.stack&&(f=d.stack.includes(d.message)?d.stack:d.message+`
`+d.stack),f})(r);throw zt("INTERNAL UNHANDLED ERROR: ",a),r})).then((r=>(this.du=!1,r))))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const a=Bx.createAndSchedule(this,e,t,r,(c=>this.yu(c)));return this.Tu.push(a),a}fu(){this.Eu&&Ie()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function P0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const c of r)if(c in a&&typeof a[c]=="function")return!0;return!1})(n,["next","error","complete"])}class q3{constructor(){this._progressObserver={},this._taskCompletionResolver=new Nn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=-1;let Gt=class extends jd{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new L1,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new L1(e),this._firestoreClient=void 0,await e}}};function jn(n){if(n._terminated)throw new ge(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||EE(n),n._firestoreClient}function EE(n){var e,t,r;const a=n._freezeSettings(),c=(function(f,m,x,y){return new hD(f,m,x,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,gE(y.experimentalLongPollingOptions),y.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new R3(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}function z3(n,e){fr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return SE(n,sd.provider,{build:r=>new dE(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function H3(n){fr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();SE(n,sd.provider,{build:t=>new S3(t,e.cacheSizeBytes)})}function SE(n,e,t){if((n=it(n,Gt))._firestoreClient||n._terminated)throw new ge(re.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ge(re.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},EE(n)}function G3(n){if(n._initialized&&!n._terminated)throw new ge(re.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Nn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!cr.D())return Promise.resolve();const a=r+"main";await cr.delete(a)})(Px(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function K3(n){return(function(t){const r=new Nn;return t.asyncQueue.enqueueAndForget((async()=>m3(await ey(t),r))),r.promise})(jn(n=it(n,Gt)))}function $3(n){return k3(jn(n=it(n,Gt)))}function Q3(n){return D3(jn(n=it(n,Gt)))}function Y3(n,e){const t=jn(n=it(n,Gt)),r=new q3;return V3(t,n._databaseId,e,r),r}function W3(n,e){return L3(jn(n=it(n,Gt)),e).then((t=>t?new qn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pr(Pt.fromBase64String(e))}catch(t){throw new ge(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pr(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ca=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eo=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let c=0;c<r.length;++c)if(r[c]!==a[c])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3=/^__.*__$/;class J3{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ti(e,this.data,this.fieldMask,t,this.fieldTransforms):new lc(e,this.data,t,this.fieldTransforms)}}class AE{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ti(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie()}}class Nm{constructor(e,t,r,a,c,d){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,c===void 0&&this.vu(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Nm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:r,xu:!1});return a.Ou(e),a}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:r,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return $f(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(IE(this.Cu)&&X3.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Z3{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ad(e)}Qu(e,t,r,a=!1){return new Nm({Cu:e,methodName:t,qu:r,path:Et.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function So(n){const e=n._freezeSettings(),t=Ad(n._databaseId);return new Z3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Tm(n,e,t,r,a,c={}){const d=n.Qu(c.merge||c.mergeFields?2:0,e,t,a);cy("Data must be an object, but it was:",d,r);const f=CE(r,d);let m,x;if(c.merge)m=new es(d.fieldMask),x=d.fieldTransforms;else if(c.mergeFields){const y=[];for(const v of c.mergeFields){const E=O0(e,v,t);if(!d.contains(E))throw new ge(re.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);DE(y,E)||y.push(E)}m=new es(y),x=d.fieldTransforms.filter((v=>m.covers(v.field)))}else m=null,x=d.fieldTransforms;return new J3(new wn(f),m,x)}class Rd extends Eo{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rd}}function jE(n,e,t){return new Nm({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class sy extends Eo{_toFieldTransform(e){return new Td(e.path,new Gl)}isEqual(e){return e instanceof sy}}class ry extends Eo{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=jE(this,e,!0),r=this.Ku.map((c=>Ao(c,t))),a=new po(r);return new Td(e.path,a)}isEqual(e){return e instanceof ry&&Uu(this.Ku,e.Ku)}}class iy extends Eo{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=jE(this,e,!0),r=this.Ku.map((c=>Ao(c,t))),a=new go(r);return new Td(e.path,a)}isEqual(e){return e instanceof iy&&Uu(this.Ku,e.Ku)}}class ay extends Eo{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Kl(e.serializer,a2(e.serializer,this.$u));return new Td(e.path,t)}isEqual(e){return e instanceof ay&&this.$u===e.$u}}function oy(n,e,t,r){const a=n.Qu(1,e,t);cy("Data must be an object, but it was:",a,r);const c=[],d=wn.empty();To(r,((m,x)=>{const y=uy(e,m,t);x=Oe(x);const v=a.Nu(y);if(x instanceof Rd)c.push(y);else{const E=Ao(x,v);E!=null&&(c.push(y),d.set(y,E))}}));const f=new es(c);return new AE(d,f,a.fieldTransforms)}function ly(n,e,t,r,a,c){const d=n.Qu(1,e,t),f=[O0(e,r,t)],m=[a];if(c.length%2!=0)throw new ge(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<c.length;E+=2)f.push(O0(e,c[E])),m.push(c[E+1]);const x=[],y=wn.empty();for(let E=f.length-1;E>=0;--E)if(!DE(x,f[E])){const A=f[E];let V=m[E];V=Oe(V);const C=d.Nu(A);if(V instanceof Rd)x.push(A);else{const O=Ao(V,C);O!=null&&(x.push(A),y.set(A,O))}}const v=new es(x);return new AE(y,v,d.fieldTransforms)}function RE(n,e,t,r=!1){return Ao(t,n.Qu(r?4:3,e))}function Ao(n,e){if(kE(n=Oe(n)))return cy("Unsupported field value:",e,n),CE(n,e);if(n instanceof Eo)return(function(r,a){if(!IE(a.Cu))throw a.Bu(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${r._methodName}() is not currently supported inside arrays`);const c=r._toFieldTransform(a);c&&a.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(r,a){const c=[];let d=0;for(const f of r){let m=Ao(f,a.Lu(d));m==null&&(m={nullValue:"NULL_VALUE"}),c.push(m),d++}return{arrayValue:{values:c}}})(n,e)}return(function(r,a){if((r=Oe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return a2(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const c=At.fromDate(r);return{timestampValue:$l(a.serializer,c)}}if(r instanceof At){const c=new At(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$l(a.serializer,c)}}if(r instanceof wm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pr)return{bytesValue:y2(a.serializer,r._byteString)};if(r instanceof It){const c=a.databaseId,d=r.firestore._databaseId;if(!d.isEqual(c))throw a.Bu(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:jx(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof ny)return(function(d,f){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:d.toArray().map((m=>{if(typeof m!="number")throw f.Bu("VectorValues must only contain numeric values.");return Nx(f.serializer,m)}))}}}}}})(r,a);throw a.Bu(`Unsupported field value: ${_m(r)}`)})(n,e)}function CE(n,e){const t={};return FT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):To(n,((r,a)=>{const c=Ao(a,e.Mu(r));c!=null&&(t[r]=c)})),{mapValue:{fields:t}}}function kE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof At||n instanceof wm||n instanceof pr||n instanceof It||n instanceof Eo||n instanceof ny)}function cy(n,e,t){if(!kE(t)||!(function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)})(t)){const r=_m(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function O0(n,e,t){if((e=Oe(e))instanceof ca)return e._internalPath;if(typeof e=="string")return uy(n,e);throw $f("Field path arguments must be of type string or ",n,!1,void 0,t)}const eM=new RegExp("[~\\*/\\[\\]]");function uy(n,e,t){if(e.search(eM)>=0)throw $f(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ca(...e.split("."))._internalPath}catch{throw $f(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $f(n,e,t,r,a){const c=r&&!r.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(c||d)&&(m+=" (found",c&&(m+=` in field ${r}`),d&&(m+=` in document ${a}`),m+=")"),new ge(re.INVALID_ARGUMENT,f+n+m)}function DE(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,t,r,a,c){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Em("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class tM extends rd{data(){return super.data()}}function Em(n,e){return typeof e=="string"?uy(n,e):e instanceof ca?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ge(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dy{}class Cd extends dy{}function $i(n,e,...t){let r=[];e instanceof dy&&r.push(e),r=r.concat(t),(function(c){const d=c.filter((m=>m instanceof hy)).length,f=c.filter((m=>m instanceof Sm)).length;if(d>1||d>0&&f>0)throw new ge(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class Sm extends Cd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Sm(e,t,r)}_apply(e){const t=this._parse(e);return OE(e._query,t),new qn(e.firestore,e.converter,N0(e._query,t))}_parse(e){const t=So(e.firestore);return(function(c,d,f,m,x,y,v){let E;if(x.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ge(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){F1(v,y);const A=[];for(const V of v)A.push(U1(m,c,V));E={arrayValue:{values:A}}}else E=U1(m,c,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||F1(v,y),E=RE(f,d,v,y==="in"||y==="not-in");return Ze.create(x,y,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nM(n,e,t){const r=e,a=Em("where",n);return Sm._create(a,r,t)}class hy extends dy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hy(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:dt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,c){let d=a;const f=c.getFlattenedFilters();for(const m of f)OE(d,m),d=N0(d,m)})(e._query,t),new qn(e.firestore,e.converter,N0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fy extends Cd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new fy(e,t)}_apply(e){const t=(function(a,c,d){if(a.startAt!==null)throw new ge(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ge(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zu(c,d)})(e._query,this._field,this._direction);return new qn(e.firestore,e.converter,(function(a,c){const d=a.explicitOrderBy.concat([c]);return new ei(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function sM(n,e="asc"){const t=e,r=Em("orderBy",n);return fy._create(r,t)}class Am extends Cd{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Am(e,t,r)}_apply(e){return new qn(e.firestore,e.converter,Lf(e._query,this._limit,this._limitType))}}function rM(n){return yE("limit",n),Am._create("limit",n,"F")}function iM(n){return yE("limitToLast",n),Am._create("limitToLast",n,"L")}class Im extends Cd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Im(e,t,r)}_apply(e){const t=PE(e,this.type,this._docOrFields,this._inclusive);return new qn(e.firestore,e.converter,(function(a,c){return new ei(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,c,a.endAt)})(e._query,t))}}function aM(...n){return Im._create("startAt",n,!0)}function oM(...n){return Im._create("startAfter",n,!1)}class jm extends Cd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new jm(e,t,r)}_apply(e){const t=PE(e,this.type,this._docOrFields,this._inclusive);return new qn(e.firestore,e.converter,(function(a,c){return new ei(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,c)})(e._query,t))}}function lM(...n){return jm._create("endBefore",n,!1)}function cM(...n){return jm._create("endAt",n,!0)}function PE(n,e,t,r){if(t[0]=Oe(t[0]),t[0]instanceof rd)return(function(c,d,f,m,x){if(!m)throw new ge(re.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const y=[];for(const v of Ol(c))if(v.field.isKeyField())y.push(fo(d,m.key));else{const E=m.data.field(v.field);if(um(E))throw new ge(re.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const A=v.field.canonicalString();throw new ge(re.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}y.push(E)}return new oa(y,x)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const a=So(n.firestore);return(function(d,f,m,x,y,v){const E=d.explicitOrderBy;if(y.length>E.length)throw new ge(re.INVALID_ARGUMENT,`Too many arguments provided to ${x}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let V=0;V<y.length;V++){const C=y[V];if(E[V].field.isKeyField()){if(typeof C!="string")throw new ge(re.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${x}(), but got a ${typeof C}`);if(!_x(d)&&C.indexOf("/")!==-1)throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${x}() must be a plain document ID, but '${C}' contains a slash.`);const O=d.path.child(Je.fromString(C));if(!Se.isDocumentKey(O))throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${x}() must result in a valid document path, but '${O}' is not because it contains an odd number of segments.`);const z=new Se(O);A.push(fo(f,z))}else{const O=RE(m,x,C);A.push(O)}}return new oa(A,v)})(n._query,n.firestore._databaseId,a,e,t,r)}}function U1(n,e,t){if(typeof(t=Oe(t))=="string"){if(t==="")throw new ge(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_x(e)&&t.indexOf("/")!==-1)throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Je.fromString(t));if(!Se.isDocumentKey(r))throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fo(n,new Se(r))}if(t instanceof It)return fo(n,t._key);throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_m(t)}.`)}function F1(n,e){if(!Array.isArray(n)||n.length===0)throw new ge(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OE(n,e){const t=(function(a,c){for(const d of a)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ge(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class my{convertValue(e,t="none"){switch(ho(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return To(e,((a,c)=>{r[a]=this.convertValue(c,t)})),r}convertVectorValue(e){var t,r,a;const c=(a=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map((d=>Tt(d.doubleValue)));return new ny(c)}convertGeoPoint(e){return new wm(Tt(e.latitude),Tt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=bx(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Wu(e));default:return null}}convertTimestamp(e){const t=Wr(e);return new At(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Je.fromString(e);Re(j2(r));const a=new ia(r.get(1),r.get(3)),c=new Se(r.popFirst(5));return a.isEqual(t)||zt(`Document ${c} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class uM extends my{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Xr=class extends rd{constructor(e,t,r,a,c,d){super(e,t,r,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Em("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Vu=class extends Xr{data(e={}){return super.data(e)}},ua=class{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new so(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Vu(this._firestore,this._userDataWriter,r.key,r,new so(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,c){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new Vu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new so(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>c||f.type!==3)).map((f=>{const m=new Vu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new so(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let x=-1,y=-1;return f.type!==0&&(x=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),y=d.indexOf(f.doc.key)),{type:dM(f.type),doc:m,oldIndex:x,newIndex:y}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function dM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie()}}function VE(n,e){return n instanceof Xr&&e instanceof Xr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ua&&e instanceof ua&&n._firestore===e._firestore&&TE(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hM(n){n=it(n,It);const e=it(n.firestore,Gt);return mE(jn(e),n._key).then((t=>py(e,n,t)))}class Io extends my{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,t)}}function fM(n){n=it(n,It);const e=it(n.firestore,Gt),t=jn(e),r=new Io(e);return M3(t,n._key).then((a=>new Xr(e,r,n._key,a,new so(a!==null&&a.hasLocalMutations,!0),n.converter)))}function mM(n){n=it(n,It);const e=it(n.firestore,Gt);return mE(jn(e),n._key,{source:"server"}).then((t=>py(e,n,t)))}function pM(n){n=it(n,qn);const e=it(n.firestore,Gt),t=jn(e),r=new Io(e);return ME(n._query),pE(t,n._query).then((a=>new ua(e,r,n,a)))}function gM(n){n=it(n,qn);const e=it(n.firestore,Gt),t=jn(e),r=new Io(e);return P3(t,n._query).then((a=>new ua(e,r,n,a)))}function xM(n){n=it(n,qn);const e=it(n.firestore,Gt),t=jn(e),r=new Io(e);return pE(t,n._query,{source:"server"}).then((a=>new ua(e,r,n,a)))}function q1(n,e,t){n=it(n,It);const r=it(n.firestore,Gt),a=Rm(n.converter,e,t);return kd(r,[Tm(So(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,St.none())])}function B1(n,e,t,...r){n=it(n,It);const a=it(n.firestore,Gt),c=So(a);let d;return d=typeof(e=Oe(e))=="string"||e instanceof ca?ly(c,"updateDoc",n._key,e,t,r):oy(c,"updateDoc",n._key,e),kd(a,[d.toMutation(n._key,St.exists(!0))])}function yM(n){return kd(it(n.firestore,Gt),[new cc(n._key,St.none())])}function bM(n,e){const t=it(n.firestore,Gt),r=Kf(n),a=Rm(n.converter,e);return kd(t,[Tm(So(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,St.exists(!1))]).then((()=>r))}function LE(n,...e){var t,r,a;n=Oe(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||P0(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(P0(e[d])){const v=e[d];e[d]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[d+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[d+2]=(a=v.complete)===null||a===void 0?void 0:a.bind(v)}let m,x,y;if(n instanceof It)x=it(n.firestore,Gt),y=oc(n._key.path),m={next:v=>{e[d]&&e[d](py(x,n,v))},error:e[d+1],complete:e[d+2]};else{const v=it(n,qn);x=it(v.firestore,Gt),y=v._query;const E=new Io(x);m={next:A=>{e[d]&&e[d](new ua(x,E,v,A))},error:e[d+1],complete:e[d+2]},ME(n._query)}return(function(E,A,V,C){const O=new bm(C),z=new Kx(A,O,V);return E.asyncQueue.enqueueAndForget((async()=>zx(await Zl(E),z))),()=>{O.Za(),E.asyncQueue.enqueueAndForget((async()=>Hx(await Zl(E),z)))}})(jn(x),y,f,m)}function vM(n,e){return O3(jn(n=it(n,Gt)),P0(e)?e:{next:e})}function kd(n,e){return(function(r,a){const c=new Nn;return r.asyncQueue.enqueueAndForget((async()=>u3(await ey(r),a,c))),c.promise})(jn(n),e)}function py(n,e,t){const r=t.docs.get(e._key),a=new Io(n);return new Xr(n,a,e._key,r,new so(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wM=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=So(e)}set(e,t,r){this._verifyNotCommitted();const a=Yi(e,this._firestore),c=Rm(a.converter,t,r),d=Tm(this._dataReader,"WriteBatch.set",a._key,c,a.converter!==null,r);return this._mutations.push(d.toMutation(a._key,St.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const c=Yi(e,this._firestore);let d;return d=typeof(t=Oe(t))=="string"||t instanceof ca?ly(this._dataReader,"WriteBatch.update",c._key,t,r,a):oy(this._dataReader,"WriteBatch.update",c._key,t),this._mutations.push(d.toMutation(c._key,St.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Yi(e,this._firestore);return this._mutations=this._mutations.concat(new cc(t._key,St.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Yi(n,e){if((n=Oe(n)).firestore!==e)throw new ge(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NM=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=So(t)}get(t){const r=Yi(t,this._firestore),a=new uM(this._firestore);return this._transaction.lookup([r._key]).then((c=>{if(!c||c.length!==1)return Ie();const d=c[0];if(d.isFoundDocument())return new rd(this._firestore,a,d.key,d,r.converter);if(d.isNoDocument())return new rd(this._firestore,a,r._key,null,r.converter);throw Ie()}))}set(t,r,a){const c=Yi(t,this._firestore),d=Rm(c.converter,r,a),f=Tm(this._dataReader,"Transaction.set",c._key,d,c.converter!==null,a);return this._transaction.set(c._key,f),this}update(t,r,a,...c){const d=Yi(t,this._firestore);let f;return f=typeof(r=Oe(r))=="string"||r instanceof ca?ly(this._dataReader,"Transaction.update",d._key,r,a,c):oy(this._dataReader,"Transaction.update",d._key,r),this._transaction.update(d._key,f),this}delete(t){const r=Yi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Yi(e,this._firestore),r=new Io(this._firestore);return super.get(e).then((a=>new Xr(this._firestore,r,t._key,a._document,new so(!1,!1),t.converter)))}};function TM(n,e,t){n=it(n,Gt);const r=Object.assign(Object.assign({},_M),t);return(function(c){if(c.maxAttempts<1)throw new ge(re.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(c,d,f){const m=new Nn;return c.asyncQueue.enqueueAndForget((async()=>{const x=await C3(c);new j3(c.asyncQueue,x,f,d,m).au()})),m.promise})(jn(n),(a=>e(new NM(n,a))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(){return new Rd("deleteField")}function SM(){return new sy("serverTimestamp")}function AM(...n){return new ry("arrayUnion",n)}function IM(...n){return new iy("arrayRemove",n)}function jM(n){return new ay("increment",n)}(function(e,t=!0){(function(a){ac=a})(da),na(new dr("firestore",((r,{instanceIdentifier:a,options:c})=>{const d=r.getProvider("app").getImmediate(),f=new Gt(new M5(r.getProvider("auth-internal")),new L5(r.getProvider("app-check-internal")),(function(x,y){if(!Object.prototype.hasOwnProperty.apply(x.options,["projectId"]))throw new ge(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ia(x.options.projectId,y)})(d,a),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f}),"PUBLIC").setMultipleInstances(!0)),Bs(Cw,"4.7.3",e),Bs(Cw,"4.7.3","esm2017")})();const RM="@firebase/firestore-compat",CM="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ge("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){if(typeof Uint8Array>"u")throw new ge("unimplemented","Uint8Arrays are not available in this environment.")}function H1(){if(!uD())throw new ge("unimplemented","Blobs are unavailable in Firestore in this environment.")}class id{constructor(e){this._delegate=e}static fromBase64String(e){return H1(),new id(pr.fromBase64String(e))}static fromUint8Array(e){return z1(),new id(pr.fromUint8Array(e))}toBase64(){return H1(),this._delegate.toBase64()}toUint8Array(){return z1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(n){return kM(n,["next","error","complete"])}function kM(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{enableIndexedDbPersistence(e,t){return z3(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return H3(e._delegate)}clearIndexedDbPersistence(e){return G3(e._delegate)}}class UE{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ia||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&fr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){U3(this._delegate,e,t,r)}enableNetwork(){return $3(this._delegate)}disableNetwork(){return Q3(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,xE("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return K3(this._delegate)}onSnapshotsInSync(e){return vM(this._delegate,e)}get app(){if(!this._appCompat)throw new ge("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ec(this,wE(this._delegate,e))}catch(t){throw Vn(t,"collection()","Firestore.collection()")}}doc(e){try{return new js(this,Kf(this._delegate,e))}catch(t){throw Vn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new On(this,F3(this._delegate,e))}catch(t){throw Vn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return TM(this._delegate,t=>e(new FE(this,t)))}batch(){return jn(this._delegate),new qE(new wM(this._delegate,e=>kd(this._delegate,e)))}loadBundle(e){return Y3(this._delegate,e)}namedQuery(e){return W3(this._delegate,e).then(t=>t?new On(this,t):null)}}class Cm extends my{constructor(e){super(),this.firestore=e}convertBytes(e){return new id(new pr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return js.forKey(t,this.firestore,null)}}function MM(n){R5(n)}class FE{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Cm(e)}get(e){const t=ro(e);return this._delegate.get(t).then(r=>new ad(this._firestore,new Xr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const a=ro(e);return r?(gy("Transaction.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const c=ro(e);return arguments.length===2?this._delegate.update(c,t):this._delegate.update(c,t,r,...a),this}delete(e){const t=ro(e);return this._delegate.delete(t),this}}class qE{constructor(e){this._delegate=e}set(e,t,r){const a=ro(e);return r?(gy("WriteBatch.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const c=ro(e);return arguments.length===2?this._delegate.update(c,t):this._delegate.update(c,t,r,...a),this}delete(e){const t=ro(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class vo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Vu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new od(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=vo.INSTANCES;let a=r.get(e);a||(a=new WeakMap,r.set(e,a));let c=a.get(t);return c||(c=new vo(e,new Cm(e),t),a.set(t,c)),c}}vo.INSTANCES=new WeakMap;class js{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cm(e)}static forPath(e,t,r){if(e.length%2!==0)throw new ge("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new js(t,new It(t._delegate,r,new Se(e)))}static forKey(e,t,r){return new js(t,new It(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ec(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ec(this.firestore,wE(this._delegate,e))}catch(t){throw Vn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Oe(e),e instanceof It?NE(this._delegate,e):!1}set(e,t){t=gy("DocumentReference.set",t);try{return t?q1(this._delegate,e,t):q1(this._delegate,e)}catch(r){throw Vn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?B1(this._delegate,e):B1(this._delegate,e,t,...r)}catch(a){throw Vn(a,"updateDoc()","DocumentReference.update()")}}delete(){return yM(this._delegate)}onSnapshot(...e){const t=BE(e),r=zE(e,a=>new ad(this.firestore,new Xr(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return LE(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=fM(this._delegate):(e==null?void 0:e.source)==="server"?t=mM(this._delegate):t=hM(this._delegate),t.then(r=>new ad(this.firestore,new Xr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new js(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Vn(n,e,t){return n.message=n.message.replace(e,t),n}function BE(n){for(const e of n)if(typeof e=="object"&&!V0(e))return e;return{}}function zE(n,e){var t,r;let a;return V0(n[0])?a=n[0]:V0(n[1])?a=n[1]:typeof n[0]=="function"?a={next:n[0],error:n[1],complete:n[2]}:a={next:n[1],error:n[2],complete:n[3]},{next:c=>{a.next&&a.next(e(c))},error:(t=a.error)===null||t===void 0?void 0:t.bind(a),complete:(r=a.complete)===null||r===void 0?void 0:r.bind(a)}}class ad{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new js(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return VE(this._delegate,e._delegate)}}class od extends ad{data(e){const t=this._delegate.data(e);return this._delegate._converter||C5(t!==void 0),t}}class On{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Cm(e)}where(e,t,r){try{return new On(this.firestore,$i(this._delegate,nM(e,t,r)))}catch(a){throw Vn(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new On(this.firestore,$i(this._delegate,sM(e,t)))}catch(r){throw Vn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new On(this.firestore,$i(this._delegate,rM(e)))}catch(t){throw Vn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new On(this.firestore,$i(this._delegate,iM(e)))}catch(t){throw Vn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new On(this.firestore,$i(this._delegate,aM(...e)))}catch(t){throw Vn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new On(this.firestore,$i(this._delegate,oM(...e)))}catch(t){throw Vn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new On(this.firestore,$i(this._delegate,lM(...e)))}catch(t){throw Vn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new On(this.firestore,$i(this._delegate,cM(...e)))}catch(t){throw Vn(t,"endAt()","Query.endAt()")}}isEqual(e){return TE(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=gM(this._delegate):(e==null?void 0:e.source)==="server"?t=xM(this._delegate):t=pM(this._delegate),t.then(r=>new L0(this.firestore,new ua(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=BE(e),r=zE(e,a=>new L0(this.firestore,new ua(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return LE(this._delegate,t,r)}withConverter(e){return new On(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class PM{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new od(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class L0{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new On(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new od(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new PM(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new od(this._firestore,r))})}isEqual(e){return VE(this._delegate,e._delegate)}}class ec extends On{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new js(this.firestore,e):null}doc(e){try{return e===void 0?new js(this.firestore,Kf(this._delegate)):new js(this.firestore,Kf(this._delegate,e))}catch(t){throw Vn(t,"doc()","CollectionReference.doc()")}}add(e){return bM(this._delegate,e).then(t=>new js(this.firestore,t))}isEqual(e){return NE(this._delegate,e._delegate)}withConverter(e){return new ec(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ro(n){return it(n,It)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(...e){this._delegate=new ca(...e)}static documentId(){return new xy(Et.keyField().canonicalString())}isEqual(e){return e=Oe(e),e instanceof ca?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this._delegate=e}static serverTimestamp(){const e=SM();return e._methodName="FieldValue.serverTimestamp",new to(e)}static delete(){const e=EM();return e._methodName="FieldValue.delete",new to(e)}static arrayUnion(...e){const t=AM(...e);return t._methodName="FieldValue.arrayUnion",new to(t)}static arrayRemove(...e){const t=IM(...e);return t._methodName="FieldValue.arrayRemove",new to(t)}static increment(e){const t=jM(e);return t._methodName="FieldValue.increment",new to(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM={Firestore:UE,GeoPoint:wm,Timestamp:At,Blob:id,Transaction:FE,WriteBatch:qE,DocumentReference:js,DocumentSnapshot:ad,Query:On,QueryDocumentSnapshot:od,QuerySnapshot:L0,CollectionReference:ec,FieldPath:xy,FieldValue:to,setLogLevel:MM,CACHE_SIZE_UNLIMITED:B3};function VM(n,e){n.INTERNAL.registerComponent(new dr("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),a=t.getProvider("firestore").getImmediate();return e(r,a)},"PUBLIC").setServiceProps(Object.assign({},OM)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(n){VM(n,(e,t)=>new UE(e,t,new DM)),n.registerVersion(RM,CM)}LM(ms);const UM={apiKey:"AIzaSyDHQFIcPtd97RAPiT41EyQXaCflHga4jXI",authDomain:"masbotinventory.firebaseapp.com",projectId:"masbotinventory",storageBucket:"masbotinventory.firebasestorage.app",messagingSenderId:"1040093470535",appId:"1:1040093470535:web:dc9ec5b6da52e37aa83662",measurementId:"G-FV1T8VHT5Z"};ms.apps.length||ms.initializeApp(UM);const Ee=ms.firestore(),df=ms.auth();Ee.enablePersistence({synchronizeTabs:!0}).catch(n=>{n.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Firestore persistence failed: Browser not supported")});const FM=({onLogin:n})=>{const[e,t]=L.useState(""),[r,a]=L.useState(""),[c,d]=L.useState(""),[f,m]=L.useState(!1),[x,y]=L.useState(!1),v=async A=>{if(A.preventDefault(),e&&r){m(!0),d("");try{await n(e,r)||d("Invalid email or password.")}catch(V){console.error("Login error",V),d(V.message||"Login failed")}finally{m(!1)}}else d("Please enter both email and password.")},E=async()=>{if(!(!window.confirm(`WARNING: This will PERMANENTLY DELETE ALL DATA (Employees, Inventory, Orders, etc.).

Are you sure you want to completely wipe the system to start fresh?`)||prompt("Type 'DELETE' to confirm wiping the database:")!=="DELETE")){y(!0);try{const V=["employees","users","inventory","leaveRequests","payrollHistory","labs","toners","mrfs","attendanceRecords","supplyChainRequests","purchaseRequests","purchaseOrders","recipes","vendors"];for(const C of V){const z=await Ee.collection(C).get();if(z.empty)continue;const ae=Ee.batch();let K=0;for(const ee of z.docs)ae.delete(Ee.collection(C).doc(ee.id)),K++;await ae.commit(),console.log(`Deleted collection: ${C}`)}alert(`System Reset Successful. All data has been deleted.
You can now login as 'admin' / '123' to start fresh.`),window.location.reload()}catch(V){console.error(V),alert("Error resetting database: "+V.message)}finally{y(!1)}}};return o.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 p-4 relative",children:[o.jsxs("div",{className:"bg-white p-8 md:p-12 rounded-2xl shadow-lg w-full max-w-md transform transition-all duration-300 border-t-4 border-purple-900",children:[o.jsxs("div",{className:"flex flex-col items-center mb-8",children:[o.jsx(_o,{className:"h-20 w-auto mb-4"}),o.jsx("p",{className:"text-blue-900 font-medium",children:"Admin Login"})]}),o.jsxs("form",{onSubmit:v,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-blue-900",children:"Email"}),o.jsx("input",{id:"email",type:"text",value:e,onChange:A=>t(A.target.value),className:"mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-purple-900 focus:border-purple-900 sm:text-sm text-blue-900",placeholder:"admin or user@example.com"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-blue-900",children:"Password"}),o.jsx("input",{id:"password",type:"password",value:r,onChange:A=>a(A.target.value),className:"mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-purple-900 focus:border-purple-900 sm:text-sm text-blue-900",placeholder:""})]}),c&&o.jsx("p",{className:"text-sm text-red-600",children:c}),o.jsx("button",{type:"submit",disabled:f,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-900 hover:bg-purple-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-900 transition-colors duration-200 disabled:bg-purple-400",children:f?"Logging in...":"Login"})]})]}),o.jsx("div",{className:"absolute bottom-4 right-4",children:o.jsx("button",{onClick:E,disabled:x,className:"text-xs text-red-300 hover:text-red-600 underline transition-colors",children:x?"Wiping Data...":"Reset System Data (Danger)"})})]})},qM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-4.68c.11-.32.223-.65.334-.982l.012-.035a6.375 6.375 0 01-2.924-4.982 6.375 6.375 0 0111.085-3.834c.11.32.223.65.334.982l.012-.035a6.375 6.375 0 01-2.924 4.982 6.375 6.375 0 01-11.085 3.834 6.375 6.375 0 012.924 4.982z"})}),ld=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h6M9 11.25h6m-6 4.5h6M21 21V3M3 21V3"})}),yy=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"})}),by=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[o.jsx("path",{d:"M12 14.25c-3.75 0-7.5-1.34-7.5-3v-4.5c0-1.66 3.35-3 7.5-3s7.5 1.34 7.5 3v4.5c0 1.65-3.75 3-7.5 3z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5v6.75c0 1.65 3.75 3 7.5 3s7.5-1.35 7.5-3V10.5M4.5 10.5L12 15l7.5-4.5"})]}),HE=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 100-18 9 9 0 000 18z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9h16.5M3.75 15h16.5M12 3v18"})]}),GE=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),KE=({module:n,onSelect:e})=>o.jsxs("div",{onClick:e,className:"bg-white p-8 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-2 transition-all duration-300 cursor-pointer text-center flex flex-col items-center h-full border-t-4 border-transparent hover:border-purple-600",role:"button",tabIndex:0,onKeyDown:t=>t.key==="Enter"&&e(),children:[o.jsx("div",{className:"text-purple-800 mb-5",children:n.icon}),o.jsx("h2",{className:"font-bold text-xl text-blue-900 mb-2",children:n.title}),o.jsx("p",{className:"text-sm text-blue-900 flex-grow",children:n.description})]}),jo=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),U0=[{id:"hr",icon:o.jsx(qM,{className:"w-12 h-12"}),title:"HR Module",description:"Attendance, Shifts, CCTV snapshots, Employee management"},{id:"inventory_management",icon:o.jsx(ld,{className:"w-12 h-12"}),title:"Inventory Management",description:"Manage assets, labs, printers, and consumables."},{id:"supply_chain",icon:o.jsx(ld,{className:"w-12 h-12"}),title:"Supply Chain Module",description:"Manage procurement, logistics, and supplier relations."},{id:"task_manager",icon:o.jsx(GE,{className:"w-12 h-12"}),title:"Task Manager",description:"Assign, track, and complete tasks with automated workflows."},{id:"finance",icon:o.jsx(yy,{className:"w-12 h-12"}),title:"Finance Module",description:"Budgeting, Payments, Receipts, WhatsApp receipts"},{id:"student",icon:o.jsx(by,{className:"w-12 h-12"}),title:"Student Module",description:"Applicants, Student Portal, Attendance, Course delivery"},{id:"website",icon:o.jsx(HE,{className:"w-12 h-12"}),title:"Website & Portals",description:"Applicant Portal, Student Portal, Teacher/Admin Dashboards"}],BM=({onModuleSelect:n,onLogout:e,accessibleModules:t})=>{const r=t?U0.filter(a=>t.includes(a.id)):U0;return o.jsxs("div",{className:"relative w-full max-w-6xl mx-auto p-4 sm:p-8",children:[o.jsxs("header",{className:"text-center mb-10 flex flex-col items-center",children:[o.jsx(_o,{className:"h-20 w-auto mb-6"}),o.jsx("p",{className:"text-blue-900 text-lg",children:"Select a module to continue"})]}),o.jsx("main",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.length>0?r.map(a=>o.jsx(KE,{module:a,onSelect:()=>n(a.id)},a.id)):o.jsxs("div",{className:"md:col-span-2 lg:col-span-3 text-center p-8 bg-white rounded-lg shadow-md",children:[o.jsx("h2",{className:"text-xl font-semibold text-blue-900",children:"No Modules Assigned"}),o.jsx("p",{className:"text-blue-900 mt-2",children:"You have not been assigned any modules. Please contact an administrator."})]})}),o.jsx("div",{className:"absolute top-4 right-4 sm:top-8 sm:right-8",children:o.jsxs("button",{onClick:e,className:"flex items-center gap-2 bg-white text-purple-900 px-4 py-2 rounded-lg shadow-md hover:bg-purple-50 transition-colors border border-purple-200","aria-label":"Logout",children:[o.jsx(jo,{className:"w-5 h-5"}),o.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:"Logout"})]})})]})},zM=({employee:n,onModuleSelect:e,onLogout:t,accessibleModules:r})=>{var x;const a=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),c=U0.filter(y=>r.includes(y.id)),f=n.employmentType==="Probation"?{total:0,used:0}:((x=n.leaveBalance)==null?void 0:x.annual)||{total:14,used:0},m=Math.max(0,f.total-f.used);return o.jsxs("div",{className:"min-h-screen bg-slate-50",children:[o.jsxs("header",{className:"bg-purple-900 shadow-sm border-b border-purple-800 px-6 py-4 flex justify-between items-center",children:[o.jsx(_o,{className:"h-8 w-auto brightness-0 invert"}),o.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-purple-100 hover:text-white transition-colors text-sm font-medium",children:[o.jsx(jo,{className:"w-5 h-5"}),"Logout"]})]}),o.jsxs("main",{className:"max-w-7xl mx-auto p-6 sm:p-8 space-y-8",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-3xl font-bold text-blue-900",children:["Welcome back, ",n.firstName]}),o.jsx("p",{className:"text-blue-900 mt-1",children:a})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex items-center gap-4",children:[o.jsx("div",{className:"h-16 w-16 rounded-full bg-purple-100 flex items-center justify-center text-purple-900 font-bold text-2xl",children:n.firstName.charAt(0)}),o.jsxs("div",{children:[o.jsxs("h2",{className:"font-bold text-blue-900",children:[n.firstName," ",n.lastName]}),o.jsx("p",{className:"text-sm text-blue-900",children:n.designation}),o.jsx("p",{className:"text-xs text-blue-800",children:n.department})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100",children:[o.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-1",children:"My Shift"}),o.jsx("p",{className:"text-lg font-semibold text-blue-900",children:n.shift||"Standard (9-6)"}),o.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[o.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500"}),o.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Active"})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100",children:[o.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-1",children:"Annual Leave Balance"}),o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsx("span",{className:"text-3xl font-bold text-blue-900",children:m}),o.jsxs("span",{className:"text-sm text-blue-800",children:["/ ",f.total," days"]})]}),o.jsx("div",{className:"w-full bg-slate-100 rounded-full h-1.5 mt-3",children:o.jsx("div",{className:"bg-purple-900 h-1.5 rounded-full",style:{width:f.total>0?`${m/f.total*100}%`:"0%"}})})]})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-6",children:"My Applications"}),c.length>0?o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(y=>o.jsx(KE,{module:y,onSelect:()=>e(y.id)},y.id))}):o.jsxs("div",{className:"bg-white rounded-xl p-8 text-center border border-dashed border-slate-300",children:[o.jsx("p",{className:"text-blue-900",children:"You do not have access to any modules yet."}),o.jsx("p",{className:"text-sm text-blue-800 mt-1",children:"Contact HR or IT administrator for access."})]})]})]})]})},km=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})}),HM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-4.68c.11-.32.223-.65.334-.982l.012-.035a6.375 6.375 0 01-2.924-4.982 6.375 6.375 0 0111.085-3.834c.11.32.223-.65.334.982l.012-.035a6.375 6.375 0 01-2.924 4.982 6.375 6.375 0 01-11.085 3.834 6.375 6.375 0 012.924 4.982z"})}),vy=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 12.75h.008v.008H12v-.008z"})}),tc=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 14.25v2.25m3-4.5v4.5m3-6.75v6.75m3-9v9M6 20.25h12A2.25 2.25 0 0020.25 18V6A2.25 2.25 0 0018 3.75H6A2.25 2.25 0 003.75 6v12A2.25 2.25 0 006 20.25z"})}),Qf=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962a3.75 3.75 0 015.25 0m-5.25 0a3.75 3.75 0 00-5.25 0M3 13.001v-5.25a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.75v5.25c0 .621-.504 1.125-1.125 1.125H4.125A1.125 1.125 0 013 13.001z"})}),GM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z"})}),KM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),$M=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),$E=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),QE=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"})}),YE=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})}),Dm=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.042 21.672L13.684 16.6m0 0l-2.51 2.225.569-9.47 5.227 7.917-3.286-.672zM12 2.25V4.5m5.834.166l-1.591 1.591M20.25 10.5H18M5.834 7.75l-1.591-1.591M4.5 10.5H2.25m11.106 4.75L9.13 18.218m-2.923-8.814l.159.098m3.523-2.226L9.13 5.782"})}),_y=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-1.008 1.11-1.226l.45-1.691a1.125 1.125 0 012.15 0l.45 1.691c.55.218 1.02.684 1.11 1.226l1.691.45a1.125 1.125 0 010 2.15l-1.691.45c-.09.542-.56 1.008-1.11 1.226l-.45 1.691a1.125 1.125 0 01-2.15 0l-.45-1.691a1.722 1.722 0 01-1.11-1.226l-1.691-.45a1.125 1.125 0 010-2.15l1.691-.45zM12 12.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5zM3.94 14.406c-.542-.09-1.008-.56-1.226-1.11l-1.691-.45a1.125 1.125 0 010-2.15l1.691-.45c.218-.55.684-1.02 1.226-1.11l.45-1.691a1.125 1.125 0 012.15 0l.45 1.691c.55.218 1.02.684 1.11 1.226l1.691.45a1.125 1.125 0 010 2.15l-1.691.45c-.218.55-.684 1.02-1.226 1.11l-.45 1.691a1.125 1.125 0 01-2.15 0l-.45-1.691a1.722 1.722 0 01-1.11-1.226l-1.691-.45a1.125 1.125 0 010-2.15l1.691-.45c.09.542.56 1.008 1.11 1.226l.45 1.691a1.125 1.125 0 01-2.15 0l-.45-1.691a1.722 1.722 0 01-1.11-1.226zM14.406 20.06c-.09.542-.56 1.008-1.11 1.226l-.45 1.691a1.125 1.125 0 01-2.15 0l-.45-1.691c-.55-.218-1.02-.684-1.11-1.226l-1.691-.45a1.125 1.125 0 010-2.15l1.691-.45c.09-.542.56-1.008 1.11-1.226l.45-1.691a1.125 1.125 0 012.15 0l.45 1.691c.55.218 1.02.684 1.11 1.226l1.691.45a1.125 1.125 0 010 2.15l-1.691.45z"})}),cd=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-1.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25A2.25 2.25 0 015.25 3h9.75a2.25 2.25 0 012.25 2.25z"})}),WE=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 3.75H6A2.25 2.25 0 003.75 6v1.5M16.5 3.75H18A2.25 2.25 0 0120.25 6v1.5m0 9V18A2.25 2.25 0 0118 20.25h-1.5m-9 0H6A2.25 2.25 0 013.75 18v-1.5M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v3m0 9v3m-4.5-4.5h-3m9 0h-3m-9-4.5h3m9 0h3"})]}),XE=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.061A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.279A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})}),QM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),wy=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664l.143.258a1.107 1.107 0 001.664.57l.143-.048a2.25 2.25 0 011.161.886l.51.766c.319.48.126 1.121-.216 1.49l-1.068.89a1.125 1.125 0 00-.405.864v.568m-6 0v-.568c0-.334-.148-.65-.405-.864l-1.068-.89a1.125 1.125 0 01-.216-1.49l.51-.766a2.25 2.25 0 001.161-.886l.143-.048a1.107 1.107 0 01.57-1.664l-.143-.258a1.107 1.107 0 01-1.664-.57l-.143.048a2.25 2.25 0 00-1.161-.886l-.51-.766a1.125 1.125 0 01.216-1.49l1.068-.89a1.125 1.125 0 00.405-.864v-.568a3 3 0 013-3h3.5a3 3 0 013 3v1.173c0 .521-.175 1.02-.49 1.432l-1.148 1.53c-.314.413-.77.68-1.256.75l-4.11.587c-.504.072-.994.27-1.432.559l-1.148.765a3 3 0 00-1.432 2.559V18a3 3 0 003 3h3.5a3 3 0 003-3v-1.173c0-.521.175-1.02.49-1.432l1.148-1.53c.314-.413.77-.68 1.256-.75l4.11-.587c.504-.072.994-.27 1.432-.559l1.148-.765a3 3 0 001.432-2.559V6a3 3 0 00-3-3h-3.5a3 3 0 00-3 3z"})}),YM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})}),WM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 12.75h.008v.008H12v-.008z"})}),XM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})}),JM=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),ud=[{id:"dashboard",label:"Dashboard",icon:km},{id:"employees",label:"Employees",icon:HM},{id:"attendance",label:"Attendance",icon:vy},{id:"reports",label:"Reports",icon:tc},{id:"users",label:"Users",icon:Qf},{id:"user-access",label:"User Access Management",icon:GM}],dd=[{id:"departments",label:"Departments",icon:KM},{id:"leaves",label:"Leaves",icon:$M},{id:"payroll",label:"Payroll",icon:$E},{id:"performance",label:"Performance",icon:QE},{id:"training",label:"Training",icon:YE},{id:"recruitment",label:"Recruitment",icon:Dm}],ZM=[...ud,...dd],Ny=[{id:"master",label:"Master Inventory",icon:ld},{id:"laptops",label:"Laptops",icon:cd},{id:"desktops",label:"Desktops",icon:cd},{id:"printers",label:"Printers & Toners",icon:XE},{id:"labs",label:"Computer Labs",icon:WE},{id:"kitchen",label:"The Chef's Academy",icon:wy}],Yf=[{id:"assets",label:"Inventory",icon:cd},{id:"users",label:"Users",icon:Qf},{id:"mrf",label:"MRF",icon:QM},{id:"reports",label:"Reports",icon:tc},{id:"settings",label:"Settings",icon:_y}],eP=[...Ny,...Yf.filter(n=>["users","mrf","reports","settings"].includes(n.id))],JE=[{id:"sc_requests",label:"New Request",icon:ld},{id:"sc_my_requests",label:"My Requests",icon:tc},{id:"sc_approvals",label:"Account Manager",icon:Dm},{id:"sc_store",label:"Store Fulfillment",icon:wy},{id:"sc_purchase",label:"Purchase Department",icon:yy}],tP=[{id:"fin_dashboard",label:"Dashboard",icon:km},{id:"budgeting",label:"Budgeting",icon:yy},{id:"payments",label:"Payments",icon:$E},{id:"receipts",label:"Receipts",icon:QE},{id:"fin_reports",label:"Reports",icon:tc}],nP=[{id:"std_dashboard",label:"Dashboard",icon:km},{id:"applicants",label:"Applicants",icon:Dm},{id:"student_portal",label:"Student Portal",icon:by},{id:"std_attendance",label:"Attendance",icon:vy},{id:"course_delivery",label:"Course Delivery",icon:YE}],sP=[{id:"web_dashboard",label:"Dashboard",icon:km},{id:"applicant_portal",label:"Applicant Portal",icon:Dm},{id:"student_portal_mgmt",label:"Student Portal",icon:by},{id:"teacher_dash",label:"Teacher Dashboard",icon:HE},{id:"admin_dash",label:"Admin Dashboard",icon:_y}],ZE=[{id:"task_dashboard",label:"Task Board",icon:GE},{id:"task_calendar",label:"Calendar",icon:WM},{id:"task_chat",label:"Chat & Discussions",icon:YM},{id:"task_analytics",label:"Team Analytics",icon:XM},{id:"task_notes",label:"My Notes",icon:JM}],G1={hr:ZM,inventory_management:eP,supply_chain:JE,finance:tP,student:nP,website:sP,task_manager:ZE},K1=({link:n,activePage:e,setActivePage:t,isCollapsed:r})=>{const a=e===n.id;return o.jsxs("a",{href:"#",onClick:c=>{c.preventDefault(),t(n.id)},className:`flex items-center py-2.5 px-4 rounded-md transition-colors duration-200 ${a?"bg-purple-50 text-purple-900 font-bold border-r-4 border-purple-900":"text-blue-900 hover:bg-purple-50 hover:text-purple-900"} ${r?"justify-center":""}`,children:[o.jsx(n.icon,{className:`h-5 w-5 ${a?"text-purple-900":"text-purple-400"}`}),!r&&o.jsx("span",{className:"ml-3 text-sm",children:n.label})]})},rP=({activePage:n,setActivePage:e,isCollapsed:t,onLogout:r,permissions:a,currentUserEmail:c,employees:d})=>{const f=c==="admin",m=d.find(E=>E.email===c),x=f?"Administrator":m?`${m.firstName} ${m.lastName}`:c,y=(f?ud:ud.filter(E=>{var A;return(A=a[E.id])==null?void 0:A.view})).filter(E=>!((m==null?void 0:m.role)==="Employee"&&E.id==="dashboard")),v=f?dd:dd.filter(E=>{var A;return(A=a[E.id])==null?void 0:A.view});return o.jsxs("aside",{className:`bg-white flex flex-col transition-all duration-300 ease-in-out border-r border-slate-200 ${t?"w-20":"w-64"}`,children:[o.jsx("div",{className:`flex items-center border-b h-16 px-4 ${t?"justify-center":"justify-start"}`,children:t?o.jsx("div",{className:"bg-purple-900 text-white font-bold text-lg rounded-md p-2 w-9 h-9 flex items-center justify-center",children:"M"}):o.jsx(_o,{className:"h-8 w-auto"})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[y.map(E=>o.jsx(K1,{link:E,activePage:n,setActivePage:e,isCollapsed:t},E.id)),v.length>0&&o.jsxs("div",{className:"pt-4",children:[!t&&o.jsx("h3",{className:"px-4 text-xs font-semibold text-blue-900 uppercase tracking-wider mb-2",children:"HR Module"}),o.jsx("div",{className:"space-y-2",children:v.map(E=>o.jsx(K1,{link:E,activePage:n,setActivePage:e,isCollapsed:t},E.id))})]})]}),o.jsxs("div",{className:"mt-auto border-t border-slate-200",children:[o.jsx("div",{className:"p-4",children:o.jsxs("div",{className:`flex items-center ${t?"justify-center":""}`,children:[o.jsx("div",{className:"h-9 w-9 rounded-full bg-purple-100 flex-shrink-0 flex items-center justify-center text-purple-900 font-bold","aria-label":"User avatar placeholder",children:x.charAt(0)}),!t&&o.jsxs("div",{className:"ml-3 overflow-hidden",children:[o.jsx("p",{className:"text-sm font-semibold text-blue-900 truncate",title:x,children:x}),o.jsx("p",{className:"text-xs text-blue-800 truncate",title:c,children:c})]})]})}),o.jsx("div",{className:"p-4 border-t border-slate-200",children:o.jsxs("button",{onClick:r,className:`flex items-center w-full py-2.5 px-4 rounded-md transition-colors duration-200 text-blue-900 hover:bg-red-50 hover:text-red-600 ${t?"justify-center":""}`,children:[o.jsx(jo,{className:"h-5 w-5"}),!t&&o.jsx("span",{className:"ml-3 text-sm font-medium",children:"Logout"})]})})]})]})},Wf=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),iP=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})}),aP=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),Mm=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5"})}),oP=({toggleSidebar:n,isSidebarCollapsed:e,onLogout:t,searchQuery:r,onSearchChange:a,onBack:c})=>o.jsxs("header",{className:"bg-purple-900 border-b border-purple-800 h-16 flex items-center justify-between px-6 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("button",{onClick:n,className:"text-purple-200 hover:text-white mr-4",children:e?o.jsx(iP,{className:"w-5 h-5"}):o.jsx(Wf,{className:"w-5 h-5"})}),o.jsxs("button",{onClick:c,className:"flex items-center gap-2 text-sm font-medium text-purple-100 hover:text-white mr-4",children:[o.jsx(Mm,{className:"w-5 h-5"}),o.jsx("span",{children:"Home"})]}),o.jsx("div",{className:"flex items-center text-sm",children:o.jsx("span",{className:"font-semibold text-white text-lg tracking-wide",children:"MASERP"})})]}),o.jsx("div",{className:"flex-1 max-w-md mx-4",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(aP,{className:"h-5 w-5 text-purple-300"})}),o.jsx("input",{type:"text",placeholder:"Search employees, users...",value:r,onChange:d=>a(d.target.value),className:"block w-full bg-purple-800 border border-transparent rounded-md py-2 pl-10 pr-3 text-sm text-white placeholder-purple-300 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent focus:bg-purple-700"})]})}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{className:"text-sm font-medium text-purple-200 hover:text-white",children:"Invite"}),o.jsx("button",{className:"text-purple-200 hover:text-white","aria-label":"Settings",children:o.jsx(_y,{className:"w-5 h-5"})}),o.jsx("button",{onClick:t,className:"text-purple-200 hover:text-red-300","aria-label":"Logout",children:o.jsx(jo,{className:"w-5 h-5"})}),o.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-700 text-purple-200 flex items-center justify-center text-xs font-bold border border-purple-600","aria-label":"User avatar placeholder",children:"U"})]})]}),lP=({percentage:n,color:e,displayText:t})=>{const a=2*Math.PI*30,c=a-n/100*a;return o.jsxs("svg",{className:"w-20 h-20 transform -rotate-90",children:[o.jsx("circle",{className:"text-blue-200",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:30,cx:"40",cy:"40"}),o.jsx("circle",{className:e,strokeWidth:"8",strokeDasharray:a,strokeDashoffset:c,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:30,cx:"40",cy:"40"}),o.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dy:".3em",className:"text-lg font-bold text-blue-900 transform rotate-90 origin-center",children:t})]})},cP=({title:n,value:e,percentage:t,color:r})=>o.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(lP,{percentage:t,color:r,displayText:e})}),o.jsx("div",{className:"ml-4 text-left",children:o.jsx("p",{className:"text-sm text-blue-900",children:n})})]}),uP=({employees:n,leaveRequests:e,onLeaveRequestAction:t,onNavigate:r})=>{const[a,c]=L.useState([]),[d,f]=L.useState(!1);L.useEffect(()=>{const C=localStorage.getItem("hrQuickAccess");c(C?JSON.parse(C):["employees","attendance","leaves","payroll"])},[]);const m=n.length,x=m>0?Math.floor(m*(.85+Math.random()*.1)):0,y=[{title:"Present Employees",value:x.toString(),percentage:m>0?Math.round(x/m*100):0,color:"text-green-500"},{title:"Total Employees",value:m.toString(),percentage:100,color:"text-blue-900"}],v=L.useMemo(()=>e.filter(C=>C.status==="Pending HR"),[e]),E=C=>{const O=n.find(z=>z.id===C);return O?`${O.firstName} ${O.lastName}`:"Unknown Employee"},A=[...ud,...dd].filter(C=>C.id!=="dashboard"),V=C=>{c(O=>{let z;return O.includes(C)?z=O.filter(ae=>ae!==C):z=[...O,C],localStorage.setItem("hrQuickAccess",JSON.stringify(z)),z})};return o.jsxs("div",{children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"HR Dashboard"}),o.jsx("p",{className:"text-blue-900 mt-1",children:"Overview of personnel, attendance, and pending actions."})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(C=>o.jsx(cP,{...C},C.title))}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[o.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-lg shadow-sm border border-blue-100",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"font-bold text-blue-900 text-lg",children:"Pending Approvals"}),o.jsxs("span",{className:"text-xs font-medium bg-orange-100 text-orange-800 px-2 py-1 rounded-full",children:[v.length," Pending"]})]}),v.length>0?o.jsxs("div",{className:"space-y-4",children:[v.slice(0,5).map(C=>o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center p-4 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsxs("div",{className:"mb-3 sm:mb-0",children:[o.jsx("p",{className:"font-semibold text-blue-900",children:E(C.employeeId)}),o.jsxs("p",{className:"text-sm text-blue-900",children:[o.jsx("span",{className:"font-medium text-blue-900",children:C.leaveType}),"  ",C.fromDate," to ",C.toDate]}),o.jsxs("p",{className:"text-xs text-blue-900 mt-1 italic",children:['"',C.reason,'"']})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>t(C.id,"Approve"),className:"px-3 py-1.5 bg-green-600 text-white text-xs font-medium rounded hover:bg-green-700 transition-colors",children:"Approve"}),o.jsx("button",{onClick:()=>t(C.id,"Reject"),className:"px-3 py-1.5 bg-red-100 text-red-700 text-xs font-medium rounded hover:bg-red-200 transition-colors border border-red-200",children:"Reject"})]})]},C.id)),v.length>5&&o.jsxs("button",{onClick:()=>r("leaves"),className:"w-full text-center text-sm text-blue-900 hover:underline py-2",children:["View all ",v.length," requests"]})]}):o.jsxs("div",{className:"text-center py-10",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-green-100 text-green-600 mb-3",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("p",{className:"text-blue-900 font-medium",children:"All caught up!"}),o.jsx("p",{className:"text-blue-900 text-sm",children:"No pending leave requests."})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-blue-100 flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"font-bold text-blue-900 text-lg",children:"Create Shortcuts"}),o.jsx("button",{onClick:()=>f(!0),className:"text-blue-900 hover:text-blue-800 text-xs font-medium hover:underline",children:"Customize"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.map(C=>{const O=A.find(ae=>ae.id===C);if(!O)return null;const z=O.icon;return o.jsxs("button",{onClick:()=>r(C),className:"flex flex-col items-center justify-center p-4 bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-300 rounded-lg transition-all duration-200 group",children:[o.jsx(z,{className:"w-6 h-6 text-blue-900 group-hover:text-blue-900 mb-2"}),o.jsx("span",{className:"text-xs font-medium text-blue-900 group-hover:text-blue-900 text-center line-clamp-1",children:O.label})]},C)}),o.jsxs("button",{onClick:()=>f(!0),className:"flex flex-col items-center justify-center p-4 border-2 border-dashed border-blue-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all text-blue-900 hover:text-blue-900",children:[o.jsx("span",{className:"text-2xl leading-none mb-1",children:"+"}),o.jsx("span",{className:"text-xs font-medium",children:"Add"})]})]})]})]}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:()=>f(!1),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",onClick:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"p-5 border-b border-blue-100",children:[o.jsx("h3",{className:"font-bold text-lg text-blue-900",children:"Create Shortcuts"}),o.jsx("p",{className:"text-sm text-blue-900",children:"Select shortcuts to pin to your dashboard."})]}),o.jsx("div",{className:"p-5 max-h-[60vh] overflow-y-auto grid grid-cols-1 gap-2",children:A.map(C=>{const O=a.includes(C.id),z=C.icon;return o.jsxs("label",{className:`flex items-center p-3 rounded-lg border cursor-pointer transition-colors ${O?"bg-blue-50 border-blue-200":"bg-white border-blue-200 hover:bg-blue-50"}`,children:[o.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-900 rounded focus:ring-blue-900 border-blue-300",checked:O,onChange:()=>V(C.id)}),o.jsxs("div",{className:"ml-3 flex items-center",children:[o.jsx(z,{className:"w-5 h-5 text-blue-900"}),o.jsx("span",{className:"ml-3 text-sm font-medium text-blue-900",children:C.label})]})]},C.id)})}),o.jsx("div",{className:"p-5 border-t border-blue-100 flex justify-end",children:o.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-blue-900 text-white rounded-md text-sm font-medium hover:bg-blue-800",children:"Done"})})]})})]})},vn=({id:n,label:e,type:t="text",value:r,onChange:a,required:c=!1,placeholder:d,disabled:f=!1})=>o.jsxs("div",{children:[o.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-blue-900",children:e}),o.jsx("input",{type:t,id:n,name:n,value:r||"",onChange:a,required:c,placeholder:d,disabled:f,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm placeholder-slate-400 text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm disabled:bg-slate-100 disabled:text-blue-900"})]}),$a=({id:n,label:e,value:t,onChange:r,children:a,required:c=!1})=>o.jsxs("div",{children:[o.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-blue-900",children:e}),o.jsx("select",{id:n,name:n,value:t||"",onChange:r,required:c,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md",children:a})]}),hf=({title:n,children:e})=>o.jsxs("div",{className:"pt-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-4 border-b pb-2",children:n}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e})]}),dP=({isOpen:n,onClose:e,employee:t,onSave:r})=>{const[a,c]=L.useState({});if(L.useEffect(()=>{t&&c(t)},[t]),!n)return null;const d=m=>{const{id:x,value:y}=m.target;c(v=>({...v,[x]:y}))},f=m=>{m.preventDefault();const{id:x,...y}=a;t.id&&r(t.id,y)};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4",onClick:e,children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[o.jsx("div",{className:"sticky top-0 bg-white p-6 border-b z-10",children:o.jsxs("h2",{className:"text-xl font-bold text-blue-900",children:["Edit Employee: ",t.firstName," ",t.lastName]})}),o.jsxs("form",{onSubmit:f,className:"flex-1 overflow-y-auto",children:[o.jsx("div",{className:"p-8",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs(hf,{title:"Personal Details",children:[o.jsx(vn,{id:"employeeId",label:"Employee ID",value:a.employeeId,onChange:d,placeholder:"e.g., EMP-001"}),o.jsx(vn,{id:"firstName",label:"First Name",value:a.firstName,onChange:d,required:!0}),o.jsx(vn,{id:"lastName",label:"Last Name",value:a.lastName,onChange:d,required:!0}),o.jsx(vn,{id:"fatherName",label:"Father's Name",value:a.fatherName,onChange:d,required:!0}),o.jsx(vn,{id:"cnic",label:"CNIC",value:a.cnic,onChange:d,placeholder:"e.g., 35202-1234567-1"}),o.jsx(vn,{id:"dob",label:"Date of Birth",type:"date",value:a.dob,onChange:d}),o.jsxs($a,{id:"gender",label:"Gender",value:a.gender,onChange:d,children:[o.jsx("option",{children:"Male"}),o.jsx("option",{children:"Female"}),o.jsx("option",{children:"Other"})]}),o.jsxs($a,{id:"maritalStatus",label:"Marital Status",value:a.maritalStatus,onChange:d,children:[o.jsx("option",{children:"Single"}),o.jsx("option",{children:"Married"})]})]}),o.jsxs(hf,{title:"Contact & Address",children:[o.jsx(vn,{id:"phone",label:"Phone Number",value:a.phone,onChange:d,placeholder:"e.g., 0300-1234567"}),o.jsx(vn,{id:"email",label:"Official Email (Username)",type:"email",value:a.email,onChange:()=>{},required:!0,disabled:!0}),o.jsx(vn,{id:"personalEmail",label:"Personal Email",type:"email",value:a.personalEmail,onChange:d}),o.jsx(vn,{id:"currentAddress",label:"Current Address",value:a.currentAddress,onChange:d}),o.jsx(vn,{id:"permanentAddress",label:"Permanent Address",value:a.permanentAddress,onChange:d})]}),o.jsxs(hf,{title:"Employment Details",children:[o.jsxs($a,{id:"department",label:"Department",value:a.department,onChange:d,required:!0,children:[o.jsx("option",{children:"Human Resources"}),o.jsx("option",{children:"IT"}),o.jsx("option",{children:"Finance"}),o.jsx("option",{children:"Engineering"}),o.jsx("option",{children:"Marketing"}),o.jsx("option",{children:"Sales"})]}),o.jsx(vn,{id:"designation",label:"Designation",value:a.designation,onChange:d,required:!0}),o.jsx(vn,{id:"joiningDate",label:"Joining Date",type:"date",value:a.joiningDate,onChange:d,required:!0}),o.jsxs($a,{id:"shift",label:"Shift Timing",value:a.shift,onChange:d,required:!0,children:[o.jsx("option",{children:"Morning (09:00 AM - 06:00 PM)"}),o.jsx("option",{children:"Evening (02:00 PM - 11:00 PM)"}),o.jsx("option",{children:"Night (10:00 PM - 07:00 AM)"})]}),o.jsxs($a,{id:"employmentType",label:"Employment Type",value:a.employmentType,onChange:d,children:[o.jsx("option",{children:"Permanent"}),o.jsx("option",{children:"Probation"}),o.jsx("option",{children:"Intern"})]}),o.jsxs($a,{id:"status",label:"Status",value:a.status,onChange:d,children:[o.jsx("option",{children:"Active"}),o.jsx("option",{children:"Resigned"}),o.jsx("option",{children:"Terminated"})]})]}),o.jsxs(hf,{title:"Financial & System Access",children:[o.jsx(vn,{id:"salary",label:"Salary (PKR)",type:"number",value:a.salary,onChange:d,required:!0}),o.jsx(vn,{id:"bankName",label:"Bank Name",value:a.bankName,onChange:d}),o.jsx(vn,{id:"accountTitle",label:"Account Title",value:a.accountTitle,onChange:d}),o.jsx(vn,{id:"accountNumber",label:"Account Number",value:a.accountNumber,onChange:d}),o.jsxs($a,{id:"role",label:"System Role",value:a.role,onChange:d,required:!0,children:[o.jsx("option",{value:"Employee",children:"Employee"}),o.jsx("option",{value:"HOD",children:"HOD"}),o.jsx("option",{value:"HR",children:"HR"})]})]})]})}),o.jsxs("div",{className:"sticky bottom-0 bg-slate-50 p-4 flex justify-end gap-4 border-t",children:[o.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-blue-900 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",children:"Cancel"}),o.jsx("button",{type:"submit",className:"py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500",children:"Save Changes"})]})]})]})})},$1={employeeId:"",firstName:"",lastName:"",fatherName:"",cnic:"",dob:"",gender:"Male",maritalStatus:"Single",currentAddress:"",permanentAddress:"",email:"",personalEmail:"",phone:"",emergencyContactName:"",emergencyContactPhone:"",department:"Human Resources",designation:"",joiningDate:"",employmentType:"Probation",status:"Active",salary:"",shift:"Morning (09:00 AM - 06:00 PM)",bankName:"",accountTitle:"",accountNumber:"",role:"Employee",password:"",confirmPassword:""},sn=({id:n,label:e,type:t="text",value:r,onChange:a,required:c=!1,placeholder:d})=>o.jsxs("div",{children:[o.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-blue-900",children:e}),o.jsx("input",{type:t,id:n,name:n,value:r||"",onChange:a,required:c,placeholder:d,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm placeholder-slate-400 text-blue-900 focus:outline-none focus:ring-blue-900 focus:border-blue-900 sm:text-sm"})]}),Tl=({id:n,label:e,value:t,onChange:r,children:a,required:c=!1})=>o.jsxs("div",{children:[o.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-blue-900",children:e}),o.jsx("select",{id:n,name:n,value:t||"",onChange:r,required:c,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 text-blue-900 focus:outline-none focus:ring-blue-900 focus:border-blue-900 sm:text-sm rounded-md",children:a})]}),_u=({title:n,children:e})=>o.jsxs("div",{className:"pt-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-4 border-b pb-2",children:n}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e})]}),hP=({onAddEmployee:n,employees:e,onResignEmployee:t,onUpdateEmployee:r})=>{const[a,c]=L.useState($1),[d,f]=L.useState(null),[m,x]=L.useState(null),[y,v]=L.useState(!1),[E,A]=L.useState(null),[V,C]=L.useState(!1);L.useEffect(()=>{if(d){const T=setTimeout(()=>f(null),5e3);return()=>clearTimeout(T)}},[d]),L.useEffect(()=>{if(m){const T=setTimeout(()=>x(null),5e3);return()=>clearTimeout(T)}},[m]);const O=T=>{const{id:S,value:N}=T.target;c(R=>({...R,[S]:N}))},z=T=>{c(S=>({...S,employmentType:T}))},ae=T=>{if(T.preventDefault(),a.password!==a.confirmPassword){f({type:"error",text:"Passwords do not match."});return}if(a.password.length<6){f({type:"error",text:"Password must be at least 6 characters long."});return}const{password:S,confirmPassword:N,...R}=a;n(R,S),x({type:"success",text:`Employee ${a.firstName} ${a.lastName} added successfully.`}),c($1),C(!1)},K=T=>{A(T),v(!0)},ee=()=>{A(null),v(!1)},B=async(T,S)=>{const N=await r(T,S);x({type:N.success?"success":"error",text:N.message}),N.success&&ee()},Q=async T=>{if(window.confirm(`Are you sure you want to mark ${T.firstName} ${T.lastName} as resigned?`)){const S=await t(T.id);x({type:S.success?"success":"error",text:S.message})}},j=L.useMemo(()=>[...e].sort((T,S)=>T.status==="Resigned"&&S.status!=="Resigned"?1:T.status!=="Resigned"&&S.status==="Resigned"?-1:0),[e]);return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Employee Management"}),o.jsx("button",{onClick:()=>C(!V),className:`py-2 px-4 rounded-md shadow-sm text-sm font-medium text-white transition-colors ${V?"bg-red-500 hover:bg-red-600":"bg-blue-900 hover:bg-blue-800"}`,children:V?"Cancel Adding":"Add New Employee"})]}),V&&o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-6xl mx-auto border border-blue-100",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-6",children:"Add New Employee"}),o.jsxs("form",{onSubmit:ae,className:"space-y-6",children:[o.jsxs(_u,{title:"Personal Details",children:[o.jsx(sn,{id:"employeeId",label:"Employee ID",value:a.employeeId,onChange:O,placeholder:"e.g., EMP-001"}),o.jsx(sn,{id:"firstName",label:"First Name",value:a.firstName,onChange:O,required:!0}),o.jsx(sn,{id:"lastName",label:"Last Name",value:a.lastName,onChange:O,required:!0}),o.jsx(sn,{id:"fatherName",label:"Father's Name",value:a.fatherName,onChange:O,required:!0}),o.jsx(sn,{id:"cnic",label:"CNIC",value:a.cnic,onChange:O,placeholder:"e.g., 35202-1234567-1"}),o.jsx(sn,{id:"dob",label:"Date of Birth",type:"date",value:a.dob,onChange:O}),o.jsxs(Tl,{id:"gender",label:"Gender",value:a.gender,onChange:O,children:[o.jsx("option",{children:"Male"}),o.jsx("option",{children:"Female"}),o.jsx("option",{children:"Other"})]}),o.jsxs(Tl,{id:"maritalStatus",label:"Marital Status",value:a.maritalStatus,onChange:O,children:[o.jsx("option",{children:"Single"}),o.jsx("option",{children:"Married"})]})]}),o.jsxs(_u,{title:"Contact & Address",children:[o.jsx(sn,{id:"phone",label:"Phone Number",value:a.phone,onChange:O,placeholder:"e.g., 0300-1234567"}),o.jsx(sn,{id:"email",label:"Official Email",type:"email",value:a.email,onChange:O,required:!0}),o.jsx(sn,{id:"personalEmail",label:"Personal Email",type:"email",value:a.personalEmail,onChange:O}),o.jsx(sn,{id:"currentAddress",label:"Current Address",value:a.currentAddress,onChange:O}),o.jsx(sn,{id:"permanentAddress",label:"Permanent Address",value:a.permanentAddress,onChange:O})]}),o.jsxs(_u,{title:"Employment Details",children:[o.jsxs(Tl,{id:"department",label:"Department",value:a.department,onChange:O,required:!0,children:[o.jsx("option",{children:"Human Resources"}),o.jsx("option",{children:"IT"}),o.jsx("option",{children:"Finance"}),o.jsx("option",{children:"Engineering"}),o.jsx("option",{children:"Marketing"}),o.jsx("option",{children:"Sales"})]}),o.jsx(sn,{id:"designation",label:"Designation",value:a.designation,onChange:O,required:!0}),o.jsx(sn,{id:"joiningDate",label:"Joining Date",type:"date",value:a.joiningDate,onChange:O,required:!0}),o.jsxs(Tl,{id:"shift",label:"Shift Timing",value:a.shift,onChange:O,required:!0,children:[o.jsx("option",{children:"Morning (09:00 AM - 06:00 PM)"}),o.jsx("option",{children:"Evening (02:00 PM - 11:00 PM)"}),o.jsx("option",{children:"Night (10:00 PM - 07:00 AM)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Employment Status"}),o.jsxs("div",{className:"flex space-x-6 mt-2",children:[o.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-900 rounded focus:ring-blue-900 border-slate-300",checked:a.employmentType==="Probation",onChange:()=>z("Probation")}),o.jsx("span",{className:"ml-2 text-blue-900",children:"Probation"})]}),o.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-900 rounded focus:ring-blue-900 border-slate-300",checked:a.employmentType==="Permanent",onChange:()=>z("Permanent")}),o.jsx("span",{className:"ml-2 text-blue-900",children:"Permanent"})]})]}),o.jsx("p",{className:"text-xs text-blue-900 mt-1",children:a.employmentType==="Probation"?"Leaves are not allocated during probation.":"Leaves will be allocated pro-rata based on joining date."})]}),o.jsxs(Tl,{id:"status",label:"Status",value:a.status,onChange:O,children:[o.jsx("option",{children:"Active"}),o.jsx("option",{children:"Resigned"}),o.jsx("option",{children:"Terminated"})]})]}),o.jsxs(_u,{title:"Financial & System Access",children:[o.jsx(sn,{id:"salary",label:"Salary (PKR)",type:"number",value:a.salary,onChange:O,required:!0}),o.jsx(sn,{id:"bankName",label:"Bank Name",value:a.bankName,onChange:O}),o.jsx(sn,{id:"accountTitle",label:"Account Title",value:a.accountTitle,onChange:O}),o.jsx(sn,{id:"accountNumber",label:"Account Number",value:a.accountNumber,onChange:O}),o.jsxs(Tl,{id:"role",label:"System Role",value:a.role,onChange:O,required:!0,children:[o.jsx("option",{value:"Employee",children:"Employee"}),o.jsx("option",{value:"HOD",children:"HOD"}),o.jsx("option",{value:"HR",children:"HR"})]})]}),o.jsxs(_u,{title:"Create User Account",children:[o.jsx(sn,{id:"password",label:"Password for User Account",type:"password",value:a.password,onChange:O,required:!0,placeholder:"Min. 6 characters"}),o.jsx(sn,{id:"confirmPassword",label:"Confirm Password",type:"password",value:a.confirmPassword,onChange:O,required:!0})]}),d&&o.jsx("div",{className:`mt-4 p-3 rounded-md text-sm ${d.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.text}),o.jsxs("div",{className:"flex justify-end pt-4 gap-4",children:[o.jsx("button",{type:"button",onClick:()=>C(!1),className:"py-2 px-6 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-blue-900 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",children:"Cancel"}),o.jsx("button",{type:"submit",className:"py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-900",children:"Add Employee"})]})]})]}),o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-7xl mx-auto",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"Employee List"}),m&&o.jsx("div",{className:`mb-4 p-3 rounded-md text-sm ${m.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.text}),o.jsx("div",{className:"overflow-x-auto",children:e.length>0?o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Emp. ID"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Designation"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Department"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Shift"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Salary (PKR)"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:j.map(T=>o.jsxs("tr",{className:`${T.status==="Resigned"?"bg-slate-50 opacity-60":""} hover:bg-purple-50 transition-colors`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-900",children:T.employeeId||"N/A"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:[T.firstName," ",T.lastName,o.jsx("div",{className:"text-xs text-blue-900 font-normal",children:T.email})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:T.designation}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:T.department}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:T.shift||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${T.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:T.status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:T.salary}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-4",children:[o.jsx("button",{onClick:()=>K(T),className:"text-blue-900 hover:text-blue-950",children:"Edit"}),o.jsx("button",{onClick:()=>Q(T),disabled:T.status==="Resigned",className:"text-orange-600 hover:text-orange-900 disabled:text-blue-900 disabled:cursor-not-allowed disabled:no-underline",children:"Resign"})]})]},T.id))})]}):o.jsx("p",{className:"text-center text-blue-900 py-10",children:'There are no employees to display. Click "Add New Employee" to get started.'})})]}),y&&E&&o.jsx(dP,{isOpen:y,onClose:ee,employee:E,onSave:B})]})},fP=({users:n,employees:e})=>o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-blue-100",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"User Accounts"}),o.jsx("p",{className:"text-sm text-blue-800",children:"List of all system logins. Users are automatically created when an employee is added."})]})}),o.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase tracking-wider border-r",children:"Name / Employee Link"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase tracking-wider border-r",children:"Email (Login ID)"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase tracking-wider",children:"Current Password"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.length>0?n.map(t=>{const r=e.find(c=>c.email===t.email),a=t.email==="admin"?"Administrator":r?`${r.firstName} ${r.lastName}`:"Unlinked User";return o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:[o.jsx("div",{className:"text-sm font-bold text-blue-900",children:a}),r&&o.jsx("div",{className:"text-xs text-blue-800 italic",children:r.designation})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:o.jsx("span",{className:"text-sm text-blue-900 font-medium",children:t.email})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("code",{className:"text-sm px-2 py-1 bg-slate-100 rounded border border-slate-200 text-purple-900 font-mono",children:t.password||"********"}),t.passwordChangeRequired&&o.jsx("span",{className:"ml-2 text-[10px] font-bold bg-orange-100 text-orange-700 px-1.5 py-0.5 rounded uppercase",children:"Must Change"})]})]},t.id)}):o.jsx("tr",{children:o.jsx("td",{colSpan:3,className:"px-6 py-10 text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{className:"w-12 h-12 text-slate-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),o.jsx("p",{className:"text-blue-900 font-medium",children:"No system users found."}),o.jsx("p",{className:"text-sm text-blue-800",children:"Add an employee in the HR section to see their login here."})]})})})})]})})]}),Pm=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),mP=({options:n,value:e,onChange:t,placeholder:r})=>{const[a,c]=L.useState(!1),d=L.useRef(null),f=n.find(x=>x.value===e);L.useEffect(()=>{const x=y=>{d.current&&!d.current.contains(y.target)&&c(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]);const m=x=>{t(x.value),c(!1)};return o.jsxs("div",{className:"relative mt-1",ref:d,children:[o.jsxs("button",{type:"button",className:"relative w-full cursor-default rounded-md border border-slate-300 bg-white py-2 pl-3 pr-10 text-left shadow-sm focus:border-teal-500 focus:outline-none focus:ring-1 focus:ring-teal-500 sm:text-sm",onClick:()=>c(!a),"aria-haspopup":"listbox","aria-expanded":a,children:[f?o.jsxs("div",{children:[o.jsx("span",{className:"block truncate font-medium text-slate-800",children:f.primaryText}),o.jsx("span",{className:"block truncate text-xs text-slate-500",children:f.secondaryText})]}):o.jsx("span",{className:"text-slate-500",children:r}),o.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:o.jsx(Pm,{className:`h-5 w-5 text-slate-400 transition-transform ${a?"rotate-180":""}`,"aria-hidden":"true"})})]}),a&&o.jsx("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",role:"listbox",children:n.map(x=>o.jsx("li",{className:"relative cursor-default select-none py-2 pl-3 pr-9 text-slate-900 hover:bg-teal-50",onClick:()=>m(x),role:"option","aria-selected":e===x.value,children:o.jsxs("div",{children:[o.jsx("span",{className:`block truncate ${e===x.value?"font-semibold":"font-normal"}`,children:x.primaryText}),o.jsx("span",{className:"block truncate text-xs text-slate-500",children:x.secondaryText})]})},x.value))})]})},pP=[{id:"hr",name:"HR Module"},{id:"inventory_management",name:"Inventory Management"},{id:"supply_chain",name:"Supply Chain Module"},{id:"task_manager",name:"Task Manager"},{id:"finance",name:"Finance Module"},{id:"student",name:"Student Module"},{id:"website",name:"Website & Portals"}],Q1=["view","edit","delete","update"],gP=({users:n,employees:e,allPermissions:t,onUserPermissionsChange:r})=>{const[a,c]=L.useState(null),[d,f]=L.useState(null),[m,x]=L.useState(new Set),[y,v]=L.useState(null),A=n.filter(K=>K.email!=="admin").map(K=>{const ee=e.find(j=>j.email===K.email),B=ee?`${ee.firstName} ${ee.lastName}`:K.email,Q=ee?K.email:"No employee record";return{value:K.email,primaryText:B,secondaryText:Q}});L.useEffect(()=>{a?(f(t[a]||{}),x(new Set)):f(null)},[a,t]),L.useEffect(()=>{if(y){const K=setTimeout(()=>v(null),5e3);return()=>clearTimeout(K)}},[y]);const V=(K,ee)=>{f(B=>{if(!B)return null;const Q={...B};if(ee){const j=G1[K]||[],T={};j.forEach(S=>{T[S.id]={view:!1,edit:!1,delete:!1,update:!1}}),Q[K]=T}else delete Q[K],x(j=>{const T=new Set(j);return T.delete(K),T});return Q})},C=K=>{x(ee=>{const B=new Set(ee);return B.has(K)?B.delete(K):B.add(K),B})},O=(K,ee,B,Q)=>{f(j=>{if(!j)return null;const T=j[K]||{},S=T[ee]||{view:!1,edit:!1,delete:!1,update:!1};return{...j,[K]:{...T,[ee]:{...S,[B]:Q}}}})},z=()=>{!a||d===null||(r(a,d),v({type:"success",text:`Permissions for ${a} have been updated.`}),c(null))},ae=()=>{c(null),f(null)};return o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-5xl mx-auto",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-6",children:"User Access Management"}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{htmlFor:"select-user",className:"block text-sm font-medium text-blue-900",children:"Select a user to manage their module access"}),o.jsx(mP,{options:A,value:a,onChange:c,placeholder:"-- Select a user --"})]}),y&&o.jsx("div",{className:`my-4 p-3 rounded-md text-sm ${y.type==="error"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:y.text}),a&&d!==null&&o.jsxs("div",{children:[o.jsx("div",{className:"space-y-4",children:pP.map(K=>{const ee=!!d[K.id],B=m.has(K.id),Q=G1[K.id]||[];return o.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center p-4 bg-slate-50",children:[o.jsx("input",{type:"checkbox",id:`module-access-${K.id}`,className:"h-5 w-5 text-teal-600 border-slate-300 rounded focus:ring-teal-500",checked:ee,onChange:j=>V(K.id,j.target.checked)}),o.jsx("label",{htmlFor:`module-access-${K.id}`,className:"ml-3 flex-1 text-lg font-semibold text-blue-900 cursor-pointer",children:K.name}),o.jsx("button",{onClick:()=>C(K.id),disabled:!ee,className:"p-1 text-blue-900 rounded-full hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-expanded":B,children:o.jsx(Pm,{className:`w-5 h-5 transition-transform duration-300 ${B?"rotate-180":""}`})})]}),ee&&B&&o.jsxs("div",{className:"bg-white p-4 border-t border-slate-200",children:[o.jsx("h3",{className:"text-md font-semibold text-blue-900 mb-3",children:"Page Permissions"}),Q.length>0?o.jsxs("table",{className:"min-w-full divide-y divide-slate-200 border",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider",children:"Feature"}),Q1.map(j=>o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-blue-900 uppercase tracking-wider",children:j},j))]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:Q.map(j=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:j.label}),Q1.map(T=>{var S,N;return o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900 text-center",children:o.jsx("input",{type:"checkbox",className:"h-4 w-4 text-teal-600 border-slate-300 rounded focus:ring-teal-500",checked:((N=(S=d[K.id])==null?void 0:S[j.id])==null?void 0:N[T])||!1,onChange:R=>O(K.id,j.id,T,R.target.checked)})},T)})]},j.id))})]}):o.jsx("p",{className:"text-sm text-blue-900",children:"No configurable pages for this module."})]})]},K.id)})}),o.jsxs("div",{className:"flex justify-end pt-6 gap-3",children:[o.jsx("button",{onClick:ae,className:"py-2 px-4 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-blue-900 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",children:"Cancel"}),o.jsx("button",{onClick:z,className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500",children:"Save Permissions"})]})]})]})},xP=({employee:n,onApply:e,onCancel:t})=>{const[r,a]=L.useState({fromDate:"",toDate:"",leaveType:"Casual Leave",reason:""}),[c,d]=L.useState("");L.useEffect(()=>{if(c){const v=setTimeout(()=>d(""),5e3);return()=>clearTimeout(v)}},[c]);const f=L.useMemo(()=>{if(r.fromDate&&r.toDate){const v=new Date(r.fromDate),E=new Date(r.toDate);if(E<v)return 0;const A=Math.abs(E.getTime()-v.getTime());return Math.ceil(A/(1e3*60*60*24))+1}return 0},[r.fromDate,r.toDate]),m=L.useMemo(()=>{var V;const E={"Casual Leave":"casual","Sick Leave":"sick","Annual Leave":"annual","Maternity Leave":"maternity","Paternity Leave":"paternity","Alternate Day Off":"alternateDayOff",Others:"others"}[r.leaveType],A=((V=n.leaveBalance)==null?void 0:V[E])||{total:0,used:0};return{total:A.total,used:A.used,remaining:Math.max(0,A.total-A.used)}},[r.leaveType,n.leaveBalance]),x=v=>{const{id:E,value:A}=v.target;a(V=>({...V,[E]:A}))},y=v=>{if(v.preventDefault(),!r.fromDate||!r.toDate||!r.reason){d("Please fill in all required fields.");return}if(new Date(r.toDate)<new Date(r.fromDate)){d('"To Date" cannot be earlier than "From Date".');return}if(r.leaveType!=="Others"){if(m.remaining<=0){d(`Your ${r.leaveType} quota is exhausted. Please select a different leave type.`);return}if(f>m.remaining){d(`Insufficient balance for ${r.leaveType}. You have ${m.remaining} days remaining, but requested ${f}.`);return}}d("");const E={employeeId:n.id,...r,status:"Pending HOD"};e(E),t()};return o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-6",children:"Apply for Leave"}),o.jsxs("form",{onSubmit:y,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2 p-4 border rounded-md bg-slate-50",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Name:"})," ",o.jsxs("span",{className:"text-sm text-blue-900",children:[n.firstName," ",n.lastName]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Department:"})," ",o.jsx("span",{className:"text-sm text-blue-900",children:n.department})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"fromDate",className:"block text-sm font-medium text-blue-900",children:"From Date"}),o.jsx("input",{type:"date",id:"fromDate",value:r.fromDate,onChange:x,required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"toDate",className:"block text-sm font-medium text-blue-900",children:"To Date"}),o.jsx("input",{type:"date",id:"toDate",value:r.toDate,onChange:x,required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]})]}),o.jsxs("div",{className:"p-3 text-center bg-teal-50 border border-teal-200 rounded-md",children:[o.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Total Leave Days Requested:"}),o.jsx("span",{className:"ml-2 text-md font-bold text-teal-600",children:f>0?f:"--"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"leaveType",className:"block text-sm font-medium text-blue-900",children:"Leave Type"}),o.jsxs("select",{id:"leaveType",value:r.leaveType,onChange:x,required:!0,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md",children:[o.jsx("option",{children:"Casual Leave"}),o.jsx("option",{children:"Sick Leave"}),o.jsx("option",{children:"Annual Leave"}),o.jsx("option",{children:"Maternity Leave"}),o.jsx("option",{children:"Paternity Leave"}),o.jsx("option",{children:"Alternate Day Off"}),o.jsx("option",{children:"Others"})]}),r.leaveType!=="Others"&&o.jsxs("p",{className:`mt-1 text-xs ${m.remaining===0?"text-red-600 font-bold":"text-blue-900"}`,children:["Remaining Balance: ",m.remaining," days (Used: ",m.used,"/",m.total,")"]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-blue-900",children:"Reason for Leave"}),o.jsx("textarea",{id:"reason",value:r.reason,onChange:x,rows:4,required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),c&&o.jsx("div",{className:"p-3 rounded-md text-sm bg-red-100 text-red-800 border border-red-200",children:c}),o.jsxs("div",{className:"flex justify-end pt-4 gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"py-2 px-4 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-blue-900 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r.leaveType!=="Others"&&m.remaining<=0,className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 disabled:bg-slate-400 disabled:cursor-not-allowed",children:"Apply for Leave"})]})]})]})},yP=({employee:n})=>{var f,m,x,y,v,E,A;const[e,t]=L.useState(!1),r=n.employmentType==="Probation",a=r?{annual:{total:0,used:0},sick:{total:0,used:0},casual:{total:0,used:0},maternity:{total:0,used:0},paternity:{total:0,used:0},alternateDayOff:{total:0,used:0}}:{annual:((f=n.leaveBalance)==null?void 0:f.annual)||{total:14,used:0},sick:((m=n.leaveBalance)==null?void 0:m.sick)||{total:7,used:0},casual:((x=n.leaveBalance)==null?void 0:x.casual)||{total:6,used:0},maternity:((y=n.leaveBalance)==null?void 0:y.maternity)||{total:90,used:0},paternity:((v=n.leaveBalance)==null?void 0:v.paternity)||{total:7,used:0},alternateDayOff:((E=n.leaveBalance)==null?void 0:E.alternateDayOff)||{total:50,used:0},others:((A=n.leaveBalance)==null?void 0:A.others)||{}},c=(V,C)=>!C||C===0?0:Math.min(100,V/C*100),d=({label:V,data:C,colorClass:O})=>{const z=C||{total:0,used:0},ae=z.used||0,K=z.total||0;return o.jsxs("div",{className:"mb-4 last:mb-0",children:[o.jsxs("div",{className:"flex justify-between text-sm mb-1 font-medium text-blue-900",children:[o.jsx("span",{children:V}),o.jsxs("span",{children:[ae," / ",K," Days Used"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:o.jsx("div",{className:`h-2.5 rounded-full ${O}`,style:{width:`${c(ae,K)}%`}})}),o.jsxs("div",{className:"text-xs text-right text-blue-900 mt-1",children:[Math.max(0,K-ae)," Remaining"]})]})};return o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 mb-6 overflow-hidden",children:[o.jsxs("button",{onClick:()=>t(!e),className:"w-full flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-100 transition-colors",children:[o.jsxs("span",{className:"font-bold text-blue-900",children:["My Leave Balance ",r&&"(Probation - No Leaves Allocated)"]}),o.jsxs("div",{className:"flex items-center text-sm text-blue-900 font-medium",children:[e?"Hide Details":"Show Details",o.jsx(Pm,{className:`ml-2 w-4 h-4 transition-transform ${e?"rotate-180":""}`})]})]}),e&&o.jsx("div",{className:"p-6 border-t border-slate-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:o.jsx(d,{label:"Annual Leave",data:a.annual,colorClass:"bg-blue-900"})}),o.jsx("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:o.jsx(d,{label:"Sick Leave",data:a.sick,colorClass:"bg-purple-600"})}),o.jsx("div",{className:"p-4 bg-indigo-50 rounded-lg border border-indigo-100",children:o.jsx(d,{label:"Casual Leave",data:a.casual,colorClass:"bg-indigo-600"})}),o.jsx("div",{className:"p-4 bg-pink-50 rounded-lg border border-pink-100",children:o.jsx(d,{label:"Maternity Leave",data:a.maternity,colorClass:"bg-pink-500"})}),o.jsx("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:o.jsx(d,{label:"Paternity Leave",data:a.paternity,colorClass:"bg-slate-600"})}),o.jsx("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:o.jsx(d,{label:"Alternate Day Off",data:a.alternateDayOff,colorClass:"bg-purple-800"})})]})})]})},bP=({currentUserEmail:n,employees:e,leaveRequests:t,onAddLeaveRequest:r,onLeaveRequestAction:a})=>{const[c,d]=L.useState(!1),f=n==="admin",m=e.find(V=>V.email===n),x=L.useMemo(()=>{if(!m&&!f)return[];const V=f?"admin":m==null?void 0:m.role,C=m==null?void 0:m.department;return t.filter(O=>{const z=e.find(ae=>ae.id===O.employeeId);return z?O.status==="Pending HOD"&&(V==="admin"||V==="HOD"&&z.department===C)||O.status==="Pending HR"&&(V==="admin"||V==="HR"):!1})},[t,n,e,f,m]),y=m?t.filter(V=>V.employeeId===m.id).sort((V,C)=>new Date(C.fromDate).getTime()-new Date(V.fromDate).getTime()):[],v=V=>{const C=e.find(O=>O.id===V);return C?`${C.firstName} ${C.lastName}`:"Unknown Employee"},E=({status:V})=>{const C="px-2.5 py-0.5 text-xs font-medium rounded-full",O={"Pending HOD":"bg-yellow-100 text-yellow-800","Pending HR":"bg-orange-100 text-orange-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return o.jsx("span",{className:`${C} ${O[V]}`,children:V})};if(c&&m)return o.jsx(xP,{employee:m,onApply:r,onCancel:()=>d(!1)});const A=(m==null?void 0:m.role)==="Employee"&&(m==null?void 0:m.employmentType)!=="Probation";return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Leave Management"}),A&&o.jsx("button",{onClick:()=>d(!0),className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-700 hover:bg-purple-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:"Apply for Leave"})]}),m&&o.jsx(yP,{employee:m}),x.length>0&&o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"Awaiting Your Approval"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Employee"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Dates"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Reason"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:x.map(V=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-sm font-medium text-blue-900",children:v(V.employeeId)}),o.jsxs("td",{className:"px-6 py-4 text-sm text-blue-900",children:[V.fromDate," to ",V.toDate]}),o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900",children:V.leaveType}),o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900 max-w-xs truncate",title:V.reason,children:V.reason}),o.jsx("td",{className:"px-6 py-4 text-sm",children:o.jsx(E,{status:V.status})}),o.jsxs("td",{className:"px-6 py-4 text-sm space-x-2",children:[o.jsx("button",{onClick:()=>a(V.id,"Approve"),className:"text-green-600 hover:text-green-900 font-medium",children:"Approve"}),o.jsx("button",{onClick:()=>a(V.id,"Reject"),className:"text-red-600 hover:text-red-900 font-medium",children:"Reject"})]})]},V.id))})]})})]}),y.length>0&&o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"My Leave History"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"From"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"To"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Reason"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Status"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:y.map(V=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900",children:V.fromDate}),o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900",children:V.toDate}),o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900",children:V.leaveType}),o.jsx("td",{className:"px-6 py-4 text-sm text-blue-900 max-w-xs truncate",title:V.reason,children:V.reason}),o.jsx("td",{className:"px-6 py-4 text-sm",children:o.jsx(E,{status:V.status})})]},V.id))})]})})]})]})},vP=[{name:"School of Arts",departments:["Department of Fine Arts","Department of Music","Department of Performing Arts","Department of Visual Arts"]},{name:"School of SIR",departments:["Department of Information Technology","Department of Robotics","Department of Software Engineering","Department of Data Science"]},{name:"School of SADU",departments:["Department of Architecture & Design","Department of Urban & Regional Planning","Department of Interior Design"]},{name:"School of SDCA",departments:["Department of Digital Communication","Department of Animation & VFX","Department of Media & Cultural Studies","Department of Game Design"]}],_P=()=>{const[n,e]=L.useState(null),t=r=>{e(n===r?null:r)};return o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-6",children:"Departments by School"}),o.jsx("div",{className:"space-y-4",children:vP.map(r=>{const a=n===r.name;return o.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden transition-all duration-300",children:[o.jsxs("button",{onClick:()=>t(r.name),className:"w-full flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-inset","aria-expanded":a,"aria-controls":`departments-${r.name}`,children:[o.jsx("h2",{className:"text-lg font-semibold text-blue-900",children:r.name}),o.jsx(Pm,{className:`w-5 h-5 text-blue-900 transition-transform duration-300 ${a?"rotate-180":""}`})]}),a&&o.jsx("div",{id:`departments-${r.name}`,className:"bg-white p-4 border-t border-slate-200",children:o.jsx("ul",{className:"space-y-2 pl-4 list-disc list-inside",children:r.departments.map(c=>o.jsx("li",{className:"text-blue-900 text-sm",children:c},c))})})]},r.name)})})]})},Y1=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 11.21 12.75 11 12 11c-.75 0-1.536.21-2.121.659-1.172.879-1.172 2.303 0 3.182zM12 21a9 9 0 110-18 9 9 0 010 18z"})}),Qa=({icon:n,title:e,value:t,bgColor:r})=>o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm flex items-center space-x-4",children:[o.jsx("div",{className:`p-3 rounded-full ${r}`,children:o.jsx(n,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-blue-900",children:e}),o.jsx("p",{className:"text-xl font-bold text-blue-900",children:t})]})]}),qs=n=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n).replace("PKR","PKR "),wP=({employees:n,payrollHistory:e,attendanceRecords:t=[],leaveRequests:r=[],onRunPayroll:a})=>{const[c,d]=L.useState(!1),[f,m]=L.useState(null),[x,y]=L.useState(null),[v,E]=L.useState(()=>new Date().toISOString().slice(0,7));L.useEffect(()=>{if(x){const ee=setTimeout(()=>y(null),5e3);return()=>clearTimeout(ee)}},[x]);const A=n.reduce((ee,B)=>ee+parseFloat(B.salary||"0"),0),V=n.length>0?A/n.length:0,C=new Date;C.setMonth(C.getMonth()+1,0);const O=async()=>{if(window.confirm(`Are you sure you want to run payroll for ${v}? This calculates deductions based on attendance.`)){const ee=await a();y({type:ee.success?"success":"error",text:ee.message})}},z=(ee,B,Q,j)=>{const T=t.filter(R=>{const D=new Date(R.date);return(R.employeeId===B||R.employeeId===ee)&&D.getMonth()===j&&D.getFullYear()===Q}).length;let S=0;return r.filter(R=>R.employeeId===ee&&R.status==="Approved").forEach(R=>{const D=new Date(R.fromDate),M=new Date(R.toDate);for(let Te=new Date(D);Te<=M;Te.setDate(Te.getDate()+1))if(Te.getMonth()===j&&Te.getFullYear()===Q){const Pe=Te.toISOString().split("T")[0];t.some(ce=>(ce.employeeId===B||ce.employeeId===ee)&&ce.date===Pe)||S++}}),{daysPresent:T,approvedLeaveDays:S,totalPaidDays:T+S}},ae=ee=>{const[B,Q]=v.split("-").map(Number),j=Q-1,{daysPresent:T,approvedLeaveDays:S,totalPaidDays:N}=z(ee.id,ee.employeeId,B,j),R=parseFloat(ee.salary||"0");let D=R,M=0;if(t.some(Ue=>{const P=new Date(Ue.date);return P.getMonth()===j&&P.getFullYear()===B})){const Ue=Math.min(30,N);D=R/30*Ue,M=R-D,M<0&&(M=0)}else M=0;const Pe=D,W=new Date(B,j).toLocaleString("default",{month:"long",year:"numeric"}),ce=[["MASBOT ERP Payslip"],[`Report for: ${W}`],[],["Employee Details"],["Employee ID",ee.employeeId||ee.id],["Name",`${ee.firstName} ${ee.lastName}`],["Department",ee.department],["Designation",ee.designation],[],["Attendance Summary"],["Days Present",T],["Approved Leave Days",S],["Total Paid Days",N],[],["Earnings","Amount (PKR)"],["Base Salary",R],[],["Deductions","Amount (PKR)"],["Absenteeism / Unpaid",M],[],["",""],["Net Salary",Pe]],ve=XLSX.utils.aoa_to_sheet(ce);ve["!cols"]=[{wch:25},{wch:20}];const ke=XLSX.utils.book_new();XLSX.utils.book_append_sheet(ke,ve,"Payslip"),XLSX.writeFile(ke,`Payslip-${ee.firstName}_${ee.lastName}-${v}.xlsx`)},K=()=>{const[ee,B]=v.split("-").map(Number),Q=B-1;return o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Employee"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Days Present"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Paid Leave"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Total Days"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Base Salary"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Deductions"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Net Pay"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(j=>{const T=parseFloat(j.salary||"0"),{daysPresent:S,approvedLeaveDays:N,totalPaidDays:R}=z(j.id,j.employeeId,ee,Q);let D=T,M=0;const Te=t.some(Pe=>{const W=new Date(Pe.date);return W.getMonth()===Q&&W.getFullYear()===ee});if(Te){const Pe=Math.min(30,R);D=T/30*Pe,M=T-D,M<0&&(M=0)}return o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm font-medium text-blue-900",children:[j.firstName," ",j.lastName]}),o.jsx("div",{className:"text-xs text-blue-900",children:j.employeeId})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900 font-bold",children:Te?S:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-bold",children:Te?N:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:Te?R:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:qs(T)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-500",children:M>0?`-${qs(M)}`:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-green-600",children:qs(D)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsx("button",{onClick:()=>ae(j),className:"text-teal-600 hover:text-teal-900",children:"Payslip"})})]},j.id)})})]})};return c?f?o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("button",{onClick:()=>m(null),className:"flex items-center gap-2 text-sm font-medium text-blue-900 hover:text-teal-600",children:[o.jsx(Wf,{className:"w-5 h-5"}),o.jsx("span",{children:"Back to History"})]})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-blue-900",children:["Payroll Details: ",f.monthYear]}),o.jsxs("p",{className:"text-blue-900 mt-1",children:["Processed on ",new Date(f.date).toLocaleDateString()]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx(Qa,{icon:Y1,title:"Total Payout",value:qs(f.totalNetPay),bgColor:"bg-green-500"}),o.jsx(Qa,{icon:Qf,title:"Employees Paid",value:f.employeeRecords.length.toString(),bgColor:"bg-blue-500"}),o.jsx(Qa,{icon:tc,title:"Total Deductions",value:qs(f.totalDeductions),bgColor:"bg-red-500"})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"Breakdown"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Employee"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Department"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Base Salary"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Deductions"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase",children:"Net Pay"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:f.employeeRecords.map(ee=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:ee.employeeName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:ee.department}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:qs(ee.baseSalary)}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-500",children:["-",qs(ee.deductions)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-green-600",children:qs(ee.netPay)})]},ee.employeeId))})]})})]})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("button",{onClick:()=>d(!1),className:"flex items-center gap-2 text-sm font-medium text-blue-900 hover:text-teal-600",children:[o.jsx(Wf,{className:"w-5 h-5"}),o.jsx("span",{children:"Back to Payroll"})]})}),o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Payroll History"}),e.length>0?o.jsx("div",{className:"space-y-4",children:e.map(ee=>o.jsxs("div",{onClick:()=>m(ee),className:"bg-white p-4 rounded-lg shadow-sm border border-transparent hover:border-teal-500 cursor-pointer transition-all flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-blue-900 text-lg",children:ee.monthYear}),o.jsxs("p",{className:"text-xs text-blue-900",children:["Processed: ",new Date(ee.date).toLocaleDateString()]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm text-blue-900",children:"Paid Out"}),o.jsx("p",{className:"font-bold text-green-600",children:qs(ee.totalNetPay)})]})]},ee.id))}):o.jsx("div",{className:"text-center py-10 bg-white rounded-lg",children:o.jsx("p",{className:"text-blue-900",children:"No payroll history found."})})]}):o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Payroll Management"}),o.jsx("p",{className:"text-blue-900 mt-1",children:"Salaries are automatically calculated based on attendance records and approved leaves."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(Qa,{icon:Y1,title:"Est. Monthly Payroll",value:qs(A),bgColor:"bg-teal-500"}),o.jsx(Qa,{icon:Qf,title:"Total Employees",value:n.length.toString(),bgColor:"bg-blue-500"}),o.jsx(Qa,{icon:tc,title:"Avg. Salary",value:qs(V),bgColor:"bg-orange-500"}),o.jsx(Qa,{icon:vy,title:"Next Payroll",value:C.toLocaleDateString(),bgColor:"bg-indigo-500"})]}),o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-6 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900",children:"Salaries"}),o.jsx("input",{type:"month",value:v,onChange:ee=>E(ee.target.value),className:"border-gray-300 rounded-md shadow-sm focus:ring-teal-500 focus:border-teal-500 sm:text-sm text-blue-900"})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>d(!0),className:"btn-secondary py-2 px-4 border rounded-md text-sm font-medium hover:bg-gray-50 text-blue-900",children:"View History"}),o.jsx("button",{onClick:O,className:"bg-teal-600 text-white py-2 px-4 rounded-md text-sm font-medium hover:bg-teal-700 shadow-sm",children:"Finalize & Run Payroll"})]})]}),x&&o.jsx("div",{className:`mb-4 p-3 rounded-md text-sm ${x.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.text}),o.jsx("div",{className:"overflow-x-auto",children:n.length>0?K():o.jsx("p",{className:"text-center text-blue-900 py-4",children:"No employees found."})})]})]})},NP=({employees:n,attendanceRecords:e=[],leaveRequests:t=[]})=>{const[r,a]=L.useState("monthly"),[c,d]=L.useState("All"),[f,m]=L.useState(""),[x,y]=L.useState(()=>new Date().toISOString().slice(0,7)),[v,E]=L.useState(()=>new Date().toISOString().split("T")[0]),[A,V]=L.useState(()=>new Date().toISOString().split("T")[0]),C=L.useMemo(()=>{const B=n.map(Q=>Q.department);return["All",...Array.from(new Set(B))]},[n]),O=L.useMemo(()=>n.filter(B=>{const Q=c==="All"||B.department===c,T=`${B.firstName} ${B.lastName}`.toLowerCase().includes(f.toLowerCase());return Q&&T}),[n,c,f]),z=B=>{const[Q,j]=x.split("-").map(Number),T=j-1,S=e.filter(D=>{const M=new Date(D.date);return(D.employeeId&&String(D.employeeId).trim()===String(B.employeeId||B.id).trim()||D.employeeId===B.id)&&M.getMonth()===T&&M.getFullYear()===Q});let N=0;S.length>0&&(N=Math.round(S.length/30*100),N>100&&(N=100));const R=t.filter(D=>{const M=D.employeeId===B.id,Te=new Date(D.fromDate),Pe=Te.getMonth()===T&&Te.getFullYear()===Q;return M&&D.status==="Approved"&&Pe}).length;return{attendancePct:N,approvedLeaves:R,daysPresent:S.length}},ae=L.useMemo(()=>e.filter(B=>{if(B.date<v||B.date>A)return!1;const Q=n.find(T=>String(T.employeeId).trim()===String(B.employeeId).trim()||T.id===B.employeeId);if(!Q||c!=="All"&&Q.department!==c)return!1;const j=`${Q.firstName} ${Q.lastName}`.toLowerCase();return!(f&&!j.includes(f.toLowerCase()))}).map(B=>{const Q=n.find(j=>String(j.employeeId).trim()===String(B.employeeId).trim()||j.id===B.employeeId);return{...B,empName:Q?`${Q.firstName} ${Q.lastName}`:"Unknown",department:(Q==null?void 0:Q.department)||"-",designation:(Q==null?void 0:Q.designation)||"-"}}).sort((B,Q)=>B.date.localeCompare(Q.date)||B.empName.localeCompare(Q.empName)),[e,v,A,c,n,f]),K=L.useMemo(()=>{const B=[],Q=new Date(v),j=new Date(A),T=n.filter(N=>{const R=c==="All"||N.department===c,M=`${N.firstName} ${N.lastName}`.toLowerCase().includes(f.toLowerCase());return R&&M}),S=new Set;e.forEach(N=>{N.date>=v&&N.date<=A&&S.add(`${String(N.employeeId).trim()}_${N.date}`)});for(let N=new Date(Q);N<=j;N.setDate(N.getDate()+1)){const R=N.toISOString().split("T")[0];T.forEach(D=>{const M=String(D.employeeId||"").trim(),Te=D.id;if(!(S.has(`${M}_${R}`)||S.has(`${Te}_${R}`))){const W=t.find(ce=>ce.employeeId===D.id&&ce.status==="Approved"&&R>=ce.fromDate&&R<=ce.toDate);B.push({date:R,empId:D.employeeId||D.id,name:`${D.firstName} ${D.lastName}`,department:D.department,designation:D.designation,status:W?"On Leave":"Absent",remarks:W?W.leaveType:"-"})}})}return B.sort((N,R)=>N.date.localeCompare(R.date)||N.name.localeCompare(R.name))},[v,A,c,n,e,t,f]),ee=()=>{if(r==="monthly"){const B=O.map((T,S)=>{const{attendancePct:N,approvedLeaves:R,daysPresent:D}=z(T);return new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(parseFloat(T.salary||"0")),{"#":S+1,Name:`${T.firstName} ${T.lastName}`,Department:T.department,Designation:T.designation,Month:x,"Days Present":D,"Attendance (%)":`${N}%`,"Leaves Taken":R}}),Q=XLSX.utils.json_to_sheet(B),j=XLSX.utils.book_new();XLSX.utils.book_append_sheet(j,Q,"Monthly Report"),XLSX.writeFile(j,`HR_Monthly_Report_${x}.xlsx`)}else if(r==="attendance"){const B=ae.map(T=>({Date:T.date,"Employee ID":T.employeeId,Name:T.empName,Department:T.department,"Time In":T.timeIn,"Time Out":T.timeOut||"-",Status:T.status})),Q=XLSX.utils.json_to_sheet(B),j=XLSX.utils.book_new();XLSX.utils.book_append_sheet(j,Q,"Attendance"),XLSX.writeFile(j,`Attendance_Report_${v}_to_${A}.xlsx`)}else if(r==="absent"){const B=K.map(T=>({Date:T.date,"Employee ID":T.empId,Name:T.name,Department:T.department,Status:T.status,Remarks:T.remarks})),Q=XLSX.utils.json_to_sheet(B),j=XLSX.utils.book_new();XLSX.utils.book_append_sheet(j,Q,"Absent"),XLSX.writeFile(j,`Absent_Report_${v}_to_${A}.xlsx`)}};return o.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-lg shadow-sm min-h-screen",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"HR Reports"}),o.jsx("p",{className:"text-sm text-blue-900",children:"Generate comprehensive reports for attendance and performance."})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 bg-slate-100 p-1 rounded-lg",children:[o.jsx("button",{onClick:()=>a("monthly"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${r==="monthly"?"bg-white text-teal-700 shadow-sm":"text-blue-900 hover:text-blue-950"}`,children:"Monthly Performance"}),o.jsx("button",{onClick:()=>a("attendance"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${r==="attendance"?"bg-white text-teal-700 shadow-sm":"text-blue-900 hover:text-blue-950"}`,children:"Attendance Report"}),o.jsx("button",{onClick:()=>a("absent"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${r==="absent"?"bg-white text-teal-700 shadow-sm":"text-blue-900 hover:text-blue-950"}`,children:"Absent Report"})]}),o.jsxs("button",{onClick:ee,className:"bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-2 px-4 rounded-md transition-colors shadow-sm flex items-center gap-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Excel"]})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 bg-slate-50 p-4 rounded-lg border border-slate-200 items-end",children:[o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("label",{htmlFor:"department-filter",className:"block text-xs font-medium text-blue-900 mb-1",children:"Department"}),o.jsx("select",{id:"department-filter",value:c,onChange:B=>d(B.target.value),className:"block w-full md:w-48 pl-3 pr-10 py-2 text-base border-slate-300 bg-white text-blue-900 focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md border",children:C.map(B=>o.jsx("option",{value:B,children:B},B))})]}),o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("label",{htmlFor:"name-search",className:"block text-xs font-medium text-blue-900 mb-1",children:"Employee Name"}),o.jsx("input",{type:"text",id:"name-search",placeholder:"Search by name...",value:f,onChange:B=>m(B.target.value),className:"block w-full md:w-48 px-3 py-2 text-base border-slate-300 bg-white text-blue-900 focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md border"})]}),r==="monthly"?o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("label",{htmlFor:"month-filter",className:"block text-xs font-medium text-blue-900 mb-1",children:"Select Month"}),o.jsx("input",{type:"month",id:"month-filter",value:x,onChange:B=>y(B.target.value),className:"block w-full md:w-48 px-3 py-2 text-base border-slate-300 bg-white text-blue-900 focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md border"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("label",{htmlFor:"from-date",className:"block text-xs font-medium text-blue-900 mb-1",children:"From Date"}),o.jsx("input",{type:"date",id:"from-date",value:v,onChange:B=>E(B.target.value),className:"block w-full md:w-40 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("label",{htmlFor:"to-date",className:"block text-xs font-medium text-blue-900 mb-1",children:"To Date"}),o.jsx("input",{type:"date",id:"to-date",value:A,onChange:B=>V(B.target.value),className:"block w-full md:w-40 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]})]})]}),r==="monthly"&&o.jsxs("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:[o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"#"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Department"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Designation"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Attendance"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Leaves"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Salary"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:O.map((B,Q)=>{const{attendancePct:j,approvedLeaves:T}=z(B),S=new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(parseFloat(B.salary||"0"));return o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:Q+1}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900 font-medium",children:[B.firstName," ",B.lastName]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.department}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.designation}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsxs("span",{className:`text-xs font-semibold inline-block py-1 px-2 rounded-full ${j>=90?"text-green-600 bg-green-100":j>=75?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"}`,children:[j,"%"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:T}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:S.replace("PKR","PKR ")})]},B.id)})})]}),O.length===0&&o.jsx("p",{className:"text-center py-8 text-blue-900",children:"No data found matching criteria."})]}),r==="attendance"&&o.jsxs("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:[o.jsxs("div",{className:"p-3 bg-green-50 border-b border-green-100 text-sm text-green-800 font-medium",children:["Showing ",ae.length," records from ",v," to ",A]}),o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Department"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Time In"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Time Out"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Status"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:ae.map((B,Q)=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.date}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:B.empName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.department}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-blue-900",children:B.timeIn}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-blue-900",children:B.timeOut||"--"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${B.status==="Late"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:B.status})})]},Q))})]}),ae.length===0&&o.jsx("p",{className:"text-center py-8 text-blue-900",children:"No attendance records found for this period."})]}),r==="absent"&&o.jsxs("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:[o.jsxs("div",{className:"p-3 bg-red-50 border-b border-red-100 text-sm text-red-800 font-medium",children:["Showing ",K.length," absentee records from ",v," to ",A]}),o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Department"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Remarks"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:K.map((B,Q)=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.date}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:B.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.department}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${B.status==="On Leave"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:B.status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:B.remarks})]},Q))})]}),K.length===0&&o.jsx("p",{className:"text-center py-8 text-blue-900",children:"No absences found! Everyone was present."})]})]})},TP=({employees:n,attendanceRecords:e,onUploadAttendance:t,currentUserEmail:r})=>{const[a,c]=L.useState(null),[d,f]=L.useState(!1),m=new Date().toISOString().split("T")[0],[x,y]=L.useState(m),[v,E]=L.useState(m),[A,V]=L.useState("All"),C=L.useRef(null),O=n.find(N=>N.email===r),z=r==="admin",ae=(O==null?void 0:O.role)==="HR",K=z||ae;L.useEffect(()=>{if(a){const N=setTimeout(()=>c(null),5e3);return()=>clearTimeout(N)}},[a]);const ee=L.useMemo(()=>{const N=n.map(R=>R.department).filter(Boolean);return["All",...Array.from(new Set(N))]},[n]),B=N=>{if(typeof N=="number"){const R=Math.round(N*86400),D=Math.floor(R/3600),M=Math.floor(R%3600/60);return`${String(D).padStart(2,"0")}:${String(M).padStart(2,"0")}`}if(typeof N=="string"){const R=N.split(":");if(R.length>=2){let D=parseInt(R[0]);const M=R[1];return N.toLowerCase().includes("pm")&&D<12&&(D+=12),N.toLowerCase().includes("am")&&D===12&&(D=0),`${String(D).padStart(2,"0")}:${M.substring(0,2)}`}}return String(N||"")},Q=N=>{if(typeof N=="number"){const D=Math.floor(N-25569)*86400;return new Date(D*1e3).toISOString().split("T")[0]}try{const R=new Date(N);return isNaN(R.getTime())?String(N):R.toISOString().split("T")[0]}catch{return String(N)}},j=async N=>{var D;const R=(D=N.target.files)==null?void 0:D[0];if(R){f(!0),c(null);try{const M=await R.arrayBuffer(),Te=XLSX.read(M,{type:"array"}),Pe=Te.SheetNames[0],W=Te.Sheets[Pe],ce=XLSX.utils.sheet_to_json(W),ve=new Map;ce.forEach(P=>{const $={};Object.keys(P).forEach(H=>{const pe=H.replace(/[^a-zA-Z0-9]/g,"").toLowerCase();$[pe]=P[H]});const le=$.employeeid||$.empid||$.id||$.userid||$.acno,_e=$.name||$.employeename||$.empname||$.employee,Ne=$.date||$.attendancedate||$.time,F=$.time||$.timein||$.checkin||$.datetime;if(!Ne)return;let me;if(le){const H=String(le).trim();me=n.find(pe=>pe.employeeId&&String(pe.employeeId).trim()===H||pe.id&&String(pe.id).trim()===H)}if(!me&&_e){const H=String(_e).trim().toLowerCase();me=n.find(pe=>`${pe.firstName} ${pe.lastName}`.toLowerCase()===H)}if(me){let H=Q(Ne),pe=B(F);if(Ne.toString().includes("T")||typeof Ne=="string"&&Ne.length>15){const Be=new Date(Ne);if(!isNaN(Be.getTime())){H=Be.toISOString().split("T")[0];const gt=String(Be.getHours()).padStart(2,"0"),Lt=String(Be.getMinutes()).padStart(2,"0");pe=`${gt}:${Lt}`}}if(H&&pe&&pe.includes(":")){const Be=`${me.id}_${H}`,[gt,Lt]=pe.split(":").map(Number),ns=gt*60+Lt;ve.has(Be)||ve.set(Be,{employeeId:me.id,date:H,times:[],status:"Present"});const En=ve.get(Be);En.times.includes(ns)||En.times.push(ns)}}});const ke=[];let Ue=0;if(ve.forEach(P=>{if(P.times.sort(($,le)=>$-le),P.times.length>0){const $=P.times[0],le=P.times[P.times.length-1],_e=`${String(Math.floor($/60)).padStart(2,"0")}:${String($%60).padStart(2,"0")}`;let Ne="";P.times.length>1&&(Ne=`${String(Math.floor(le/60)).padStart(2,"0")}:${String(le%60).padStart(2,"0")}`);let F="Present";const[me,H]=_e.split(":").map(Number);(me>9||me===9&&H>15)&&(F="Late"),ke.push({employeeId:P.employeeId,date:P.date,timeIn:_e,timeOut:Ne,status:F}),Ue++}}),ke.length>0){const P=await t(ke);c({type:P.success?"success":"error",text:`${P.message} (${Ue} daily records processed)`})}else c({type:"error",text:"No valid records matched. Ensure ID or Name columns match your employee data."})}catch(M){console.error("Error processing file:",M),c({type:"error",text:"Failed to process the uploaded file. Please ensure it is a valid Excel/CSV file."})}finally{f(!1),C.current&&(C.current.value="")}}},T=N=>{const R=n.find(D=>D.employeeId===N||D.id===N);return R?`${R.firstName} ${R.lastName}`:"Unknown"},S=L.useMemo(()=>e.filter(N=>{if(!K&&O&&!(N.employeeId===O.id||N.employeeId===O.employeeId)||!(N.date>=x&&N.date<=v))return!1;if(K&&A!=="All"){const D=n.find(M=>M.employeeId===N.employeeId||M.id===N.employeeId);if((D==null?void 0:D.department)!==A)return!1}return!0}).sort((N,R)=>{if(N.date!==R.date)return R.date.localeCompare(N.date);const D=T(N.employeeId),M=T(R.employeeId);return D.localeCompare(M)}),[e,x,v,A,n,K,O]);return o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm space-y-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:"Attendance Management"}),o.jsx("p",{className:"text-blue-900 mt-1",children:K?"Upload biometric logs or view daily records.":"View your attendance history."})]}),K&&o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"file",ref:C,onChange:j,accept:".xlsx, .xls, .csv",className:"hidden"}),o.jsxs("button",{onClick:()=>{var N;return(N=C.current)==null?void 0:N.click()},disabled:d,className:"flex items-center justify-center gap-2 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 disabled:bg-teal-400 disabled:cursor-not-allowed",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),d?"Processing...":"Upload Machine Data"]})]})]}),a&&o.jsx("div",{className:`p-3 rounded-md text-sm ${a.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.text}),o.jsxs("div",{className:"bg-slate-50 p-4 rounded-md border border-slate-200",children:[o.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Filters"}),o.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-end gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"from-date",className:"block text-xs font-medium text-blue-900 mb-1",children:"From Date"}),o.jsx("input",{type:"date",id:"from-date",value:x,onChange:N=>y(N.target.value),className:"block w-full sm:w-40 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"to-date",className:"block text-xs font-medium text-blue-900 mb-1",children:"To Date"}),o.jsx("input",{type:"date",id:"to-date",value:v,onChange:N=>E(N.target.value),className:"block w-full sm:w-40 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"})]}),K&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dept-select",className:"block text-xs font-medium text-blue-900 mb-1",children:"Department"}),o.jsx("select",{id:"dept-select",value:A,onChange:N=>V(N.target.value),className:"block w-full sm:w-48 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-blue-900 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",children:ee.map(N=>o.jsx("option",{value:N,children:N},N))})]})]})]}),o.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Employee ID"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Employee Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Time In"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Time Out"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-blue-900 uppercase",children:"Status"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:S.length>0?S.map(N=>{const R=N.status==="Late"?"bg-yellow-100 text-yellow-800":N.status==="Absent"?"bg-red-100 text-red-800":"bg-green-100 text-green-800";return o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:N.date}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:N.employeeId}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-900",children:T(N.employeeId)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:N.timeIn}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-900",children:N.timeOut||"--"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${R}`,children:N.status})})]},N.id)}):o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"text-center py-10",children:o.jsx("p",{className:"text-blue-900",children:"No attendance records found for the selected criteria."})})})})]})})]})},EP=({onBack:n,employees:e,users:t,onAddEmployee:r,onLogout:a,allPermissions:c,onUserPermissionsChange:d,currentUserEmail:f,leaveRequests:m,onAddLeaveRequest:x,onLeaveRequestAction:y,onResignEmployee:v,payrollHistory:E,onRunPayroll:A,onUpdateEmployee:V,attendanceRecords:C,onUploadAttendance:O})=>{var Pe;const[z,ae]=L.useState(!1),K=f==="admin",ee=((Pe=c[f])==null?void 0:Pe.hr)||{},B=e.find(W=>W.email===f),Q=L.useMemo(()=>{if(K)return"dashboard";const ce=[...ud,...dd].filter(ve=>{var ke;return(B==null?void 0:B.role)==="Employee"&&ve.id==="dashboard"?!1:(ke=ee[ve.id])==null?void 0:ke.view});return ce.length>0?ce[0].id:null},[K,ee,B]),[j,T]=L.useState(Q),[S,N]=L.useState("");L.useEffect(()=>{!j&&Q&&T(Q)},[Q,j]);const R=()=>{ae(!z)},D=L.useMemo(()=>{if(!S)return e;const W=S.toLowerCase();return e.filter(ce=>`${ce.firstName} ${ce.lastName}`.toLowerCase().includes(W)||ce.email.toLowerCase().includes(W)||ce.department.toLowerCase().includes(W)||ce.designation.toLowerCase().includes(W)||(ce.employeeId||"").toLowerCase().includes(W))},[e,S]),M=L.useMemo(()=>{if(!S)return t;const W=S.toLowerCase();return t.filter(ce=>{if(ce.email.toLowerCase().includes(W))return!0;const ve=e.find(ke=>ke.email===ce.email);return!!(ve&&`${ve.firstName} ${ve.lastName}`.toLowerCase().includes(W))})},[t,e,S]),Te=()=>{if(!j)return o.jsxs("div",{className:"p-6 text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Access Denied"}),o.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"You do not have permission to view any pages in this module. Please contact an administrator."}),o.jsx("button",{onClick:n,className:"mt-4 text-teal-600 hover:underline",children:"Go Back"})]});switch(j){case"dashboard":return o.jsx(uP,{employees:e,leaveRequests:m,onLeaveRequestAction:y,onNavigate:T});case"employees":return o.jsx(hP,{onAddEmployee:r,employees:D,onResignEmployee:v,onUpdateEmployee:V});case"attendance":return o.jsx(TP,{employees:e,attendanceRecords:C,onUploadAttendance:O,currentUserEmail:f});case"reports":return o.jsx(NP,{employees:e,attendanceRecords:C,leaveRequests:m});case"users":return o.jsx(fP,{users:M,employees:e});case"user-access":return o.jsx(gP,{users:t,employees:e,allPermissions:c,onUserPermissionsChange:d});case"leaves":return o.jsx(bP,{currentUserEmail:f,employees:e,leaveRequests:m,onAddLeaveRequest:x,onLeaveRequestAction:y});case"departments":return o.jsx(_P,{});case"payroll":return o.jsx(wP,{employees:e,payrollHistory:E,attendanceRecords:C,leaveRequests:m,onRunPayroll:A});default:return o.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:["Content for ",j]})}};return o.jsxs("div",{className:"flex h-screen bg-slate-100",children:[o.jsx(rP,{activePage:j||"",setActivePage:T,isCollapsed:z,onLogout:a,permissions:ee,currentUserEmail:f,employees:e}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx(oP,{toggleSidebar:R,isSidebarCollapsed:z,onLogout:a,searchQuery:S,onSearchChange:N,onBack:n}),o.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-slate-100",children:o.jsx("div",{className:"p-6",children:Te()})})]})]})},SP=({currentPage:n,onNavigate:e,permissions:t,currentUserEmail:r,employees:a})=>{const c=r==="admin",d=Ny.map(v=>v.id),f=c?Yf:Yf.filter(v=>{var E;return v.id==="assets"?d.some(A=>{var V;return(V=t==null?void 0:t[A])==null?void 0:V.view}):(E=t==null?void 0:t[v.id])==null?void 0:E.view}),m=a.find(v=>v.email===r),x=c?"Administrator":m?`${m.firstName} ${m.lastName}`:r,y=x.charAt(0).toUpperCase();return o.jsxs("aside",{className:"w-64 flex-shrink-0 flex flex-col bg-white dark:bg-gray-800 border-r border-slate-200 dark:border-gray-700",children:[o.jsx("div",{className:"flex items-center justify-center h-20 border-b border-slate-200 dark:border-gray-700 flex-shrink-0 px-4",children:o.jsx(_o,{className:"w-full h-10"})}),o.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2 overflow-y-auto",children:f.map(v=>{const E=v.icon;return o.jsxs("button",{onClick:()=>e(v.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left ${n===v.id?"bg-purple-50 text-purple-900 font-bold border-r-4 border-purple-900":"text-blue-900 dark:text-blue-300 hover:bg-purple-50 hover:text-purple-900 dark:hover:bg-gray-700"}`,children:[o.jsx(E,{className:`w-6 h-6 ${n===v.id?"text-purple-900":"text-purple-800"}`}),o.jsx("span",{className:"font-medium",children:v.label})]},v.id)})}),o.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center font-bold text-purple-900 dark:text-purple-300",children:y}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-sm text-blue-900 dark:text-white",title:x,children:x}),o.jsx("p",{className:"text-xs text-blue-800 dark:text-gray-400",title:r,children:r})]})]})})]})},AP=n=>{if(!n.specs)return"-";const{cpu:e,ram:t,storage:r,gpu:a,lcd:c}=n.specs;if(n.type==="Monitor"&&c)return c;const d=[e,t,r,a].filter(Boolean);return d.length===0?"-":d.join(" / ")},Ty=({inventory:n,onEdit:e,onResign:t,onDelete:r,view:a})=>{const c=f=>{switch(f){case"In Use":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"In Stock":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"Maintenance":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},d=a==="All"||a==="In Use";return o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-blue-600 dark:text-gray-400",children:[o.jsx("thead",{className:"text-xs text-blue-900 uppercase bg-blue-50 dark:bg-gray-700 dark:text-gray-400",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Type"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Brand"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Model"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Specifications"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Serial No."}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Assigned To"}),d&&o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Department"}),d&&o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Issue Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Others"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:o.jsx("span",{className:"sr-only",children:"Actions"})})]})}),o.jsx("tbody",{children:n.map(f=>o.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-blue-50 dark:hover:bg-gray-600",children:[o.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-blue-900 dark:text-white whitespace-nowrap",children:f.type}),o.jsx("td",{className:"px-6 py-4 font-semibold text-blue-800",children:f.brand||"-"}),o.jsx("td",{className:"px-6 py-4 text-blue-800",children:f.model}),o.jsx("td",{className:"px-6 py-4 text-xs text-blue-600",children:AP(f)}),o.jsx("td",{className:"px-6 py-4 font-mono text-xs text-blue-600",children:f.serialNumber||"-"}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${c(f.status)}`,children:f.status})}),o.jsx("td",{className:"px-6 py-4 text-blue-800",children:f.assignedTo||"-"}),d&&o.jsx("td",{className:"px-6 py-4 text-blue-800",children:f.department||"-"}),d&&o.jsx("td",{className:"px-6 py-4 text-blue-800",children:f.issueDate||"-"}),o.jsx("td",{className:"px-6 py-4 text-blue-600",children:f.others||"-"}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[o.jsx("button",{onClick:()=>e(f),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Edit"}),f.status==="In Use"&&f.assignedTo&&o.jsx("button",{onClick:()=>t(f.assignedTo),className:"font-medium text-yellow-600 dark:text-yellow-500 hover:underline",children:"Resign"}),r&&o.jsx("button",{onClick:()=>r(f.id),className:"font-medium text-red-600 dark:text-red-500 hover:underline",children:"Delete"})]})})]},f.id))})]})})},ff={type:"Kitchen",model:"",brand:"",status:"In Stock",assignedTo:"",serialNumber:"",department:"",designation:"",issueDate:"",vendor:"",maintenanceDate:"",others:"",specs:{cpu:"",ram:"",storage:"",gpu:"",lcd:""},telephoneExt:"",quantity:1,unit:"",itemCode:"",itemName:"",subCategory:"",purchaseDate:"",cost:"",assetLife:"",location:"",condition:"",remarks:""},W1=({type:n,specs:e,brand:t,onChange:r})=>n!=="Laptop"&&n!=="Desktop"&&n!=="Monitor"&&n!=="Electronics"?null:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-1 mt-3 pt-3 border-t border-blue-200 dark:border-gray-600",children:[o.jsx("input",{type:"text",name:"brand",value:t||"",onChange:r,placeholder:"Brand (e.g., Dell, HP)",className:"input-style mb-3"}),(n==="Laptop"||n==="Desktop")&&o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",name:"cpu",value:(e==null?void 0:e.cpu)||"",onChange:r,placeholder:"CPU (e.g., Core i7)",className:"input-style mb-3"}),o.jsx("input",{type:"text",name:"ram",value:(e==null?void 0:e.ram)||"",onChange:r,placeholder:"RAM (e.g., 16GB DDR4)",className:"input-style mb-3"}),o.jsx("input",{type:"text",name:"storage",value:(e==null?void 0:e.storage)||"",onChange:r,placeholder:"Storage (e.g., 512GB SSD)",className:"input-style mb-3"})]}),n==="Desktop"&&o.jsx("input",{type:"text",name:"gpu",value:(e==null?void 0:e.gpu)||"",onChange:r,placeholder:"GPU (e.g., NVIDIA RTX 3060)",className:"input-style mb-3"}),(n==="Laptop"||n==="Desktop"||n==="Monitor")&&o.jsx("input",{type:"text",name:"lcd",value:(e==null?void 0:e.lcd)||"",onChange:r,placeholder:"LCD / Display",className:"input-style mb-3"})]}),Dd=n=>{const{isOpen:e,onClose:t,onSave:r,editingAsset:a,initialStatus:c,initialType:d,isMultiAddMode:f,employees:m}=n,x=(T="In Stock")=>({...ff,specs:{...ff.specs},status:T}),[y,v]=L.useState(x()),[E,A]=L.useState({assignedTo:"",department:"",designation:"",issueDate:""}),[V,C]=L.useState([x("In Use")]),O=L.useCallback(()=>{v(x()),A({assignedTo:"",department:"",designation:"",issueDate:""}),C([x("In Use")])},[]);L.useEffect(()=>{if(e)if(a)v({...ff,...a,specs:{...ff.specs,...a.specs||{}}});else if(f)C([x("In Use")]),A({assignedTo:"",department:"",designation:"",issueDate:""});else{const T=x(c);d&&(T.type=d),v(T)}else setTimeout(O,300)},[e,a,f,c,d,O]);const z=T=>{const{name:S,value:N}=T.target;if(["cpu","ram","storage","gpu","lcd"].includes(S))v(R=>({...R,specs:{...R.specs||{},[S]:N}}));else if(S==="assignedTo"){const R=m.find(D=>`${D.firstName} ${D.lastName}`===N);v(R?D=>({...D,assignedTo:N,department:R.department,designation:R.designation}):D=>({...D,assignedTo:N}))}else v(R=>({...R,[S]:N}))},ae=T=>{const{name:S,value:N}=T.target;if(S==="assignedTo"){const R=m.find(D=>`${D.firstName} ${D.lastName}`===N);A(R?D=>({...D,assignedTo:N,department:R.department,designation:R.designation}):D=>({...D,[S]:N,department:"",designation:""}))}else A(R=>({...R,[S]:N}))},K=(T,S)=>{const{name:N,value:R}=S.target;C(D=>{const M=[...D],Te={...M[T]};return Te.specs&&(Te.specs={...Te.specs}),["cpu","ram","storage","gpu","lcd"].includes(N)?Te.specs={...Te.specs||{},[N]:R}:N==="brand"?Te.brand=R:Te[N]=R,M[T]=Te,M})},ee=()=>{C(T=>[...T,x("In Use")])},B=T=>{C(S=>S.filter((N,R)=>R!==T))},Q=T=>{if(T.preventDefault(),f&&!a){const S=V.map(N=>({...N,...E,status:"In Use"}));r(S)}else r([y],a==null?void 0:a.id)};if(!e)return null;const j=o.jsx("datalist",{id:"employee-list",children:m.map(T=>o.jsx("option",{value:`${T.firstName} ${T.lastName}`},T.id))});return f&&!a?o.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start",onClick:t,children:[j,o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl",onClick:T=>T.stopPropagation(),children:[o.jsxs("form",{onSubmit:Q,children:[o.jsxs("div",{className:"p-6 border-b border-blue-200 dark:border-gray-700",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 dark:text-white",children:"Assign New Assets"}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:"Bulk assign assets to an employee."})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 dark:bg-gray-700 p-4 rounded-lg",children:[o.jsx("h3",{className:"font-medium text-blue-900 dark:text-white mb-3",children:"Employee Details"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{list:"employee-list",name:"assignedTo",value:E.assignedTo,onChange:ae,placeholder:"Search Employee",className:"input-style",required:!0}),o.jsx("input",{type:"text",name:"department",value:E.department,onChange:T=>{},placeholder:"Department",className:"input-style bg-gray-100",readOnly:!0}),o.jsx("input",{type:"text",name:"designation",value:E.designation,onChange:T=>{},placeholder:"Designation",className:"input-style bg-gray-100",readOnly:!0}),o.jsx("input",{type:"date",name:"issueDate",value:E.issueDate,onChange:ae,className:"input-style",required:!0})]})]}),o.jsxs("div",{className:"space-y-4",children:[V.map((T,S)=>o.jsxs("div",{className:"border border-blue-200 dark:border-gray-600 p-4 rounded-lg relative",children:[o.jsx("button",{type:"button",onClick:()=>B(S),className:"absolute top-2 right-2 text-red-500 hover:text-red-700",title:"Remove Asset",children:""}),o.jsxs("h4",{className:"text-sm font-medium text-blue-800 dark:text-gray-300 mb-2",children:["Asset #",S+1]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("select",{name:"type",value:T.type,onChange:N=>K(S,N),className:"input-style",children:[o.jsx("option",{value:"Laptop",children:"Laptop"}),o.jsx("option",{value:"Desktop",children:"Desktop"}),o.jsx("option",{value:"Monitor",children:"Monitor"}),o.jsx("option",{value:"Electronics",children:"Electronics"}),o.jsx("option",{value:"Furniture",children:"Furniture"}),o.jsx("option",{value:"Accessory",children:"Accessory"})]}),o.jsx("input",{type:"text",name:"model",value:T.model,onChange:N=>K(S,N),placeholder:"Model",className:"input-style",required:!0}),o.jsx("input",{type:"text",name:"serialNumber",value:T.serialNumber,onChange:N=>K(S,N),placeholder:"Serial Number",className:"input-style"})]}),o.jsx(W1,{type:T.type,specs:T.specs,brand:T.brand,onChange:N=>K(S,N)})]},S)),o.jsx("button",{type:"button",onClick:ee,className:"w-full py-2 border-2 border-dashed border-blue-300 dark:border-gray-600 rounded-lg text-blue-600 dark:text-gray-400 hover:bg-blue-50 dark:hover:bg-gray-700",children:"+ Add Another Asset"})]})]}),o.jsxs("div",{className:"p-6 border-t border-blue-200 dark:border-gray-700 flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-blue-800 bg-white border border-blue-300 rounded-lg hover:bg-blue-50",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-900 rounded-lg hover:bg-blue-800",children:"Assign Assets"})]})]}),o.jsx("style",{children:`
                        .input-style { background-color: #F9FAFB; border: 1px solid #BFDBFE; border-radius: 0.375rem; padding: 0.5rem 0.75rem; width: 100%; color: #1e3a8a; }
                        .input-style::placeholder { color: #93C5FD; }
                        .dark .input-style { background-color: #374151; border-color: #4B5563; color: white; }
                     `})]})]}):o.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start",onClick:t,children:[j,o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl",onClick:T=>T.stopPropagation(),children:[o.jsxs("form",{onSubmit:Q,children:[o.jsxs("div",{className:"p-6 border-b border-blue-200 dark:border-gray-700",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 dark:text-white",children:a?"Edit Asset":"Add New Asset"}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:"Enter details for the item."})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Category"}),o.jsxs("select",{name:"type",value:y.type,onChange:z,className:"input-style",children:[o.jsx("option",{value:"Kitchen",children:"Kitchen"}),o.jsx("option",{value:"Laptop",children:"Laptop"}),o.jsx("option",{value:"Desktop",children:"Desktop"}),o.jsx("option",{value:"Printer",children:"Printer"}),o.jsx("option",{value:"Monitor",children:"Monitor"}),o.jsx("option",{value:"Electronics",children:"Electronics"}),o.jsx("option",{value:"Furniture",children:"Furniture"}),o.jsx("option",{value:"Accessory",children:"Accessory"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Model / Name"}),o.jsx("input",{type:"text",name:"model",value:y.model,onChange:z,className:"input-style",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Status"}),o.jsxs("select",{name:"status",value:y.status,onChange:z,className:"input-style",children:[o.jsx("option",{value:"In Stock",children:"In Stock"}),o.jsx("option",{value:"In Use",children:"In Use"}),o.jsx("option",{value:"Maintenance",children:"Maintenance"})]})]}),y.type==="Kitchen"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Quantity"}),o.jsx("input",{type:"number",name:"quantity",value:y.quantity,onChange:z,className:"input-style",required:!0,min:"0",step:"any"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Unit (e.g. kg, liters)"}),o.jsx("input",{type:"text",name:"unit",value:y.unit,onChange:z,className:"input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Item Code"}),o.jsx("input",{type:"text",name:"itemCode",value:y.itemCode,onChange:z,className:"input-style"})]})]}):o.jsxs("div",{children:[o.jsx("label",{className:"label-style",children:"Serial Number"}),o.jsx("input",{type:"text",name:"serialNumber",value:y.serialNumber,onChange:z,className:"input-style"})]})]}),y.status==="In Use"&&o.jsxs("div",{className:"bg-blue-50 dark:bg-gray-700 p-4 rounded-lg space-y-3",children:[o.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-white",children:"Assignment Details"}),o.jsx("input",{list:"employee-list",name:"assignedTo",value:y.assignedTo,onChange:z,placeholder:"Assigned To (Employee)",className:"input-style"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsx("input",{type:"text",name:"department",value:y.department,onChange:z,placeholder:"Department",className:"input-style"}),o.jsx("input",{type:"text",name:"location",value:y.location,onChange:z,placeholder:"Location",className:"input-style"})]}),o.jsx("input",{type:"date",name:"issueDate",value:y.issueDate,onChange:z,className:"input-style"})]}),o.jsx(W1,{type:y.type,specs:y.specs,brand:y.brand,onChange:z}),o.jsx("textarea",{name:"others",value:y.others,onChange:z,placeholder:"Other Details / Remarks",className:"input-style",rows:2})]}),o.jsxs("div",{className:"p-6 border-t border-blue-200 dark:border-gray-700 flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-blue-800 bg-white border border-blue-300 rounded-lg hover:bg-blue-50",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-900 rounded-lg hover:bg-blue-800",children:"Save Asset"})]})]}),o.jsx("style",{children:`
                    .input-style { background-color: #F9FAFB; border: 1px solid #BFDBFE; border-radius: 0.375rem; padding: 0.5rem 0.75rem; width: 100%; color: #1e3a8a; }
                    .input-style::placeholder { color: #93C5FD; }
                    .dark .input-style { background-color: #374151; border-color: #4B5563; color: white; }
                    .label-style { display: block; font-size: 0.875rem; font-weight: 500; color: #1e3a8a; margin-bottom: 0.25rem; }
                    .dark .label-style { color: #D1D5DB; }
                `})]})]})},IP=({title:n,count:e,icon:t,onClick:r,color:a})=>o.jsxs("div",{onClick:r,className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform duration-200 flex flex-col items-start",children:[o.jsx("div",{className:`rounded-lg p-3 mb-4 ${a}`,children:hd.cloneElement(t,{className:"h-8 w-8 text-white"})}),o.jsx("h3",{className:"font-bold text-lg text-blue-900 dark:text-white",children:n}),o.jsxs("p",{className:"text-blue-900 dark:text-gray-400 mt-1 text-sm",children:[e," items"]})]}),jP=({isOpen:n,onClose:e,onSave:t,editingGroupedToner:r})=>{const[a,c]=L.useState(""),[d,f]=L.useState(""),[m,x]=L.useState(0),[y,v]=L.useState(0);L.useEffect(()=>{n&&(r?(c(r.model),f(r.compatiblePrinters.join(", ")),x(r.filled.quantity),v(r.empty.quantity)):(c(""),f(""),x(1),v(0)))},[n,r]);const E=C=>{C.preventDefault();const O=d.split(",").map(z=>z.trim()).filter(Boolean);t({model:a,compatiblePrinters:O,filledQuantity:Number(m)||0,emptyQuantity:Number(y)||0,originalModelName:r==null?void 0:r.model})};if(!n)return null;const A=r?"Edit Toner Model":"Add New Toner Model",V=r?"Update the details for this toner model.":"Enter the details for the new toner model.";return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start","aria-modal":"true",role:"dialog",onClick:e,children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg",onClick:C=>C.stopPropagation(),children:[o.jsxs("form",{onSubmit:E,children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:A}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:V})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"model",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Toner Model"}),o.jsx("input",{type:"text",id:"model",name:"model",value:a,onChange:C=>c(C.target.value),required:!0,className:"mt-1 block w-full input-style",placeholder:"e.g., HP 58A"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"compatiblePrinters",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Compatible Printer Models"}),o.jsx("input",{type:"text",id:"compatiblePrinters",name:"compatiblePrinters",value:d,onChange:C=>f(C.target.value),className:"mt-1 block w-full input-style",placeholder:"e.g., HP LaserJet Pro M404dn, Other Model"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Separate multiple models with a comma."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"filledQuantity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filled Quantity"}),o.jsx("input",{type:"number",id:"filledQuantity",name:"filledQuantity",value:m,onChange:C=>x(parseInt(C.target.value,10)),min:"0",required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"emptyQuantity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Empty Quantity"}),o.jsx("input",{type:"number",id:"emptyQuantity",name:"emptyQuantity",value:y,onChange:C=>v(parseInt(C.target.value,10)),min:"0",required:!0,className:"mt-1 block w-full input-style"})]})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700",children:"Save Toner Model"})]})]}),o.jsx("style",{children:".input-style { background-color: #F9FAFB; border: 1px solid #D1D5DB; border-radius: 0.5rem; padding: 0.75rem 1rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); transition: all 0.2s ease-in-out; } .dark .input-style { background-color: #374151; border-color: #4B5563; color: #F9FAFB; } .input-style:focus { outline: none; --tw-ring-color: #3B82F6; box-shadow: 0 0 0 2px var(--tw-ring-color); }"})]})})},s0=({title:n,count:e,icon:t,colorClasses:r})=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center space-x-4",children:[o.jsx("div",{className:`rounded-full p-3 ${r.bg}`,children:hd.cloneElement(t,{className:`h-6 w-6 ${r.text}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-gray-400",children:n}),o.jsx("p",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:e})]})]}),RP=n=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...n,children:o.jsx("path",{fillRule:"evenodd",d:"M3 3.5A1.5 1.5 0 014.5 2h5.25a1.5 1.5 0 011.06.44l3.5 3.5a1.5 1.5 0 01.44 1.06V16.5A1.5 1.5 0 0113.5 18H4.5A1.5 1.5 0 013 16.5v-13zM9 12.25a.75.75 0 00-1.5 0v.5a.75.75 0 001.5 0v-.5z",clipRule:"evenodd"})}),CP=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...n,children:[o.jsx("path",{d:"M5.5 2A2.5 2.5 0 003 4.5v11A2.5 2.5 0 005.5 18h9a2.5 2.5 0 002.5-2.5V8.31l-5.5-5.5H5.5zM9 4.75a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 019 4.75z"}),o.jsx("path",{d:"M10.121 2.227a.75.75 0 00-1.06 0l-5.5 5.5A.75.75 0 004 8.25v7.25a.75.75 0 00.75.75h8.5a.75.75 0 00.75-.75V8.25a.75.75 0 00-.22-.53l-5.5-5.5zM10 8a1 1 0 11-2 0 1 1 0 012 0z"})]}),kP=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...n,children:[o.jsx("path",{d:"M2 3.5A1.5 1.5 0 013.5 2h13A1.5 1.5 0 0118 3.5v13a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 012 16.5v-13z"}),o.jsx("path",{d:"M5 6a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H6z"})]}),DP=n=>{const{printers:e,toners:t,onAddNewAsset:r,onUpdateAsset:a,onDeleteAsset:c,onResignEmployee:d,onSaveTonerModel:f,onDeleteTonerModel:m,onMarkTonerEmpty:x,onMarkTonerFilled:y,employees:v}=n,[E,A]=L.useState("printers"),[V,C]=L.useState(""),[O,z]=L.useState(!1),[ae,K]=L.useState(null),[ee,B]=L.useState(),[Q,j]=L.useState(!1),[T,S]=L.useState(null),[N,R]=L.useState("All"),D=L.useMemo(()=>{const F=V.trim().toLowerCase();return F?e.filter(me=>Object.values(me).some(H=>String(H).toLowerCase().includes(F))||Object.values(me.specs||{}).some(H=>String(H).toLowerCase().includes(F))):e},[e,V]),M=L.useMemo(()=>["All",...Array.from(new Set(t.map(F=>F.model)))],[t]),Te=L.useMemo(()=>{const F=new Map;return t.forEach(me=>{F.has(me.model)||F.set(me.model,{model:me.model,compatiblePrinters:me.compatiblePrinters,filled:{id:null,quantity:0},empty:{id:null,quantity:0}});const H=F.get(me.model);me.status==="Filled"?(H.filled.id=me.id,H.filled.quantity=me.quantity,H.compatiblePrinters=[...new Set([...H.compatiblePrinters,...me.compatiblePrinters])]):me.status==="Empty"&&(H.empty.id=me.id,H.empty.quantity=me.quantity,H.compatiblePrinters=[...new Set([...H.compatiblePrinters,...me.compatiblePrinters])])}),Array.from(F.values()).sort((me,H)=>me.model.localeCompare(H.model))},[t]),Pe=L.useMemo(()=>N==="All"?Te:Te.filter(F=>F.model===N),[Te,N]),W=L.useMemo(()=>({total:t.reduce((F,me)=>F+me.quantity,0),filled:t.filter(F=>F.status==="Filled").reduce((F,me)=>F+me.quantity,0),empty:t.filter(F=>F.status==="Empty").reduce((F,me)=>F+me.quantity,0)}),[t]),ce=()=>{K(null),B("Printer"),z(!0)},ve=F=>{K(F),B(void 0),z(!0)},ke=()=>{z(!1),K(null),B(void 0)},Ue=()=>{S(null),j(!0)},P=F=>{S(F),j(!0)},$=()=>{j(!1)},le=(F,me)=>{const H={...F[0],type:"Printer"};me?a({...H,id:me}):r([H]),ke()},_e=F=>{f(F),$()},Ne=F=>{window.confirm(`Are you sure you want to delete all toner records for model "${F}"? This will remove both filled and empty stock. This action cannot be undone.`)&&m(F)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:"Printers & Toners"}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:"Manage all printing devices and their consumables."})]})}),o.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:o.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>A("printers"),className:`${E==="printers"?"border-purple-900 text-purple-900 dark:text-blue-400":"border-transparent text-blue-600 dark:text-gray-400 hover:text-blue-900 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:["Printers (",e.length,")"]}),o.jsxs("button",{onClick:()=>A("toners"),className:`${E==="toners"?"border-purple-900 text-purple-900 dark:text-blue-400":"border-transparent text-blue-600 dark:text-gray-400 hover:text-blue-900 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:["Toners (",M.length-1," Models)"]})]})}),E==="printers"&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-4",children:[o.jsxs("div",{className:"relative w-full sm:w-auto flex-grow",children:[o.jsx("input",{type:"text",placeholder:"Search printers... (e.g., model, serial, user)",value:V,onChange:F=>C(F.target.value),className:"w-full sm:w-96 pl-10 pr-4 py-2 border border-slate-200 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-900 text-blue-900 placeholder-slate-400"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-purple-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),o.jsxs("button",{onClick:ce,className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium flex items-center space-x-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),o.jsx("span",{children:"Add New Printer"})]})]}),o.jsx(Ty,{inventory:D,onEdit:ve,onResign:d,view:"All",onDelete:c})]}),E==="toners"&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(s0,{title:"Total Toner Stock",count:W.total,icon:o.jsx(kP,{}),colorClasses:{bg:"bg-purple-100 dark:bg-gray-700",text:"text-purple-900 dark:text-gray-300"}}),o.jsx(s0,{title:"Total Filled Toners",count:W.filled,icon:o.jsx(RP,{}),colorClasses:{bg:"bg-green-100 dark:bg-green-900",text:"text-green-600 dark:text-green-300"}}),o.jsx(s0,{title:"Total Empty Toners",count:W.empty,icon:o.jsx(CP,{}),colorClasses:{bg:"bg-yellow-100 dark:bg-yellow-900",text:"text-yellow-600 dark:text-yellow-300"}})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{htmlFor:"tonerModelFilter",className:"text-sm font-medium text-blue-900 dark:text-gray-300",children:"Filter by Model:"}),o.jsx("select",{id:"tonerModelFilter",value:N,onChange:F=>R(F.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-blue-500 text-blue-900",children:M.map(F=>o.jsx("option",{value:F,children:F},F))})]}),o.jsxs("button",{onClick:Ue,className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium flex items-center space-x-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),o.jsx("span",{children:"Add New Toner Model"})]})]}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-blue-600 dark:text-gray-400",children:[o.jsx("thead",{className:"text-xs text-blue-900 uppercase bg-purple-50 dark:bg-gray-700 dark:text-gray-400",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Toner Model"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Compatible Printers"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Filled Qty"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Empty Qty"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Total Qty"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Actions"})]})}),o.jsx("tbody",{children:Pe.map(F=>o.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-purple-50 dark:hover:bg-gray-600",children:[o.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-blue-900 dark:text-white whitespace-nowrap",children:F.model}),o.jsx("td",{className:"px-6 py-4 text-xs text-blue-800",children:F.compatiblePrinters.join(", ")}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",children:F.filled.quantity})}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",children:F.empty.quantity})}),o.jsx("td",{className:"px-6 py-4 text-center font-bold text-blue-900 dark:text-gray-300",children:F.filled.quantity+F.empty.quantity}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[o.jsx("button",{onClick:()=>x(F.filled.id),disabled:!F.filled.id||F.filled.quantity===0,className:"font-medium text-yellow-600 dark:text-yellow-500 hover:underline disabled:text-gray-400 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:no-underline","aria-label":`Mark one ${F.model} toner as empty`,title:"Mark 1 Empty",children:"Mark Empty"}),o.jsx("button",{onClick:()=>y(F.empty.id),disabled:!F.empty.id||F.empty.quantity===0,className:"font-medium text-green-600 dark:text-green-500 hover:underline disabled:text-gray-400 dark:disabled:text-gray-500 disabled:cursor-not-allowed disabled:no-underline","aria-label":`Mark one ${F.model} toner as filled`,title:"Mark 1 Filled",children:"Mark Filled"}),o.jsx("button",{onClick:()=>P(F),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline","aria-label":`Edit ${F.model} toner model`,title:"Edit Model",children:"Edit"}),o.jsx("button",{onClick:()=>Ne(F.model),className:"font-medium text-red-600 dark:text-red-500 hover:underline","aria-label":`Delete all ${F.model} toner records`,title:"Delete Model",children:"Delete"})]})})]},F.model))})]})})]})]}),o.jsx(Dd,{isOpen:O,onClose:ke,onSave:le,editingAsset:ae,initialType:ee,employees:v}),o.jsx(jP,{isOpen:Q,onClose:$,onSave:_e,editingGroupedToner:T})]})},X1={serialNumber:"",systemModel:"",lcdModel:"",lcdInches:"",cpu:"",ram:"",storage:"",gpu:"",keyboard:"",mouse:"",networkDevice:"Ethernet"},MP=({isOpen:n,onClose:e,onSave:t,editingSystem:r})=>{const[a,c]=L.useState(X1);L.useEffect(()=>{n&&c(r||X1)},[n,r]);const d=m=>{const{name:x,value:y}=m.target;c(v=>({...v,[x]:y}))},f=m=>{m.preventDefault(),t(a,r==null?void 0:r.id)};return n?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start",onClick:e,"aria-modal":"true",role:"dialog",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl",onClick:m=>m.stopPropagation(),children:[o.jsxs("form",{onSubmit:f,children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit System":"Add New System"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter the details of the computer system."})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"System & Display"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"systemModel",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"System Model"}),o.jsx("input",{type:"text",id:"systemModel",name:"systemModel",value:a.systemModel,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"serialNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Serial Number"}),o.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:a.serialNumber,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"lcdModel",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"LCD Model"}),o.jsx("input",{type:"text",id:"lcdModel",name:"lcdModel",value:a.lcdModel,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"lcdInches",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"LCD Size (Inches)"}),o.jsx("input",{type:"text",id:"lcdInches",name:"lcdInches",value:a.lcdInches,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]})]})]}),o.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Core Components"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"cpu",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"CPU"}),o.jsx("input",{type:"text",id:"cpu",name:"cpu",value:a.cpu,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"ram",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"RAM"}),o.jsx("input",{type:"text",id:"ram",name:"ram",value:a.ram,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"storage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Storage"}),o.jsx("input",{type:"text",id:"storage",name:"storage",value:a.storage,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"gpu",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Graphics Card (GPU)"}),o.jsx("input",{type:"text",id:"gpu",name:"gpu",value:a.gpu,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]})]})]}),o.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Peripherals & Network"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-2",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"keyboard",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Keyboard"}),o.jsx("input",{type:"text",id:"keyboard",name:"keyboard",value:a.keyboard,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"mouse",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mouse"}),o.jsx("input",{type:"text",id:"mouse",name:"mouse",value:a.mouse,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"networkDevice",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Network Device"}),o.jsx("input",{type:"text",id:"networkDevice",name:"networkDevice",value:a.networkDevice,onChange:d,required:!0,className:"mt-1 block w-full input-style",placeholder:"e.g., Ethernet or WiFi Tenda"})]})]})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700",children:"Save System"})]})]}),o.jsx("style",{children:`
                    .input-style {
                        background-color: #F9FAFB; /* bg-gray-50 */
                        border: 1px solid #D1D5DB; /* border-gray-300 */
                        border-radius: 0.375rem; /* rounded-md */
                        padding: 0.5rem 0.75rem; /* px-3 py-2 */
                        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
                        transition: all 0.2s ease-in-out;
                    }
                    .dark .input-style {
                        background-color: #374151; /* dark:bg-gray-700 */
                        border-color: #4B5563; /* dark:border-gray-600 */
                        color: #F9FAFB; /* dark:text-white */
                    }
                    .input-style:focus {
                        outline: none;
                        --tw-ring-color: #3B82F6; /* focus:ring-blue-500 */
                        box-shadow: 0 0 0 2px var(--tw-ring-color);
                    }
                `})]})}):null},PP=({labs:n,onAddSystem:e,onUpdateSystem:t,onDeleteSystem:r})=>{const[a,c]=L.useState(null),[d,f]=L.useState(!1),[m,x]=L.useState(null),y=()=>{x(null),f(!0)},v=O=>{x(O),f(!0)},E=()=>{f(!1),x(null)},A=(O,z)=>{a&&(z?t(a.id,{...O,id:z}):e(a.id,O),E())},V=O=>{a&&window.confirm(`Are you sure you want to delete system ${O}?`)&&r(a.id,O)},C=()=>{if(!a)return;const O=["ID","Serial Number","System Model","LCD Model","LCD Inches","CPU","RAM","Storage","GPU","Keyboard","Mouse","Network Device"],z=a.systems.map(B=>[`"${B.id}"`,`"${B.serialNumber}"`,`"${B.systemModel}"`,`"${B.lcdModel}"`,`"${B.lcdInches}"`,`"${B.cpu}"`,`"${B.ram}"`,`"${B.storage}"`,`"${B.gpu}"`,`"${B.keyboard}"`,`"${B.mouse}"`,`"${B.networkDevice}"`].join(",")),ae="data:text/csv;charset=utf-8,"+[O.join(","),...z].join(`
`),K=encodeURI(ae),ee=document.createElement("a");ee.setAttribute("href",K),ee.setAttribute("download",`${a.name.replace(/\s+/g,"_")}_Inventory.csv`),document.body.appendChild(ee),ee.click(),document.body.removeChild(ee)};return a?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-6",children:[o.jsxs("button",{onClick:()=>c(null),className:"mb-6 flex items-center text-sm font-medium text-blue-900 dark:text-blue-400 hover:underline",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to All Labs"]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:[a.name," - Systems Inventory"]}),o.jsxs("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:["Total Systems: ",a.systems.length]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:C,disabled:a.systems.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-md text-sm font-medium flex items-center space-x-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),o.jsx("span",{children:"Download Inventory"})]}),o.jsxs("button",{onClick:y,className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium flex items-center space-x-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),o.jsx("span",{children:"Add New System"})]})]})]}),a.systems.length>0?o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-blue-600 dark:text-gray-400",children:[o.jsx("thead",{className:"text-xs text-blue-900 uppercase bg-purple-50 dark:bg-gray-700 dark:text-gray-400",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Serial No."}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"System Model"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"CPU"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"RAM"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Storage"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"GPU"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Keyboard"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Mouse"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:o.jsx("span",{className:"sr-only",children:"Actions"})})]})}),o.jsx("tbody",{children:a.systems.map(O=>o.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-purple-50 dark:hover:bg-gray-600",children:[o.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-blue-900 dark:text-white whitespace-nowrap",children:O.id}),o.jsx("td",{className:"px-6 py-4",children:O.serialNumber}),o.jsx("td",{className:"px-6 py-4",children:O.systemModel}),o.jsx("td",{className:"px-6 py-4",children:O.cpu}),o.jsx("td",{className:"px-6 py-4",children:O.ram}),o.jsx("td",{className:"px-6 py-4",children:O.storage}),o.jsx("td",{className:"px-6 py-4",children:O.gpu}),o.jsx("td",{className:"px-6 py-4",children:O.keyboard}),o.jsx("td",{className:"px-6 py-4",children:O.mouse}),o.jsxs("td",{className:"px-6 py-4 text-right flex items-center space-x-3",children:[o.jsx("button",{onClick:()=>v(O),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Edit"}),o.jsx("button",{onClick:()=>V(O.id),className:"font-medium text-red-600 dark:text-red-500 hover:underline",children:"Delete"})]})]},O.id))})]})}):o.jsxs("div",{className:"text-center py-10 px-6 bg-white dark:bg-gray-800 rounded-lg shadow",children:[o.jsx("h3",{className:"text-lg font-medium text-blue-900 dark:text-white",children:"No Systems Found"}),o.jsxs("p",{className:"mt-1 text-sm text-blue-600 dark:text-gray-400",children:["There are no systems currently registered in ",a.name,"."]}),o.jsx("button",{onClick:y,className:"mt-4 px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium",children:"Add the First System"})]})]}),o.jsx(MP,{isOpen:d,onClose:E,onSave:A,editingSystem:m})]}):o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white mb-6",children:"Computer Labs"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(O=>o.jsxs("div",{onClick:()=>c(O),className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-transform duration-200",children:[o.jsx("h3",{className:"font-bold text-lg text-blue-900 dark:text-white",children:O.name}),o.jsxs("p",{className:"text-blue-600 dark:text-gray-400 mt-2",children:[O.systems.length," Systems"]})]},O.id))})]})},El={Barista:[{name:"Espresso Shot",ingredients:[{name:"Coffee Beans",quantity:.018,unit:"kg"}]},{name:"Cappuccino",ingredients:[{name:"Coffee Beans",quantity:.018,unit:"kg"},{name:"Milk",quantity:.15,unit:"liters"}]}],Cooking:[{name:"Basic Omelette",ingredients:[{name:"Eggs",quantity:2,unit:"pieces"},{name:"Butter",quantity:.01,unit:"kg"},{name:"Salt",quantity:.001,unit:"kg"}]},{name:"Mirepoix Prep",ingredients:[{name:"Onion",quantity:2,unit:"pieces"},{name:"Carrot",quantity:1,unit:"pieces"},{name:"Celery",quantity:1,unit:"pieces"}]}],"Culinary Chef":[{name:"Vinaigrette",ingredients:[{name:"Olive Oil",quantity:.06,unit:"liters"},{name:"Vinegar",quantity:.02,unit:"liters"},{name:"Salt",quantity:.001,unit:"kg"}]}],Bakery:[{name:"Simple Bread Dough",ingredients:[{name:"Flour",quantity:.5,unit:"kg"},{name:"Water",quantity:.3,unit:"liters"},{name:"Yeast",quantity:.007,unit:"kg"},{name:"Salt",quantity:.01,unit:"kg"}]},{name:"Basic Cookie Dough",ingredients:[{name:"Flour",quantity:.25,unit:"kg"},{name:"Butter",quantity:.15,unit:"kg"},{name:"Sugar",quantity:.2,unit:"kg"},{name:"Eggs",quantity:1,unit:"pieces"}]}]},OP=n=>{var Ne;const[e,t]=L.useState(!1),[r,a]=L.useState(null),[c,d]=L.useState(null),[f,m]=L.useState(Object.keys(El)[0]),[x,y]=L.useState(El[f][0].name),[v,E]=L.useState(1),[A,V]=L.useState(!1),[C,O]=L.useState("item"),[z,ae]=L.useState([]),[K,ee]=L.useState(""),[B,Q]=L.useState(""),[j,T]=L.useState(1),[S,N]=L.useState("");L.useEffect(()=>{y(El[f][0].name)},[f]),L.useEffect(()=>{if(c){const F=setTimeout(()=>d(null),5e3);return()=>clearTimeout(F)}},[c]);const R=L.useMemo(()=>n.inventory.filter(F=>F.type==="Kitchen"),[n.inventory]),D=L.useMemo(()=>El[f].find(F=>F.name===x),[f,x]),M=L.useMemo(()=>{if(!D)return{canMake:!1,needed:[]};let F=!0;const me=D.ingredients.map(H=>{const pe=R.find(ns=>ns.model.toLowerCase()===H.name.toLowerCase()),Be=H.quantity*v,gt=(pe==null?void 0:pe.quantity)||0,Lt=gt>=Be;return Lt||(F=!1),{name:H.name,required:Be.toFixed(3),available:gt,sufficient:Lt,unit:H.unit}});return{canMake:F,needed:me}},[D,R,v]),Te=()=>{a(null),t(!0)},Pe=F=>{a(F),t(!0)},W=(F,me)=>{const H=F.map(pe=>({...pe,type:"Kitchen",status:"In Stock",assignedTo:""}));me&&H.length===1?n.onUpdateAsset({...H[0],id:me}):n.onAddNewAsset(H),t(!1),d({type:"success",text:`Material ${me?"updated":"added"} successfully.`})},ce=async()=>{if(!D||!M.canMake)return;const F=D.ingredients.map(me=>{const H=R.find(Be=>Be.model.toLowerCase()===me.name.toLowerCase()),pe=H.quantity-me.quantity*v;return{id:H.id,newQuantity:pe}});await n.onUpdateKitchenStock(F),d({type:"success",text:`${v} student(s) worth of materials for ${x} used. Stock updated.`})},ve=F=>{ae([]),ee(""),Q(""),T(1),N(""),F&&(O("item"),ke(F,1)),V(!0)},ke=(F,me)=>{ae(H=>H.find(Be=>Be.item.id===F.id)?H.map(Be=>Be.item.id===F.id?{...Be,qty:Be.qty+me}:Be):[...H,{item:F,qty:me}])},Ue=(F,me)=>{ae(z.map(H=>H.item.id===F?{...H,qty:Math.max(.001,me)}:H))},P=F=>{ae(z.filter(me=>me.item.id!==F))},$=()=>{if(!n.recipes||!B)return;const F=n.recipes.find(me=>me.id===B);F&&F.ingredients.forEach(me=>{const H=me.name.toLowerCase().trim(),pe=R.find(Be=>Be.model.toLowerCase().trim()===H);pe&&ke(pe,me.quantity*j)})},le=async()=>{if(!n.onCreateSCRequest)return;if(z.length===0){alert("Cart is empty");return}const F=n.employees.find(pe=>pe.email===n.currentUserEmail),H={requesterName:F?`${F.firstName} ${F.lastName}`:n.currentUserEmail||"Chef",requesterEmail:n.currentUserEmail||"",department:"Kitchen",date:new Date().toISOString(),purpose:K||"Kitchen Restock",status:"Pending Account Manager",items:z.map(pe=>({inventoryId:pe.item.id,name:pe.item.model,quantityRequested:pe.qty,unit:pe.item.unit||"units"}))};await n.onCreateSCRequest(H),V(!1),d({type:"success",text:"Requisition submitted to Store Manager."})},_e=L.useMemo(()=>{if(!S)return R;const F=S.toLowerCase();return R.filter(me=>me.model.toLowerCase().includes(F))},[R,S]);return o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"The Chef's Academy"}),o.jsx("div",{className:"flex gap-2",children:n.onCreateSCRequest&&o.jsxs("button",{onClick:()=>ve(),className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 font-medium flex items-center gap-2 shadow-sm",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})}),"New Store Requisition"]})})]}),c&&o.jsx("div",{className:`p-4 rounded-md text-sm ${c.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.text}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Class Recipe Execution"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select Course"}),o.jsx("select",{value:f,onChange:F=>m(F.target.value),className:"w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5",children:Object.keys(El).map(F=>o.jsx("option",{value:F,children:F},F))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select Recipe"}),o.jsx("select",{value:x,onChange:F=>y(F.target.value),className:"w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5",children:El[f].map(F=>o.jsx("option",{value:F.name,children:F.name},F.name))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Students / Servings"}),o.jsx("input",{type:"number",min:"1",value:v,onChange:F=>E(Math.max(1,parseInt(F.target.value)||1)),className:"w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Materials Required:"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:M.needed.map((F,me)=>o.jsxs("div",{className:`p-3 rounded border flex justify-between items-center ${F.sufficient?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:F.name}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Need: ",F.required," ",F.unit]})]}),o.jsxs("div",{className:`text-xs font-bold ${F.sufficient?"text-green-700":"text-red-700"}`,children:[F.sufficient?"Available":"Low Stock",o.jsx("br",{}),o.jsxs("span",{className:"font-normal text-gray-500",children:["Stock: ",F.available]})]})]},me))})]}),o.jsx("div",{className:"mt-6 flex justify-end",children:o.jsx("button",{onClick:ce,disabled:!M.canMake,className:"px-6 py-2.5 bg-blue-900 text-white rounded-lg hover:bg-blue-800 disabled:bg-gray-400 disabled:cursor-not-allowed font-medium shadow-sm transition-colors",children:"Use Materials for Class"})})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Kitchen Inventory"}),o.jsx("button",{onClick:Te,className:"text-sm text-blue-900 hover:underline font-medium",children:"+ Add New Ingredient"})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[o.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3",children:"Ingredient Name"}),o.jsx("th",{className:"px-6 py-3 text-center",children:"Current Stock"}),o.jsx("th",{className:"px-6 py-3 text-center",children:"Unit"}),o.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),o.jsx("tbody",{children:R.map(F=>o.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-purple-50 dark:hover:bg-gray-600 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white",children:F.model}),o.jsx("td",{className:"px-6 py-4 text-center font-semibold",children:F.quantity}),o.jsx("td",{className:"px-6 py-4 text-center",children:F.unit}),o.jsxs("td",{className:"px-6 py-4 text-right space-x-2",children:[o.jsx("button",{onClick:()=>ve(F),className:"font-medium text-blue-900 hover:underline",children:"Request"}),o.jsx("button",{onClick:()=>Pe(F),className:"font-medium text-teal-600 hover:underline",children:"Edit"}),o.jsx("button",{onClick:()=>n.onDeleteAsset(F.id),className:"font-medium text-red-600 hover:underline",children:"Delete"})]})]},F.id))})]})})]}),o.jsx(Dd,{isOpen:e,onClose:()=>t(!1),onSave:W,editingAsset:r,employees:n.employees,initialType:"Kitchen"}),A&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start",onClick:()=>V(!1),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl",onClick:F=>F.stopPropagation(),children:[o.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"New Store Requisition"}),o.jsx("button",{onClick:()=>V(!1),className:"text-slate-400 hover:text-slate-600",children:""})]}),o.jsxs("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex space-x-4 mb-4 border-b",children:[o.jsx("button",{onClick:()=>O("item"),className:`pb-2 text-sm font-medium ${C==="item"?"border-b-2 border-blue-900 text-blue-900":"text-slate-500"}`,children:"Select Items"}),o.jsx("button",{onClick:()=>O("dish"),className:`pb-2 text-sm font-medium ${C==="dish"?"border-b-2 border-blue-900 text-blue-900":"text-slate-500"}`,children:"Select by Dish"})]}),C==="item"?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",placeholder:"Search ingredients...",className:"w-full border rounded px-3 py-2 text-sm mb-2",value:S,onChange:F=>N(F.target.value)}),o.jsx("div",{className:"h-64 overflow-y-auto border rounded",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2",children:"Item"}),o.jsx("th",{className:"px-3 py-2",children:"Stock"}),o.jsx("th",{className:"px-3 py-2"})]})}),o.jsx("tbody",{children:_e.map(F=>o.jsxs("tr",{className:"hover:bg-purple-50 border-b transition-colors",children:[o.jsx("td",{className:"px-3 py-2",children:F.model}),o.jsxs("td",{className:"px-3 py-2",children:[F.quantity," ",F.unit]}),o.jsxs("td",{className:"px-3 py-2 text-right",children:[o.jsx("button",{onClick:()=>ke(F,1),className:"text-xs bg-blue-50 text-blue-900 px-2 py-1 rounded hover:bg-blue-100",children:"Add"}),(F.quantity||0)===0&&o.jsx("span",{className:"block text-[10px] text-red-500",children:"Out of Stock"})]})]},F.id))})]})})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Select Dish"}),o.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:B,onChange:F=>Q(F.target.value),children:[o.jsx("option",{value:"",children:"-- Choose --"}),(Ne=n.recipes)==null?void 0:Ne.map(F=>o.jsx("option",{value:F.id,children:F.name},F.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Portions"}),o.jsx("input",{type:"number",min:"1",value:j,onChange:F=>T(parseInt(F.target.value)),className:"w-full border rounded px-3 py-2 text-sm"})]}),o.jsx("button",{onClick:$,className:"w-full bg-blue-900 text-white py-2 rounded text-sm hover:bg-blue-800",children:"Add Ingredients to Cart"})]})]}),o.jsxs("div",{className:"flex flex-col h-full bg-slate-50 rounded border p-4",children:[o.jsx("h3",{className:"font-bold text-slate-800 mb-2",children:"Request Cart"}),o.jsx("div",{className:"flex-1 overflow-y-auto mb-4 bg-white rounded border p-2",children:z.length===0?o.jsx("p",{className:"text-slate-400 text-center text-sm py-4",children:"Empty"}):o.jsx("ul",{className:"space-y-2",children:z.map((F,me)=>o.jsxs("li",{className:"flex justify-between items-center text-sm border-b pb-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:F.item.model}),o.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["(",F.item.unit,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"number",min:"0.1",step:"0.1",value:F.qty,onChange:H=>Ue(F.item.id,parseFloat(H.target.value)),className:"w-16 border rounded px-1 py-0.5 text-center"}),o.jsx("button",{onClick:()=>P(F.item.id),className:"text-red-500 hover:text-red-700",children:""})]})]},me))})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Purpose / Note"}),o.jsx("textarea",{className:"w-full border rounded px-3 py-2 text-sm",rows:2,placeholder:"e.g. Class preparation",value:K,onChange:F=>ee(F.target.value)}),o.jsx("button",{onClick:le,className:"w-full mt-3 bg-green-600 text-white py-2 rounded font-medium hover:bg-green-700",children:"Submit Request"})]})]})]})]})})]})},VP=({inventory:n,employees:e,onAddNewAsset:t,onUpdateAsset:r,onDeleteAsset:a,onResignEmployee:c})=>{const[d,f]=L.useState(!1),[m,x]=L.useState(null),[y,v]=L.useState("All"),[E,A]=L.useState(""),[V,C]=L.useState(),O=L.useMemo(()=>n.filter(Q=>Q.type!=="Kitchen"),[n]),z=L.useMemo(()=>{const Q=y==="All"?O:O.filter(T=>T.status===y),j=E.trim().toLowerCase();return j?Q.filter(T=>Object.values(T).some(S=>String(S).toLowerCase().includes(j))||Object.values(T.specs||{}).some(S=>String(S).toLowerCase().includes(j))):Q},[y,O,E]),ae=["All","In Use","In Stock","Maintenance"],K=()=>{x(null),C(y==="All"?"In Use":y),f(!0)},ee=Q=>{x(Q),f(!0)},B=(Q,j)=>{j&&Q.length===1?r({...Q[0],id:j}):t(Q),f(!1),x(null)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:"Master Inventory"}),o.jsx("p",{className:"text-sm text-blue-900 dark:text-gray-400",children:"A complete list of all company hardware (IT & General)."})]}),o.jsxs("button",{onClick:K,className:"px-4 py-2 bg-purple-900 text-white rounded-lg hover:bg-purple-800 transition-colors shadow-md text-sm font-medium flex items-center space-x-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),o.jsx("span",{children:"Assign New Asset"})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[o.jsx("div",{className:"flex bg-purple-50 dark:bg-gray-700 rounded-lg",children:ae.map(Q=>o.jsxs("button",{onClick:()=>v(Q),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${y===Q?"bg-purple-900 text-white shadow":"text-blue-900 dark:text-gray-300 hover:bg-purple-200 dark:hover:bg-gray-600"}`,children:[Q," (",Q==="All"?O.length:O.filter(j=>j.status===Q).length,")"]},Q))}),o.jsxs("div",{className:"relative w-full md:w-auto",children:[o.jsx("input",{type:"text",placeholder:"Search anything...",value:E,onChange:Q=>A(Q.target.value),className:"w-full md:w-80 pl-10 pr-4 py-2 border border-slate-200 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-900 placeholder-slate-400 text-blue-900"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-purple-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),o.jsx(Ty,{inventory:z,onEdit:ee,onResign:c,onDelete:a,view:y})]}),o.jsx(Dd,{isOpen:d,onClose:()=>f(!1),onSave:B,editingAsset:m,initialStatus:V,employees:e,isMultiAddMode:!m&&y!=="In Stock"&&y!=="Maintenance"})]})},J1=({assetType:n,inventory:e,employees:t,onAddNewAsset:r,onUpdateAsset:a,onDeleteAsset:c,onResignEmployee:d})=>{const[f,m]=L.useState(!1),[x,y]=L.useState(null),[v,E]=L.useState(""),A=L.useMemo(()=>e.filter(T=>T.type===n),[e,n]),V=L.useMemo(()=>{const T=v.trim().toLowerCase();return T?A.filter(S=>Object.values(S).some(N=>String(N).toLowerCase().includes(T))||Object.values(S.specs||{}).some(N=>String(N).toLowerCase().includes(T))):A},[A,v]),C=L.useMemo(()=>({total:A.length,inUse:A.filter(T=>T.status==="In Use").length,inStock:A.filter(T=>T.status==="In Stock").length,maintenance:A.filter(T=>T.status==="Maintenance").length}),[A]),O=()=>{y(null),m(!0)},z=T=>{y(T),m(!0)},ae=(T,S)=>{const N=T.map(R=>({...R,type:n}));S&&N.length===1?a({...N[0],id:S}):r(N),m(!1),y(null)},K=({title:T,count:S,icon:N,colorClasses:R})=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 flex items-center space-x-4",children:[o.jsx("div",{className:`rounded-full p-3 ${R.bg}`,children:hd.cloneElement(N,{className:`h-6 w-6 ${R.text}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-gray-400",children:T}),o.jsx("p",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:S})]})]}),ee=T=>o.jsx("svg",{...T,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),B=T=>o.jsx("svg",{...T,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Q=T=>o.jsx("svg",{...T,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),j=T=>o.jsxs("svg",{...T,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:[n," Inventory"]}),o.jsx("button",{onClick:O,className:"px-4 py-2 bg-purple-900 text-white rounded-lg hover:bg-purple-800 text-sm font-medium flex items-center space-x-2",children:o.jsxs("span",{children:["Add New ",n]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[o.jsx(K,{title:`Total ${n}s`,count:C.total,icon:o.jsx(ee,{}),colorClasses:{bg:"bg-purple-50 dark:bg-gray-700",text:"text-purple-800 dark:text-gray-300"}}),o.jsx(K,{title:"In Use",count:C.inUse,icon:o.jsx(B,{}),colorClasses:{bg:"bg-green-100 dark:bg-green-900",text:"text-green-600 dark:text-green-300"}}),o.jsx(K,{title:"In Stock",count:C.inStock,icon:o.jsx(Q,{}),colorClasses:{bg:"bg-purple-100 dark:bg-purple-900",text:"text-purple-900 dark:text-blue-300"}}),o.jsx(K,{title:"Maintenance",count:C.maintenance,icon:o.jsx(j,{}),colorClasses:{bg:"bg-yellow-100 dark:bg-yellow-900",text:"text-yellow-600 dark:text-yellow-300"}})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"relative w-full md:w-auto",children:[o.jsx("input",{type:"text",placeholder:`Search ${n}s... (e.g., model, serial, user)`,value:v,onChange:T=>E(T.target.value),className:"w-full md:w-96 pl-10 pr-4 py-2 border border-slate-200 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-900 placeholder-slate-400 text-blue-900"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-purple-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),o.jsx(Ty,{inventory:V,onEdit:z,onResign:d,onDelete:c,view:"All"}),o.jsx(Dd,{isOpen:f,onClose:()=>m(!1),onSave:ae,editingAsset:x,employees:t,initialType:n})]})},LP=n=>{const[e,t]=L.useState("overview"),r=n.currentUserEmail==="admin",a=L.useMemo(()=>({master:n.inventory.filter(d=>d.type!=="Kitchen").length,laptops:n.inventory.filter(d=>d.type==="Laptop").length,desktops:n.inventory.filter(d=>d.type==="Desktop").length,printers:n.inventory.filter(d=>d.type==="Printer").length,labs:n.labs.length,kitchen:n.inventory.filter(d=>d.type==="Kitchen").length}),[n.inventory,n.labs]),c=()=>{switch(e){case"master":return o.jsx(VP,{inventory:n.inventory,employees:n.employees,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onResignEmployee:n.onResignEmployee});case"laptops":return o.jsx(J1,{assetType:"Laptop",inventory:n.inventory,employees:n.employees,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onResignEmployee:n.onResignEmployee});case"desktops":return o.jsx(J1,{assetType:"Desktop",inventory:n.inventory,employees:n.employees,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onResignEmployee:n.onResignEmployee});case"printers":return o.jsx(DP,{printers:n.inventory.filter(m=>m.type==="Printer"),toners:n.toners,employees:n.employees,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onResignEmployee:n.onResignEmployee,onSaveTonerModel:n.onSaveTonerModel,onDeleteTonerModel:n.onDeleteTonerModel,onMarkTonerEmpty:n.onMarkTonerEmpty,onMarkTonerFilled:n.onMarkTonerFilled});case"labs":return o.jsx(PP,{labs:n.labs,onAddSystem:n.onAddSystem,onUpdateSystem:n.onUpdateSystem,onDeleteSystem:n.onDeleteSystem});case"kitchen":return o.jsx(OP,{inventory:n.inventory,employees:n.employees,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onUpdateKitchenStock:n.onUpdateKitchenStock,recipes:n.recipes,onCreateSCRequest:n.onCreateSCRequest,currentUserEmail:n.currentUserEmail});case"overview":default:const d=[{id:"master",title:"Master Inventory",count:a.master,icon:o.jsx(ld,{}),onClick:()=>t("master"),color:"bg-purple-900"},{id:"laptops",title:"Laptops",count:a.laptops,icon:o.jsx(cd,{}),onClick:()=>t("laptops"),color:"bg-purple-800"},{id:"desktops",title:"Desktops",count:a.desktops,icon:o.jsx(cd,{}),onClick:()=>t("desktops"),color:"bg-purple-700"},{id:"printers",title:"Printers & Toners",count:a.printers,icon:o.jsx(XE,{}),onClick:()=>t("printers"),color:"bg-purple-900"},{id:"labs",title:"Computer Labs",count:a.labs,icon:o.jsx(WE,{}),onClick:()=>t("labs"),color:"bg-purple-800"},{id:"kitchen",title:"The Chef's Academy",count:a.kitchen,icon:o.jsx(wy,{}),onClick:()=>t("kitchen"),color:"bg-purple-900"}],f=r?d:d.filter(m=>{var x,y;return(y=(x=n.permissions)==null?void 0:x[m.id])==null?void 0:y.view});return o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white mb-6",children:"Inventory Overview"}),f.length>0?o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(m=>o.jsx(IP,{...m},m.id))}):o.jsxs("div",{className:"text-center py-10 px-6 bg-white dark:bg-gray-800 rounded-lg shadow",children:[o.jsx("h3",{className:"text-lg font-medium text-blue-900 dark:text-white",children:"No Inventory Access"}),o.jsx("p",{className:"mt-1 text-sm text-blue-900 dark:text-gray-400",children:"You do not have permission to view any inventory categories."})]})]})}};return o.jsxs("div",{className:"p-6",children:[e!=="overview"&&o.jsxs("button",{onClick:()=>t("overview"),className:"mb-6 flex items-center text-sm font-medium text-purple-800 dark:text-blue-400 hover:underline",children:[o.jsx(Wf,{className:"h-4 w-4 mr-1"}),"Back to Inventory Overview"]}),c()]})},UP=({users:n,onResignEmployee:e})=>{const[t,r]=L.useState(null),a=c=>{r(t===c?null:c)};return o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white mb-6",children:"Employees & Assigned Assets"}),o.jsx("div",{className:"space-y-4",children:n.map(c=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow transition-shadow duration-200",children:[o.jsxs("div",{className:"w-full flex justify-between items-center p-4 text-left",children:[o.jsxs("div",{onClick:()=>a(c.id),className:"cursor-pointer flex-grow",children:[o.jsx("p",{className:"font-semibold text-blue-900 dark:text-white",children:c.name}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:c.email})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("span",{className:"text-sm px-2 py-1 bg-purple-100 text-purple-900 dark:bg-gray-700 rounded-full",children:[c.assets.length," Assets"]}),c.assets.length>0&&o.jsx("button",{onClick:()=>e(c.name),className:"font-medium text-yellow-600 dark:text-yellow-500 hover:underline text-sm px-2 py-1 rounded-md hover:bg-yellow-100 dark:hover:bg-gray-700","aria-label":`Resign all assets from ${c.name}`,children:"Resign"}),o.jsx("button",{onClick:()=>a(c.id),"aria-label":"Toggle asset details",className:"p-1",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-blue-600 dark:text-gray-400 transition-transform ${t===c.id?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),t===c.id&&o.jsx("div",{className:"border-t border-slate-200 dark:border-gray-700 p-4",children:c.assets.length>0?o.jsx("ul",{className:"space-y-2",children:c.assets.map(d=>o.jsxs("li",{className:"flex justify-between items-center text-sm",children:[o.jsxs("div",{children:[o.jsxs("span",{className:"font-medium text-blue-900 dark:text-gray-200",children:[d.type,":"]}),o.jsx("span",{className:"text-blue-600 dark:text-gray-400 ml-2",children:d.model})]}),o.jsx("span",{className:"text-xs font-mono bg-purple-50 text-purple-900 dark:bg-gray-700 px-2 py-1 rounded",children:d.id})]},d.id))}):o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400 text-center",children:"No assets assigned to this user."})})]},c.id))})]})},Z1={mrfNumber:"",demandNumber:"",description:""},FP=({isOpen:n,onClose:e,onSave:t,editingMRF:r})=>{const[a,c]=L.useState(Z1);L.useEffect(()=>{n&&c(r?{mrfNumber:r.mrfNumber,demandNumber:r.demandNumber,description:r.description}:Z1)},[r,n]);const d=y=>{const{name:v,value:E}=y.target;c(A=>({...A,[v]:E}))},f=y=>{y.preventDefault(),t(a,r==null?void 0:r.id)};if(!n)return null;const m=r?"Edit MRF":"Generate New MRF",x=r?"Update the details for this MRF.":"Enter the details for the new Material Requisition Form.";return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-y-auto flex justify-center items-start","aria-modal":"true",role:"dialog",onClick:e,children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg",onClick:y=>y.stopPropagation(),children:[o.jsxs("form",{onSubmit:f,children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:m}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:x})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"mrfNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"MRF Number"}),o.jsx("input",{type:"text",id:"mrfNumber",name:"mrfNumber",value:a.mrfNumber,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"demandNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Demand Number"}),o.jsx("input",{type:"text",id:"demandNumber",name:"demandNumber",value:a.demandNumber,onChange:d,required:!0,className:"mt-1 block w-full input-style"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),o.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:d,required:!0,rows:4,className:"mt-1 block w-full input-style"})]})]}),o.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3 flex-shrink-0",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 btn-secondary",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 btn-primary",children:"Save MRF"})]})]}),o.jsx("style",{children:`
                    .input-style { background-color: #F9FAFB; border: 1px solid #D1D5DB; border-radius: 0.5rem; padding: 0.75rem 1rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); transition: all 0.2s ease-in-out; width: 100%; }
                    .dark .input-style { background-color: #374151; border-color: #4B5563; color: #F9FAFB; }
                    .input-style:focus { outline: none; --tw-ring-color: #3B82F6; box-shadow: 0 0 0 2px var(--tw-ring-color); }
                    .btn-primary { padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 500; color: white; background-color: #2563EB; border: 1px solid transparent; border-radius: 0.5rem; }
                    .btn-primary:hover { background-color: #1D4ED8; }
                    .btn-secondary { padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 500; color: #374151; background-color: white; border: 1px solid #D1D5DB; border-radius: 0.5rem; }
                    .dark .btn-secondary { color: #D1D5DB; background-color: #374151; border-color: #4B5563; }
                    .btn-secondary:hover { background-color: #F9FAFB; }
                    .dark .btn-secondary:hover { background-color: #4B5563; }
                `})]})})},qP=({mrfs:n,onAddNewMRF:e,onUpdateMRF:t,onDeleteMRF:r})=>{const[a,c]=L.useState(!1),[d,f]=L.useState(null),m=()=>{f(null),c(!0)},x=C=>{f(C),c(!0)},y=()=>{c(!1),f(null)},v=(C,O)=>{if(O){const z=n.find(K=>K.id===O);if(!z)return;const ae={...z,...C};t(ae)}else{const z={mrfNumber:C.mrfNumber,demandNumber:C.demandNumber,description:C.description,date:new Date().toISOString(),status:"Pending"};e(z)}y()},E=(C,O)=>{t({...C,status:O})},A=C=>{window.confirm("Are you sure you want to delete this MRF? This action cannot be undone.")&&r(C)},V=C=>{switch(C){case"Pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"Proceed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:"MRF Management"}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:"Track and manage all Material Requisition Forms."})]}),o.jsxs("button",{onClick:m,className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium flex items-center space-x-2","aria-label":"Generate New MRF",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),o.jsx("span",{children:"Generate MRF"})]})]}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-blue-600 dark:text-gray-400",children:[o.jsx("thead",{className:"text-xs text-blue-900 uppercase bg-purple-50 dark:bg-gray-700 dark:text-gray-400",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3",children:"MRF No."}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Demand No."}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Description"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:o.jsx("span",{className:"sr-only",children:"Actions"})})]})}),o.jsx("tbody",{children:n.length>0?n.map(C=>o.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-purple-50 dark:hover:bg-gray-600",children:[o.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-blue-900 dark:text-white whitespace-nowrap",children:C.mrfNumber}),o.jsx("td",{className:"px-6 py-4 text-blue-800",children:C.demandNumber}),o.jsx("td",{className:"px-6 py-4 text-blue-800",children:new Date(C.date).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 text-blue-800",children:o.jsx("div",{className:"max-w-xs overflow-hidden whitespace-nowrap text-ellipsis",title:C.description,children:C.description||"-"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("select",{value:C.status,onChange:O=>E(C,O.target.value),className:`border-none rounded-md text-xs font-semibold p-1 ${V(C.status)} focus:ring-2 focus:ring-blue-900`,"aria-label":`Status for MRF ${C.mrfNumber}`,children:[o.jsx("option",{value:"Pending",children:"Pending"}),o.jsx("option",{value:"Proceed",children:"Proceed"})]})}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[o.jsx("button",{onClick:()=>x(C),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Edit"}),o.jsx("button",{onClick:()=>A(C.id),className:"font-medium text-red-600 dark:text-red-500 hover:underline",children:"Delete"})]})})]},C.id)):o.jsx("tr",{children:o.jsxs("td",{colSpan:6,className:"text-center py-10 px-6",children:[o.jsx("h3",{className:"text-lg font-medium text-blue-900 dark:text-white",children:"No MRFs Found"}),o.jsx("p",{className:"mt-1 text-sm text-blue-600 dark:text-gray-400",children:"There are no Material Requisition Forms yet."}),o.jsx("button",{onClick:m,className:"mt-4 px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors shadow-md text-sm font-medium",children:"Generate the First MRF"})]})})})]})})]}),o.jsx(FP,{isOpen:a,onClose:y,onSave:v,editingMRF:d})]})},BP=({inventory:n,employees:e})=>{const[t,r]=L.useState("user"),a=()=>{let x=[];const y=new Date().toISOString().slice(0,10);t==="user"?x=n.filter(A=>A.assignedTo).map(A=>{const V=e.find(C=>`${C.firstName} ${C.lastName}`===A.assignedTo);return{"Employee Name":A.assignedTo,Department:(V==null?void 0:V.department)||A.department||"-",Designation:(V==null?void 0:V.designation)||A.designation||"-","Asset Type":A.type,Brand:A.brand||"-",Model:A.model,"Serial Number":A.serialNumber||"-","Issue Date":A.issueDate||"-",Status:A.status}}).sort((A,V)=>A["Employee Name"].localeCompare(V["Employee Name"])):t==="equipment"?x=n.map(A=>({Type:A.type,Brand:A.brand||"-",Model:A.model,"Serial Number":A.serialNumber||"-",Status:A.status,"Assigned To":A.assignedTo||"Unassigned",Department:A.department||"-"})).sort((A,V)=>A.Type.localeCompare(V.Type)):t==="department"&&(x=n.filter(A=>A.department).map(A=>({Department:A.department,"Assigned Employee":A.assignedTo||"Unassigned","Asset Type":A.type,Model:A.model,"Serial Number":A.serialNumber||"-",Status:A.status})).sort((A,V)=>(A.Department||"").localeCompare(V.Department||"")));const v=XLSX.utils.json_to_sheet(x),E=XLSX.utils.book_new();XLSX.utils.book_append_sheet(E,v,"Report"),XLSX.writeFile(E,`Inventory_${t}_report_${y}.xlsx`)},c=()=>{window.print()},d=()=>{const x=new Map;n.filter(v=>v.assignedTo).forEach(v=>{if(!x.has(v.assignedTo)){const E=e.find(A=>`${A.firstName} ${A.lastName}`===v.assignedTo);x.set(v.assignedTo,{emp:E,assets:[]})}x.get(v.assignedTo).assets.push(v)});const y=Array.from(x.entries()).sort((v,E)=>v[0].localeCompare(E[0]));return o.jsxs("div",{className:"space-y-8",children:[y.map(([v,{emp:E,assets:A}])=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-slate-200 dark:border-gray-700 overflow-hidden break-inside-avoid",children:[o.jsxs("div",{className:"bg-slate-50 dark:bg-gray-700 px-6 py-4 border-b border-slate-200 dark:border-gray-600 flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-white",children:v}),o.jsxs("p",{className:"text-sm text-blue-600 dark:text-gray-300",children:[(E==null?void 0:E.designation)||A[0].designation||"N/A"," - ",o.jsx("span",{className:"font-medium text-teal-600 dark:text-teal-400",children:(E==null?void 0:E.department)||A[0].department||"N/A"})]})]}),o.jsxs("div",{className:"text-sm font-medium bg-purple-100 text-purple-900 px-3 py-1 rounded-full",children:[A.length," Assets"]})]}),o.jsxs("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-gray-700",children:[o.jsx("thead",{className:"bg-white dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Model"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Serial"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Issue Date"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-gray-700",children:A.map(V=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-3 text-sm text-blue-900 dark:text-white font-medium",children:V.type}),o.jsxs("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300",children:[V.brand," ",V.model]}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300 font-mono",children:V.serialNumber||"-"}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300",children:V.issueDate||"-"})]},V.id))})]})]},v)),y.length===0&&o.jsx("p",{className:"text-center text-blue-600",children:"No assigned assets found."})]})},f=()=>{const x=new Map;n.forEach(v=>{x.has(v.type)||x.set(v.type,[]),x.get(v.type).push(v)});const y=Array.from(x.entries()).sort((v,E)=>v[0].localeCompare(E[0]));return o.jsx("div",{className:"space-y-8",children:y.map(([v,E])=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-slate-200 dark:border-gray-700 overflow-hidden break-inside-avoid",children:[o.jsxs("div",{className:"bg-slate-50 dark:bg-gray-700 px-6 py-4 border-b border-slate-200 dark:border-gray-600 flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-white",children:v}),o.jsxs("div",{className:"text-sm font-medium bg-purple-100 text-purple-900 px-3 py-1 rounded-full",children:[E.length," Total"]})]}),o.jsxs("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-gray-700",children:[o.jsx("thead",{className:"bg-white dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Model"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Serial"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Assigned To"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-gray-700",children:E.map(A=>o.jsxs("tr",{children:[o.jsxs("td",{className:"px-6 py-3 text-sm text-blue-900 dark:text-white",children:[A.brand," ",A.model]}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300 font-mono",children:A.serialNumber||"-"}),o.jsx("td",{className:"px-6 py-3 text-sm",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${A.status==="In Use"?"bg-green-100 text-green-800":A.status==="In Stock"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:A.status})}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300",children:A.assignedTo||"-"})]},A.id))})]})]},v))})},m=()=>{const x=new Map;n.forEach(v=>{const E=v.department||"Unassigned";x.has(E)||x.set(E,[]),x.get(E).push(v)});const y=Array.from(x.entries()).sort((v,E)=>v[0]==="Unassigned"?1:E[0]==="Unassigned"?-1:v[0].localeCompare(E[0]));return o.jsx("div",{className:"space-y-8",children:y.map(([v,E])=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-slate-200 dark:border-gray-700 overflow-hidden break-inside-avoid",children:[o.jsxs("div",{className:"bg-slate-50 dark:bg-gray-700 px-6 py-4 border-b border-slate-200 dark:border-gray-600 flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-white",children:v}),o.jsxs("div",{className:"text-sm font-medium bg-orange-100 text-orange-800 px-3 py-1 rounded-full",children:[E.length," Assets"]})]}),o.jsxs("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-gray-700",children:[o.jsx("thead",{className:"bg-white dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Assigned To"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Model"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-900 dark:text-gray-400 uppercase",children:"Serial"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-gray-700",children:E.map(A=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-3 text-sm text-blue-900 dark:text-white font-medium",children:A.assignedTo||"-"}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300",children:A.type}),o.jsxs("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300",children:[A.brand," ",A.model]}),o.jsx("td",{className:"px-6 py-3 text-sm text-blue-600 dark:text-gray-300 font-mono",children:A.serialNumber||"-"})]},A.id))})]})]},v))})};return o.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 no-print",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-white",children:"Inventory Reports"}),o.jsx("p",{className:"text-sm text-blue-600 dark:text-gray-400",children:"Generate and export detailed inventory reports."})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsx("div",{className:"relative",children:o.jsxs("select",{value:t,onChange:x=>r(x.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md shadow-sm bg-white dark:bg-gray-700 dark:border-gray-600 text-blue-900 dark:text-white",children:[o.jsx("option",{value:"user",children:"User-wise Report"}),o.jsx("option",{value:"equipment",children:"Equipment-wise Report"}),o.jsx("option",{value:"department",children:"Department-wise Report"})]})}),o.jsx("button",{onClick:c,className:"px-4 py-2 bg-white dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-200 hover:bg-slate-50 dark:hover:bg-gray-600 text-sm font-medium transition-colors shadow-sm",children:"Print"}),o.jsxs("button",{onClick:a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium transition-colors shadow-md flex items-center gap-2",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Excel"]})]})]}),o.jsxs("div",{className:"report-content",children:[o.jsxs("div",{className:"hidden print-block mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold text-center text-blue-900",children:"MASBOT ERP Inventory Report"}),o.jsxs("p",{className:"text-center text-lg mt-2 capitalize text-blue-800",children:[t,"-wise Breakdown"]}),o.jsx("p",{className:"text-center text-sm text-blue-600",children:new Date().toLocaleDateString()})]}),t==="user"&&d(),t==="equipment"&&f(),t==="department"&&m()]}),o.jsx("style",{children:`
                @media print {
                    .no-print { display: none !important; }
                    .print-block { display: block !important; }
                    body { background-color: white; }
                    .report-content { width: 100%; }
                    /* Ensure colors print */
                    * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                }
                .print-block { display: none; }
            `})]})},zP=n=>{const e=n.currentUserEmail==="admin",t=L.useMemo(()=>{if(e)return"assets";if(!n.permissions)return null;if(Ny.some(y=>{var v,E;return(E=(v=n.permissions)==null?void 0:v[y.id])==null?void 0:E.view}))return"assets";const x=Yf.find(y=>{var v,E;return y.id!=="assets"&&((E=(v=n.permissions)==null?void 0:v[y.id])==null?void 0:E.view)});return(x==null?void 0:x.id)||null},[e,n.permissions]),[r,a]=L.useState(t);L.useEffect(()=>{!r&&t&&a(t)},[t,r]);const c=L.useMemo(()=>{const m=new Map;return n.employees.forEach(x=>{m.set(x.email,{id:x.id,name:`${x.firstName} ${x.lastName}`,email:x.email,assets:[]})}),n.inventory.forEach(x=>{if(x.assignedTo){const y=Array.from(m.values()).find(v=>v.name===x.assignedTo);y&&y.assets.push({id:x.id,type:x.type,model:x.model})}}),Array.from(m.values())},[n.employees,n.inventory]);L.useMemo(()=>n.inventory.filter(m=>m.type==="Printer"),[n.inventory]);const d=()=>{if(!r)return o.jsxs("div",{className:"p-6 text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Access Denied"}),o.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"You do not have permission to view any pages in this module. Please contact an administrator."})]});switch(r){case"assets":return o.jsx(LP,{inventory:n.inventory,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onResignEmployee:n.onResignEmployee,employees:n.employees,labs:n.labs,toners:n.toners,onAddSystem:n.onAddSystem,onUpdateSystem:n.onUpdateSystem,onDeleteSystem:n.onDeleteSystem,onSaveTonerModel:n.onSaveTonerModel,onDeleteTonerModel:n.onDeleteTonerModel,onMarkTonerEmpty:n.onMarkTonerEmpty,onMarkTonerFilled:n.onMarkTonerFilled,onUpdateKitchenStock:n.onUpdateKitchenStock,currentUserEmail:n.currentUserEmail,permissions:n.permissions,recipes:n.recipes,onCreateSCRequest:n.onCreateSCRequest});case"users":return o.jsx(UP,{users:c,onResignEmployee:n.onResignEmployee});case"mrf":return o.jsx(qP,{mrfs:n.mrfs,onAddNewMRF:n.onAddNewMRF,onUpdateMRF:n.onUpdateMRF,onDeleteMRF:n.onDeleteMRF});case"reports":return o.jsx(BP,{inventory:n.inventory,employees:n.employees});case"settings":return o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Settings"}),o.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Settings page is under construction."})]});default:return null}},f={assets:"Inventory",users:"Employees & Assigned Assets",labs:"Computer Labs",printers:"Printers & Toners",mrf:"MRF Management",reports:"Inventory Reports",settings:"Settings"};return o.jsxs("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900",children:[o.jsx(SP,{currentPage:r,onNavigate:a,permissions:n.permissions,currentUserEmail:n.currentUserEmail,employees:n.employees}),o.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsxs("header",{className:"bg-purple-900 dark:bg-purple-950 border-b border-purple-800 dark:border-purple-900 h-16 flex-shrink-0 flex items-center justify-between px-6",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("button",{onClick:n.onBack,className:"flex items-center gap-2 text-sm font-medium text-purple-200 hover:text-white",children:[o.jsx(Mm,{className:"w-5 h-5"}),o.jsx("span",{children:"Home"})]})}),o.jsx("h1",{className:"text-lg font-bold text-white",children:r?f[r]:"Inventory Management"}),o.jsxs("button",{onClick:n.onLogout,className:"flex items-center gap-2 bg-purple-800 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-purple-700 transition-colors","aria-label":"Logout",children:[o.jsx(jo,{className:"w-5 h-5"}),o.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]}),o.jsx("div",{className:"flex-1 overflow-x-hidden overflow-y-auto",children:d()})]})]})},HP=({activePage:n,setActivePage:e,currentUserEmail:t})=>{const r=t==="admin";return o.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0",children:[o.jsx("div",{className:"h-16 flex items-center justify-center border-b border-slate-200 px-4",children:o.jsx(_o,{className:"h-8 w-auto"})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[o.jsx("div",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wider mb-4 px-2",children:"Supply Chain"}),JE.map(a=>{if(a.id==="sc_approvals"&&!r)return null;const c=a.icon,d=n===a.id;return o.jsxs("button",{onClick:()=>e(a.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors text-sm font-medium ${d?"bg-purple-50 text-purple-900":"text-blue-900 hover:bg-purple-50"}`,children:[o.jsx(c,{className:`w-5 h-5 ${d?"text-purple-900":"text-purple-400"}`}),o.jsx("span",{children:a.label})]},a.id)})]}),o.jsx("div",{className:"p-4 border-t border-slate-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-900 font-bold text-xs",children:t.charAt(0).toUpperCase()}),o.jsxs("div",{className:"overflow-hidden",children:[o.jsx("p",{className:"text-sm font-medium text-blue-900 truncate",children:t}),o.jsx("p",{className:"text-xs text-blue-800 truncate",children:r?"CEO / Admin":"User"})]})]})})]})},GP=({inventory:n,currentUserEmail:e,employees:t,onCreateRequest:r,recipes:a=[]})=>{var S;const[c,d]=L.useState("item"),[f,m]=L.useState([]),[x,y]=L.useState(""),[v,E]=L.useState(""),[A,V]=L.useState(null),[C,O]=L.useState(""),[z,ae]=L.useState(1),K=L.useMemo(()=>n.filter(N=>N.type==="Kitchen"&&N.model.toLowerCase().includes(v.toLowerCase())),[n,v]),ee=(N,R=1)=>{m(D=>D.find(Te=>Te.item.id===N.id)?D.map(Te=>Te.item.id===N.id?{...Te,qty:Te.qty+R}:Te):[...D,{item:N,qty:R}])},B=(N,R)=>{m(f.map(D=>D.item.id===N?{...D,qty:Math.max(.001,R)}:D))},Q=N=>{m(f.filter(R=>R.item.id!==N))},j=()=>{if(!C)return;const N=a.find(M=>M.id===C);if(!N)return;let R=0,D=[];N.ingredients.forEach(M=>{const Te=n.find(Pe=>Pe.model.toLowerCase()===M.name.toLowerCase()&&Pe.type==="Kitchen");if(Te){const Pe=M.quantity*z;ee(Te,Pe),R++}else D.push(M.name)}),D.length>0?V({type:"error",text:`Added available ingredients, but could not find: ${D.join(", ")}`}):R>0&&V({type:"success",text:`Ingredients for ${z} portions of ${N.name} added to cart.`})},T=async()=>{if(f.length===0){V({type:"error",text:"Please add items to your request."});return}if(!x.trim()){V({type:"error",text:"Please specify a purpose or recipe for this request."});return}const N=t.find(D=>D.email===e),R={requesterName:N?`${N.firstName} ${N.lastName}`:e,requesterEmail:e,department:(N==null?void 0:N.department)||"Kitchen",date:new Date().toISOString(),purpose:x,status:"Pending Account Manager",items:f.map(D=>({inventoryId:D.item.id,name:D.item.model,quantityRequested:D.qty,unit:D.item.unit||"units"}))};await r(R),V({type:"success",text:"Request submitted successfully to Account Manager for approval."}),m([]),y("")};return o.jsx("div",{className:"max-w-6xl mx-auto space-y-6",children:o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[o.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"New Stock Requisition"}),o.jsxs("div",{className:"flex space-x-4 mb-6 border-b border-slate-200",children:[o.jsx("button",{onClick:()=>d("item"),className:`pb-2 px-4 text-sm font-medium border-b-2 transition-colors ${c==="item"?"border-blue-900 text-blue-900":"border-transparent text-blue-800 hover:text-blue-900"}`,children:"Item Selection"}),o.jsx("button",{onClick:()=>d("dish"),className:`pb-2 px-4 text-sm font-medium border-b-2 transition-colors ${c==="dish"?"border-blue-900 text-blue-900":"border-transparent text-blue-800 hover:text-blue-900"}`,children:"Dish Selection"})]}),A&&o.jsx("div",{className:`p-4 mb-4 rounded-md text-sm ${A.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.text}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsx("div",{children:c==="item"?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",placeholder:"Search ingredients...",className:"w-full px-4 py-2 border rounded-lg mb-4 focus:ring-2 focus:ring-blue-900 focus:outline-none placeholder-blue-300 text-blue-900",value:v,onChange:N=>E(N.target.value)}),o.jsx("div",{className:"h-96 overflow-y-auto border rounded-lg",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-purple-50 text-blue-900 font-medium sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Item"}),o.jsx("th",{className:"px-4 py-2",children:"Available"}),o.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),o.jsx("tbody",{className:"divide-y",children:K.map(N=>(f.some(R=>R.item.id===N.id),o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-2 font-medium text-blue-900",children:N.model}),o.jsxs("td",{className:"px-4 py-2 text-blue-900",children:[N.quantity," ",N.unit]}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("button",{onClick:()=>ee(N),disabled:N.quantity===0,className:"text-xs bg-purple-900 text-white px-2 py-1 rounded hover:bg-purple-800 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add"})})]},N.id)))})]})})]}):o.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-100 h-full",children:[o.jsx("h3",{className:"font-bold text-blue-900 mb-4",children:"Select a Dish"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Recipe / Dish"}),o.jsxs("select",{value:C,onChange:N=>O(N.target.value),className:"w-full border-blue-200 rounded-md focus:ring-blue-900 text-blue-900",children:[o.jsx("option",{value:"",children:"-- Select Dish --"}),a.map(N=>o.jsx("option",{value:N.id,children:N.name},N.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Number of Portions"}),o.jsx("input",{type:"number",min:"1",value:z,onChange:N=>ae(Math.max(1,parseInt(N.target.value)||1)),className:"w-full border-blue-200 rounded-md focus:ring-blue-900 text-blue-900"})]}),o.jsx("button",{onClick:j,disabled:!C,className:"w-full bg-blue-900 text-white py-2 rounded-md hover:bg-blue-800 disabled:bg-blue-300 transition-colors",children:"Add Ingredients to Cart"}),C&&o.jsxs("div",{className:"mt-4 p-4 bg-white rounded border border-blue-100",children:[o.jsx("h4",{className:"text-xs font-bold text-blue-900 uppercase mb-2",children:"Ingredients per portion:"}),o.jsx("ul",{className:"text-xs text-blue-900 space-y-1",children:(S=a.find(N=>N.id===C))==null?void 0:S.ingredients.map((N,R)=>o.jsxs("li",{className:"flex justify-between",children:[o.jsx("span",{children:N.name}),o.jsxs("span",{children:[N.quantity," ",N.unit]})]},R))})]})]})]})}),o.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200 flex flex-col",children:[o.jsx("h3",{className:"font-bold text-blue-900 mb-4",children:"Request Cart"}),o.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:f.length===0?o.jsx("p",{className:"text-blue-900 text-center py-10 italic",children:"No items selected."}):o.jsx("ul",{className:"space-y-2",children:f.map((N,R)=>o.jsxs("li",{className:"bg-white p-3 rounded shadow-sm flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-blue-900",children:N.item.model}),o.jsxs("p",{className:"text-xs text-blue-900",children:["Unit: ",N.item.unit]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"number",min:"0.001",step:"0.001",value:N.qty,onChange:D=>B(N.item.id,parseFloat(D.target.value)),className:"w-20 px-2 py-1 border rounded text-sm text-center text-blue-900"}),o.jsx("button",{onClick:()=>Q(N.item.id),className:"text-red-500 hover:text-red-700",children:""})]})]},R))})}),o.jsxs("div",{className:"mt-auto",children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Purpose / Note"}),o.jsx("textarea",{value:x,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-900 focus:outline-none mb-4 text-blue-900 placeholder-blue-300",rows:2,placeholder:"e.g. For Advanced Baking Class - Croissants"}),o.jsx("button",{onClick:T,className:"w-full bg-blue-900 text-white py-2 rounded-lg font-medium hover:bg-blue-800 transition-colors shadow-sm",children:"Submit Request"})]})]})]})]})})},KP=({requests:n,purchaseOrders:e,onAction:t,onPOAction:r})=>{const[a,c]=L.useState("requisitions"),d=n.filter(m=>m.status==="Pending Account Manager"),f=e.filter(m=>m.status==="Pending Account Manager");return o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Account Manager Approvals"})}),o.jsx("div",{className:"border-b border-slate-200 mb-6",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>c("requisitions"),className:`whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm ${a==="requisitions"?"border-purple-900 text-purple-900":"border-transparent text-blue-900 hover:text-blue-800 hover:border-slate-300"}`,children:["Requisitions (",d.length,")"]}),o.jsxs("button",{onClick:()=>c("pos"),className:`whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm ${a==="pos"?"border-purple-900 text-purple-900":"border-transparent text-blue-900 hover:text-blue-800 hover:border-slate-300"}`,children:["Purchase Orders (",f.length,")"]})]})}),a==="requisitions"&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"bg-white p-12 rounded-lg shadow-sm text-center",children:o.jsx("p",{className:"text-blue-900 text-lg",children:"No pending requisitions awaiting approval."})}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(m=>o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-l-4 border-l-orange-400",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-lg text-blue-900",children:m.requesterName}),o.jsxs("p",{className:"text-sm text-blue-900",children:[m.department,"  ",new Date(m.date).toLocaleDateString()]})]}),o.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs font-bold px-2 py-1 rounded uppercase tracking-wide",children:m.status})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Purpose:"}),o.jsxs("p",{className:"text-sm text-blue-900 bg-purple-50 p-2 rounded italic",children:['"',m.purpose,'"']})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Items Requested:"}),o.jsx("ul",{className:"text-sm space-y-1",children:m.items.map((x,y)=>o.jsxs("li",{className:"flex justify-between border-b border-slate-100 pb-1 last:border-0 hover:bg-purple-50 transition-colors text-blue-900",children:[o.jsx("span",{children:x.name}),o.jsxs("span",{className:"font-mono text-blue-900",children:[x.quantityRequested," ",x.unit]})]},y))})]}),o.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-100",children:[o.jsx("button",{onClick:()=>t(m.id,"Approve"),className:"flex-1 bg-green-600 text-white py-2 rounded font-medium hover:bg-green-700 transition-colors",children:"Approve"}),o.jsx("button",{onClick:()=>{const x=prompt("Enter rejection reason:");x&&t(m.id,"Reject",x)},className:"flex-1 bg-red-50 text-red-600 border border-red-200 py-2 rounded font-medium hover:bg-red-100 transition-colors",children:"Reject"})]})]},m.id))})}),a==="pos"&&o.jsx(o.Fragment,{children:f.length===0?o.jsx("div",{className:"bg-white p-12 rounded-lg shadow-sm text-center",children:o.jsx("p",{className:"text-blue-900 text-lg",children:"No pending Purchase Orders awaiting approval."})}):o.jsx("div",{className:"grid grid-cols-1 gap-6",children:f.map(m=>o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-l-4 border-l-purple-500",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg text-blue-900",children:["PO #",m.poNumber]}),o.jsxs("p",{className:"text-sm text-blue-900",children:["Vendor: ",m.vendorName,"  ",new Date(m.date).toLocaleDateString()]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["PKR ",m.totalAmount.toLocaleString()]}),o.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded uppercase tracking-wide",children:m.status})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-purple-50 text-blue-900",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Item"}),o.jsx("th",{className:"px-4 py-2 text-center",children:"Qty"}),o.jsx("th",{className:"px-4 py-2 text-right",children:"Unit Price"}),o.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),o.jsx("tbody",{className:"divide-y border-t border-b",children:m.items.map((x,y)=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-2 text-blue-900",children:x.itemName}),o.jsxs("td",{className:"px-4 py-2 text-center text-blue-900",children:[x.quantity," ",x.unit]}),o.jsx("td",{className:"px-4 py-2 text-right text-blue-900",children:x.unitPrice}),o.jsx("td",{className:"px-4 py-2 text-right text-blue-900",children:x.totalPrice})]},y))})]})}),o.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-100 justify-end",children:[o.jsx("button",{onClick:()=>r(m.id,"Reject"),className:"px-6 py-2 bg-red-50 text-red-600 border border-red-200 rounded font-medium hover:bg-red-100 transition-colors",children:"Reject PO"}),o.jsx("button",{onClick:()=>r(m.id,"Approve"),className:"px-6 py-2 bg-green-600 text-white rounded font-medium hover:bg-green-700 transition-colors",children:"Approve PO"})]})]},m.id))})})]})},$P=({requests:n,purchaseRequests:e,purchaseOrders:t,inventory:r,employees:a,onIssue:c,onForwardToPurchase:d,onCreatePurchaseRequest:f,onCreateSCRequest:m,onGRN:x,currentUserEmail:y,onAddNewAsset:v,onUpdateAsset:E,onDeleteAsset:A,onIssueAsset:V,onReturnAsset:C,recipes:O=[]})=>{const[z,ae]=L.useState("consumables"),[K,ee]=L.useState(""),[B,Q]=L.useState(!1),[j,T]=L.useState(null),[S,N]=L.useState({grnNumber:"",remarks:""}),[R,D]=L.useState(!1),[M,Te]=L.useState(null),Pe=L.useMemo(()=>{const H=new Map;return r.forEach(pe=>{pe.id&&H.set(pe.id,pe)}),Array.from(H.values())},[r]),W=L.useMemo(()=>Pe.filter(H=>H.type==="Kitchen"&&!["Oven","Mixer","Fridge","Chiller","Blender","Stove","Microwave","Equipment","Table","Station","Range","Grinder","Dishwasher"].some(pe=>H.model.includes(pe)||H.itemName&&H.itemName.includes(pe)||H.subCategory&&(H.subCategory.includes("Equipment")||H.subCategory.includes("Furniture")||H.subCategory.includes("Tools")))),[Pe]),ce=L.useMemo(()=>Pe.filter(H=>H.type==="Kitchen"&&["Oven","Mixer","Fridge","Chiller","Blender","Stove","Microwave","Equipment","Tool","Table","Station","Range","Grinder","Dishwasher"].some(pe=>H.model.includes(pe)||H.itemName&&H.itemName.includes(pe)||H.subCategory&&(H.subCategory.includes("Equipment")||H.subCategory.includes("Furniture")||H.subCategory.includes("Tools")))),[Pe]),ve=L.useMemo(()=>{const H=Pe.length,pe=Pe.filter(gt=>(gt.quantity||0)<=5).length,Be=n.filter(gt=>gt.status==="Pending Store").length;return{totalItems:H,lowStockCount:pe,pendingReqsCount:Be}},[Pe,n]),ke=L.useMemo(()=>{const H=K.toLowerCase();return W.filter(pe=>pe.model.toLowerCase().includes(H)||pe.itemCode&&pe.itemCode.toLowerCase().includes(H))},[W,K]),Ue=L.useMemo(()=>{const H=K.toLowerCase();return ce.filter(pe=>pe.model.toLowerCase().includes(H)||pe.itemName&&pe.itemName.toLowerCase().includes(H)||pe.itemCode&&pe.itemCode.toLowerCase().includes(H)||pe.assignedTo&&pe.assignedTo.toLowerCase().includes(H)||pe.location&&pe.location.toLowerCase().includes(H)||pe.material&&pe.material.toLowerCase().includes(H))},[ce,K]),P=n.filter(H=>H.status==="Pending Store"),$=t.filter(H=>H.status==="Approved"),le=async H=>{const pe=prompt("Enter Chef/Employee name to issue this equipment:");if(!pe)return;if(!a.some(gt=>`${gt.firstName} ${gt.lastName}`.toLowerCase()===pe.toLowerCase())){alert("Employee not found in records.");return}try{await V(H,pe),alert("Equipment issued to "+pe)}catch(gt){alert(gt.message)}},_e=async H=>{window.confirm("Confirm return of this equipment to main store stock?")&&(await C(H),alert("Equipment returned to stock."))},Ne=()=>{Te(null),D(!0)},F=async H=>{window.confirm("Issue these consumables now? Stock will be updated automatically.")&&(await c(H),alert("Materials issued to Kitchen."))},me=(H,pe)=>{pe&&H.length===1?E({...H[0],id:pe}):v(H),D(!1),Te(null)};return o.jsxs("div",{className:"max-w-full mx-auto space-y-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Store Management & Fulfillment"}),o.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Managing Kitchen Inventory (Ration) and Fixed Assets (Professional Equipment)."})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{className:"px-4 py-2 bg-purple-100 text-purple-900 border border-purple-200 rounded-lg hover:bg-purple-200 font-bold text-sm flex items-center gap-2 shadow-sm",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Generate MRF"]}),o.jsx("button",{onClick:Ne,className:"px-4 py-2 bg-blue-900 text-white rounded-lg hover:bg-blue-800 font-medium text-sm flex items-center gap-2 shadow-sm",children:o.jsx("span",{children:"+ Add Kitchen Asset"})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4",children:[o.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Total Inventory Items"}),o.jsx("p",{className:"text-2xl font-black text-blue-900",children:ve.totalItems})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4",children:[o.jsx("div",{className:"bg-red-100 p-3 rounded-lg",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Low Stock Alerts"}),o.jsx("p",{className:"text-2xl font-black text-red-600",children:ve.lowStockCount})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex items-center gap-4",children:[o.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-purple-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Pending Requisitions"}),o.jsx("p",{className:"text-2xl font-black text-purple-900",children:ve.pendingReqsCount})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[600px]",children:[o.jsx("div",{className:"flex border-b border-slate-200 bg-slate-50 p-1 gap-1",children:[{id:"consumables",label:"Consumables (Ration)",count:W.length},{id:"fixedAssets",label:"Fixed Assets (Machinery)",count:ce.length},{id:"fulfillment",label:"Pending Fulfillments",count:P.length},{id:"receiving",label:"PO Receiving (GRN)",count:$.length}].map(H=>o.jsxs("button",{onClick:()=>{ae(H.id),ee("")},className:`flex-1 py-2.5 px-4 text-sm font-bold rounded-lg transition-all ${z===H.id?"bg-purple-900 text-white shadow-md scale-[1.02]":"text-blue-900 hover:bg-white hover:shadow-sm"}`,children:[H.label," ",o.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-[10px] ${z===H.id?"bg-purple-700":"bg-slate-200"}`,children:H.count})]},H.id))}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6 relative max-w-md",children:[o.jsx("input",{type:"text",placeholder:`Search ${z==="fixedAssets"?"Assets, Codes, Materials...":z}...`,className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-900 outline-none shadow-sm",value:K,onChange:H=>ee(H.target.value)}),o.jsx("svg",{className:"w-5 h-5 absolute left-3 top-2.5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),z==="consumables"&&o.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:o.jsxs("table",{className:"min-w-full text-sm text-left divide-y divide-slate-200",children:[o.jsx("thead",{className:"bg-purple-50 text-blue-900 font-bold uppercase text-[10px] tracking-wider",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 border-r",children:"Item Code"}),o.jsx("th",{className:"px-6 py-4 border-r",children:"Ingredient Name"}),o.jsx("th",{className:"px-6 py-4 border-r text-center",children:"Available Stock"}),o.jsx("th",{className:"px-6 py-4 border-r",children:"Unit"}),o.jsx("th",{className:"px-6 py-4 border-r",children:"Storage Location"}),o.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-100",children:ke.map(H=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 font-mono text-xs text-blue-800 border-r",children:H.itemCode||"-"}),o.jsx("td",{className:"px-6 py-4 font-bold text-blue-900 border-r",children:H.model}),o.jsx("td",{className:"px-6 py-4 text-center border-r",children:o.jsx("span",{className:`px-3 py-1 rounded-full font-bold ${H.quantity<=5?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:H.quantity||0})}),o.jsx("td",{className:"px-6 py-4 text-blue-800 border-r",children:H.unit||"-"}),o.jsx("td",{className:"px-6 py-4 text-blue-800 border-r",children:H.location||"-"}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsx("button",{onClick:()=>{Te(H),D(!0)},className:"text-purple-900 hover:underline font-bold",children:"Edit"})})]},H.id))})]})}),z==="fixedAssets"&&o.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:o.jsxs("table",{className:"min-w-full text-[11px] text-left divide-y divide-slate-200 whitespace-nowrap",children:[o.jsx("thead",{className:"bg-blue-50 text-blue-900 font-bold uppercase tracking-wider",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-3 border-r",children:"Sr No"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Asset Code"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Item Name"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Category"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Material"}),o.jsx("th",{className:"px-3 py-3 border-r text-center",children:"Quantity"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Unit (pcs/..)"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Condition"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Purchase Date"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Purchase Price"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Assigned L"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Responsible Person"}),o.jsx("th",{className:"px-3 py-3 border-r",children:"Remarks"}),o.jsx("th",{className:"px-3 py-3 text-right",children:"Operation"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:Ue.map((H,pe)=>o.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[o.jsx("td",{className:"px-3 py-3 border-r text-slate-500 font-medium text-center",children:pe+1}),o.jsx("td",{className:"px-3 py-3 border-r font-mono text-blue-900 font-bold",children:H.itemCode||"-"}),o.jsx("td",{className:"px-3 py-3 border-r font-bold text-blue-900",children:H.itemName||H.model}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-800",children:H.subCategory||H.type}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-800 font-medium",children:H.material||"-"}),o.jsx("td",{className:"px-3 py-3 border-r text-center font-bold text-blue-900",children:H.quantity||0}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-800",children:H.unit||"Pcs"}),o.jsx("td",{className:"px-3 py-3 border-r",children:o.jsx("span",{className:`px-2 py-0.5 rounded font-bold uppercase text-[9px] ${H.condition==="Excellent"||H.condition==="New"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:H.condition||"Good"})}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-800",children:H.purchaseDate||"-"}),o.jsxs("td",{className:"px-3 py-3 border-r text-blue-900 font-mono",children:["PKR ",H.cost||"0"]}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-800 font-medium",children:H.location||"Store"}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-900 font-bold underline decoration-blue-200",children:H.assignedTo||"In Store"}),o.jsx("td",{className:"px-3 py-3 border-r text-blue-600 italic max-w-xs truncate",title:H.remarks,children:H.remarks||"-"}),o.jsxs("td",{className:"px-3 py-3 text-right space-x-2",children:[H.status==="In Stock"?o.jsx("button",{onClick:()=>le(H.id),className:"text-green-600 font-bold hover:underline",children:"Issue"}):o.jsx("button",{onClick:()=>_e(H.id),className:"text-orange-600 font-bold hover:underline",children:"Return"}),o.jsx("button",{onClick:()=>{Te(H),D(!0)},className:"text-blue-900 font-bold hover:underline",children:"Edit"})]})]},H.id))})]})}),z==="fulfillment"&&o.jsx("div",{className:"space-y-4",children:P.length===0?o.jsx("p",{className:"text-center py-20 text-slate-400 italic",children:"No approved requisitions to fulfill at this moment."}):P.map(H=>o.jsxs("div",{className:"p-5 bg-purple-50 border border-purple-200 rounded-xl flex justify-between items-center group hover:bg-purple-100 transition-all shadow-sm",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("h3",{className:"font-bold text-lg text-blue-900",children:H.requesterName}),o.jsx("span",{className:"text-[10px] font-bold bg-white border border-purple-300 text-purple-900 px-2 py-0.5 rounded uppercase",children:H.department})]}),o.jsxs("p",{className:"text-sm text-blue-800 mb-3 font-medium italic",children:["Purpose: ",H.purpose]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:H.items.map((pe,Be)=>o.jsxs("span",{className:"bg-white px-2 py-1 rounded border border-purple-200 text-xs font-mono text-blue-900 shadow-xs",children:[pe.name,": ",pe.quantityRequested," ",pe.unit]},Be))})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>F(H.id),className:"bg-purple-900 text-white px-6 py-3 rounded-lg font-bold hover:bg-purple-800 shadow-sm transition-transform active:scale-95",children:"Issue Materials"}),o.jsx("button",{onClick:()=>d(H.id),className:"bg-white text-purple-900 border border-purple-900 px-4 py-3 rounded-lg font-bold hover:bg-purple-50",children:"Market Buy"})]})]},H.id))}),z==="receiving"&&o.jsx("div",{className:"space-y-4",children:$.length===0?o.jsx("p",{className:"text-center py-20 text-slate-400 italic",children:"No approved Purchase Orders to receive."}):$.map(H=>o.jsxs("div",{className:"p-5 bg-green-50 border border-green-200 rounded-xl flex justify-between items-center group shadow-sm",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg text-blue-900",children:["PO #",H.poNumber]}),o.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:["Vendor: ",H.vendorName,"  Value: PKR ",H.totalAmount.toLocaleString()]}),o.jsxs("p",{className:"text-xs text-blue-700 mt-2 font-mono",children:["Items: ",H.items.map(pe=>`${pe.itemName} (${pe.quantity})`).join(", ")]})]}),o.jsx("button",{onClick:()=>{T(H),N({grnNumber:`GRN-${Date.now().toString().slice(-4)}`,remarks:"Received in good condition."}),Q(!0)},className:"bg-green-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-green-700 shadow-sm transition-transform active:scale-95",children:"Accept Delivery (GRN)"})]},H.id))})]})]}),B&&j&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4",onClick:()=>Q(!1),children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8",onClick:H=>H.stopPropagation(),children:[o.jsx("h3",{className:"text-2xl font-bold text-blue-900 mb-2",children:"Generate GRN"}),o.jsxs("p",{className:"text-sm text-blue-600 mb-6 font-medium",children:["Accepting items for PO #",j.poNumber]}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-blue-900 uppercase block mb-1",children:"GRN Ref Number"}),o.jsx("input",{type:"text",value:S.grnNumber,onChange:H=>N({...S,grnNumber:H.target.value}),className:"w-full border border-slate-300 rounded-lg p-2.5 text-blue-900 focus:ring-2 focus:ring-green-500 outline-none"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-bold text-blue-900 uppercase block mb-1",children:"Remarks"}),o.jsx("textarea",{value:S.remarks,onChange:H=>N({...S,remarks:H.target.value}),className:"w-full border border-slate-300 rounded-lg p-2.5 text-blue-900 focus:ring-2 focus:ring-green-500 outline-none",rows:3})]}),o.jsx("button",{onClick:async()=>{await x(j.id,S),Q(!1),alert("Inventory successfully updated.")},className:"w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 shadow-lg mt-2 transition-all",children:"Confirm Receipt"})]})]})}),o.jsx(Dd,{isOpen:R,onClose:()=>D(!1),onSave:me,editingAsset:M,employees:a,initialType:"Kitchen"})]})},QP=({requests:n,currentUserEmail:e})=>{const t=n.filter(a=>a.requesterEmail===e||e==="admin"),r=a=>{switch(a){case"Pending Account Manager":return"bg-yellow-100 text-yellow-800";case"Pending Store":return"bg-blue-100 text-blue-800";case"Issued":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:"My Requests"}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-purple-50 text-blue-900 font-bold uppercase",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4",children:"Date"}),o.jsx("th",{className:"px-6 py-4",children:"Purpose"}),o.jsx("th",{className:"px-6 py-4",children:"Items Count"}),o.jsx("th",{className:"px-6 py-4",children:"Status"}),o.jsx("th",{className:"px-6 py-4",children:"Remarks"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200",children:t.length>0?t.map(a=>o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-blue-900",children:new Date(a.date).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 font-medium text-blue-900",children:a.purpose}),o.jsx("td",{className:"px-6 py-4 text-blue-900",children:a.items.length}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${r(a.status)}`,children:a.status})}),o.jsx("td",{className:"px-6 py-4 text-blue-900 italic",children:a.status==="Rejected"?a.rejectionReason:a.status==="Issued"?`Issued on ${new Date(a.issuedDate).toLocaleDateString()}`:"-"})]},a.id)):o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-blue-900",children:"No requests found."})})})]})})]})},YP=({requests:n,purchaseRequests:e,vendors:t,purchaseOrders:r,onCreatePO:a,onUpdatePO:c,onDeletePO:d,currentUserEmail:f})=>{const[m,x]=L.useState("pending"),[y,v]=L.useState(null),[E,A]=L.useState({vendorId:"",price:0}),[V,C]=L.useState(!1),[O,z]=L.useState(null),[ae,K]=L.useState({vendorId:"",totalAmount:0,status:"Pending Account Manager"}),ee=n.filter(S=>S.status==="Forwarded to Purchase"),B=async()=>{if(!y||!E.vendorId)return;const S=t.find(D=>D.id===E.vendorId);if(!S)return;const N=E.price,R={poNumber:`PO-${Date.now().toString().slice(-6)}`,originalRequestId:y.id,vendorId:S.id,vendorName:S.name,date:new Date().toISOString(),status:"Pending Account Manager",generatedBy:f,totalAmount:N,items:y.items.map(D=>({itemName:D.name,quantity:D.quantityRequested,unit:D.unit,unitPrice:N/y.items.length,totalPrice:N/y.items.length,inventoryId:D.inventoryId}))};await a(R),v(null),A({vendorId:"",price:0}),alert("Purchase Order created and sent to Account Manager for approval.")},Q=S=>{z(S),K({vendorId:S.vendorId,totalAmount:S.totalAmount,status:S.status}),C(!0)},j=async S=>{if(S.preventDefault(),!O||!c)return;const N=t.find(R=>R.id===ae.vendorId);await c(O.id,{vendorId:ae.vendorId,vendorName:(N==null?void 0:N.name)||O.vendorName,totalAmount:ae.totalAmount,status:ae.status}),C(!1),z(null)},T=S=>{switch(S){case"Pending Account Manager":return"bg-yellow-100 text-yellow-800";case"Approved":return"bg-blue-100 text-blue-800";case"Received":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Purchase Department"})}),o.jsx("div",{className:"border-b border-slate-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>x("pending"),className:`whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm ${m==="pending"?"border-blue-900 text-blue-900":"border-transparent text-blue-900 hover:text-blue-800 hover:border-slate-300"}`,children:["Process Requests (",ee.length,")"]}),o.jsx("button",{onClick:()=>x("history"),className:`whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm ${m==="history"?"border-blue-900 text-blue-900":"border-transparent text-blue-900 hover:text-blue-800 hover:border-slate-300"}`,children:"Purchase History"})]})}),m==="pending"&&o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Requests to Process"}),ee.length===0?o.jsx("div",{className:"bg-white p-8 rounded-lg shadow-sm text-center text-blue-900",children:"No requests forwarded from Store."}):o.jsx("div",{className:"space-y-4",children:ee.map(S=>o.jsxs("div",{className:`bg-white p-4 rounded-lg shadow-sm border-2 cursor-pointer transition-all ${(y==null?void 0:y.id)===S.id?"border-blue-900 ring-2 ring-blue-100":"border-transparent hover:border-slate-300"}`,onClick:()=>v(S),children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h4",{className:"font-bold text-blue-900",children:S.purpose}),o.jsx("span",{className:"text-xs font-mono text-blue-900",children:new Date(S.date).toLocaleDateString()})]}),o.jsxs("p",{className:"text-sm text-blue-900 mb-2",children:["From: ",S.requesterName," (",S.department,")"]}),o.jsxs("div",{className:"bg-purple-50 p-2 rounded text-xs text-blue-900",children:[o.jsx("strong",{children:"Items:"})," ",S.items.map(N=>`${N.name} (${N.quantityRequested} ${N.unit})`).join(", ")]})]},S.id))})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm h-fit sticky top-6",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-4 border-b pb-2",children:"Create Purchase Order"}),y?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Selected Request"}),o.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-100 rounded text-sm text-blue-900",children:[y.purpose," (",y.items.length," items)"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Date"}),o.jsx("input",{type:"text",value:new Date().toLocaleDateString(),disabled:!0,className:"w-full bg-slate-100 border rounded p-2 text-blue-900 cursor-not-allowed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Select Vendor"}),o.jsxs("select",{value:E.vendorId,onChange:S=>A({...E,vendorId:S.target.value}),className:"w-full border rounded p-2 focus:ring-blue-900 text-blue-900",children:[o.jsx("option",{value:"",children:"-- Choose Vendor --"}),t.map(S=>o.jsx("option",{value:S.id,children:S.name},S.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Total Estimated Cost (PKR)"}),o.jsx("input",{type:"number",min:"0",value:E.price,onChange:S=>A({...E,price:parseFloat(S.target.value)}),className:"w-full border rounded p-2 focus:ring-blue-900 text-blue-900"})]}),o.jsx("button",{onClick:B,disabled:!E.vendorId||E.price<=0,className:"w-full bg-blue-900 text-white py-2 rounded font-medium hover:bg-blue-800 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:"Generate PO for Approval"})]}):o.jsx("p",{className:"text-blue-900 text-sm text-center py-10",children:"Select a request from the list to generate a Purchase Order."})]})]}),m==="history"&&o.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-purple-50 text-blue-900 uppercase font-bold",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4",children:"Date"}),o.jsx("th",{className:"px-6 py-4",children:"PO Number"}),o.jsx("th",{className:"px-6 py-4",children:"Vendor"}),o.jsx("th",{className:"px-6 py-4",children:"Items"}),o.jsx("th",{className:"px-6 py-4 text-right",children:"Total Amount"}),o.jsx("th",{className:"px-6 py-4",children:"Status"}),o.jsx("th",{className:"px-6 py-4",children:"GRN Info"}),o.jsx("th",{className:"px-6 py-4 text-center",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200",children:r.length>0?r.map(S=>{var N;return o.jsxs("tr",{className:"hover:bg-purple-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 text-blue-900",children:new Date(S.date).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 font-mono font-medium text-blue-900",children:S.poNumber}),o.jsx("td",{className:"px-6 py-4 text-blue-900",children:S.vendorName}),o.jsx("td",{className:"px-6 py-4 text-blue-900",children:o.jsxs("div",{className:"max-w-xs truncate",title:S.items.map(R=>R.itemName).join(", "),children:[S.items.length," items (",(N=S.items[0])==null?void 0:N.itemName,"...)"]})}),o.jsxs("td",{className:"px-6 py-4 text-right font-bold text-blue-900",children:["PKR ",S.totalAmount.toLocaleString()]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${T(S.status)}`,children:S.status})}),o.jsx("td",{className:"px-6 py-4 text-xs text-blue-900",children:S.grnNumber?o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-green-700",children:S.grnNumber}),o.jsx("p",{children:new Date(S.grnDate).toLocaleDateString()})]}):"-"}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsxs("div",{className:"flex justify-center gap-2",children:[o.jsx("button",{onClick:()=>Q(S),className:"text-blue-900 hover:text-blue-950 text-xs font-medium",title:"Edit PO",disabled:S.status==="Received",children:"Edit"}),o.jsx("span",{className:"text-blue-300",children:"|"}),o.jsx("button",{onClick:()=>d&&d(S.id),className:"text-red-600 hover:text-red-800 text-xs font-medium",title:"Delete PO",children:"Delete"})]})})]},S.id)}):o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"text-center py-10 text-blue-900",children:"No purchase history available."})})})]})}),V&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:()=>C(!1),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",onClick:S=>S.stopPropagation(),children:[o.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4 border-b pb-2",children:"Edit Purchase Order"}),o.jsxs("form",{onSubmit:j,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Vendor"}),o.jsx("select",{value:ae.vendorId,onChange:S=>K({...ae,vendorId:S.target.value}),className:"w-full border rounded p-2 focus:ring-blue-900 text-blue-900",children:t.map(S=>o.jsx("option",{value:S.id,children:S.name},S.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Total Amount (PKR)"}),o.jsx("input",{type:"number",min:"0",value:ae.totalAmount,onChange:S=>K({...ae,totalAmount:parseFloat(S.target.value)}),className:"w-full border rounded p-2 focus:ring-blue-900 text-blue-900"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-1",children:"Status"}),o.jsxs("select",{value:ae.status,onChange:S=>K({...ae,status:S.target.value}),className:"w-full border rounded p-2 focus:ring-blue-900 text-blue-900",children:[o.jsx("option",{value:"Pending Account Manager",children:"Pending Account Manager"}),o.jsx("option",{value:"Approved",children:"Approved"}),o.jsx("option",{value:"Rejected",children:"Rejected"}),o.jsx("option",{value:"Received",children:"Received"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 border rounded text-blue-900 hover:bg-slate-50",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-900 text-white rounded hover:bg-blue-800",children:"Save Changes"})]})]})]})})]})},WP=n=>{const[e,t]=L.useState("sc_my_requests"),r=n.employees.find(x=>x.email===n.currentUserEmail),a=n.currentUserEmail==="admin",c=a||(r==null?void 0:r.role)==="HOD"&&(r==null?void 0:r.department)==="Finance"||(r==null?void 0:r.designation)==="Account Manager",d=a||(r==null?void 0:r.role)==="HOD"||(r==null?void 0:r.department)==="Store",f=a||(r==null?void 0:r.department)==="Finance"||(r==null?void 0:r.department)==="Purchase",m=()=>{switch(e){case"sc_requests":return o.jsx(GP,{inventory:n.inventory,currentUserEmail:n.currentUserEmail,employees:n.employees,onCreateRequest:n.onCreateRequest,recipes:n.recipes});case"sc_approvals":return c?o.jsx(KP,{requests:n.requests,purchaseOrders:n.purchaseOrders,onAction:n.onActionRequest,onPOAction:n.onPOAction}):o.jsx("div",{className:"p-6 text-center text-blue-900",children:"Access Denied. Account Managers Only."});case"sc_store":return d?o.jsx($P,{requests:n.requests,purchaseRequests:n.purchaseRequests,purchaseOrders:n.purchaseOrders,inventory:n.inventory,employees:n.employees,recipes:n.recipes,onIssue:n.onIssueRequest,onForwardToPurchase:n.onForwardToPurchase,onCreatePurchaseRequest:n.onCreatePurchaseRequest,onCreateSCRequest:n.onCreateRequest,onGRN:n.onGRN,currentUserEmail:n.currentUserEmail,onAddNewAsset:n.onAddNewAsset,onUpdateAsset:n.onUpdateAsset,onDeleteAsset:n.onDeleteAsset,onIssueAsset:n.onIssueAsset,onReturnAsset:n.onReturnAsset}):o.jsx("div",{className:"p-6 text-center text-blue-900",children:"Access Denied. Store Managers Only."});case"sc_purchase":return f?o.jsx(YP,{requests:n.requests,purchaseRequests:n.purchaseRequests,vendors:n.vendors,purchaseOrders:n.purchaseOrders,onCreatePO:n.onCreatePO,onUpdatePO:n.onUpdatePO,onDeletePO:n.onDeletePO,currentUserEmail:n.currentUserEmail}):o.jsx("div",{className:"p-6 text-center text-blue-900",children:"Access Denied. Purchase Department Only."});case"sc_my_requests":default:return o.jsx(QP,{requests:n.requests,currentUserEmail:n.currentUserEmail})}};return o.jsxs("div",{className:"flex h-screen bg-slate-100",children:[o.jsx(HP,{activePage:e,setActivePage:t,currentUserEmail:n.currentUserEmail}),o.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsxs("header",{className:"bg-purple-900 border-b border-purple-800 h-16 flex-shrink-0 flex items-center justify-between px-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:n.onBack,className:"flex items-center gap-2 text-sm font-medium text-purple-200 hover:text-white",children:[o.jsx(Mm,{className:"w-5 h-5"}),o.jsx("span",{children:"Home"})]}),o.jsx("div",{className:"h-6 w-px bg-purple-700 mx-2"}),o.jsx("h1",{className:"text-lg font-bold text-white",children:"The Chef's Academy Supply Chain"})]}),o.jsxs("button",{onClick:n.onLogout,className:"flex items-center gap-2 bg-purple-800 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[o.jsx(jo,{className:"w-5 h-5"}),o.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]}),o.jsx("div",{className:"flex-1 overflow-x-hidden overflow-y-auto p-6",children:m()})]})]})},XP=({activePage:n,setActivePage:e,currentUserEmail:t})=>o.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0",children:[o.jsx("div",{className:"h-16 flex items-center justify-center border-b border-slate-200 px-4",children:o.jsx(_o,{className:"h-8 w-auto"})}),o.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[o.jsx("div",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wider mb-4 px-2",children:"Workplace"}),ZE.map(r=>{const a=r.icon,c=n===r.id;return o.jsxs("button",{onClick:()=>e(r.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors text-sm font-medium ${c?"bg-purple-50 text-purple-900":"text-blue-900 hover:bg-purple-50"}`,children:[o.jsx(a,{className:`w-5 h-5 ${c?"text-purple-900":"text-purple-400"}`}),o.jsx("span",{children:r.label})]},r.id)})]}),o.jsx("div",{className:"p-4 border-t border-slate-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-900 font-bold text-xs",children:t.charAt(0).toUpperCase()}),o.jsx("div",{className:"overflow-hidden",children:o.jsx("p",{className:"text-sm font-medium text-blue-900 truncate",title:t,children:t})})]})})]}),JP=({messages:n,employees:e,currentUserEmail:t,onSendMessage:r})=>{const[a,c]=L.useState("public"),[d,f]=L.useState(""),[m,x]=L.useState(!1),y=L.useRef(null),v=()=>{var C;(C=y.current)==null||C.scrollIntoView({behavior:"smooth"})};L.useEffect(()=>{v()},[n,a]);const E=n.filter(C=>a==="public"?C.isPublic===!0:!C.isPublic&&(C.senderEmail===t&&C.receiverEmail===a||C.senderEmail===a&&C.receiverEmail===t)).sort((C,O)=>new Date(C.timestamp).getTime()-new Date(O.timestamp).getTime()),A=async C=>{C.preventDefault();const O=d.trim();if(!(!O||m)){x(!0);try{const z=e.find(ee=>ee.email===t),ae=z?`${z.firstName} ${z.lastName}`:t==="admin"?"Administrator":t,K={senderEmail:t,senderName:ae,message:O,timestamp:new Date().toISOString(),isPublic:a==="public"};a!=="public"&&(K.receiverEmail=a),await r(K),f("")}catch(z){console.error("Failed to send message:",z),alert("Failed to send message. Please try again.")}finally{x(!1)}}},V=e.filter(C=>C.email!==t);return o.jsxs("div",{className:"flex h-full bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[o.jsxs("div",{className:"w-64 bg-slate-50 border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"p-4 font-bold text-blue-900 border-b border-slate-200 bg-white",children:"Conversations"}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs("button",{onClick:()=>c("public"),className:`w-full text-left px-4 py-3 flex items-center gap-3 hover:bg-slate-100 transition-colors ${a==="public"?"bg-purple-100 border-r-4 border-purple-900":""}`,children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-bold shadow-sm",children:"#"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-bold text-blue-900",children:"Public Chat"}),o.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-semibold",children:"Broadcast to all"})]})]}),o.jsx("div",{className:"mt-4 px-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2",children:"Direct Messages"}),V.map(C=>o.jsxs("button",{onClick:()=>c(C.email),className:`w-full text-left px-4 py-2.5 flex items-center gap-3 hover:bg-slate-100 transition-colors ${a===C.email?"bg-purple-100 border-r-4 border-purple-900":""}`,children:[o.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold text-xs shadow-sm",children:C.firstName.charAt(0)}),o.jsxs("div",{className:"overflow-hidden",children:[o.jsxs("p",{className:"text-sm font-medium text-blue-900 truncate",children:[C.firstName," ",C.lastName]}),o.jsx("p",{className:"text-[10px] text-slate-500 truncate",children:C.department})]})]},C.id))]})]}),o.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[o.jsx("div",{className:"h-14 border-b border-slate-200 flex items-center px-6 bg-white shadow-sm z-10",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${a==="public"?"bg-green-500 animate-pulse":"bg-blue-500"}`}),o.jsx("h3",{className:"font-bold text-blue-900",children:a==="public"?"General Public Chat":(()=>{const C=e.find(O=>O.email===a);return C?`${C.firstName} ${C.lastName}`:a})()})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-slate-50",children:[E.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400 opacity-60",children:[o.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),o.jsx("p",{className:"text-sm font-medium",children:"No messages yet in this circle."})]}):E.map(C=>{const O=C.senderEmail===t;return o.jsx("div",{className:`flex ${O?"justify-end":"justify-start"}`,children:o.jsxs("div",{className:"max-w-[75%] group",children:[!O&&o.jsx("p",{className:"text-[10px] font-bold mb-1 ml-1 text-purple-900 uppercase",children:C.senderName}),o.jsxs("div",{className:`rounded-2xl px-4 py-2 shadow-sm ${O?"bg-purple-900 text-white rounded-tr-none":"bg-white text-slate-800 border border-slate-200 rounded-tl-none"}`,children:[o.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:C.message}),o.jsx("p",{className:`text-[9px] mt-1 text-right ${O?"text-purple-200":"text-slate-400"} font-medium`,children:new Date(C.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},C.id)}),o.jsx("div",{ref:y})]}),o.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:o.jsxs("form",{onSubmit:A,className:"flex gap-2 items-center bg-slate-100 rounded-full px-4 py-1 focus-within:ring-2 focus-within:ring-purple-900 transition-all",children:[o.jsx("input",{type:"text",value:d,onChange:C=>f(C.target.value),disabled:m,placeholder:a==="public"?"Message everyone...":"Send a direct message...",className:"flex-1 bg-transparent border-none py-2 focus:ring-0 text-sm text-blue-900 placeholder-slate-400"}),o.jsx("button",{type:"submit",disabled:!d.trim()||m,className:"bg-purple-900 text-white rounded-full p-2 hover:bg-purple-800 transition-all flex items-center justify-center w-8 h-8 shadow-sm disabled:opacity-50 disabled:bg-slate-400",children:m?o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 translate-x-0.5",children:o.jsx("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})})})]})})]})]})},ZP=({tasks:n,currentUserEmail:e})=>{const[t,r]=L.useState(new Date),a=(C,O)=>new Date(C,O+1,0).getDate(),c=(C,O)=>new Date(C,O,1).getDay(),d=["January","February","March","April","May","June","July","August","September","October","November","December"],f=()=>{r(new Date(t.getFullYear(),t.getMonth()-1,1))},m=()=>{r(new Date(t.getFullYear(),t.getMonth()+1,1))},x=t.getFullYear(),y=t.getMonth(),v=a(x,y),E=c(x,y),A=L.useMemo(()=>n.filter(C=>{if(!C.dueDate)return!1;const O=new Date(C.dueDate);return O.getMonth()===y&&O.getFullYear()===x}),[n,y,x]),V=()=>{const C=[];let O=[];for(let z=0;z<E;z++)O.push(o.jsx("div",{className:"h-32 bg-slate-50 border border-slate-100"},`empty-${z}`));for(let z=1;z<=v;z++){const ae=`${x}-${String(y+1).padStart(2,"0")}-${String(z).padStart(2,"0")}`,K=A.filter(B=>B.dueDate===ae),ee=new Date().toDateString()===new Date(x,y,z).toDateString();if(O.push(o.jsxs("div",{className:`h-32 bg-white border border-slate-200 p-2 overflow-y-auto ${ee?"bg-purple-50":""}`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:`text-sm font-semibold ${ee?"text-purple-700":"text-slate-700"}`,children:z}),K.length>0&&o.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-1.5 rounded-full",children:K.length})]}),o.jsx("div",{className:"space-y-1",children:K.map(B=>o.jsx("div",{className:`text-[10px] p-1 rounded truncate border-l-2 ${B.status==="Closed"||B.status==="Completed - Pending Review"?"bg-green-50 border-green-500 text-green-700":B.status==="In Progress"?"bg-blue-50 border-blue-500 text-blue-700":"bg-yellow-50 border-yellow-500 text-yellow-700"}`,title:B.title,children:B.title},B.id))})]},z)),(z+E)%7===0||z===v){if(z===v&&(z+E)%7!==0){const B=7-(z+E)%7;for(let Q=0;Q<B;Q++)O.push(o.jsx("div",{className:"h-32 bg-slate-50 border border-slate-100"},`empty-end-${Q}`))}C.push(o.jsx("div",{className:"grid grid-cols-7",children:O},`row-${z}`)),O=[]}}return C};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Task Calendar"}),o.jsxs("div",{className:"flex items-center gap-4 bg-white p-2 rounded-lg shadow-sm",children:[o.jsx("button",{onClick:f,className:"p-1 hover:bg-slate-100 rounded text-blue-900",children:"<"}),o.jsxs("span",{className:"font-bold text-lg text-blue-900 w-32 text-center",children:[d[y]," ",x]}),o.jsx("button",{onClick:m,className:"p-1 hover:bg-slate-100 rounded text-blue-900",children:">"})]})]}),o.jsxs("div",{className:"flex-1 bg-white rounded-lg shadow-sm border border-slate-200 flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"grid grid-cols-7 bg-purple-900 text-white text-center py-2 text-sm font-semibold",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:V()})]})]})},e6=({tasks:n,employees:e})=>{const t=n.length,r=n.filter(v=>v.status==="Completed - Pending Review"||v.status==="Closed").length,a=n.filter(v=>v.status==="Completed - Pending Review").length,c=n.filter(v=>v.status==="In Progress").length,d=n.filter(v=>v.status==="Closed"?!1:new Date(v.dueDate)<new Date),f=t>0?Math.round(r/t*100):0,m=L.useMemo(()=>{const v=new Date;let E=0,A=0,V=0;return n.filter(C=>C.status!=="Closed").forEach(C=>{const O=new Date(C.createdAt),z=Math.abs(v.getTime()-O.getTime()),ae=Math.ceil(z/(1e3*60*60*24));ae<=3?E++:ae<=7?A++:V++}),{less3:E,less7:A,more7:V}},[n]),x=L.useMemo(()=>{const v=new Map;return n.forEach(E=>{const A=E.assignedToDepartment||"Unassigned";v.set(A,(v.get(A)||0)+1)}),Array.from(v.entries()).sort((E,A)=>A[1]-E[1])},[n]),y=({title:v,value:E,subtext:A,color:V})=>o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100",children:[o.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-1",children:v}),o.jsx("div",{className:`text-3xl font-bold ${V}`,children:E}),o.jsx("p",{className:"text-xs text-slate-400 mt-2",children:A})]});return o.jsxs("div",{className:"space-y-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"Task Analytics & Reports"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsx(y,{title:"Pending Review",value:a,subtext:"Awaiting Manager Approval",color:"text-orange-600"}),o.jsx(y,{title:"Overdue Tasks",value:d.length,subtext:"Past due date",color:"text-red-600"}),o.jsx(y,{title:"In Progress",value:c,subtext:"Currently active",color:"text-blue-600"}),o.jsx(y,{title:"Completion Rate",value:`${f}%`,subtext:"Overall efficiency",color:"text-green-600"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-4",children:"Task Aging Report (Unfinished)"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-slate-600",children:"Less than 3 days"}),o.jsx("span",{className:"font-bold text-green-600",children:m.less3})]}),o.jsx("div",{className:"w-full bg-slate-100 h-2 rounded-full",children:o.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${m.less3/t*100}%`}})}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-slate-600",children:"3 - 7 days"}),o.jsx("span",{className:"font-bold text-yellow-600",children:m.less7})]}),o.jsx("div",{className:"w-full bg-slate-100 h-2 rounded-full",children:o.jsx("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:`${m.less7/t*100}%`}})}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-slate-600",children:"More than 7 days"}),o.jsx("span",{className:"font-bold text-red-600",children:m.more7})]}),o.jsx("div",{className:"w-full bg-slate-100 h-2 rounded-full",children:o.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:`${m.more7/t*100}%`}})})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 lg:col-span-2",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-4",children:"Critical Overdue Tasks"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left",children:[o.jsx("thead",{className:"bg-slate-50 text-slate-600",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Task"}),o.jsx("th",{className:"px-4 py-2",children:"Assigned To"}),o.jsx("th",{className:"px-4 py-2",children:"Due Date"}),o.jsx("th",{className:"px-4 py-2",children:"Status"})]})}),o.jsxs("tbody",{className:"divide-y",children:[d.slice(0,5).map(v=>o.jsxs("tr",{className:"hover:bg-red-50",children:[o.jsx("td",{className:"px-4 py-2 font-medium text-blue-900",children:v.title}),o.jsx("td",{className:"px-4 py-2 text-slate-600",children:v.assignedToName}),o.jsx("td",{className:"px-4 py-2 text-red-600 font-bold",children:new Date(v.dueDate).toLocaleDateString()}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded",children:v.status})})]},v.id)),d.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"text-center py-4 text-slate-400",children:"No overdue tasks. Great job!"})})]})]})})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100",children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-4",children:"Tasks by Department"}),o.jsx("div",{className:"flex flex-wrap gap-4",children:x.map(([v,E])=>o.jsxs("div",{className:"flex-1 min-w-[150px] bg-slate-50 p-4 rounded-lg border text-center",children:[o.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase",children:v}),o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:E})]},v))})]})]})},t6=({notes:n,currentUserEmail:e,onAddNote:t,onDeleteNote:r})=>{const[a,c]=L.useState(""),[d,f]=L.useState(""),[m,x]=L.useState("yellow"),y=n.filter(A=>A.userId===e).sort((A,V)=>new Date(V.date).getTime()-new Date(A.date).getTime()),v=async A=>{if(A.preventDefault(),!a.trim()&&!d.trim())return;const V={userId:e,title:a||"Untitled Note",content:d,color:m,date:new Date().toISOString()};await t(V),c(""),f("")},E=[{id:"yellow",class:"bg-yellow-100 border-yellow-200"},{id:"green",class:"bg-green-100 border-green-200"},{id:"blue",class:"bg-blue-100 border-blue-200"},{id:"purple",class:"bg-purple-100 border-purple-200"},{id:"red",class:"bg-red-100 border-red-200"}];return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:"My Notes & Scratchpad"}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full overflow-hidden",children:[o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 h-fit",children:[o.jsx("h3",{className:"font-bold text-lg text-slate-700 mb-4",children:"Add New Note"}),o.jsxs("form",{onSubmit:v,className:"space-y-4",children:[o.jsx("input",{type:"text",placeholder:"Title...",value:a,onChange:A=>c(A.target.value),className:"w-full border-b border-slate-200 pb-2 focus:border-purple-500 focus:outline-none text-slate-800 font-medium"}),o.jsx("textarea",{placeholder:"Write something...",rows:6,value:d,onChange:A=>f(A.target.value),className:"w-full resize-none focus:outline-none text-sm text-slate-600"}),o.jsxs("div",{className:"flex justify-between items-center pt-2",children:[o.jsx("div",{className:"flex gap-2",children:E.map(A=>o.jsx("button",{type:"button",onClick:()=>x(A.id),className:`w-6 h-6 rounded-full border transition-transform ${A.class.split(" ")[0]} ${m===A.id?"scale-125 ring-2 ring-slate-300":""}`},A.id))}),o.jsx("button",{type:"submit",className:"bg-purple-900 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-purple-800 transition-colors",children:"Save Note"})]})]})]}),o.jsx("div",{className:"lg:col-span-2 overflow-y-auto pr-2",children:o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:y.length===0?o.jsx("div",{className:"col-span-2 text-center py-10 text-slate-400",children:"No notes yet. Create one to get started!"}):y.map(A=>{var C;const V=((C=E.find(O=>O.id===A.color))==null?void 0:C.class)||"bg-white border-slate-200";return o.jsxs("div",{className:`p-5 rounded-xl border shadow-sm relative group transition-transform hover:-translate-y-1 ${V}`,children:[o.jsx("button",{onClick:()=>r(A.id),className:"absolute top-3 right-3 text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),o.jsx("h4",{className:"font-bold text-slate-800 mb-2",children:A.title}),o.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:A.content}),o.jsx("p",{className:"text-xs text-slate-500 mt-4 text-right",children:new Date(A.date).toLocaleDateString()})]},A.id)})})})]})]})},eS=({priority:n})=>{const e={Low:"bg-gray-100 text-gray-800",Medium:"bg-blue-100 text-blue-800",High:"bg-orange-100 text-orange-800",Critical:"bg-red-100 text-red-800"};return o.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${e[n]}`,children:n})},mf=({task:n,onSelect:e})=>{const t=new Date(n.dueDate)<new Date&&n.status!=="Closed";return o.jsxs("div",{onClick:()=>e(n),className:`bg-white p-3 rounded-lg shadow-sm border mb-3 cursor-pointer hover:shadow-md transition-all ${t?"border-red-300 border-l-4":"border-slate-200"}`,children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx(eS,{priority:n.priority}),o.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(n.dueDate).toLocaleDateString()})]}),o.jsx("h4",{className:"font-bold text-blue-900 text-sm mb-1 leading-tight",children:n.title}),o.jsx("p",{className:"text-xs text-slate-500 mb-2 line-clamp-2",children:n.description}),o.jsxs("div",{className:"flex justify-between items-center border-t pt-2 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-100 text-purple-700 flex items-center justify-center text-[10px] font-bold",children:n.assignedToName.charAt(0)}),o.jsx("span",{className:"text-[10px] text-slate-600 truncate max-w-[80px]",children:n.assignedToName})]}),o.jsx("span",{className:`text-[10px] font-medium px-1.5 py-0.5 rounded ${n.status==="Reopened"?"bg-red-50 text-red-600":"bg-slate-100 text-slate-600"}`,children:n.status})]})]})},n6=({tasks:n,employees:e,currentUserEmail:t,onCreateTask:r,onTaskWorkflowAction:a,onDeleteTask:c})=>{const[d,f]=L.useState(!1),[m,x]=L.useState(null),[y,v]=L.useState(""),[E,A]=L.useState(""),[V,C]=L.useState(""),[O,z]=L.useState("Medium"),[ae,K]=L.useState("Operations"),[ee,B]=L.useState(""),[Q,j]=L.useState(new Date().toISOString().split("T")[0]),[T,S]=L.useState(""),N=e.find(P=>P.email===t),R=t==="admin",D=R||(N==null?void 0:N.role)==="HOD"||(N==null?void 0:N.role)==="HR",[M,Te]=L.useState("my"),Pe=async P=>{P.preventDefault();let $=T,le="",_e="";if(D){if(!$){alert("Please select an employee to assign the task to.");return}const F=e.find(me=>me.id===$);le=F?`${F.firstName} ${F.lastName}`:"Unknown",_e=(F==null?void 0:F.department)||""}else $=(N==null?void 0:N.id)||t,le=N?`${N.firstName} ${N.lastName}`:t,_e=(N==null?void 0:N.department)||"";const Ne={title:E,description:V,category:ae,priority:O,startDate:Q,dueDate:ee,assignedTo:$,assignedToName:le,assignedToDepartment:_e,createdBy:t,status:D&&$!==(N==null?void 0:N.id)?"Assigned":"New",createdAt:new Date().toISOString(),history:[]};await r(Ne),f(!1),W()},W=()=>{A(""),C(""),z("Medium"),K("Operations"),B(""),S("")},ce=L.useMemo(()=>{let P=n;const $=(N==null?void 0:N.id)||t;return M==="my"?P=n.filter(le=>le.assignedTo===$):R||(P=n.filter(le=>le.createdBy===t||le.assignedToDepartment===(N==null?void 0:N.department))),P},[n,M,N,t,R]),ve={todo:ce.filter(P=>["New","Assigned","Reopened"].includes(P.status)),inProgress:ce.filter(P=>P.status==="In Progress"),review:ce.filter(P=>P.status==="Completed - Pending Review"),closed:ce.filter(P=>P.status==="Closed")},ke=async P=>{if(!m)return;let $=m.status,le=!1;switch(P){case"Accept":$="In Progress";break;case"Complete":$="Completed - Pending Review",le=!0;break;case"Approve":$="Closed";break;case"Reject":$="Reopened",le=!0;break}if(le&&!y.trim()){alert(`Please enter remarks to ${P} this task.`);return}await a(m.id,$,P,y),x(null),v("")},Ue=()=>{var _e;if(!m)return null;const P=m.assignedTo===((N==null?void 0:N.id)||t),$=m.createdBy===t,le=R||D||$;return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:()=>x(null),children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:Ne=>Ne.stopPropagation(),children:[o.jsxs("div",{className:"p-6 border-b flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"bg-slate-100 text-slate-600 text-xs px-2 py-1 rounded uppercase font-bold",children:m.category}),o.jsx(eS,{priority:m.priority})]}),o.jsx("h2",{className:"text-xl font-bold text-blue-900",children:m.title})]}),o.jsx("button",{onClick:()=>x(null),className:"text-slate-400 hover:text-slate-600 text-2xl",children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs",children:"Assigned To"}),o.jsx("p",{className:"font-medium text-blue-900",children:m.assignedToName})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs",children:"Assigned By"}),o.jsx("p",{className:"font-medium text-blue-900",children:m.createdBy})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs",children:"Due Date"}),o.jsx("p",{className:`font-medium ${new Date(m.dueDate)<new Date&&m.status!=="Closed"?"text-red-600":"text-blue-900"}`,children:new Date(m.dueDate).toLocaleDateString()})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs",children:"Status"}),o.jsx("p",{className:"font-medium text-blue-900",children:m.status})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-sm font-bold text-blue-900 mb-2",children:"Description"}),o.jsx("p",{className:"text-slate-700 text-sm whitespace-pre-wrap bg-slate-50 p-3 rounded",children:m.description})]}),o.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100 mb-6",children:[o.jsx("h3",{className:"text-sm font-bold text-blue-900 mb-3",children:"Actions"}),o.jsxs("div",{className:"flex flex-col gap-3",children:[["New","Assigned","Reopened"].includes(m.status)&&P&&o.jsx("button",{onClick:()=>ke("Accept"),className:"w-full bg-blue-600 text-white py-2 rounded font-medium hover:bg-blue-700",children:"Accept Task & Start"}),m.status==="In Progress"&&P&&o.jsxs(o.Fragment,{children:[o.jsx("textarea",{className:"w-full text-sm border rounded p-2 mb-2",placeholder:"Completion remarks / output summary...",value:y,onChange:Ne=>v(Ne.target.value)}),o.jsx("button",{onClick:()=>ke("Complete"),className:"w-full bg-green-600 text-white py-2 rounded font-medium hover:bg-green-700",children:"Mark as Completed"})]}),m.status==="Completed - Pending Review"&&le&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{className:"text-xs text-blue-900",children:[o.jsx("strong",{children:"User Remarks:"})," ",m.completionRemarks]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>ke("Approve"),className:"flex-1 bg-green-600 text-white py-2 rounded font-medium hover:bg-green-700",children:"Approve & Close"}),o.jsx("div",{className:"flex-1 flex flex-col gap-1",children:o.jsx("button",{onClick:()=>ke("Reject"),className:"bg-red-50 text-red-600 border border-red-200 py-2 rounded font-medium hover:bg-red-100 transition-colors",children:"Reject"})})]}),o.jsx("input",{type:"text",className:"w-full text-sm border rounded p-2",placeholder:"Rejection reason (Required for Reject)...",value:y,onChange:Ne=>v(Ne.target.value)})]}),m.status==="Closed"&&o.jsx("p",{className:"text-center text-sm text-green-600 font-medium py-2",children:"Task Closed Successfully"})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-bold text-blue-900 mb-3",children:"Activity History"}),o.jsx("div",{className:"space-y-4 border-l-2 border-slate-200 ml-2 pl-4",children:(_e=m.history)==null?void 0:_e.slice().reverse().map((Ne,F)=>o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-purple-400 ring-4 ring-white"}),o.jsx("p",{className:"text-xs text-slate-500",children:new Date(Ne.timestamp).toLocaleString()}),o.jsxs("p",{className:"text-sm font-medium text-blue-900",children:[Ne.action," ",o.jsxs("span",{className:"font-normal text-slate-600",children:["by ",Ne.by]})]}),Ne.details&&o.jsx("p",{className:"text-xs text-slate-600 mt-1 italic",children:Ne.details})]},F))})]})]}),le&&o.jsxs("div",{className:"p-4 bg-slate-50 border-t flex justify-between items-center",children:[o.jsxs("span",{className:"text-xs text-slate-400",children:["ID: ",m.id]}),o.jsx("button",{onClick:()=>{window.confirm("Permanently delete this task?")&&(c(m.id),x(null))},className:"text-red-500 hover:text-red-700 text-xs font-medium",children:"Delete Task"})]})]})})};return o.jsxs("div",{className:"h-full flex flex-col p-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[o.jsxs("div",{className:"flex bg-white rounded-lg p-1 shadow-sm",children:[o.jsx("button",{onClick:()=>Te("my"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${M==="my"?"bg-purple-100 text-purple-900":"text-slate-600 hover:bg-slate-50"}`,children:"My Tasks"}),D&&o.jsx("button",{onClick:()=>Te("team"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${M==="team"?"bg-purple-100 text-purple-900":"text-slate-600 hover:bg-slate-50"}`,children:"Team Tasks"})]}),D&&o.jsx("button",{onClick:()=>f(!0),className:"bg-purple-900 hover:bg-purple-800 text-white px-4 py-2 rounded-lg shadow-sm text-sm font-medium flex items-center gap-2",children:o.jsx("span",{children:"+ New Task"})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 h-full overflow-hidden",children:[o.jsxs("div",{className:"bg-slate-100 rounded-lg p-3 flex flex-col h-full max-h-full",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3 px-1",children:[o.jsx("h3",{className:"font-bold text-slate-700 text-sm uppercase tracking-wide",children:"To Do"}),o.jsx("span",{className:"bg-slate-200 text-slate-700 text-xs px-2 py-0.5 rounded-full",children:ve.todo.length})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:ve.todo.map(P=>o.jsx(mf,{task:P,onSelect:x},P.id))})]}),o.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 flex flex-col h-full max-h-full border border-blue-100",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3 px-1",children:[o.jsx("h3",{className:"font-bold text-blue-800 text-sm uppercase tracking-wide",children:"In Progress"}),o.jsx("span",{className:"bg-blue-200 text-blue-800 text-xs px-2 py-0.5 rounded-full",children:ve.inProgress.length})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:ve.inProgress.map(P=>o.jsx(mf,{task:P,onSelect:x},P.id))})]}),o.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 flex flex-col h-full max-h-full border border-orange-100",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3 px-1",children:[o.jsx("h3",{className:"font-bold text-orange-800 text-sm uppercase tracking-wide",children:"Review"}),o.jsx("span",{className:"bg-orange-200 text-orange-800 text-xs px-2 py-0.5 rounded-full",children:ve.review.length})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:ve.review.map(P=>o.jsx(mf,{task:P,onSelect:x},P.id))})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-3 flex flex-col h-full max-h-full border border-green-100",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3 px-1",children:[o.jsx("h3",{className:"font-bold text-green-800 text-sm uppercase tracking-wide",children:"Closed"}),o.jsx("span",{className:"bg-green-200 text-green-800 text-xs px-2 py-0.5 rounded-full",children:ve.closed.length})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:ve.closed.map(P=>o.jsx(mf,{task:P,onSelect:x},P.id))})]})]}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:()=>f(!1),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg p-6",onClick:P=>P.stopPropagation(),children:[o.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:"Create New Task"}),o.jsxs("form",{onSubmit:Pe,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Title"}),o.jsx("input",{type:"text",value:E,onChange:P=>A(P.target.value),required:!0,className:"w-full border rounded p-2 text-sm",placeholder:"e.g. Server Maintenance"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Description"}),o.jsx("textarea",{value:V,onChange:P=>C(P.target.value),rows:3,className:"w-full border rounded p-2 text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Category"}),o.jsxs("select",{value:ae,onChange:P=>K(P.target.value),className:"w-full border rounded p-2 text-sm",children:[o.jsx("option",{children:"Operations"}),o.jsx("option",{children:"IT Support"}),o.jsx("option",{children:"ERP"}),o.jsx("option",{children:"Finance"}),o.jsx("option",{children:"HR"}),o.jsx("option",{children:"Other"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Priority"}),o.jsxs("select",{value:O,onChange:P=>z(P.target.value),className:"w-full border rounded p-2 text-sm",children:[o.jsx("option",{children:"Low"}),o.jsx("option",{children:"Medium"}),o.jsx("option",{children:"High"}),o.jsx("option",{children:"Critical"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Start Date"}),o.jsx("input",{type:"date",value:Q,onChange:P=>j(P.target.value),className:"w-full border rounded p-2 text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Due Date"}),o.jsx("input",{type:"date",value:ee,onChange:P=>B(P.target.value),className:"w-full border rounded p-2 text-sm",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Assign To"}),o.jsxs("select",{value:T,onChange:P=>S(P.target.value),className:"w-full border rounded p-2 text-sm",required:!0,children:[o.jsx("option",{value:"",children:"Select Employee"}),e.map(P=>o.jsxs("option",{value:P.id,children:[P.firstName," ",P.lastName," (",P.department,")"]},P.id))]})]}),o.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[o.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded text-slate-600 hover:bg-slate-50",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-900 text-white rounded hover:bg-purple-800",children:"Create Task"})]})]})]})}),o.jsx(Ue,{})]})},s6=n=>{const[e,t]=L.useState("task_dashboard");return o.jsxs("div",{className:"min-h-screen bg-slate-100 flex",children:[o.jsx(XP,{activePage:e,setActivePage:t,currentUserEmail:n.currentUserEmail}),o.jsxs("div",{className:"flex-1 flex flex-col h-screen overflow-hidden",children:[o.jsxs("header",{className:"bg-purple-900 border-b border-purple-800 h-16 flex-shrink-0 flex items-center justify-between px-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:n.onBack,className:"flex items-center gap-2 text-sm font-medium text-purple-200 hover:text-white",children:[o.jsx(Mm,{className:"w-5 h-5"}),o.jsx("span",{children:"Home"})]}),o.jsx("div",{className:"h-6 w-px bg-purple-700 mx-2"}),o.jsx("h1",{className:"text-lg font-bold text-white",children:"Task Manager"})]}),o.jsxs("button",{onClick:n.onLogout,className:"flex items-center gap-2 bg-purple-800 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[o.jsx(jo,{className:"w-5 h-5"}),o.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]}),o.jsxs("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-slate-100 p-6",children:[e==="task_dashboard"&&o.jsx(n6,{tasks:n.tasks,employees:n.employees,currentUserEmail:n.currentUserEmail,onCreateTask:n.onCreateTask,onTaskWorkflowAction:n.onTaskWorkflowAction,onDeleteTask:n.onDeleteTask}),e==="task_calendar"&&o.jsx(ZP,{tasks:n.tasks,currentUserEmail:n.currentUserEmail}),e==="task_chat"&&o.jsx("div",{className:"h-full",children:o.jsx(JP,{messages:n.messages,employees:n.employees,currentUserEmail:n.currentUserEmail,onSendMessage:n.onSendMessage})}),e==="task_analytics"&&o.jsx(e6,{tasks:n.tasks,employees:n.employees}),e==="task_notes"&&o.jsx(t6,{notes:n.notes,currentUserEmail:n.currentUserEmail,onAddNote:n.onAddNote,onDeleteNote:n.onDeleteNote})]})]})]})},r6=n=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[o.jsx("path",{d:"M12 1.5l2.12 6.4H21l-5.37 3.94 2.12 6.4-5.75-4.22-5.75 4.22 2.12-6.4L3 7.9h6.88L12 1.5zm0 3.82l-1.41 4.28H6.3l3.63 2.65-1.42 4.28L12 13.9l3.49 2.63-1.42-4.28L17.7 9.6h-4.29L12 5.32z"}),o.jsx("path",{d:"M12 1.5l-2.12 6.4H3l5.37 3.94-2.12 6.4 5.75-4.22 5.75 4.22-2.12-6.4L21 7.9h-6.88L12 1.5zm0 3.82L13.41 9.6h4.29l-3.63 2.65 1.42 4.28L12 13.9 8.51 16.53l1.42-4.28L6.3 9.6h4.29L12 5.32z",transform:"rotate(60 12 12)"})]}),i6=({onUpdatePassword:n,onSkip:e})=>{const[t,r]=L.useState(""),[a,c]=L.useState(""),[d,f]=L.useState(null),[m,x]=L.useState(!1),y=async v=>{if(v.preventDefault(),f(null),!t||!a){f({type:"error",text:"Please fill in both fields."});return}if(t!==a){f({type:"error",text:"Passwords do not match."});return}if(t.length<6){f({type:"error",text:"Password must be at least 6 characters long."});return}x(!0);const E=await n(t);x(!1),E.success||f({type:"error",text:E.message})};return o.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white p-8 md:p-12 rounded-2xl shadow-lg w-full max-w-md transform transition-all duration-300",children:[o.jsxs("div",{className:"flex flex-col items-center mb-8",children:[o.jsx(r6,{className:"w-20 h-20 text-orange-500 mb-4"}),o.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Change Your Password"}),o.jsx("p",{className:"text-slate-500 text-center mt-2",children:"For enhanced security, you can update your password now or skip for later."})]}),o.jsxs("form",{onSubmit:y,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-slate-600",children:"New Password"}),o.jsx("input",{id:"newPassword",type:"password",value:t,onChange:v=>r(v.target.value),className:"mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",placeholder:""})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-600",children:"Confirm New Password"}),o.jsx("input",{id:"confirmPassword",type:"password",value:a,onChange:v=>c(v.target.value),className:"mt-1 block w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",placeholder:""})]}),d&&o.jsx("p",{className:`text-sm ${d.type==="error"?"text-red-500":"text-green-600"}`,children:d.text}),o.jsxs("div",{className:"space-y-4 pt-2",children:[o.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-colors duration-200 disabled:bg-teal-400",children:m?"Saving...":"Save and Continue"}),o.jsx("button",{type:"button",onClick:e,className:"w-full flex justify-center py-3 px-4 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-slate-700 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 transition-colors duration-200",children:"Skip for now"})]})]})]})})},a6=()=>{var oi;const[n,e]=L.useState(!1),[t,r]=L.useState(!1),[a,c]=L.useState(null),[d,f]=L.useState(null),[m,x]=L.useState(!0),[y,v]=L.useState([]),[E,A]=L.useState([]),[V,C]=L.useState({}),[O,z]=L.useState([]),[ae,K]=L.useState([]),[ee,B]=L.useState([]),[Q,j]=L.useState([]),[T,S]=L.useState([]),[N,R]=L.useState([]),[D,M]=L.useState([]),[Te,Pe]=L.useState([]),[W,ce]=L.useState([]),[ve,ke]=L.useState([]),[Ue,P]=L.useState([]),[$,le]=L.useState([]),[_e,Ne]=L.useState([]),[F,me]=L.useState([]),[H,pe]=L.useState([]);L.useEffect(()=>{n&&d==="admin"&&ee.length===0&&(async()=>{const ye=[{itemCode:"CON-101",model:"Tomatoes",itemName:"Tomatoes",type:"Kitchen",subCategory:"Vegetables",brand:"Local Vendor",quantity:30,unit:"Kg",condition:"Fresh",status:"In Stock",assignedTo:"",location:"Kitchen Store",purchaseDate:"2024-03-01",cost:"150",remarks:"Fresh stock"},{itemCode:"CON-102",model:"Onions",itemName:"Onions",type:"Kitchen",subCategory:"Vegetables",brand:"Local Vendor",quantity:40,unit:"Kg",condition:"Good",status:"In Stock",assignedTo:"",location:"Kitchen Store",purchaseDate:"2024-03-01",cost:"80",remarks:""},{itemCode:"CON-103",model:"Fine Flour",itemName:"Fine Flour",type:"Kitchen",subCategory:"Bakery",brand:"Local Vendor",quantity:100,unit:"kg",condition:"Good",status:"In Stock",assignedTo:"",location:"Store Room",purchaseDate:"2024-02-25",cost:"1200",remarks:"Dry storage"},{itemCode:"KFA-001",model:"Industrial Pizza Oven",itemName:"Pizza Oven XL",type:"Kitchen",subCategory:"Cooking Equipment",brand:"Rational",material:"Stainless Steel",quantity:1,unit:"Pcs",condition:"Excellent",status:"In Stock",assignedTo:"",location:"Main Kitchen",purchaseDate:"2023-05-12",cost:"450,000",remarks:"Serviced monthly"},{itemCode:"KFA-002",model:"20L Dough Mixer",itemName:"Planetary Mixer",type:"Kitchen",subCategory:"Bakery Tools",brand:"Hobart",material:"Cast Iron/Steel",quantity:2,unit:"Pcs",condition:"Good",status:"In Use",assignedTo:"Chef Ahmed",location:"Bakery Lab",purchaseDate:"2023-01-20",cost:"185,000",remarks:"Heavy duty"},{itemCode:"KFA-003",model:"Commercial Deep Fridge",itemName:"Vertical Chiller",type:"Kitchen",subCategory:"Refrigeration",brand:"Haier",material:"Aluminum/Fiber",quantity:1,unit:"Pcs",condition:"New",status:"In Stock",assignedTo:"",location:"Storage Area",purchaseDate:"2024-02-15",cost:"120,000",remarks:"Warranty active"},{itemCode:"KFA-004",model:"4-Burner Range",itemName:"Cooking Range",type:"Kitchen",subCategory:"Cooking Equipment",brand:"Super Asia",material:"Metal/Brass",quantity:3,unit:"Pcs",condition:"Good",status:"In Use",assignedTo:"Chef Maria",location:"Main Kitchen",purchaseDate:"2022-11-05",cost:"85,000",remarks:"Needs igniter check"},{itemCode:"KFA-005",model:"Stainless Prep Table",itemName:"Work Station",type:"Kitchen",subCategory:"Furniture",brand:"Custom Fabrication",material:"Stainless Steel 304",quantity:4,unit:"Pcs",condition:"Good",status:"In Stock",assignedTo:"",location:"Prep Lab",purchaseDate:"2023-06-30",cost:"45,000",remarks:"Sanitary grade"}],de=Ee.batch();ye.forEach(he=>{const Le=Ee.collection("inventory").doc();de.set(Le,he)}),await de.commit()})()},[n,d,ee.length]),L.useEffect(()=>df.onAuthStateChanged(ye=>{ye?(e(!0),ye.email==="admin@masbot.erp"?f("admin"):f(ye.email)):n||(f(null),c(null)),x(!1)}),[n]),L.useEffect(()=>{if(!d){v([]),A([]);return}let ne=[];return(async()=>{try{ne.push(Ee.collection("employees").onSnapshot(de=>v(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("users").onSnapshot(de=>A(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("app_data").doc("permissions").onSnapshot(de=>{de.exists?C(de.data()):Ee.collection("app_data").doc("permissions").set({})})),ne.push(Ee.collection("leaveRequests").onSnapshot(de=>z(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("payrollHistory").where("date","!=",null).onSnapshot(de=>{const he=de.docs.map(Le=>({...Le.data(),id:Le.id}));he.sort((Le,at)=>new Date(at.date).getTime()-new Date(Le.date).getTime()),K(he)})),ne.push(Ee.collection("inventory").onSnapshot(de=>B(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("labs").onSnapshot(de=>j(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("toners").onSnapshot(de=>S(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("mrfs").onSnapshot(de=>R(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("attendanceRecords").onSnapshot(de=>M(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("supplyChainRequests").onSnapshot(de=>Pe(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("purchaseRequests").onSnapshot(de=>ce(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("recipes").onSnapshot(de=>ke(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("vendors").onSnapshot(de=>P(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("purchaseOrders").onSnapshot(de=>le(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("tasks").onSnapshot(de=>Ne(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("messages").onSnapshot(de=>me(de.docs.map(he=>({...he.data(),id:he.id}))))),ne.push(Ee.collection("notes").onSnapshot(de=>pe(de.docs.map(he=>({...he.data(),id:he.id})))))}catch(de){console.error("Firebase init failed",de)}})(),()=>{ne.forEach(de=>de())}},[d]);const Be=ne=>{const ye=new Date(ne),de=new Date().getFullYear(),he=ye.getFullYear(),Le={annual:{total:14,used:0},sick:{total:7,used:0},casual:{total:6,used:0},maternity:{total:90,used:0},paternity:{total:7,used:0},alternateDayOff:{total:50,used:0},others:{total:0,used:0}};if(he<de)return Le;const Rn=(12-ye.getMonth())/12;return{annual:{total:Math.round(14*Rn),used:0},sick:{total:Math.round(7*Rn),used:0},casual:{total:Math.round(6*Rn),used:0},maternity:{total:90,used:0},paternity:{total:7,used:0},alternateDayOff:{total:Math.round(50*Rn),used:0},others:{total:0,used:0}}},gt=async(ne,ye)=>{if(!ye)return!1;if(ne==="admin"&&ye==="123")return e(!0),f("admin"),!0;try{const de=await Ee.collection("users").where("email","==",ne).get();if(!de.empty){const he=de.docs[0].data();if(he.password===ye){e(!0),f(ne),r(!!he.passwordChangeRequired);const Le=ne.includes("@")?ne:`${ne}@masbot.erp`;try{await df.signInWithEmailAndPassword(Le,ye.length>=6?ye:`${ye}fallback`)}catch{console.warn("Firebase Auth sync skipped.")}return!0}}try{return await df.signInWithEmailAndPassword(ne,ye),e(!0),f(ne),!0}catch(he){throw he.code==="auth/configuration-not-found"&&console.error("Firebase Auth not enabled."),he}}catch(de){throw console.error("Login process error:",de),de}},Lt=async()=>{try{await df.signOut()}catch{}e(!1),f(null),c(null)},ns=async(ne,ye)=>{const de=ne.employmentType==="Permanent"?Be(ne.joiningDate):{annual:{total:0,used:0},sick:{total:0,used:0},casual:{total:0,used:0},maternity:{total:0,used:0},paternity:{total:0,used:0},alternateDayOff:{total:0,used:0},others:{total:0,used:0}},he=await Ee.collection("employees").add({...ne,leaveBalance:de});await Ee.collection("users").doc(ne.email).set({email:ne.email,password:ye,passwordChangeRequired:!0,employeeId:he.id})},En=async(ne,ye)=>{const de=Ee.collection("employees").doc(ne);return ye.employmentType==="Permanent"?await de.update({...ye,leaveBalance:Be(new Date().toISOString().split("T")[0])}):await de.update(ye),{success:!0,message:"Employee updated successfully"}},gr=async ne=>(await Ee.collection("employees").doc(ne).update({status:"Resigned"}),{success:!0,message:"Employee marked as resigned."}),si=async(ne,ye)=>{await Ee.collection("app_data").doc("permissions").set({...V,[ne]:ye})},mc=async ne=>{await Ee.collection("leaveRequests").add(ne)},Ro=async(ne,ye)=>{const de=Ee.collection("leaveRequests").doc(ne),he=O.find(Le=>Le.id===ne);if(ye==="Approve"&&he)if(he.status==="Pending HOD")await de.update({status:"Pending HR"});else{await de.update({status:"Approved"});const Le=Math.ceil(Math.abs(new Date(he.toDate).getTime()-new Date(he.fromDate).getTime())/(1e3*60*60*24))+1,at={"Casual Leave":"casual","Sick Leave":"sick","Annual Leave":"annual","Maternity Leave":"maternity","Paternity Leave":"paternity","Alternate Day Off":"alternateDayOff",Others:"others"}[he.leaveType];await Ee.collection("employees").doc(he.employeeId).update({[`leaveBalance.${at}.used`]:ms.firestore.FieldValue.increment(Le)})}else await de.update({status:"Rejected"})},ri=async()=>{const ne={id:"",date:new Date().toISOString(),monthYear:new Date().toLocaleString("default",{month:"long",year:"numeric"}),totalPayroll:0,totalDeductions:0,totalNetPay:0,employeeRecords:y.map(ye=>({employeeId:ye.id,employeeName:`${ye.firstName} ${ye.lastName}`,department:ye.department,baseSalary:parseFloat(ye.salary),deductions:0,netPay:parseFloat(ye.salary)}))};return ne.totalPayroll=ne.employeeRecords.reduce((ye,de)=>ye+de.baseSalary,0),ne.totalNetPay=ne.employeeRecords.reduce((ye,de)=>ye+de.netPay,0),await Ee.collection("payrollHistory").add(ne),{success:!0,message:"Payroll run successfully."}},xr=async ne=>{const ye=Ee.batch();return ne.forEach(de=>ye.set(Ee.collection("attendanceRecords").doc(`${de.employeeId}_${de.date}`),de)),await ye.commit(),{success:!0,message:"Attendance records uploaded."}},yr=async ne=>{const ye=Ee.batch();ne.forEach(de=>ye.set(Ee.collection("inventory").doc(),de)),await ye.commit()},Co=async ne=>{const{id:ye,...de}=ne;await Ee.collection("inventory").doc(ye).update(de)},ii=async ne=>{await Ee.collection("inventory").doc(ne).delete()},en=async(ne,ye)=>{const de=Q.find(he=>he.id===ne);de&&await Ee.collection("labs").doc(ne).update({systems:[...de.systems,{...ye,id:`SYS-${Date.now()}`}]})},ko=async(ne,ye)=>{const de=Q.find(he=>he.id===ne);de&&await Ee.collection("labs").doc(ne).update({systems:de.systems.map(he=>he.id===ye.id?ye:he)})},Ut=async(ne,ye)=>{const de=Q.find(he=>he.id===ne);de&&await Ee.collection("labs").doc(ne).update({systems:de.systems.filter(he=>he.id!==ye)})},Kt=async ne=>{const ye=T.find(de=>de.model===ne.model);ye?await Ee.collection("toners").doc(ye.id).update({quantity:ne.filledQuantity+ne.emptyQuantity,compatiblePrinters:ne.compatiblePrinters}):(ne.filledQuantity>0&&await Ee.collection("toners").add({model:ne.model,compatiblePrinters:ne.compatiblePrinters,quantity:ne.filledQuantity,status:"Filled"}),ne.emptyQuantity>0&&await Ee.collection("toners").add({model:ne.model,compatiblePrinters:ne.compatiblePrinters,quantity:ne.emptyQuantity,status:"Empty"}))},ks=async ne=>{const ye=Ee.batch();T.filter(de=>de.model===ne).forEach(de=>ye.delete(Ee.collection("toners").doc(de.id))),await ye.commit()},Do=async ne=>{await Ee.collection("mrfs").add(ne)},xa=async ne=>{const{id:ye,...de}=ne;await Ee.collection("mrfs").doc(ye).update(de)},pc=async ne=>{await Ee.collection("mrfs").doc(ne).delete()},br=async ne=>{const ye=Ee.batch();ne.forEach(de=>ye.update(Ee.collection("inventory").doc(de.id),{quantity:de.newQuantity})),await ye.commit()},Ds=async ne=>{await Ee.collection("supplyChainRequests").add({...ne,status:"Pending Account Manager"})},on=async(ne,ye,de)=>{const he=Te.find(at=>at.id===ne),Le={status:ye==="Approve"?(he==null?void 0:he.department)==="Store"?"Forwarded to Purchase":"Pending Store":"Rejected",approvalDate:new Date().toISOString()};de&&(Le.rejectionReason=de),await Ee.collection("supplyChainRequests").doc(ne).update(Le)},Bn=async ne=>{const ye=Te.find(he=>he.id===ne);if(!ye)throw new Error("Request not found");const de=Ee.batch();de.update(Ee.collection("supplyChainRequests").doc(ne),{status:"Issued",issuedDate:new Date().toISOString()}),ye.items.forEach(he=>{he.inventoryId&&he.inventoryId.trim()!==""&&de.update(Ee.collection("inventory").doc(he.inventoryId),{quantity:ms.firestore.FieldValue.increment(-he.quantityRequested)})}),await de.commit()},pn=async ne=>{await Ee.collection("supplyChainRequests").doc(ne).update({status:"Forwarded to Purchase"})},gc=async ne=>{await Ee.collection("purchaseRequests").add(ne)},ya=async ne=>{await Ee.collection("purchaseOrders").add({...ne,status:"Pending Account Manager"})},Mo=async(ne,ye)=>{await Ee.collection("purchaseOrders").doc(ne).update(ye)},vr=async ne=>{await Ee.collection("purchaseOrders").doc(ne).delete()},xs=async(ne,ye)=>{await Ee.collection("purchaseOrders").doc(ne).update({status:ye==="Approve"?"Approved":"Rejected"})},Hs=async(ne,ye)=>{const de=$.find(Le=>Le.id===ne);if(!de)return;const he=Ee.batch();he.update(Ee.collection("purchaseOrders").doc(ne),{status:"Received",grnNumber:ye.grnNumber,grnRemarks:ye.remarks,grnDate:new Date().toISOString()}),de.items.forEach(Le=>{Le.inventoryId&&he.update(Ee.collection("inventory").doc(Le.inventoryId),{quantity:ms.firestore.FieldValue.increment(Le.quantity)})}),de.originalRequestId&&he.update(Ee.collection("supplyChainRequests").doc(de.originalRequestId),{status:"Pending Store"}),await he.commit()},ss=async(ne,ye)=>{const de=y.find(he=>`${he.firstName} ${he.lastName}`===ye);if(!de)throw new Error("Employee not found");await Ee.collection("inventory").doc(ne).update({status:"In Use",assignedTo:ye,department:de.department,designation:de.designation,issueDate:new Date().toISOString().split("T")[0]})},zn=async ne=>{await Ee.collection("inventory").doc(ne).update({status:"In Stock",assignedTo:"",department:"",designation:"",issueDate:""})},Gs=async ne=>{await Ee.collection("tasks").add({...ne,history:[{action:"Created",by:d||"Unknown",timestamp:new Date().toISOString(),details:`Task created with status ${ne.status}`}]})},ai=async(ne,ye,de,he)=>{const Le=new Date().toISOString(),at={status:ye,history:ms.firestore.FieldValue.arrayUnion({action:de,by:d||"Unknown",timestamp:Le,details:he?`${de}: ${he}`:`Status changed to ${ye}`})};he&&(ye==="Completed - Pending Review"?(at.completionRemarks=he,at.completedDate=Le):ye==="Reopened"&&(at.rejectionRemarks=he)),ye==="Closed"&&(at.completedDate=Le),await Ee.collection("tasks").doc(ne).update(at)},ba=async ne=>{await Ee.collection("tasks").doc(ne).delete()},Ms=async ne=>{const ye=JSON.parse(JSON.stringify(ne));await Ee.collection("messages").add(ye)},Ks=async ne=>{await Ee.collection("notes").add(ne)},tn=async ne=>{await Ee.collection("notes").doc(ne).delete()},va=async ne=>{const ye=await Ee.collection("users").where("email","==",d==="admin"?"admin":d).get();return ye.empty?{success:!1,message:"User record not found"}:(await Ee.collection("users").doc(ye.docs[0].id).update({password:ne,passwordChangeRequired:!1}),r(!1),{success:!0,message:"Password updated"})},Ps=hd.useMemo(()=>d==="admin"?["hr","inventory_management","supply_chain","finance","student","website","task_manager"]:!d||!V[d]?[]:Object.keys(V[d]).filter(ne=>Object.values(V[d][ne]).some(ye=>ye.view)),[d,V]);if(m)return o.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50 text-slate-500",children:"Loading ERP System..."});if(!n)return o.jsx(FM,{onLogin:gt});if(t)return o.jsx(i6,{onUpdatePassword:va,onSkip:()=>r(!1)});if(a)switch(a){case"hr":return o.jsx(EP,{onBack:()=>c(null),employees:y,users:E,onAddEmployee:ns,onLogout:Lt,allPermissions:V,onUserPermissionsChange:si,currentUserEmail:d||"",leaveRequests:O,onAddLeaveRequest:mc,onLeaveRequestAction:Ro,onResignEmployee:gr,payrollHistory:ae,onRunPayroll:ri,onUpdateEmployee:En,attendanceRecords:D,onUploadAttendance:xr});case"inventory_management":return o.jsx(zP,{onBack:()=>c(null),onLogout:Lt,currentUserEmail:d||"",permissions:(oi=V[d||""])==null?void 0:oi.inventory_management,inventory:ee,employees:y,labs:Q,toners:T,mrfs:N,recipes:ve,onAddNewAsset:yr,onUpdateAsset:Co,onDeleteAsset:ii,onResignEmployee:()=>{},onAddSystem:en,onUpdateSystem:ko,onDeleteSystem:Ut,onSaveTonerModel:Kt,onDeleteTonerModel:ks,onMarkTonerEmpty:()=>{},onMarkTonerFilled:()=>{},onAddNewMRF:Do,onUpdateMRF:xa,onDeleteMRF:pc,onUpdateKitchenStock:br,onCreateSCRequest:Ds});case"supply_chain":return o.jsx(WP,{onBack:()=>c(null),onLogout:Lt,currentUserEmail:d||"",inventory:ee,employees:y,requests:Te,purchaseRequests:W,purchaseOrders:$,recipes:ve,vendors:Ue,onCreateRequest:Ds,onActionRequest:on,onIssueRequest:Bn,onForwardToPurchase:pn,onCreatePurchaseRequest:gc,onCreatePO:ya,onUpdatePO:Mo,onDeletePO:vr,onPOAction:xs,onGRN:Hs,onAddNewAsset:yr,onUpdateAsset:Co,onDeleteAsset:ii,onIssueAsset:ss,onReturnAsset:zn});case"task_manager":return o.jsx(s6,{onBack:()=>c(null),onLogout:Lt,currentUserEmail:d||"",tasks:_e,employees:y,onCreateTask:Gs,onTaskWorkflowAction:ai,onDeleteTask:ba,messages:F,onSendMessage:Ms,notes:H,onAddNote:Ks,onDeleteNote:tn});default:return o.jsxs("div",{className:"flex h-screen items-center justify-center flex-col gap-4",children:[o.jsx("p",{children:"Module under construction"}),o.jsx("button",{onClick:()=>c(null),className:"text-blue-900 underline",children:"Go Back"})]})}const ys=y.find(ne=>ne.email===d);return ys&&ys.role==="Employee"&&d!=="admin"?o.jsx(zM,{employee:ys,onModuleSelect:c,onLogout:Lt,accessibleModules:Ps}):o.jsx(BM,{onModuleSelect:c,onLogout:Lt,accessibleModules:d==="admin"?void 0:Ps})},tS=document.getElementById("root");if(!tS)throw new Error("Could not find root element to mount to");const o6=UA.createRoot(tS);o6.render(o.jsx(hd.StrictMode,{children:o.jsx(a6,{})}));
